import{j as e,L as Lr,X as Ys,M as el,H as Jc,B as ys,U as _s,a as Zn,A as jt,C as pt,b as Yc,c as Mr,S as qc,G as ei,m as ge,d as er,e as sr,f as vn,E as wn,g as Ms,h as Ve,i as sl,k as tl,R as ct,l as Rr,T as Ot,n as ft,o as ra,p as na,P as xs,q as Vt,r as Ks,s as Vs,t as Qc,u as Zc,v as si,w as tr,x as ja,y as eo,z as ti,D as so,F as Zs,I as Zt,J as ar,K as hs,N as al,O as ai,Q as rl,V as bn,Z as nl,W as to,Y as ot,_ as yn,$ as gt,a0 as ao,a1 as ri,a2 as ro,a3 as no,a4 as io,a5 as At,a6 as il,a7 as ll,a8 as lo,a9 as co,aa as ni,ab as vr,ac as wr,ad as oo}from"./ui-vendor-6dLOkWHW.js";import{a as mo,r as S,b as Nn}from"./react-vendor-Gm9i_4Ku.js";import{u as mr,a as xo,L as jn,O as cl,R as ho,b as ks,N as Sa,B as uo}from"./router-vendor-BwhuXlSB.js";import{c as ol,t as fo}from"./utils-vendor-BTGVH9Kg.js";(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))r(n);new MutationObserver(n=>{for(const l of n)if(l.type==="childList")for(const i of l.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function t(n){const l={};return n.integrity&&(l.integrity=n.integrity),n.referrerPolicy&&(l.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?l.credentials="include":n.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function r(n){if(n.ep)return;n.ep=!0;const l=t(n);fetch(n.href,l)}})();var Sn={},ii=mo;Sn.createRoot=ii.createRoot,Sn.hydrateRoot=ii.hydrateRoot;const li=({children:s})=>e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"w-full max-w-md",children:[e.jsxs("div",{className:"flex flex-col items-center justify-center text-center mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-blue-600",children:"Kelas Guru"}),e.jsx("p",{className:"text-gray-500 mt-2",children:"Platform manajemen pembelajaran"})]}),e.jsx("div",{className:"bg-white rounded-lg shadow-md p-6",children:s}),e.jsxs("div",{className:"mt-6 text-center text-sm text-gray-500",children:["© ",new Date().getFullYear()," Kelas Guru. All rights reserved."]})]})});function ci(s,a){if(typeof s=="function")return s(a);s!=null&&(s.current=a)}function go(...s){return a=>{let t=!1;const r=s.map(n=>{const l=ci(n,a);return!t&&typeof l=="function"&&(t=!0),l});if(t)return()=>{for(let n=0;n<r.length;n++){const l=r[n];typeof l=="function"?l():ci(s[n],null)}}}}function po(s){const a=wo(s),t=S.forwardRef((r,n)=>{const{children:l,...i}=r,c=S.Children.toArray(l),d=c.find(yo);if(d){const o=d.props.children,m=c.map(g=>g===d?S.Children.count(o)>1?S.Children.only(null):S.isValidElement(o)?o.props.children:null:g);return e.jsx(a,{...i,ref:n,children:S.isValidElement(o)?S.cloneElement(o,void 0,m):null})}return e.jsx(a,{...i,ref:n,children:l})});return t.displayName=`${s}.Slot`,t}var vo=po("Slot");function wo(s){const a=S.forwardRef((t,r)=>{const{children:n,...l}=t;if(S.isValidElement(n)){const i=jo(n),c=No(l,n.props);return n.type!==S.Fragment&&(c.ref=r?go(r,i):i),S.cloneElement(n,c)}return S.Children.count(n)>1?S.Children.only(null):null});return a.displayName=`${s}.SlotClone`,a}var bo=Symbol("radix.slottable");function yo(s){return S.isValidElement(s)&&typeof s.type=="function"&&"__radixId"in s.type&&s.type.__radixId===bo}function No(s,a){const t={...a};for(const r in a){const n=s[r],l=a[r];/^on[A-Z]/.test(r)?n&&l?t[r]=(...c)=>{const d=l(...c);return n(...c),d}:n&&(t[r]=n):r==="style"?t[r]={...n,...l}:r==="className"&&(t[r]=[n,l].filter(Boolean).join(" "))}return{...s,...t}}function jo(s){var r,n;let a=(r=Object.getOwnPropertyDescriptor(s.props,"ref"))==null?void 0:r.get,t=a&&"isReactWarning"in a&&a.isReactWarning;return t?s.ref:(a=(n=Object.getOwnPropertyDescriptor(s,"ref"))==null?void 0:n.get,t=a&&"isReactWarning"in a&&a.isReactWarning,t?s.props.ref:s.props.ref||s.ref)}const oi=s=>typeof s=="boolean"?`${s}`:s===0?"0":s,di=ol,dl=(s,a)=>t=>{var r;if((a==null?void 0:a.variants)==null)return di(s,t==null?void 0:t.class,t==null?void 0:t.className);const{variants:n,defaultVariants:l}=a,i=Object.keys(n).map(o=>{const m=t==null?void 0:t[o],g=l==null?void 0:l[o];if(m===null)return null;const x=oi(m)||oi(g);return n[o][x]}),c=t&&Object.entries(t).reduce((o,m)=>{let[g,x]=m;return x===void 0||(o[g]=x),o},{}),d=a==null||(r=a.compoundVariants)===null||r===void 0?void 0:r.reduce((o,m)=>{let{class:g,className:x,...f}=m;return Object.entries(f).every(p=>{let[h,w]=p;return Array.isArray(w)?w.includes({...l,...c}[h]):{...l,...c}[h]===w})?[...o,g,x]:o},[]);return di(s,i,d,t==null?void 0:t.class,t==null?void 0:t.className)};function xt(...s){return fo(ol(s))}const So=dl("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),V=S.forwardRef(({className:s,variant:a,size:t,asChild:r=!1,...n},l)=>{const i=r?vo:"button";return e.jsx(i,{className:xt(So({variant:a,size:t,className:s})),ref:l,...n})});V.displayName="Button";const To="https://script.google.com/macros/s/AKfycbxXpRmTWd8C9Eq_bG5hIzIytGwneBKkh43QcqbDZKzqlRlPWKl9EuiyaL6qxi04P81Z/exec";let $s={username:"",password:""},Va=!1;function An(){if(Va){console.log("🔒 Session already initialized, skipping...");return}try{const s=localStorage.getItem("user");if(console.log("🔍 Initializing session, userData from localStorage:",s?"found":"not found"),s){const a=JSON.parse(s);console.log("👤 Parsed user data:",{username:a.username,role:a.role,hasPassword:!!a.password}),$s.username=a.username||"",$s.password=a.password||"",console.log("🔐 Session credentials restored:",{username:$s.username,hasPassword:!!$s.password})}Va=!0}catch(s){console.error("❌ Error initializing session:",s),localStorage.removeItem("user"),Va=!0}}An();function ko(s,a,t){if(console.log("🔐 Setting session credentials for:",s),$s.username=s,$s.password=a,t){const r={...t,password:a};console.log("💾 Saving user data to localStorage with credentials"),localStorage.setItem("user",JSON.stringify(r))}console.log("✅ Session credentials set successfully")}function la(){const s=$s.username!==""&&$s.password!=="";return console.log("🔍 Checking session credentials:",{username:$s.username,hasPassword:!!$s.password,result:s}),s}function Zr(){try{const s=localStorage.getItem("user");if(s)return JSON.parse(s)}catch(s){console.error("Error parsing user data:",s)}return null}function Fn(){console.log("🧹 Clearing session credentials"),$s.username="",$s.password="",Va=!1;try{localStorage.removeItem("user"),localStorage.removeItem("session"),localStorage.removeItem("credentials")}catch{}}function ml(){console.log("🔄 Refreshing session credentials from localStorage"),Va=!1,An()}async function be(s,a={}){try{const t=new URLSearchParams;if(t.append("action",s),s!=="login"){if(!la()&&(console.log("⚠️ No session credentials, attempting to refresh from localStorage..."),ml(),!la()))return{success:!1,error:"Tidak ada kredensial tersimpan. Silakan login terlebih dahulu."};t.append("username",$s.username),t.append("password",$s.password)}Object.entries(a).forEach(([i,c])=>{t.append(i,String(c))});const r={...Object.fromEntries(t.entries())};if(r.password&&(r.password="********"),r.studentPassword&&(r.studentPassword="********"),console.log(`API Request: ${s}`,r),s.includes("delete")||s.includes("Delete")){console.log("🗑️ DELETE OPERATION DEBUG:"),console.log("- Action:",s),console.log("- Original params:",a),console.log("- Form data entries:",Object.fromEntries(t.entries()));for(const[i,c]of t.entries())(c==="undefined"||c==="null"||c==="")&&console.warn(`⚠️ Potential issue: ${i} = "${c}"`)}if(s==="addStudent"){console.log("➕ ADD STUDENT OPERATION DEBUG:"),console.log("- Action:",s),console.log("- Original params:",a),console.log("- Form data entries (exact order):",Object.fromEntries(t.entries()));const i=[];for(const[c,d]of t.entries())i.push(`${c}=${d}`);console.log("- Form data string:",i.join("&"))}const n=await fetch(To,{method:"POST",body:t});if(!n.ok)throw new Error(`HTTP error! status: ${n.status}`);const l=await n.json();return console.log("API Response:",l),!l.success&&l.error==="Invalid credentials"&&(console.log("❌ Invalid credentials received, clearing session"),Fn()),l}catch(t){throw console.error("API request error:",t),new Error("Terjadi kesalahan saat menghubungi server")}}const mi={login:(s,a)=>be("login",{username:s,password:a}).then(t=>(t.success&&ko(s,a,t.user),t)),logout:()=>(Fn(),{success:!0}),checkLogin:()=>la(),verifyStudents:async()=>be("verifyStudents"),addSampleStudents:async()=>be("addSampleStudents"),debugAndFixData:async()=>be("debugAndFixData"),getDemoUsers:async()=>be("getDemoUsers")},et={getAll:()=>la()?be("getClasses",{username:$s.username}):Promise.resolve({success:!1,error:"Tidak ada kredensial tersimpan. Silakan login terlebih dahulu."}),create:(s,a,t)=>{const r=a?`${t} (${a})`:t;return be("addClass",{className:s,description:r})},update:(s,a,t,r)=>{const n=t?`${r} (${t})`:r;return be("updateClass",{classId:s,className:a,description:n})},delete:s=>be("deleteClass",{classId:s}),getStats:async s=>{try{const a=await be("getStudents"),t=a.success?(a.students||[]).filter(d=>d.classId===s):[],r=await be("getAssignments"),n=r.success?(r.assignments||[]).filter(d=>d.classId===s):[],l=await be("getGrades"),i=l.success?(l.grades||[]).filter(d=>d.classId===s):[];let c=null;if(i.length>0){const d=i.filter(o=>o.score&&!isNaN(parseFloat(o.score)));if(d.length>0){const o=d.reduce((m,g)=>m+parseFloat(g.score),0);c=Math.round(o/d.length*10)/10}}return{success:!0,stats:{studentsCount:t.length,assignmentsCount:n.length,averageGrade:c}}}catch(a){return console.error("Error getting class stats:",a),{success:!1,error:"Gagal mengambil statistik kelas"}}}},_o={getByClass:s=>be("getStudents",{classId:s}),addToClass:(s,a)=>be("addStudent",{classId:s,studentUsername:a}),removeFromClass:(s,a)=>be("removeStudent",{classId:s,studentUsername:a}),getAll:()=>be("getStudents"),getById:s=>be("getStudent",{id:s}),create:(s,a,t,r="pass123")=>{if(!a||!t)return Promise.resolve({success:!1,error:"Username dan nama lengkap harus diisi"});const n={classId:s,studentUsername:a,studentPassword:r,fullName:t,role:"student",pass:r,pwd:r,student_password:r};return console.log("➕ Creating student with multiple password parameters:",n),be("addStudent",n)},update:(s,a,t)=>{if(!s||s==="undefined"||s==="")return Promise.resolve({success:!1,error:"ID siswa tidak valid"});if(!a)return Promise.resolve({success:!1,error:"Nama lengkap harus diisi"});const r={id:s,studentId:s,studentUsername:s,fullName:a};return t&&(r.password=t),be("updateStudent",r)},delete:s=>{if(!s||s==="undefined"||s===""||s==="null")return console.error("❌ Invalid student ID for deletion:",s),Promise.resolve({success:!1,error:"ID siswa tidak valid atau kosong"});console.log("🗑️ Attempting to delete student with ID:",s),console.log("🗑️ Student ID type:",typeof s),console.log("🗑️ Student ID length:",s.length),console.log("🗑️ Student ID JSON:",JSON.stringify(s));const a={id:s,studentId:s,studentUsername:s};return console.log("🗑️ Delete parameters:",a),be("deleteStudent",a)}},Rt={getAll:()=>be("getAssignments"),getByClass:s=>be("getAssignments",{classId:s}),getById:s=>be("getAssignment",{id:s}),create:(s,a,t,r,n=100)=>be("addAssignment",{classId:s,title:a,description:t,dueDate:r,maxPoints:n}),update:(s,a,t,r,n=100)=>be("updateAssignment",{id:s,title:a,description:t,dueDate:r,maxPoints:n}),delete:s=>be("deleteAssignment",{id:s})},ya={getAll:()=>be("getGrades"),getByClass:s=>be("getGrades",{classId:s}),getByAssignment:s=>be("getGrades",{assignmentId:s}),getByStudent:s=>be("getGradesByStudent",{studentId:s}),create:(s,a,t,r="")=>be("addGrade",{assignmentId:s,studentUsername:a,points:t,feedback:r}),update:(s,a,t="")=>be("updateGrade",{id:s,points:a,feedback:t}),updateByStudentAssignment:(s,a,t,r="")=>be("updateGradeByStudentAssignment",{studentUsername:s,assignmentId:a,points:t,feedback:r}),delete:s=>be("deleteGrade",{id:s})},Or={getAll:()=>be("getAttendance"),getByClass:(s,a)=>{const t={classId:s};return a&&(t.date=a),be("getAttendance",t)},getByStudent:s=>be("getStudentAttendance",{studentId:s}),update:(s,a,t)=>be("updateAttendance",{classId:s,date:a,attendanceData:JSON.stringify(t)}),add:(s,a,t,r,n)=>{const l={classId:s,date:a,studentUsername:t,status:r};return n&&(l.notes=n),be("addAttendance",l)},delete:s=>be("deleteAttendance",{id:s}),getByDate:s=>be("getAttendance",{date:s}),getSummary:s=>{const a={};return s&&(a.classId=s),be("getAttendance",a)}},br={getAll:()=>be("getJournals"),getByClass:s=>be("getJournals",{classId:s}),create:(s,a,t,r,n)=>be("addJournal",{classId:s,date:a,topic:t,activities:r,notes:n}),update:(s,a,t,r)=>be("updateJournal",{journalId:s,topic:a,activities:t,notes:r}),delete:s=>be("deleteJournal",{journalId:s})},yr={getAll:()=>be("getEvents"),getByClass:s=>be("getEvents",{classId:s}),create:(s,a,t,r,n)=>be("addEvent",{classId:s,title:a,description:t,eventDate:r,eventType:n}),update:(s,a,t,r,n)=>be("updateEvent",{eventId:s,title:a,description:t,eventDate:r,eventType:n}),delete:s=>be("deleteEvent",{eventId:s})},Nr={getAll:()=>be("getQuestions"),getByClass:s=>be("getQuestions",{classId:s}),getByCategory:s=>be("getQuestions",{category:s}),create:(s,a,t,r,n,l)=>be("addQuestion",{classId:s,category:a,questionText:t,options:JSON.stringify(r),correctAnswer:n,difficulty:l}),update:(s,a,t,r,n,l)=>be("updateQuestion",{questionId:s,category:a,questionText:t,options:JSON.stringify(r),correctAnswer:n,difficulty:l}),delete:s=>be("deleteQuestion",{questionId:s})},Eo={getAll:()=>be("getGamification"),getByClass:s=>be("getGamification",{classId:s}),getByStudent:s=>be("getGamification",{studentUsername:s}),getStudentProgress:s=>be("getGamification",{studentUsername:s}),awardPoints:(s,a,t,r="")=>be("awardPoints",{classId:s,studentUsername:a,points:t,reason:r}),updateLevel:(s,a,t)=>be("updateGamificationLevel",{classId:s,studentUsername:a,level:t}),awardBadge:(s,a,t,r)=>be("awardBadge",{classId:s,studentUsername:a,badgeId:t,badgeName:r}),addAchievement:(s,a,t,r)=>be("addAchievement",{classId:s,studentUsername:a,achievementId:t,achievementName:r}),getLeaderboard:s=>{const a={};return s&&(a.classId=s),be("getGamificationLeaderboard",a)},getAchievements:s=>be("getGamification",{studentUsername:s}),initializeStudent:(s,a)=>be("initializeGamification",{classId:s,studentUsername:a}),update:(s,a,t)=>be("updateGamification",{classId:s,studentUsername:a,...t}),getStats:()=>be("getGamificationStats"),awardAchievement:(s,a,t)=>be("awardGamificationAchievement",{classId:s,studentUsername:a,achievementId:t})},jr={getAll:()=>be("getBadges"),create:(s,a,t,r,n)=>be("addBadge",{name:s,description:a,icon:t,category:r,pointValue:n}),update:(s,a,t,r,n,l)=>be("updateBadge",{id:s,name:a,description:t,icon:r,category:n,pointValue:l}),delete:s=>be("deleteBadge",{id:s}),toggleStatus:s=>be("toggleBadgeStatus",{id:s})},Sr={getAll:()=>be("getLevels"),create:(s,a,t,r)=>be("addLevel",{name:s,pointsRequired:a,benefits:t,color:r}),update:(s,a,t,r,n)=>be("updateLevel",{id:s,name:a,pointsRequired:t,benefits:r,color:n}),delete:s=>be("deleteLevel",{id:s})},Ga={getAll:()=>be("getChallenges"),create:(s,a,t,r)=>be("addChallenge",{title:s,description:a,reward:t,deadline:r}),update:(s,a,t,r,n)=>be("updateChallenge",{id:s,title:a,description:t,reward:r,deadline:n}),delete:s=>be("deleteChallenge",{id:s}),toggleStatus:s=>be("toggleChallengeStatus",{id:s})},ta={getAll:()=>be("getStudents"),getByClass:s=>be("getStudents").then(a=>{if(a.success){const t=(a.students||[]).filter(r=>r.classId===s);return{...a,students:t}}return a}),create:(s,a,t,r="pass123")=>{if(!a||!t)return Promise.resolve({success:!1,error:"Username dan nama lengkap harus diisi"});const n={classId:s,studentUsername:a,studentPassword:r,fullName:t,role:"student",pass:r,pwd:r,student_password:r};return console.log("➕ Creating student with multiple password parameters:",n),be("addStudent",n)},update:(s,a,t)=>{if(!s||s==="undefined"||s==="")return Promise.resolve({success:!1,error:"ID siswa tidak valid"});if(!a)return Promise.resolve({success:!1,error:"Nama lengkap harus diisi"});const r={id:s,studentId:s,studentUsername:s,fullName:a};return t&&(r.password=t),be("updateStudent",r)},delete:s=>{if(!s||s==="undefined"||s===""||s==="null")return console.error("❌ Invalid student ID for deletion:",s),Promise.resolve({success:!1,error:"ID siswa tidak valid atau kosong"});console.log("🗑️ Attempting to delete student with ID:",s),console.log("🗑️ Student ID type:",typeof s),console.log("🗑️ Student ID length:",s.length),console.log("🗑️ Student ID JSON:",JSON.stringify(s));const a={id:s,studentId:s,studentUsername:s};return console.log("🗑️ Delete parameters:",a),be("deleteStudent",a)}},Co=()=>{var o,m,g,x,f,p;const s=mr(),a=xo(),[t,r]=S.useState(null),[n,l]=S.useState(!1);S.useEffect(()=>{const h=Zr();h?r(h):s("/login")},[s]);const i=()=>{Fn(),s("/login")},c=()=>{l(!n)};S.useEffect(()=>{l(!1)},[a.pathname]);const d=[{name:"Dashboard",path:"/guru",icon:e.jsx(Jc,{size:20})},{name:"Kelas",path:"/guru/kelas",icon:e.jsx(ys,{size:20})},{name:"Siswa",path:"/guru/siswa",icon:e.jsx(_s,{size:20})},{name:"Tugas",path:"/guru/tugas",icon:e.jsx(Zn,{size:20})},{name:"Nilai",path:"/guru/nilai",icon:e.jsx(jt,{size:20})},{name:"Presensi",path:"/guru/presensi",icon:e.jsx(pt,{size:20})},{name:"Jurnal",path:"/guru/jurnal",icon:e.jsx(Yc,{size:20})},{name:"Kegiatan",path:"/guru/kegiatan",icon:e.jsx(pt,{size:20})},{name:"Bank Soal",path:"/guru/bank-soal",icon:e.jsx(Zn,{size:20})},{name:"Gamifikasi",path:"/guru/gamifikasi",icon:e.jsx(Mr,{size:20})},{name:"Pengaturan",path:"/guru/pengaturan",icon:e.jsx(qc,{size:20})}];return t?e.jsxs("div",{className:"min-h-screen bg-background flex",children:[e.jsx("div",{className:"hidden lg:flex w-64 flex-col fixed inset-y-0 z-50",children:e.jsxs("div",{className:"flex flex-col h-full bg-card border-r border-border",children:[e.jsx("div",{className:"h-16 flex items-center px-6 border-b border-border bg-card",children:e.jsx("h1",{className:"text-xl font-bold text-foreground",children:"Kelas Guru"})}),e.jsx("div",{className:"flex-1 py-4 flex flex-col gap-1 overflow-y-auto",children:d.map(h=>e.jsxs(jn,{to:h.path,className:`flex items-center gap-3 px-4 py-3 mx-3 rounded-lg text-sm font-medium transition-all duration-200 ${a.pathname===h.path?"bg-primary text-primary-foreground shadow-md":"text-muted-foreground hover:bg-muted hover:text-foreground"}`,children:[h.icon,h.name]},h.path))}),e.jsxs("div",{className:"p-4 border-t border-border bg-card",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4 p-3 bg-muted/30 rounded-lg",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-primary/10 flex items-center justify-center text-primary font-semibold",children:((o=t.fullName)==null?void 0:o[0])||((m=t.username)==null?void 0:m[0])||"G"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"font-medium text-foreground truncate",children:t.fullName||t.username||"Guru"}),e.jsx("div",{className:"text-xs text-muted-foreground truncate",children:t.username})]})]}),e.jsxs(V,{variant:"outline",className:"w-full justify-start gap-2 h-10",onClick:i,children:[e.jsx(Lr,{size:18}),"Keluar"]})]})]})}),e.jsxs("div",{className:"flex-1 lg:pl-64",children:[e.jsxs("header",{className:"h-16 lg:hidden flex items-center justify-between border-b border-border px-4 bg-card/80 backdrop-blur-sm sticky top-0 z-40",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(V,{variant:"ghost",size:"icon",onClick:c,className:"text-foreground hover:bg-muted",children:n?e.jsx(Ys,{size:24}):e.jsx(el,{size:24})}),e.jsx("h1",{className:"text-lg font-bold text-foreground",children:"Kelas Guru"})]}),e.jsx("div",{className:"w-8 h-8 rounded-full bg-primary/10 flex items-center justify-center text-primary text-sm font-semibold",children:((g=t.fullName)==null?void 0:g[0])||((x=t.username)==null?void 0:x[0])||"G"})]}),n&&e.jsxs("div",{className:"fixed inset-0 z-50 lg:hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-background/80 backdrop-blur-sm",onClick:c}),e.jsxs("div",{className:"absolute inset-y-0 left-0 w-80 max-w-[85vw] bg-card shadow-2xl",children:[e.jsxs("div",{className:"h-16 flex items-center justify-between px-6 border-b border-border",children:[e.jsx("h1",{className:"text-lg font-bold text-foreground",children:"Menu"}),e.jsx(V,{variant:"ghost",size:"icon",onClick:c,className:"text-muted-foreground hover:text-foreground",children:e.jsx(Ys,{size:20})})]}),e.jsx("div",{className:"p-4 border-b border-border",children:e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-muted/30 rounded-lg",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-primary/10 flex items-center justify-center text-primary font-semibold",children:((f=t.fullName)==null?void 0:f[0])||((p=t.username)==null?void 0:p[0])||"G"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"font-medium text-foreground truncate",children:t.fullName||t.username||"Guru"}),e.jsx("div",{className:"text-sm text-muted-foreground truncate",children:t.username})]})]})}),e.jsxs("div",{className:"flex-1 py-4 overflow-y-auto",children:[e.jsx("div",{className:"space-y-1 px-4",children:d.map(h=>e.jsxs(jn,{to:h.path,className:`flex items-center gap-3 px-4 py-3 rounded-lg text-sm font-medium transition-all duration-200 ${a.pathname===h.path?"bg-primary text-primary-foreground shadow-md":"text-muted-foreground hover:bg-muted hover:text-foreground"}`,onClick:c,children:[h.icon,h.name]},h.path))}),e.jsx("div",{className:"mt-6 px-4",children:e.jsxs(V,{variant:"outline",className:"w-full justify-start gap-2 h-11",onClick:i,children:[e.jsx(Lr,{size:18}),"Keluar"]})})]})]})]}),e.jsx("main",{className:"p-4 sm:p-6 lg:p-8 min-h-[calc(100vh-4rem)] lg:min-h-screen",children:e.jsx(cl,{})})]})]}):e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-background",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin w-8 h-8 border-2 border-primary border-t-transparent rounded-full mx-auto mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"Loading..."})]})})},Ao=()=>{var c,d;const s=mr(),[a,t]=S.useState(null),[r,n]=S.useState(!1);S.useEffect(()=>{const o=localStorage.getItem("user");if(!o){s("/login");return}try{const m=JSON.parse(o);if(m.role!=="student"){s("/login");return}t(m)}catch{s("/login")}},[s]);const l=()=>{localStorage.removeItem("user"),s("/login")},i=()=>{n(!r)};return a?e.jsxs("div",{className:"min-h-screen bg-[#1a1c2e] text-white",children:[e.jsxs("header",{className:"h-16 flex items-center justify-between border-b border-[#353964] px-4 lg:px-8 bg-[#252940]",children:[e.jsx("div",{className:"flex items-center gap-3",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ei,{className:"h-6 w-6 text-indigo-400"}),e.jsx("h1",{className:"text-xl font-bold bg-gradient-to-r from-indigo-400 to-purple-400 bg-clip-text text-transparent",children:"Student Dashboard"})]})}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"hidden md:flex items-center gap-3",children:[e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"font-medium",children:a.fullName||"Student"}),e.jsx("div",{className:"text-xs text-indigo-300",children:a.className||"Student"})]}),e.jsx("div",{className:"w-10 h-10 rounded-full bg-indigo-600 flex items-center justify-center text-white ring-2 ring-purple-400",children:((c=a.fullName)==null?void 0:c[0])||"S"})]}),e.jsx(V,{variant:"ghost",size:"icon",onClick:i,className:"md:hidden text-white hover:bg-[#353964]",children:r?e.jsx(Ys,{size:24}):e.jsx(el,{size:24})}),e.jsxs(V,{variant:"outline",size:"sm",className:"hidden md:flex gap-2 bg-[#252940] border-[#353964] text-gray-300 hover:bg-[#353964] hover:text-white",onClick:l,children:[e.jsx(Lr,{size:16}),"Logout"]})]})]}),r&&e.jsx("div",{className:"fixed inset-0 z-40 md:hidden bg-black/50 backdrop-blur-sm",onClick:i,children:e.jsxs("div",{className:"fixed inset-y-0 right-0 w-3/4 max-w-sm z-50 bg-[#252940]",onClick:o=>o.stopPropagation(),children:[e.jsx("div",{className:"h-16 flex items-center px-6 border-b border-[#353964]",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ei,{className:"h-5 w-5 text-indigo-400"}),e.jsx("h1",{className:"text-lg font-bold bg-gradient-to-r from-indigo-400 to-purple-400 bg-clip-text text-transparent",children:"Menu"})]})}),e.jsx("div",{className:"p-4",children:e.jsxs("div",{className:"bg-[#1e213a] rounded-lg p-4 border border-[#353964]",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-indigo-600 flex items-center justify-center text-white ring-2 ring-purple-400",children:((d=a.fullName)==null?void 0:d[0])||"S"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:a.fullName||"Student"}),e.jsx("div",{className:"text-xs text-indigo-300",children:a.className||"Student"})]})]}),e.jsxs(V,{variant:"outline",className:"w-full justify-start gap-2 bg-[#252940] border-[#353964] text-gray-300 hover:bg-[#353964] hover:text-white",onClick:l,children:[e.jsx(Lr,{size:18}),"Logout"]})]})})]})}),e.jsx("main",{className:"min-h-[calc(100vh-4rem)]",children:e.jsx(cl,{})})]}):e.jsx("div",{className:"min-h-screen bg-[#1a1c2e] flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin w-12 h-12 border-4 border-purple-500 border-t-transparent rounded-full mx-auto mb-4"}),e.jsx("p",{className:"text-white font-medium",children:"Loading..."})]})})},Ge=S.forwardRef(({className:s,...a},t)=>e.jsx("div",{ref:t,className:xt("rounded-xl border bg-card text-card-foreground shadow-sm transition-all duration-200 hover:shadow-md",s),...a}));Ge.displayName="Card";const ms=S.forwardRef(({className:s,...a},t)=>e.jsx("div",{ref:t,className:xt("flex flex-col space-y-1.5 p-6",s),...a}));ms.displayName="CardHeader";const ls=S.forwardRef(({className:s,...a},t)=>e.jsx("h3",{ref:t,className:xt("text-2xl font-semibold leading-none tracking-tight",s),...a}));ls.displayName="CardTitle";const bs=S.forwardRef(({className:s,...a},t)=>e.jsx("p",{ref:t,className:xt("text-sm text-muted-foreground",s),...a}));bs.displayName="CardDescription";const We=S.forwardRef(({className:s,...a},t)=>e.jsx("div",{ref:t,className:xt("p-6 pt-0",s),...a}));We.displayName="CardContent";const Fo=S.forwardRef(({className:s,...a},t)=>e.jsx("div",{ref:t,className:xt("flex items-center p-6 pt-0",s),...a}));Fo.displayName="CardFooter";const He=S.forwardRef(({className:s,type:a,...t},r)=>e.jsx("input",{type:a,className:xt("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",s),ref:r,...t}));He.displayName="Input";function dt({size:s="md",className:a}){const t={sm:"w-4 h-4",md:"w-6 h-6",lg:"w-8 h-8"};return e.jsx(ge.div,{className:xt("animate-spin rounded-full border-2 border-current border-t-transparent",t[s],a),animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"}})}function Tn({className:s,rows:a=3}){return e.jsx("div",{className:xt("space-y-3",s),children:Array.from({length:a}).map((t,r)=>e.jsx(ge.div,{className:"h-4 bg-muted rounded",style:{width:`${Math.random()*40+60}%`},animate:{opacity:[.5,1,.5]},transition:{duration:1.5,repeat:1/0,delay:r*.1,ease:"easeInOut"}},r))})}function xl({className:s}){return e.jsxs("div",{className:xt("p-4 border rounded-lg space-y-3",s),children:[e.jsx(ge.div,{className:"h-6 bg-muted rounded w-3/4",animate:{opacity:[.5,1,.5]},transition:{duration:1.5,repeat:1/0}}),e.jsx(Tn,{rows:2}),e.jsx(ge.div,{className:"h-8 bg-muted rounded w-1/4",animate:{opacity:[.5,1,.5]},transition:{duration:1.5,repeat:1/0,delay:.2}})]})}const Do=()=>{const s=mr(),[a,t]=S.useState(!1),[r,n]=S.useState(!1),[l,i]=S.useState(""),[c,d]=S.useState(!1),[o,m]=S.useState({username:"",password:""}),[g,x]=S.useState(""),[f,p]=S.useState("teacher"),[h,w]=S.useState(!1);S.useEffect(()=>{const D=Zr();D&&(D.role==="teacher"?s("/guru"):D.role==="student"&&s("/siswa"))},[s]);const L=D=>{const{name:q,value:z}=D.target;m(G=>({...G,[q]:z})),g&&x("")},O=async D=>{if(D.preventDefault(),x(""),t(!0),!o.username||!o.password){x("Username dan password harus diisi"),t(!1);return}try{const q=await mi.login(o.username,o.password);q.success?q.user.role==="teacher"?s("/guru"):q.user.role==="student"?s("/siswa"):x("Tipe user tidak valid."):(x("Username atau password tidak valid. Silakan coba lagi."),console.error("Login error:",q.error))}catch(q){x("Terjadi kesalahan saat menghubungi server. Silakan coba beberapa saat lagi."),console.error(q)}finally{t(!1)}},I=D=>{p(D),m({username:"",password:""}),x("")},H=async()=>{n(!0),i("");try{const D=await mi.verifyStudents();D.success?i(`Verifikasi berhasil: ${D.message}`):i(`Verifikasi gagal: ${D.error}`)}catch(D){i("Terjadi kesalahan saat melakukan verifikasi"),console.error(D)}finally{n(!1)}};S.useEffect(()=>{const D=q=>{q.ctrlKey&&q.shiftKey&&q.key==="A"&&w(z=>!z)};return window.addEventListener("keydown",D),()=>{window.removeEventListener("keydown",D)}},[]);const ae={hidden:{opacity:0},visible:{opacity:1,transition:{duration:.6,staggerChildren:.1}}},oe={hidden:{opacity:0,y:20},visible:{opacity:1,y:0}};return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-indigo-50 to-purple-50 flex items-center justify-center p-4",children:e.jsxs(ge.div,{initial:"hidden",animate:"visible",variants:ae,className:"w-full max-w-md relative",children:[e.jsx(ge.div,{variants:oe,className:"mb-6",children:e.jsxs("div",{className:"flex bg-gray-100 rounded-xl p-1",children:[e.jsxs("button",{className:`flex-1 py-3 px-4 flex items-center justify-center gap-2 rounded-lg transition-all duration-200 text-sm ${f==="teacher"?"bg-white text-blue-600 shadow-sm font-medium":"text-gray-600 hover:text-gray-900"}`,onClick:()=>I("teacher"),children:[e.jsx(ys,{size:18}),e.jsx("span",{children:"Guru"})]}),e.jsxs("button",{className:`flex-1 py-3 px-4 flex items-center justify-center gap-2 rounded-lg transition-all duration-200 text-sm ${f==="student"?"bg-white text-blue-600 shadow-sm font-medium":"text-gray-600 hover:text-gray-900"}`,onClick:()=>I("student"),children:[e.jsx(er,{size:18}),e.jsx("span",{children:"Siswa"})]})]})}),e.jsx(ge.div,{variants:oe,children:e.jsxs(Ge,{className:"border-0 shadow-2xl bg-white/80 backdrop-blur-xl",children:[e.jsxs(ms,{className:"pb-6 text-center",children:[e.jsx("div",{className:"w-20 h-20 bg-gradient-to-r from-blue-600 to-indigo-600 rounded-2xl flex items-center justify-center mx-auto mb-4 shadow-lg",children:e.jsx(er,{className:"w-10 h-10 text-white"})}),e.jsx(ls,{className:"text-2xl font-bold text-gray-900",children:"Kelas Guru"}),e.jsx(bs,{className:"text-base text-gray-600",children:f==="teacher"?"Masuk ke dashboard guru untuk mengelola kelas dan siswa":"Masuk ke dashboard siswa untuk melihat progress belajar"})]}),e.jsx(We,{className:"space-y-4 sm:space-y-6",children:e.jsxs("form",{onSubmit:O,className:"space-y-4 sm:space-y-5",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Username"}),e.jsxs("div",{className:"relative",children:[e.jsx(sr,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4 sm:w-5 sm:h-5"}),e.jsx(He,{type:"text",name:"username",value:o.username,onChange:L,placeholder:f==="teacher"?"Masukkan username guru":"Masukkan username siswa",className:"pl-10 sm:pl-12 h-11 sm:h-12 text-sm sm:text-base",disabled:a,autoComplete:"username"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(vn,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4 sm:w-5 sm:h-5"}),e.jsx(He,{type:c?"text":"password",name:"password",value:o.password,onChange:L,placeholder:"Masukkan password",className:"pl-10 sm:pl-12 pr-10 sm:pr-12 h-11 sm:h-12 text-sm sm:text-base",disabled:a,autoComplete:"current-password"}),e.jsx("button",{type:"button",onClick:()=>d(!c),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",disabled:a,children:c?e.jsx(wn,{className:"w-4 h-4 sm:w-5 sm:h-5"}):e.jsx(Ms,{className:"w-4 h-4 sm:w-5 sm:h-5"})})]})]}),e.jsx(Ve,{children:g&&e.jsx(ge.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg text-sm",children:g})}),e.jsx(V,{type:"submit",className:"w-full h-11 sm:h-12 bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 text-white font-medium text-sm sm:text-base",disabled:a||!o.username||!o.password,children:a?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(dt,{size:"sm"}),e.jsx("span",{children:"Masuk..."})]}):e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{children:"Masuk"}),e.jsx(sl,{className:"w-4 h-4 sm:w-5 sm:h-5"})]})})]})})]})}),e.jsx(Ve,{children:h&&e.jsx(ge.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:20},className:"mt-4 sm:mt-6",children:e.jsxs(Ge,{className:"border-orange-200 bg-orange-50/80 backdrop-blur-sm",children:[e.jsxs(ms,{className:"pb-3",children:[e.jsxs(ls,{className:"text-lg flex items-center gap-2 text-orange-800",children:[e.jsx(tl,{className:"w-5 h-5"}),"Admin Panel"]}),e.jsx(bs,{className:"text-orange-700 text-sm",children:"Panel administratif untuk verifikasi sistem"})]}),e.jsxs(We,{className:"space-y-3 sm:space-y-4",children:[e.jsx(V,{onClick:H,disabled:r,variant:"outline",className:"w-full border-orange-300 text-orange-700 hover:bg-orange-100 h-10 sm:h-11 text-sm sm:text-base",children:r?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ct,{className:"w-4 h-4 animate-spin"}),e.jsx("span",{children:"Memverifikasi..."})]}):e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(_s,{className:"w-4 h-4"}),e.jsx("span",{children:"Verifikasi Data Siswa"})]})}),e.jsx(Ve,{children:l&&e.jsx(ge.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"bg-white p-3 rounded border border-orange-200 text-sm text-gray-700",children:l})}),e.jsx("p",{className:"text-xs text-orange-600 text-center",children:"Press Ctrl+Shift+A to toggle this panel"})]})]})})})]})})},Io=()=>{const s=mr(),[a,t]=S.useState(!1),[r,n]=S.useState(!1),[l,i]=S.useState(!1),[c,d]=S.useState({username:"",password:"",confirmPassword:"",fullName:"",role:"student"}),[o,m]=S.useState(""),g=h=>{const{name:w,value:L}=h.target;d(O=>({...O,[w]:L})),o&&m("")},x=async h=>{if(h.preventDefault(),m(""),!c.fullName||!c.username||!c.password||!c.confirmPassword){m("Semua field harus diisi");return}if(c.password!==c.confirmPassword){m("Password tidak cocok");return}if(c.password.length<6){m("Password minimal 6 karakter");return}t(!0);try{await new Promise(w=>setTimeout(w,1e3)),console.log("Registration would be:",{username:c.username,fullName:c.fullName,role:c.role}),s("/login",{state:{message:"Pendaftaran berhasil! Silakan login dengan akun Anda."}})}catch(w){m("Terjadi kesalahan saat menghubungi server. Silakan coba lagi."),console.error(w)}finally{t(!1)}},f={hidden:{opacity:0},visible:{opacity:1,transition:{duration:.6,staggerChildren:.1}}},p={hidden:{opacity:0,y:20},visible:{opacity:1,y:0}};return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-indigo-50 to-purple-50 flex items-center justify-center p-4",children:e.jsxs(ge.div,{initial:"hidden",animate:"visible",variants:f,className:"w-full max-w-md relative",children:[e.jsxs(ge.div,{variants:p,className:"text-center mb-6 sm:mb-8",children:[e.jsx("div",{className:"w-16 h-16 sm:w-20 sm:h-20 bg-gradient-to-r from-green-600 to-emerald-600 rounded-2xl flex items-center justify-center mx-auto mb-4 shadow-lg",children:e.jsx(Rr,{className:"w-8 h-8 sm:w-10 sm:h-10 text-white"})}),e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900 mb-2",children:"Daftar Akun"}),e.jsx("p",{className:"text-sm sm:text-base text-gray-600",children:"Bergabung dengan platform pembelajaran modern"})]}),e.jsx(ge.div,{variants:p,children:e.jsxs(Ge,{className:"border-0 shadow-2xl bg-white/80 backdrop-blur-xl",children:[e.jsxs(ms,{className:"pb-4 sm:pb-6",children:[e.jsxs(ls,{className:"text-xl sm:text-2xl font-bold flex items-center gap-3",children:[e.jsx(tl,{className:"w-5 h-5 sm:w-6 sm:h-6 text-green-600"}),e.jsx("span",{children:"Buat Akun Baru"})]}),e.jsx(bs,{className:"text-sm sm:text-base",children:"Isi data diri Anda untuk membuat akun baru di Kelas Guru"})]}),e.jsxs(We,{className:"space-y-4 sm:space-y-6",children:[e.jsxs("form",{onSubmit:x,className:"space-y-4 sm:space-y-5",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Nama Lengkap"}),e.jsxs("div",{className:"relative",children:[e.jsx(sr,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4 sm:w-5 sm:h-5"}),e.jsx(He,{id:"fullName",name:"fullName",type:"text",value:c.fullName,onChange:g,placeholder:"Masukkan nama lengkap Anda",className:"pl-10 sm:pl-12 h-11 sm:h-12 text-sm sm:text-base",disabled:a,required:!0})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Daftar Sebagai"}),e.jsxs("div",{className:"flex bg-gray-100 rounded-xl p-1",children:[e.jsxs("button",{type:"button",className:`flex-1 py-3 px-3 sm:px-4 flex items-center justify-center gap-2 rounded-lg transition-all duration-200 text-sm sm:text-base ${c.role==="student"?"bg-white text-green-600 shadow-sm font-medium":"text-gray-600 hover:text-gray-900"}`,onClick:()=>d(h=>({...h,role:"student"})),children:[e.jsx(er,{size:18,className:"sm:w-5 sm:h-5"}),e.jsx("span",{children:"Siswa"})]}),e.jsxs("button",{type:"button",className:`flex-1 py-3 px-3 sm:px-4 flex items-center justify-center gap-2 rounded-lg transition-all duration-200 text-sm sm:text-base ${c.role==="teacher"?"bg-white text-green-600 shadow-sm font-medium":"text-gray-600 hover:text-gray-900"}`,onClick:()=>d(h=>({...h,role:"teacher"})),children:[e.jsx(ys,{size:18,className:"sm:w-5 sm:h-5"}),e.jsx("span",{children:"Guru"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Username"}),e.jsxs("div",{className:"relative",children:[e.jsx(sr,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4 sm:w-5 sm:h-5"}),e.jsx(He,{id:"username",name:"username",type:"text",value:c.username,onChange:g,placeholder:"Pilih username unik",className:"pl-10 sm:pl-12 h-11 sm:h-12 text-sm sm:text-base",disabled:a,required:!0,autoComplete:"username"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(vn,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4 sm:w-5 sm:h-5"}),e.jsx(He,{id:"password",name:"password",type:r?"text":"password",value:c.password,onChange:g,placeholder:"Minimal 6 karakter",className:"pl-10 sm:pl-12 pr-10 sm:pr-12 h-11 sm:h-12 text-sm sm:text-base",disabled:a,required:!0,autoComplete:"new-password"}),e.jsx("button",{type:"button",onClick:()=>n(!r),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",disabled:a,children:r?e.jsx(wn,{className:"w-4 h-4 sm:w-5 sm:h-5"}):e.jsx(Ms,{className:"w-4 h-4 sm:w-5 sm:h-5"})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Konfirmasi Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(vn,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4 sm:w-5 sm:h-5"}),e.jsx(He,{id:"confirmPassword",name:"confirmPassword",type:l?"text":"password",value:c.confirmPassword,onChange:g,placeholder:"Ulangi password",className:"pl-10 sm:pl-12 pr-10 sm:pr-12 h-11 sm:h-12 text-sm sm:text-base",disabled:a,required:!0,autoComplete:"new-password"}),e.jsx("button",{type:"button",onClick:()=>i(!l),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",disabled:a,children:l?e.jsx(wn,{className:"w-4 h-4 sm:w-5 sm:h-5"}):e.jsx(Ms,{className:"w-4 h-4 sm:w-5 sm:h-5"})})]})]}),e.jsx(Ve,{children:o&&e.jsx(ge.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg text-sm",children:o})}),e.jsx(V,{type:"submit",className:"w-full h-11 sm:h-12 bg-gradient-to-r from-green-600 to-emerald-600 hover:from-green-700 hover:to-emerald-700 text-white font-medium text-sm sm:text-base",disabled:a||!c.fullName||!c.username||!c.password||!c.confirmPassword,children:a?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(dt,{size:"sm"}),e.jsx("span",{children:"Mendaftar..."})]}):e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{children:"Daftar Sekarang"}),e.jsx(sl,{className:"w-4 h-4 sm:w-5 sm:h-5"})]})})]}),e.jsx("div",{className:"pt-4 border-t border-gray-200",children:e.jsx("div",{className:"text-center",children:e.jsxs("p",{className:"text-sm text-gray-600",children:["Sudah punya akun?"," ",e.jsx(jn,{to:"/login",className:"text-green-600 font-medium hover:text-green-700 hover:underline transition-colors",children:"Masuk disini"})]})})}),e.jsx("div",{className:"text-center",children:e.jsxs("p",{className:"text-xs text-gray-500",children:["Dengan mendaftar, Anda menyetujui"," ",e.jsx("span",{className:"text-green-600 hover:underline cursor-pointer",children:"Syarat & Ketentuan"})," ","dan"," ",e.jsx("span",{className:"text-green-600 hover:underline cursor-pointer",children:"Kebijakan Privasi"})," ","kami."]})})]})]})}),e.jsx(ge.div,{variants:p,className:"text-center mt-6 sm:mt-8",children:e.jsx("p",{className:"text-xs sm:text-sm text-gray-500",children:"© 2024 Kelas Guru. Platform pembelajaran digital."})})]})})},Po=dl("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground",success:"border-transparent bg-green-100 text-green-800 hover:bg-green-200 dark:bg-green-900 dark:text-green-100",warning:"border-transparent bg-yellow-100 text-yellow-800 hover:bg-yellow-200 dark:bg-yellow-900 dark:text-yellow-100",info:"border-transparent bg-blue-100 text-blue-800 hover:bg-blue-200 dark:bg-blue-900 dark:text-blue-100"}},defaultVariants:{variant:"default"}});function Xs({className:s,variant:a,...t}){return e.jsx("div",{className:xt(Po({variant:a}),s),...t})}const Ws={initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-10}},Aa={initial:{opacity:0,x:-20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20}},Ro={animate:{transition:{staggerChildren:.1}}};ge.div;ge.button;ge.section;ge.div;function fs({children:s,className:a,variant:t=Ws,delay:r=0}){return e.jsx(ge.div,{initial:"initial",animate:"animate",exit:"exit",variants:t,transition:{duration:.3,ease:"easeOut",delay:r},className:xt(a),children:s})}function hl({children:s}){return e.jsx(ge.div,{initial:"initial",animate:"animate",variants:Ro,children:s})}const Oo=()=>{const[s,a]=S.useState({totalClasses:0,totalStudents:0,totalAssignments:0,averageGrade:0,todayAttendance:0,pendingGrades:0,overdueAssignments:0,activeStudents:0}),[t,r]=S.useState([]),[n,l]=S.useState([]),[i,c]=S.useState(!0),[d,o]=S.useState(null),[m,g]=S.useState(new Date),[x,f]=S.useState(null),p=mr();S.useEffect(()=>{const W=Zr();o(W),h()},[]);const h=async()=>{try{c(!0),console.log("📊 Loading comprehensive dashboard data...");const[W,re,ve]=await Promise.all([et.getAll(),ta.getAll(),Rt.getAll()]);let te=[];W.success&&(te=W.classes||[],console.log("📚 Loaded classes:",te.length));let ke=[];re.success&&(ke=re.students||[],console.log("👥 Loaded students:",ke.length));let xe=[];ve.success?(console.log("📝 RAW ASSIGNMENTS API RESPONSE:",ve),xe=(ve.assignments||[]).map(me=>{var F;return{...me,className:((F=te.find(J=>J.id===me.classId))==null?void 0:F.name)||"Unknown Class",status:O(me.dueDate)}}),console.log("📝 FINAL PROCESSED ASSIGNMENTS:",xe.length,"assignments"),console.log("📝 Assignment IDs:",xe.map(me=>me.id)),console.log("📝 Sample assignment data:",xe[0])):console.error("❌ Failed to load assignments:",ve);const[Ie,je]=await Promise.all([ya.getAll(),Or.getAll()]);let Oe=[];Ie.success?(console.log("🎯 RAW GRADES API RESPONSE:",Ie),Oe=(Ie.grades||[]).map(me=>{var U;const F=xe.find(Y=>Y.id===me.assignmentId),J={id:me.id,studentUsername:me.studentUsername,assignmentId:me.assignmentId,assignmentTitle:(F==null?void 0:F.title)||"Unknown Assignment",points:me.points||me.value||0,feedback:me.feedback||"",gradedAt:me.gradedAt||me.createdAt||new Date().toISOString(),studentName:me.studentName||((U=ke.find(Y=>Y.username===me.studentUsername))==null?void 0:U.fullName)||me.studentUsername};return me.assignmentId&&!F&&console.warn("⚠️ Grade references unknown assignment:",{gradeId:me.id,assignmentId:me.assignmentId,availableAssignments:xe.map(Y=>Y.id)}),J}),console.log("🎯 FINAL PROCESSED GRADES:",Oe.length,"grades"),console.log("🎯 Sample grade data:",Oe[0])):console.error("❌ Failed to load grades:",Ie);let N=[];je.success&&(N=je.attendance||[],console.log("📋 Loaded attendance records:",N.length));const P=te.map(me=>({...me,studentCount:ke.filter(F=>F.classId===me.id).length}));r(P.slice(0,4));const T=w(te,ke,xe,Oe,N);a(T);const A=Oe.filter(me=>!xe.find(F=>F.id===me.assignmentId));A.length>0?(f({orphanedGrades:A.length,detectedAt:new Date}),console.warn("🚨 Data integrity issue detected: orphaned grades found")):f(null);const X=L(xe,Oe,N,ke,te);l(X),g(new Date),console.log("✅ Dashboard data loaded successfully"),console.log("📊 Final stats:",T)}catch(W){console.error("❌ Error loading dashboard data:",W)}finally{c(!1)}},w=(W,re,ve,te,ke)=>{console.log("🔍 DEBUGGING DATA SYNC:",{classesCount:W.length,studentsCount:re.length,assignmentsCount:ve.length,gradesCount:te.length,assignments:ve.map(U=>({id:U.id,title:U.title,classId:U.classId})),grades:te.map(U=>({id:U.id,assignmentId:U.assignmentId,studentUsername:U.studentUsername,points:U.points})),assignmentIds:ve.map(U=>U.id),gradeAssignmentIds:[...new Set(te.map(U=>U.assignmentId))]});const xe=te.filter(U=>ve.find(Y=>Y.id===U.assignmentId)),Ie=xe.length>0?xe.reduce((U,Y)=>U+Y.points,0)/xe.length:0;console.log("📊 Grade calculation summary:",{totalGradesInDB:te.length,validGrades:xe.length,orphanedGrades:te.length-xe.length,averageFromValidGrades:Ie});const je=new Date().toISOString().split("T")[0],Oe=ke.filter(U=>U.date===je&&U.status==="present").length,N=new Date,P=ve.filter(U=>new Date(U.dueDate)<N&&U.status!=="completed").length;let T=0,A=[];const X=te.filter(U=>!ve.find(Y=>Y.id===U.assignmentId));X.length>0&&console.warn("🗑️ Found orphaned grades (referencing deleted assignments):",X.map(U=>({gradeId:U.id,assignmentId:U.assignmentId,studentUsername:U.studentUsername}))),ve.forEach(U=>{const Y=re.filter(de=>de.classId===U.classId),ue=xe.filter(de=>de.assignmentId===U.id),Me=new Set(ue.map(de=>de.studentUsername)),le=Y.filter(de=>!Me.has(de.username)),B={assignmentId:U.id,assignmentTitle:U.title,classId:U.classId,totalStudentsInClass:Y.length,totalValidGradesGiven:ue.length,ungradedCount:le.length,ungradedStudents:le.map(de=>de.username),gradedStudents:[...Me]};A.push(B),le.length>0&&(T+=le.length)}),console.log("📊 DETAILED Pending grades calculation:",{totalAssignments:ve.length,totalGrades:te.length,finalPendingGrades:T,detailedBreakdown:A,orphanedGrades:te.filter(U=>!ve.find(Y=>Y.id===U.assignmentId)),validGrades:te.filter(U=>ve.find(Y=>Y.id===U.assignmentId))});const me=new Date;me.setDate(me.getDate()-7);const F=[...new Set(ke.filter(U=>new Date(U.date)>=me).map(U=>U.studentUsername))].length,J={totalClasses:W.length,totalStudents:re.length,totalAssignments:ve.length,averageGrade:Math.round(Ie*10)/10,todayAttendance:Oe,pendingGrades:T,overdueAssignments:P,activeStudents:F};return console.log("📈 FINAL CALCULATED STATS:",J),J},L=(W,re,ve,te,ke)=>{const xe=[],Ie=re.sort((N,P)=>new Date(P.gradedAt).getTime()-new Date(N.gradedAt).getTime()).slice(0,5).map(N=>{const P=te.find(T=>T.username===N.studentUsername);return{id:`grade-${N.id}`,type:"grade",title:`Nilai ${N.assignmentTitle} (${N.points}/100)`,time:H(N.gradedAt),student:(P==null?void 0:P.fullName)||N.studentUsername,details:N}}),je=ve.filter(N=>{const P=new Date(N.date),T=new Date,A=new Date(T);return A.setDate(A.getDate()-1),P>=A}).slice(0,3).map(N=>{var A;const P=te.find(X=>X.username===N.studentUsername),T=(A=ke.find(X=>X.id===N.classId))==null?void 0:A.name;return{id:`attendance-${N.id}`,type:"attendance",title:`Presensi ${T} - ${I(N.status)}`,time:H(N.date),student:(P==null?void 0:P.fullName)||N.studentUsername,className:T,details:N}}),Oe=W.sort((N,P)=>new Date(P.dueDate).getTime()-new Date(N.dueDate).getTime()).slice(0,3).map(N=>({id:`assignment-${N.id}`,type:"assignment",title:`Tugas "${N.title}" - ${N.className}`,time:`Deadline ${H(N.dueDate)}`,className:N.className,details:N}));return xe.push(...Ie,...je,...Oe),xe.sort((N,P)=>{var X,me,F,J,U,Y;const T=((X=N.details)==null?void 0:X.gradedAt)||((me=N.details)==null?void 0:me.date)||((F=N.details)==null?void 0:F.dueDate)||"1970-01-01",A=((J=P.details)==null?void 0:J.gradedAt)||((U=P.details)==null?void 0:U.date)||((Y=P.details)==null?void 0:Y.dueDate)||"1970-01-01";return new Date(A).getTime()-new Date(T).getTime()}).slice(0,8)},O=W=>{const re=new Date,ve=new Date(W);return ve<re?"overdue":ve.getTime()-re.getTime()<24*60*60*1e3?"due_soon":"active"},I=W=>{switch(W){case"present":return"Hadir";case"absent":return"Tidak Hadir";case"sick":return"Sakit";case"permission":return"Izin";default:return W}},H=W=>{const re=new Date(W),te=Math.floor((new Date().getTime()-re.getTime())/(1e3*60*60));return te<1?"Baru saja":te<24?`${te} jam lalu`:te<48?"Kemarin":`${Math.floor(te/24)} hari lalu`},ae=[{title:"Total Kelas",value:s.totalClasses,icon:ys,color:"bg-blue-500",description:"Kelas aktif",trend:`${s.totalClasses>0?"+":""}${s.totalClasses} kelas`},{title:"Total Siswa",value:s.totalStudents,icon:_s,color:"bg-green-500",description:"Siswa terdaftar",trend:`${s.activeStudents} aktif minggu ini`},{title:"Tugas Aktif",value:s.totalAssignments,icon:Ot,color:"bg-orange-500",description:"Tugas berlangsung",trend:`${s.overdueAssignments} lewat deadline`},{title:"Rata-rata Nilai",value:s.averageGrade>0?s.averageGrade.toFixed(1):"-",icon:jt,color:"bg-purple-500",description:"Nilai keseluruhan",trend:s.pendingGrades>0?`${s.pendingGrades} siswa belum dinilai`:"Semua sudah dinilai"}],oe=W=>{switch(W){case"assignment":return Ot;case"grade":return jt;case"attendance":return ft;case"student_joined":return _s;case"assignment_submitted":return Vs;default:return Vt}},D=W=>{switch(W){case"assignment":return"bg-orange-100 text-orange-600";case"grade":return"bg-green-100 text-green-600";case"attendance":return"bg-blue-100 text-blue-600";case"student_joined":return"bg-purple-100 text-purple-600";case"assignment_submitted":return"bg-emerald-100 text-emerald-600";default:return"bg-gray-100 text-gray-600"}},q=()=>{p("/guru/kelas")},z=W=>{p("/guru/kelas")},G=()=>{p("/guru/kegiatan")},ce=W=>{switch(W){case"Buat Tugas":p("/guru/tugas");break;case"Input Nilai":p("/guru/nilai");break;case"Catat Presensi":p("/guru/presensi");break;case"Kelola Siswa":p("/guru/siswa");break;default:console.log("Unknown action:",W)}},M=()=>{i||h()};return i?e.jsxs("div",{className:"space-y-4 sm:space-y-6 p-4 sm:p-6",children:[e.jsx("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-3 sm:gap-4 lg:gap-6",children:Array.from({length:4}).map((W,re)=>e.jsx(xl,{},re))}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4 sm:gap-6",children:[e.jsx("div",{className:"lg:col-span-2",children:e.jsx(Tn,{rows:6})}),e.jsx("div",{children:e.jsx(Tn,{rows:4})})]})]}):e.jsxs("div",{className:"space-y-4 sm:space-y-6 bg-gray-50/50 min-h-screen",children:[e.jsx(fs,{variant:Ws,children:e.jsx("div",{className:"bg-gradient-to-r from-blue-600 to-indigo-600 rounded-xl sm:rounded-2xl p-4 sm:p-6 text-white",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("h1",{className:"text-xl sm:text-2xl lg:text-3xl font-bold",children:["Selamat Datang, ",(d==null?void 0:d.fullName)||"Guru","! 👋"]}),e.jsxs("p",{className:"text-blue-100 mt-2 text-sm sm:text-base",children:["Anda mengelola ",s.totalClasses," kelas dengan ",s.totalStudents," siswa"]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-4 mt-3",children:[e.jsxs("div",{className:"flex items-center gap-2 text-blue-200 text-xs sm:text-sm",children:[e.jsx(ft,{className:"w-3 h-3 sm:w-4 sm:h-4"}),e.jsxs("span",{children:["Update terakhir: ",m.toLocaleTimeString("id-ID",{hour:"2-digit",minute:"2-digit"})]})]}),e.jsxs(V,{variant:"outline",size:"sm",onClick:M,disabled:i,className:"bg-white/10 border-white/20 text-white hover:bg-white/20 h-7 sm:h-8 text-xs",children:[e.jsx(ct,{className:`w-3 h-3 mr-1 ${i?"animate-spin":""}`}),"Refresh"]})]})]}),e.jsx(ge.div,{className:"hidden sm:block self-center",initial:{scale:0},animate:{scale:1},transition:{delay:.2,type:"spring"},children:e.jsx("div",{className:"w-16 h-16 sm:w-20 sm:h-20 bg-white/20 rounded-full flex items-center justify-center",children:e.jsx(ra,{className:"w-8 h-8 sm:w-10 sm:h-10"})})})]})})}),e.jsx(hl,{children:e.jsx("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-3 sm:gap-4 lg:gap-6",children:ae.map((W,re)=>e.jsx(fs,{delay:re*.1,children:e.jsxs(Ge,{className:"relative overflow-hidden border-0 shadow-lg hover:shadow-xl transition-all duration-300 hover:scale-105",children:[e.jsxs(ms,{className:"flex flex-row items-center justify-between space-y-0 pb-2 p-4 sm:p-6 sm:pb-2",children:[e.jsx(ls,{className:"text-xs sm:text-sm font-medium text-gray-600 leading-tight",children:W.title}),e.jsx("div",{className:`p-1.5 sm:p-2 rounded-lg ${W.color} text-white flex-shrink-0`,children:e.jsx(W.icon,{className:"w-3 h-3 sm:w-4 sm:h-4"})})]}),e.jsxs(We,{className:"p-4 sm:p-6 pt-0",children:[e.jsx("div",{className:"text-xl sm:text-2xl font-bold text-gray-900",children:W.value}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:W.description}),e.jsxs("div",{className:"flex items-center mt-2",children:[e.jsx(na,{className:"w-3 h-3 text-green-500 mr-1 flex-shrink-0"}),e.jsx("span",{className:"text-xs text-green-500 truncate",children:W.trend})]})]}),e.jsx("div",{className:"absolute top-0 right-0 w-16 h-16 sm:w-20 sm:h-20 opacity-10",children:e.jsx("div",{className:`w-full h-full rounded-full ${W.color} transform translate-x-4 sm:translate-x-6 -translate-y-4 sm:-translate-y-6`})})]})},W.title))})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4 sm:gap-6",children:[e.jsx(fs,{variant:Aa,delay:.4,className:"lg:col-span-2",children:e.jsxs(Ge,{className:"border-0 shadow-lg",children:[e.jsxs(ms,{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between space-y-2 sm:space-y-0 p-4 sm:p-6",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs(ls,{className:"flex items-center gap-2 text-base sm:text-lg",children:[e.jsx(ys,{className:"w-4 h-4 sm:w-5 sm:h-5 text-blue-600"}),"Kelas Terbaru"]}),e.jsx(bs,{className:"text-xs sm:text-sm",children:"Kelas yang baru-baru ini Anda kelola"})]}),e.jsxs(V,{size:"sm",className:"bg-blue-600 hover:bg-blue-700 h-9 sm:h-10 text-xs sm:text-sm w-full sm:w-auto",onClick:q,children:[e.jsx(xs,{className:"w-3 h-3 sm:w-4 sm:h-4 mr-2"}),"Tambah Kelas"]})]}),e.jsx(We,{className:"p-4 sm:p-6 pt-0",children:e.jsx("div",{className:"space-y-3 sm:space-y-4",children:t.length>0?t.map((W,re)=>e.jsxs(ge.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.1*re},className:"flex items-center justify-between p-3 sm:p-4 rounded-lg bg-gray-50 hover:bg-gray-100 transition-colors group",children:[e.jsxs("div",{className:"flex items-center space-x-3 sm:space-x-4 flex-1 min-w-0",children:[e.jsx("div",{className:"w-10 h-10 sm:w-12 sm:h-12 bg-gradient-to-br from-blue-500 to-indigo-500 rounded-lg flex items-center justify-center flex-shrink-0",children:e.jsx(ys,{className:"w-5 h-5 sm:w-6 sm:h-6 text-white"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"font-semibold text-gray-900 text-sm sm:text-base truncate",children:W.name}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2 mt-1",children:[W.subject&&e.jsx(Xs,{variant:"secondary",className:"text-xs",children:W.subject}),e.jsxs("div",{className:"flex items-center gap-1 text-xs sm:text-sm text-gray-500",children:[e.jsx(_s,{className:"w-3 h-3"}),e.jsxs("span",{children:[W.studentCount||0," siswa"]})]})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1 truncate",children:W.description||"Tidak ada deskripsi"})]})]}),e.jsx(V,{size:"sm",variant:"ghost",className:"opacity-0 group-hover:opacity-100 transition-opacity ml-2 flex-shrink-0 w-8 h-8 sm:w-auto sm:h-auto",onClick:()=>z(W.id),children:e.jsx(Ms,{className:"w-3 h-3 sm:w-4 sm:h-4"})})]},W.id)):e.jsxs("div",{className:"text-center py-6 sm:py-8 text-gray-500",children:[e.jsx(ys,{className:"w-10 h-10 sm:w-12 sm:h-12 mx-auto mb-4 text-gray-300"}),e.jsx("p",{className:"text-sm sm:text-base",children:"Belum ada kelas yang dibuat"}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Mulai dengan membuat kelas pertama Anda"}),e.jsxs(V,{className:"mt-4 h-9 sm:h-10 text-xs sm:text-sm",size:"sm",onClick:q,children:[e.jsx(xs,{className:"w-3 h-3 sm:w-4 sm:h-4 mr-2"}),"Buat Kelas Pertama"]})]})})})]})}),e.jsx(fs,{variant:Ws,delay:.6,children:e.jsxs(Ge,{className:"border-0 shadow-lg",children:[e.jsxs(ms,{className:"p-4 sm:p-6",children:[e.jsxs(ls,{className:"flex items-center gap-2 text-base sm:text-lg",children:[e.jsx(Vt,{className:"w-4 h-4 sm:w-5 sm:h-5 text-green-600"}),"Aktivitas Terbaru"]}),e.jsx(bs,{className:"text-xs sm:text-sm",children:"Update terbaru dari kelas Anda"})]}),e.jsxs(We,{className:"p-4 sm:p-6 pt-0",children:[e.jsx("div",{className:"space-y-3 sm:space-y-4",children:n.length>0?n.map((W,re)=>{const ve=oe(W.type),te=D(W.type);return e.jsxs(ge.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1*re},className:"flex items-start space-x-3 p-3 rounded-lg hover:bg-gray-50 transition-colors",children:[e.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0 ${te}`,children:e.jsx(ve,{className:"w-4 h-4"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-xs sm:text-sm font-medium text-gray-900 line-clamp-2",children:W.title}),W.student&&e.jsxs("p",{className:"text-xs text-gray-600 truncate mt-1",children:[e.jsx(_s,{className:"w-3 h-3 inline mr-1"}),W.student]}),W.className&&!W.student&&e.jsxs("p",{className:"text-xs text-gray-600 truncate mt-1",children:[e.jsx(ys,{className:"w-3 h-3 inline mr-1"}),W.className]}),e.jsxs("p",{className:"text-xs text-gray-400 mt-1 flex items-center gap-1",children:[e.jsx(ft,{className:"w-3 h-3"}),W.time]})]})]},W.id)}):e.jsxs("div",{className:"text-center py-6 sm:py-8 text-gray-500",children:[e.jsx(Vt,{className:"w-10 h-10 sm:w-12 sm:h-12 mx-auto mb-4 text-gray-300"}),e.jsx("p",{className:"text-sm sm:text-base",children:"Belum ada aktivitas terbaru"}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Aktivitas akan muncul setelah ada interaksi di kelas"})]})}),e.jsxs(V,{variant:"outline",className:"w-full mt-4 h-9 sm:h-10 text-xs sm:text-sm",size:"sm",onClick:G,children:[e.jsx(Vt,{className:"w-3 h-3 sm:w-4 sm:h-4 mr-2"}),"Lihat Semua Aktivitas"]})]})]})})]}),e.jsx(fs,{variant:Ws,delay:.8,children:e.jsxs(Ge,{className:"border-0 shadow-lg",children:[e.jsxs(ms,{className:"p-4 sm:p-6",children:[e.jsx(ls,{className:"text-base sm:text-lg",children:"Aksi Cepat"}),e.jsx(bs,{className:"text-xs sm:text-sm",children:"Akses cepat ke fitur yang sering digunakan • Data real-time"})]}),e.jsxs(We,{className:"p-4 sm:p-6 pt-0",children:[e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-3 sm:gap-4",children:[{title:"Buat Tugas",icon:Ot,color:"bg-orange-500",stat:`${s.totalAssignments} aktif`,urgent:s.overdueAssignments>0,urgentText:`${s.overdueAssignments} lewat deadline`},{title:"Input Nilai",icon:jt,color:"bg-green-500",stat:`Rata-rata ${s.averageGrade>0?s.averageGrade.toFixed(1):"0"}`,urgent:s.pendingGrades>0,urgentText:s.pendingGrades>0?`${s.pendingGrades} siswa belum dinilai`:void 0},{title:"Catat Presensi",icon:ft,color:"bg-blue-500",stat:`${s.todayAttendance} hadir hari ini`,urgent:!1},{title:"Kelola Siswa",icon:_s,color:"bg-purple-500",stat:`${s.totalStudents} total`,urgent:!1,urgentText:`${s.activeStudents} aktif minggu ini`}].map(W=>e.jsx(ge.div,{whileHover:{scale:1.05},whileTap:{scale:.95},children:e.jsxs(V,{variant:"outline",className:`h-20 sm:h-24 flex-col space-y-1 sm:space-y-2 hover:shadow-md transition-all duration-200 w-full relative ${W.urgent?"border-red-200 bg-red-50":""}`,onClick:()=>ce(W.title),children:[W.urgent&&e.jsx("div",{className:"absolute -top-1 -right-1 w-3 h-3 bg-red-500 rounded-full animate-pulse"}),e.jsx("div",{className:`p-1.5 sm:p-2 rounded-lg ${W.color} text-white`,children:e.jsx(W.icon,{className:"w-4 h-4 sm:w-5 sm:h-5"})}),e.jsxs("div",{className:"text-center",children:[e.jsx("span",{className:"text-xs leading-tight font-medium",children:W.title}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:W.stat}),W.urgent&&W.urgentText&&e.jsx("p",{className:"text-xs text-red-600 font-medium",children:W.urgentText})]})]})},W.title))}),e.jsxs("div",{className:"mt-4 sm:mt-6 space-y-2",children:[x&&e.jsxs("div",{className:"flex items-start gap-2 p-3 bg-orange-50 border border-orange-200 rounded-lg",children:[e.jsx(Ks,{className:"w-4 h-4 text-orange-600 flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-xs sm:text-sm text-orange-800 font-medium",children:"Masalah Sinkronisasi Data Terdeteksi"}),e.jsxs("p",{className:"text-xs text-orange-700 mt-1",children:["Ditemukan ",e.jsxs("span",{className:"font-medium",children:[x.orphanedGrades," nilai"]}),' yang mereferensikan tugas yang sudah tidak ada. Ini bisa menyebabkan perhitungan "siswa belum dinilai" tidak akurat.']}),e.jsxs("p",{className:"text-xs text-orange-600 mt-2",children:["💡 ",e.jsx("strong",{children:"Solusi:"})," Hapus nilai lama yang tidak valid di halaman Nilai, atau buat ulang tugas yang hilang."]})]})]}),s.overdueAssignments>0&&e.jsxs("div",{className:"flex items-center gap-2 p-3 bg-red-50 border border-red-200 rounded-lg",children:[e.jsx(Ks,{className:"w-4 h-4 text-red-600 flex-shrink-0"}),e.jsxs("p",{className:"text-xs sm:text-sm text-red-800",children:[e.jsxs("span",{className:"font-medium",children:[s.overdueAssignments," tugas"]})," telah melewati deadline"]})]}),s.pendingGrades>0&&e.jsxs("div",{className:"flex items-center gap-2 p-3 bg-yellow-50 border border-yellow-200 rounded-lg",children:[e.jsx(ft,{className:"w-4 h-4 text-yellow-600 flex-shrink-0"}),e.jsxs("p",{className:"text-xs sm:text-sm text-yellow-800",children:[e.jsxs("span",{className:"font-medium",children:[s.pendingGrades," siswa"]})," belum dinilai pada tugas yang ada"]})]}),s.totalClasses>0&&s.totalStudents>0&&e.jsxs("div",{className:"flex items-center gap-2 p-3 bg-green-50 border border-green-200 rounded-lg",children:[e.jsx(Vs,{className:"w-4 h-4 text-green-600 flex-shrink-0"}),e.jsxs("p",{className:"text-xs sm:text-sm text-green-800",children:["Sistem berjalan normal • ",e.jsxs("span",{className:"font-medium",children:[s.activeStudents," siswa"]})," aktif minggu ini"]})]})]})]})]})})]})},Lo=()=>{const[s,a]=S.useState(!0),[t,r]=S.useState(!1),[n,l]=S.useState(null),[i,c]=S.useState({points:0,level:1,badges:[],rank:0,totalStudents:0,attendance:0,averageGrade:0,completedAssignments:0}),[d,o]=S.useState([]),[m,g]=S.useState(null),[x,f]=S.useState([]);S.useEffect(()=>{const H=setTimeout(()=>{p()},500);return()=>clearTimeout(H)},[]);const p=async(H=!1)=>{try{H?r(!0):a(!0),l(null);const ae=localStorage.getItem("user");if(!ae){l("User data not found. Please login again.");return}const oe=JSON.parse(ae);if(g(oe),console.log("👤 Loading dashboard for user:",oe),console.log("🔍 Checking session credentials before API calls..."),!la()&&(console.log("⚠️ No session credentials found, attempting refresh..."),ml(),await new Promise(W=>setTimeout(W,100)),!la())){l("Session expired. Please login again.");return}console.log("✅ Session credentials verified, proceeding with API calls..."),console.log("📡 Fetching gamification data...");const D=await be("getGamification",{});console.log("📊 Gamification result:",D),console.log("📡 Fetching badges data...");const q=await be("getBadges",{});console.log("🏅 Badges result:",q),console.log("📡 Fetching students data...");const z=await be("getStudentsFromSheet",{});console.log("👥 Students result:",z),console.log("📡 Fetching attendance data...");const G=await be("getAttendance",{});console.log("📅 Attendance result:",G),console.log("📡 Fetching grades data...");const ce=await be("getGrades",{});console.log("📊 Grades result:",ce),console.log("📡 Fetching assignments data...");const M=await be("getAssignments",{});if(console.log("📝 Assignments result:",M),q.success&&q.badges?(f(q.badges),console.log("✅ Available badges loaded:",q.badges.length)):(console.log("⚠️ No badges data available"),f([])),D.success&&z.success){const W=D.data||[],re=z.students||[],ve=G.success?G.attendance||[]:[],te=ce.success?ce.grades||[]:[],ke=M.success?M.assignments||[]:[];console.log("📊 Processing data:",{gamificationEntries:W.length,studentsCount:re.length,attendanceRecords:ve.length,gradesCount:te.length,assignmentsCount:ke.length});const xe=W.find(le=>le.studentUsername===oe.username);console.log("🎯 Current user gamification data:",xe);const Ie=ve.filter(le=>le.studentUsername===oe.username),je=Ie.length,Oe=Ie.filter(le=>le.status==="present"||le.status==="hadir").length,N=je>0?Math.round(Oe/je*100):0;console.log("📅 Attendance calculation:",{userAttendanceRecords:Ie.length,totalAttendanceRecords:je,presentRecords:Oe,allAttendanceStatuses:Ie.map(le=>le.status),realAttendanceRate:N});const P=te.filter(le=>{const B=le.studentUsername===oe.username,de=le.points!==null&&le.points!==void 0&&le.points!==""||le.value!==null&&le.value!==void 0&&le.value!==""||le.score!==null&&le.score!==void 0&&le.score!=="";return console.log(`📊 Grade check for ${le.studentUsername}: isUser=${B}, points=${le.points}, value=${le.value}, score=${le.score}, valid=${de}`),B&&de});console.log("📊 User grades found:",P);const T=P.map(le=>{const B=parseFloat(le.points)||parseFloat(le.value)||parseFloat(le.score)||0;return console.log(`📈 Processing grade: points=${le.points}, value=${le.value}, score=${le.score} -> ${B}`),B}).filter(le=>!isNaN(le)&&le>=0),A=T.reduce((le,B)=>le+B,0),X=T.length>0?Math.round(A/T.length*100)/100:0;console.log("📊 Grade calculation details:",{userGrades:P.length,validGrades:T.length,validGradeValues:T,totalGradePoints:A,realAverageGrade:X,sampleRawGrades:P.slice(0,3)});const me=te.filter(le=>le.studentUsername===oe.username),F=new Set;me.forEach(le=>{le.assignmentId&&F.add(le.assignmentId),le.assignment&&F.add(le.assignment),le.assignmentTitle&&F.add(le.assignmentTitle)});const J=Math.max(F.size,me.length);console.log("📝 Assignment calculation:",{userAssignmentGrades:me.length,uniqueAssignmentIds:Array.from(F),uniqueAssignments:F.size,realCompletedAssignments:J,sampleGrades:me.slice(0,3)}),console.log("📈 Final calculated stats:",{attendanceRate:N,averageGrade:X,completedAssignments:J,totalAttendanceRecords:je,presentRecords:Oe,userGrades:P.length,validGrades:T.length});const U=W.filter(le=>le.studentUsername&&(le.points||le.points===0)).map(le=>{const B=re.find(de=>de.username===le.studentUsername);return{username:le.studentUsername,fullName:(B==null?void 0:B.fullName)||le.studentUsername,points:parseInt(le.points)||0,level:parseInt(le.level)||1,badges:le.badges?le.badges.split(",").filter(de=>de.trim()).length:0}}).sort((le,B)=>B.points-le.points);console.log("🏆 Leaderboard data:",U),o(U.slice(0,10));const Y=U.findIndex(le=>le.username===oe.username)+1;console.log("🥇 User rank:",Y);const ue=xe!=null&&xe.badges?xe.badges.split(",").filter(le=>le.trim()):[],Me={points:parseInt(xe==null?void 0:xe.points)||0,level:parseInt(xe==null?void 0:xe.level)||1,badges:ue,rank:Y||U.length+1,totalStudents:re.length,attendance:N,averageGrade:X,completedAssignments:J};console.log("📈 Final user stats with real data:",Me),c(Me)}else{console.error("❌ Failed to load data:",{gamificationResult:D,studentsResult:z}),l("Failed to load dashboard data. Some information may be unavailable.");const W=G.success?G.attendance||[]:[],re=ce.success?ce.grades||[]:[];if(W.length>0||re.length>0){console.log("📊 Attempting to calculate stats from available data...");const ve=W.filter(T=>T.studentUsername===oe.username),te=ve.length,ke=ve.filter(T=>T.status==="present"||T.status==="hadir").length,xe=te>0?Math.round(ke/te*100):0,Ie=re.filter(T=>{const A=T.studentUsername===oe.username,X=T.points!==null&&T.points!==void 0&&T.points!==""||T.value!==null&&T.value!==void 0&&T.value!==""||T.score!==null&&T.score!==void 0&&T.score!=="";return A&&X}),je=Ie.map(T=>parseFloat(T.points)||parseFloat(T.value)||parseFloat(T.score)||0).filter(T=>!isNaN(T)&&T>=0),Oe=je.reduce((T,A)=>T+A,0),N=je.length>0?Math.round(Oe/je.length*100)/100:0,P=Ie.length;console.log("📊 Fallback stats calculated:",{attendance:xe,averageGrade:N,completedAssignments:P}),c(T=>{var A;return{...T,attendance:xe,averageGrade:N,completedAssignments:P,totalStudents:z.success&&((A=z.students)==null?void 0:A.length)||0}})}else c(ve=>{var te;return{...ve,totalStudents:z.success&&((te=z.students)==null?void 0:te.length)||0}})}}catch(ae){console.error("❌ Error loading dashboard data:",ae),l("An error occurred while loading your dashboard. Please try refreshing the page.")}finally{a(!1),r(!1)}},h=()=>{p(!0)},w=(H,ae)=>H>=10&&ae>=90?{name:"Archmage",icon:"🧙‍♂️",color:"from-purple-600 to-indigo-800"}:H>=8&&ae>=85?{name:"Wizard",icon:"🔮",color:"from-blue-600 to-purple-700"}:H>=6&&ae>=80?{name:"Scholar",icon:"📚",color:"from-green-600 to-blue-600"}:H>=4&&ae>=75?{name:"Apprentice",icon:"🎓",color:"from-yellow-600 to-green-600"}:H>=2?{name:"Student",icon:"📖",color:"from-orange-600 to-yellow-600"}:{name:"Novice",icon:"🌱",color:"from-gray-600 to-orange-600"},L=()=>{const oe=i.level*20,D=i.level*15;return{hp:Math.min(100+oe,(100+oe)*(i.attendance/100)),maxHp:100+oe,mp:Math.min(50+D,(50+D)*(i.averageGrade/100)),maxMp:50+D,exp:i.points%1e3,expToNext:1e3,attack:Math.floor(i.completedAssignments*2+i.level*3),defense:Math.floor(i.attendance/10+i.level*2),intelligence:Math.floor(i.averageGrade/5+i.level*2),wisdom:Math.floor(i.badges.length*5+i.level)}},O=w(i.level,i.averageGrade),I=L();return s?e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 flex items-center justify-center px-4",children:e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"animate-spin w-16 h-16 border-4 border-purple-500 border-t-transparent rounded-full mx-auto mb-4"}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsx(Qc,{className:"w-6 h-6 text-purple-400 animate-pulse"})})]}),e.jsx("p",{className:"text-white font-bold text-lg",children:"⚡ Lagi loading nih..."}),e.jsx("p",{className:"text-purple-300 text-sm mt-2",children:"Bentar ya, data lagi di-sync ✨"})]})}):n?e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-red-900 via-slate-900 to-red-900 flex items-center justify-center p-4",children:e.jsxs("div",{className:"text-center max-w-md bg-slate-800/50 backdrop-blur-sm border border-red-500/30 rounded-2xl p-8",children:[e.jsx("div",{className:"text-6xl mb-4",children:"⚠️"}),e.jsx("h2",{className:"text-xl font-bold text-white mb-2",children:"🛡️ Waduh, ada error!"}),e.jsx("p",{className:"text-red-300 mb-6",children:n}),e.jsxs(V,{onClick:h,className:"bg-red-600 hover:bg-red-700 border border-red-500",children:[e.jsx(Zc,{className:"w-4 h-4 mr-2"}),"Coba Lagi 🔄"]})]})}):e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-purple-900 to-indigo-900 relative overflow-hidden",children:[e.jsxs("div",{className:"absolute inset-0 opacity-10",children:[e.jsx("div",{className:"absolute top-10 left-10 text-6xl animate-pulse",children:"⭐"}),e.jsx("div",{className:"absolute top-32 right-20 text-4xl animate-bounce",children:"🔮"}),e.jsx("div",{className:"absolute bottom-20 left-32 text-5xl animate-pulse",children:"⚡"}),e.jsx("div",{className:"absolute bottom-40 right-10 text-3xl animate-bounce",children:"🌟"}),e.jsx("div",{className:"absolute top-1/2 left-1/4 text-7xl animate-pulse",children:"✨"})]}),e.jsxs("div",{className:"relative z-10 space-y-6 p-4 sm:p-6 lg:p-8",children:[e.jsxs("div",{className:"relative overflow-hidden rounded-3xl bg-gradient-to-r from-indigo-900 via-purple-900 to-pink-900 p-8 text-white border border-purple-500/30",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-purple-600/20 to-pink-600/20"}),e.jsx("div",{className:"relative z-10",children:e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-6",children:[e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsxs("div",{className:`relative w-24 h-24 rounded-full bg-gradient-to-br ${O.color} flex items-center justify-center text-4xl border-4 border-white/30 shadow-2xl`,children:[O.icon,e.jsx("div",{className:"absolute -top-2 -right-2 bg-yellow-500 text-black text-xs font-bold px-2 py-1 rounded-full",children:i.level})]}),e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold mb-2",children:[(m==null?void 0:m.fullName)||"Hero"," ⚔️"]}),e.jsxs("div",{className:"flex items-center gap-4 mb-2",children:[e.jsx("span",{className:`px-3 py-1 rounded-full bg-gradient-to-r ${O.color} text-sm font-bold border border-white/30`,children:O.name}),e.jsxs("span",{className:"text-purple-300",children:["Ranking #",i.rank>0?i.rank:"?"," di Kerajaan"]})]}),e.jsx("p",{className:"text-purple-200",children:i.points>500?"Legend banget! Quest master sejati 🏆":i.points>200?"Keren nih, adventurer yang promising! ⚡":"Pemula yang semangat, gas terus! 🌟"})]})]}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("div",{className:"text-center bg-white/10 rounded-xl p-4 backdrop-blur-sm",children:[e.jsx(si,{className:"w-6 h-6 mx-auto mb-1 text-yellow-400"}),e.jsx("div",{className:"text-2xl font-bold",children:i.points.toLocaleString()}),e.jsx("div",{className:"text-xs text-purple-300",children:"Total XP"})]}),e.jsxs("div",{className:"text-center bg-white/10 rounded-xl p-4 backdrop-blur-sm",children:[e.jsx(jt,{className:"w-6 h-6 mx-auto mb-1 text-orange-400"}),e.jsx("div",{className:"text-2xl font-bold",children:i.badges.length}),e.jsx("div",{className:"text-xs text-purple-300",children:"Trofi"})]})]})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2 bg-slate-800/50 backdrop-blur-sm rounded-2xl border border-purple-500/30 p-6",children:[e.jsxs("h2",{className:"text-xl font-bold text-white mb-6 flex items-center gap-2",children:[e.jsx(tr,{className:"w-6 h-6 text-yellow-400"}),"Progress & Achievement"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-gradient-to-br from-yellow-600/20 to-orange-600/20 border border-yellow-500/30 rounded-xl p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(si,{className:"w-8 h-8 text-yellow-400"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold text-white",children:"Total Experience"}),e.jsx("p",{className:"text-yellow-300 text-sm",children:"XP yang udah dikumpulin"})]})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-4xl font-bold text-yellow-400 mb-2",children:i.points.toLocaleString()}),e.jsx("div",{className:"text-sm text-yellow-300",children:"Poin XP"})]})]}),e.jsxs("div",{className:`bg-gradient-to-br ${O.color}/20 border border-purple-500/30 rounded-xl p-6`,children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"text-3xl",children:O.icon}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold text-white",children:"Level Sekarang"}),e.jsx("p",{className:"text-purple-300 text-sm",children:O.name})]})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-4xl font-bold text-white mb-2",children:i.level}),e.jsx("div",{className:"text-sm text-purple-300",children:"Level"})]})]})]}),e.jsxs("div",{className:"mt-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-white font-medium",children:"Progress ke Level Selanjutnya"}),e.jsxs("span",{className:"text-yellow-400 font-bold",children:[I.exp,"/",I.expToNext," XP"]})]}),e.jsx("div",{className:"bg-slate-700 rounded-full h-4 overflow-hidden",children:e.jsx("div",{className:"h-full bg-gradient-to-r from-yellow-500 to-orange-500 transition-all duration-500",style:{width:`${I.exp/I.expToNext*100}%`}})}),e.jsxs("div",{className:"text-xs text-slate-400 mt-1 text-center",children:[Math.round(I.exp/I.expToNext*100),"% selesai"]})]})]}),e.jsxs("div",{className:"bg-slate-800/50 backdrop-blur-sm rounded-2xl border border-purple-500/30 p-6",children:[e.jsxs("h2",{className:"text-xl font-bold text-white mb-6 flex items-center gap-2",children:[e.jsx(ja,{className:"w-6 h-6 text-yellow-400"}),"Hall of Fame 🏰"]}),d.length>0?e.jsx("div",{className:"space-y-3",children:d.slice(0,8).map((H,ae)=>e.jsxs("div",{className:`flex items-center gap-3 p-3 rounded-lg transition-all duration-200 hover:scale-102 ${H.username===(m==null?void 0:m.username)?"bg-gradient-to-r from-purple-600/30 to-pink-600/30 border border-purple-400/50":"bg-slate-700/30 hover:bg-slate-700/50"}`,children:[e.jsxs("div",{className:"text-2xl min-w-[2rem] text-center",children:[ae===0&&"👑",ae===1&&"🥈",ae===2&&"🥉",ae>2&&`#${ae+1}`]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("p",{className:`font-medium truncate ${H.username===(m==null?void 0:m.username)?"text-white":"text-slate-300"}`,children:[H.fullName,H.username===(m==null?void 0:m.username)&&" (Kamu)"]}),e.jsxs("p",{className:"text-xs text-slate-400",children:[H.points.toLocaleString()," XP • Lv.",H.level]})]}),e.jsxs("div",{className:"flex items-center gap-1 text-yellow-400",children:[e.jsx(jt,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm font-bold",children:H.badges})]})]},H.username))}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(eo,{className:"w-12 h-12 mx-auto mb-4 text-slate-400"}),e.jsx("p",{className:"text-slate-400",children:"Hall of Fame lagi kosong nih..."})]}),e.jsxs(V,{variant:"outline",className:"w-full mt-4 border-purple-500/50 text-purple-300 hover:bg-purple-600/20 hover:text-white",onClick:h,disabled:t,children:[e.jsx(ti,{className:`w-4 h-4 mr-2 ${t?"animate-spin":""}`}),t?"Refreshing...":"Refresh Data 🔄"]})]})]}),e.jsxs("div",{className:"bg-slate-800/50 backdrop-blur-sm rounded-2xl border border-purple-500/30 p-6",children:[e.jsxs("h2",{className:"text-xl font-bold text-white mb-6 flex items-center gap-2",children:[e.jsx(na,{className:"w-6 h-6 text-blue-400"}),"Progress Akademik 📊",t&&e.jsx("span",{className:"ml-auto text-xs bg-blue-500/20 text-blue-300 px-2 py-1 rounded-full animate-pulse",children:"Syncing..."})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-slate-300",children:"Tingkat Kehadiran"}),e.jsxs("span",{className:"text-sm font-bold text-green-400",children:[i.attendance,"%"]})]}),e.jsx("div",{className:"w-full h-3 bg-slate-700 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-gradient-to-r from-green-500 to-emerald-500 rounded-full transition-all duration-500",style:{width:`${i.attendance}%`}})}),e.jsx("p",{className:"text-xs text-slate-400 mt-1",children:i.attendance>=80?"Rajin banget! Mantap 👏":i.attendance>0?"Yuk lebih rajin hadir! 📚":"Data kehadiran lagi di-sync...⏳"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-slate-300",children:"Rata-rata Nilai"}),e.jsx("span",{className:"text-sm font-bold text-blue-400",children:i.averageGrade})]}),e.jsx("div",{className:"w-full h-3 bg-slate-700 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-gradient-to-r from-blue-500 to-purple-500 rounded-full transition-all duration-500",style:{width:`${Math.min(i.averageGrade,100)}%`}})}),e.jsx("p",{className:"text-xs text-slate-400 mt-1",children:i.averageGrade>=80?"Prestasi keren! 🌟":i.averageGrade>0?"Semangat belajar terus! 📖":"Data nilai lagi di-sync...⏳"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-slate-300",children:"Tugas Selesai"}),e.jsx("span",{className:"text-sm font-bold text-purple-400",children:i.completedAssignments})]}),e.jsx("div",{className:"w-full h-3 bg-slate-700 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-gradient-to-r from-purple-500 to-pink-500 rounded-full transition-all duration-500",style:{width:`${Math.min(i.completedAssignments/Math.max(i.completedAssignments,10)*100,100)}%`}})}),e.jsx("p",{className:"text-xs text-slate-400 mt-1",children:i.completedAssignments>=10?"Produktif banget! 🔥":i.completedAssignments>0?"Ada quest lain menunggu! 💪":"Data tugas lagi di-sync...⏳"})]})]})]}),i.badges.length>0?e.jsxs("div",{className:"bg-slate-800/50 backdrop-blur-sm rounded-2xl border border-purple-500/30 p-6",children:[e.jsxs("h2",{className:"text-xl font-bold text-white mb-6 flex items-center gap-2",children:[e.jsx(jt,{className:"w-6 h-6 text-yellow-400"}),"Koleksi Trofi 🏆",e.jsxs("span",{className:"ml-auto text-sm bg-yellow-500/20 text-yellow-300 px-3 py-1 rounded-full border border-yellow-500/30",children:[i.badges.length," Badge",i.badges.length!==1?"s":""]})]}),e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6 gap-4",children:i.badges.map((H,ae)=>{const oe=x.find(D=>D.name===H);return e.jsxs("div",{className:"relative group bg-gradient-to-br from-yellow-500/20 to-orange-500/20 border border-yellow-500/30 rounded-2xl p-6 text-center hover:scale-105 transition-all duration-300 hover:shadow-2xl cursor-pointer",title:H,children:[e.jsx("div",{className:"text-4xl mb-3",children:(oe==null?void 0:oe.icon)||"🏆"}),e.jsx("h3",{className:"text-sm font-bold text-white mb-1 leading-tight min-h-[2.5rem] flex items-center justify-center",children:H}),(oe==null?void 0:oe.pointValue)&&e.jsxs("div",{className:"text-xs text-yellow-300 font-medium",children:["+",oe.pointValue," XP"]}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-yellow-500/0 to-yellow-500/20 rounded-2xl opacity-0 group-hover:opacity-100 transition-opacity"}),e.jsx("div",{className:"absolute top-2 right-2 opacity-0 group-hover:opacity-100 transition-opacity duration-300",children:e.jsx("div",{className:"w-2 h-2 bg-yellow-400 rounded-full animate-pulse"})})]},ae)})}),e.jsx("div",{className:"mt-6 pt-6 border-t border-slate-600/50",children:e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4 text-center",children:[e.jsxs("div",{className:"bg-slate-700/30 rounded-xl p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-yellow-400",children:i.badges.length}),e.jsx("div",{className:"text-xs text-slate-400",children:"Badge Diperoleh"})]}),e.jsxs("div",{className:"bg-slate-700/30 rounded-xl p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-orange-400",children:x.reduce((H,ae)=>{const oe=i.badges.includes(ae.name);return H+(oe&&ae.pointValue||0)},0)}),e.jsx("div",{className:"text-xs text-slate-400",children:"XP dari Badge"})]}),e.jsxs("div",{className:"bg-slate-700/30 rounded-xl p-4 col-span-2 md:col-span-1",children:[e.jsxs("div",{className:"text-2xl font-bold text-purple-400",children:[Math.round(i.badges.length/Math.max(x.length,1)*100),"%"]}),e.jsx("div",{className:"text-xs text-slate-400",children:"Koleksi Lengkap"})]})]})})]}):e.jsxs("div",{className:"bg-slate-800/50 backdrop-blur-sm rounded-2xl border border-purple-500/30 p-6",children:[e.jsxs("h2",{className:"text-xl font-bold text-white mb-6 flex items-center gap-2",children:[e.jsx(jt,{className:"w-6 h-6 text-yellow-400"}),"Koleksi Trofi 🏆",e.jsx("span",{className:"ml-auto text-sm bg-slate-600/50 text-slate-400 px-3 py-1 rounded-full border border-slate-500/30",children:"0 Badge"})]}),e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"w-24 h-24 mx-auto mb-6 bg-slate-700/50 rounded-full flex items-center justify-center",children:e.jsx(jt,{className:"w-12 h-12 text-slate-400"})}),e.jsx("p",{className:"text-slate-400 text-lg font-medium mb-2",children:"Belum ada badge nih"}),e.jsx("p",{className:"text-slate-500 text-sm mb-6",children:"Yuk selesaikan achievement untuk dapetin trofi pertama! ⭐"}),x.length>0&&e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-400 text-sm mb-4",children:"Badge yang bisa didapetin:"}),e.jsxs("div",{className:"flex justify-center gap-2 flex-wrap max-w-md mx-auto",children:[x.slice(0,6).map((H,ae)=>e.jsx("div",{className:"text-2xl opacity-50 hover:opacity-100 transition-opacity",title:H.name,children:H.icon||"🏆"},ae)),x.length>6&&e.jsxs("div",{className:"text-slate-500 text-sm",children:["+",x.length-6," lagi"]})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx(V,{className:"h-16 bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800 text-white font-medium border border-blue-500/50",onClick:h,disabled:t,children:e.jsxs("div",{className:"text-center",children:[e.jsx(ti,{className:`w-6 h-6 mx-auto mb-1 ${t?"animate-spin":""}`}),e.jsx("span",{className:"text-sm",children:t?"Refreshing...":"Refresh Stats"})]})}),e.jsx(V,{className:"h-16 bg-gradient-to-r from-green-600 to-green-700 hover:from-green-700 hover:to-green-800 text-white font-medium border border-green-500/50",children:e.jsxs("div",{className:"text-center",children:[e.jsx(so,{className:"w-6 h-6 mx-auto mb-1"}),e.jsx("span",{className:"text-sm",children:"Peta Progress"})]})}),e.jsx(V,{className:"h-16 bg-gradient-to-r from-purple-600 to-purple-700 hover:from-purple-700 hover:to-purple-800 text-white font-medium border border-purple-500/50",children:e.jsxs("div",{className:"text-center",children:[e.jsx(_s,{className:"w-6 h-6 mx-auto mb-1"}),e.jsx("span",{className:"text-sm",children:"Teman Kelas"})]})}),e.jsx(V,{className:"h-16 bg-gradient-to-r from-orange-600 to-orange-700 hover:from-orange-700 hover:to-orange-800 text-white font-medium border border-orange-500/50",children:e.jsxs("div",{className:"text-center",children:[e.jsx(tr,{className:"w-6 h-6 mx-auto mb-1"}),e.jsx("span",{className:"text-sm",children:"Achievement"})]})})]})]})]})},Mo=()=>{const[s,a]=S.useState([]),[t,r]=S.useState([]),[n,l]=S.useState({}),[i,c]=S.useState(!0),[d,o]=S.useState(!1),[m,g]=S.useState(""),[x,f]=S.useState(0),[p,h]=S.useState(!1),[w,L]=S.useState(!1),[O,I]=S.useState({name:"",subject:"",description:""}),[H,ae]=S.useState(!1),[oe,D]=S.useState(!1),[q,z]=S.useState(null),[G,ce]=S.useState({name:"",subject:"",description:""}),[M,W]=S.useState(!1),[re,ve]=S.useState(!1),[te,ke]=S.useState(null),[xe,Ie]=S.useState(null);S.useEffect(()=>{Oe()},[]),S.useEffect(()=>{if(m){const Y=s.filter(ue=>ue.name.toLowerCase().includes(m.toLowerCase())||ue.subject.toLowerCase().includes(m.toLowerCase())||ue.description.toLowerCase().includes(m.toLowerCase()));r(Y)}else r(s)},[m,s]),S.useEffect(()=>{if(xe){const Y=setTimeout(()=>{Ie(null)},5e3);return()=>clearTimeout(Y)}},[xe]);const je=(Y,ue)=>{Ie({type:Y,message:ue})},Oe=async()=>{try{c(!0),f(20),console.log("🔄 Loading classes...");const Y=await et.getAll();if(console.log("📊 Classes response:",Y),Y.success){const ue=Y.classes||[];a(ue),r(ue),f(60),console.log("✅ Loaded classes:",ue.length),c(!1),f(100),ue.length>0&&N(ue)}else console.error("❌ Failed to load classes:",Y.error),je("error",Y.error||"Gagal memuat data kelas"),c(!1)}catch(Y){console.error("💥 Error loading classes:",Y),je("error","Terjadi kesalahan saat memuat data kelas"),c(!1)}},N=async Y=>{if(Y.length!==0)try{o(!0),console.log("📈 Loading class statistics incrementally...");let ue=0;const Me=async de=>{try{const pe=await et.getStats(de.id),E=pe.success&&pe.stats?pe.stats:{studentsCount:0,assignmentsCount:0,averageGrade:null};l(ye=>({...ye,[de.id]:E})),ue++;const R=Math.round(ue/Y.length*100);return console.log(`📊 Loaded stats for ${de.name}: ${R}% complete`),{classId:de.id,stats:E}}catch(pe){console.error(`Error loading stats for class ${de.id}:`,pe);const E={studentsCount:0,assignmentsCount:0,averageGrade:null};return l(R=>({...R,[de.id]:E})),ue++,{classId:de.id,stats:E}}},le=Y.slice(0,3),B=Y.slice(3);await Promise.all(le.map(de=>Me(de)));for(let de=0;de<B.length;de++){const pe=B[de];setTimeout(()=>{Me(pe)},de*100)}console.log("✅ Stats loading initiated for all classes")}catch(ue){console.error("💥 Error loading class statistics:",ue)}finally{setTimeout(()=>{o(!1)},Y.length*150)}},P=async Y=>{if(Y.length!==0)try{o(!0),console.log("📈 Loading class statistics...");const ue=Y.map(async B=>{try{const de=await et.getStats(B.id);return{classId:B.id,stats:de.success&&de.stats?de.stats:{studentsCount:0,assignmentsCount:0,averageGrade:null}}}catch(de){return console.error(`Error loading stats for class ${B.id}:`,de),{classId:B.id,stats:{studentsCount:0,assignmentsCount:0,averageGrade:null}}}}),Me=await Promise.all(ue),le={};Me.forEach(({classId:B,stats:de})=>{le[B]=de}),l(le),console.log("✅ Loaded class statistics:",le)}catch(ue){console.error("💥 Error loading class statistics:",ue)}finally{o(!1)}},T=async()=>{try{console.log("🔄 Refreshing classes data..."),s.length>0?(o(!0),je("success","Memperbarui statistik kelas..."),await P(s)):await Oe(),je("success","Data berhasil diperbarui")}catch(Y){console.error("💥 Error refreshing data:",Y),je("error","Gagal memperbarui data")}},A=async Y=>{Y.preventDefault(),L(!0);try{console.log("➕ Creating class:",O);const ue=await et.create(O.name,O.subject,O.description);console.log("📝 Create response:",ue),ue.success?(I({name:"",subject:"",description:""}),h(!1),je("success",`Kelas "${O.name}" berhasil dibuat!`),await Oe()):(console.error("❌ Failed to create class:",ue.error),je("error",ue.error||"Gagal membuat kelas"))}catch(ue){console.error("💥 Error creating class:",ue),je("error","Terjadi kesalahan saat membuat kelas")}finally{L(!1)}},X=Y=>{z(Y),ce({name:Y.name,subject:Y.subject,description:Y.description}),ae(!0)},me=async Y=>{if(Y.preventDefault(),!!q){D(!0);try{console.log("✏️ Updating class:",q.id,G);const ue=await et.update(q.id,G.name,G.subject,G.description);console.log("📝 Update response:",ue),ue.success?(ae(!1),z(null),je("success",`Kelas "${G.name}" berhasil diperbarui!`),await T()):(console.error("❌ Failed to update class:",ue.error),je("error",ue.error||"Gagal memperbarui kelas"))}catch(ue){console.error("💥 Error updating class:",ue),je("error","Terjadi kesalahan saat memperbarui kelas")}finally{D(!1)}}},F=Y=>{ke(Y),W(!0)},J=async()=>{if(te){ve(!0);try{console.log("🗑️ Deleting class:",te.id);const Y=await et.delete(te.id);console.log("🗑️ Delete response:",Y),Y.success?(W(!1),ke(null),je("success",`Kelas "${te.name}" berhasil dihapus!`),await T()):(console.error("❌ Failed to delete class:",Y.error),je("error",Y.error||"Gagal menghapus kelas"))}catch(Y){console.error("💥 Error deleting class:",Y),je("error","Terjadi kesalahan saat menghapus kelas")}finally{ve(!1)}}},U=()=>{const Y=["from-blue-500 to-indigo-600","from-purple-500 to-pink-600","from-green-500 to-teal-600","from-orange-500 to-red-600","from-cyan-500 to-blue-600","from-violet-500 to-purple-600"];return Y[Math.floor(Math.random()*Y.length)]};return i?e.jsxs("div",{className:"space-y-4 sm:space-y-6 p-4 sm:p-6",children:[e.jsx("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold",children:"Kelas"}),e.jsx("p",{className:"text-gray-600 mt-2 text-sm sm:text-base",children:"Kelola semua kelas Anda"})]})}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 sm:gap-6",children:Array.from({length:6}).map((Y,ue)=>e.jsx(xl,{},ue))})]}):e.jsxs("div",{className:"space-y-4 sm:space-y-6 bg-gray-50/50 min-h-screen",children:[e.jsx(Ve,{children:xe&&e.jsx(ge.div,{initial:{opacity:0,y:-50},animate:{opacity:1,y:0},exit:{opacity:0,y:-50},className:"fixed top-4 left-4 right-4 sm:top-4 sm:right-4 sm:left-auto z-50",children:e.jsxs("div",{className:`flex items-center gap-3 p-3 sm:p-4 rounded-lg shadow-lg ${xe.type==="success"?"bg-green-50 text-green-800 border border-green-200":"bg-red-50 text-red-800 border border-red-200"}`,children:[xe.type==="success"?e.jsx(Vs,{className:"w-4 h-4 sm:w-5 sm:h-5 flex-shrink-0"}):e.jsx(Zs,{className:"w-4 h-4 sm:w-5 sm:h-5 flex-shrink-0"}),e.jsx("span",{className:"font-medium text-sm sm:text-base flex-1",children:xe.message}),e.jsx("button",{onClick:()=>Ie(null),className:"ml-2 text-gray-400 hover:text-gray-600 transition-colors flex-shrink-0",children:e.jsx(Ys,{className:"w-4 h-4"})})]})})}),e.jsx(fs,{variant:Ws,children:e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900",children:"Kelas"}),e.jsxs("p",{className:"text-gray-600 mt-2 text-sm sm:text-base",children:["Kelola semua kelas Anda dengan mudah",d&&e.jsx("span",{className:"ml-2 text-blue-600",children:"• Memuat statistik..."}),x>0&&x<100&&e.jsxs("span",{className:"ml-2 text-blue-600",children:["• Loading ",x,"%"]})]})]}),e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 w-full sm:w-auto",children:[e.jsxs(V,{onClick:T,variant:"outline",size:"sm",disabled:d,className:"flex items-center gap-2 flex-1 sm:flex-none h-9 sm:h-10",children:[e.jsx(ct,{className:`w-3 h-3 sm:w-4 sm:h-4 ${d?"animate-spin":""}`}),e.jsx("span",{className:"text-xs sm:text-sm",children:d?"Memuat...":"Refresh"})]}),e.jsxs(V,{onClick:()=>h(!0),className:"bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 text-white flex-1 sm:flex-none h-9 sm:h-10",children:[e.jsx(xs,{className:"w-3 h-3 sm:w-4 sm:h-4 mr-2"}),e.jsx("span",{className:"text-xs sm:text-sm",children:"Buat Kelas"})]})]})]})}),e.jsx(fs,{variant:Aa,delay:.1,children:e.jsx(Ge,{className:"border-0 shadow-lg",children:e.jsx(We,{className:"p-4 sm:p-6",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 sm:gap-4",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(Zt,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),e.jsx(He,{placeholder:"Cari kelas, mata pelajaran, atau deskripsi...",value:m,onChange:Y=>g(Y.target.value),className:"pl-10 h-10 sm:h-11 text-sm sm:text-base"})]}),e.jsx("div",{className:"flex gap-2 self-start sm:self-center",children:e.jsxs(Xs,{variant:"outline",className:"text-xs sm:text-sm whitespace-nowrap",children:[t.length," Kelas"]})})]})})})}),e.jsx(hl,{children:e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 sm:gap-6",children:t.map((Y,ue)=>{const Me=n[Y.id]||{studentsCount:0,assignmentsCount:0,averageGrade:null};return e.jsx(fs,{delay:ue*.1,children:e.jsx(ge.div,{whileHover:{y:-5},className:"group",children:e.jsxs(Ge,{className:"border-0 shadow-lg hover:shadow-xl transition-all duration-300 overflow-hidden",children:[e.jsxs("div",{className:`bg-gradient-to-r ${U()} p-4 sm:p-6 text-white relative`,children:[e.jsx("div",{className:"flex justify-between items-start",children:e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"text-lg sm:text-xl font-bold mb-2 truncate",children:Y.name}),Y.subject&&e.jsx(Xs,{variant:"secondary",className:"bg-white/20 text-white border-white/30 text-xs",children:Y.subject})]})}),e.jsx("div",{className:"absolute top-0 right-0 w-24 h-24 sm:w-32 sm:h-32 opacity-10",children:e.jsx(ys,{className:"w-full h-full"})})]}),e.jsxs(We,{className:"p-4 sm:p-6",children:[e.jsx("p",{className:"text-gray-600 mb-4 line-clamp-2 text-sm sm:text-base",children:Y.description||"Tidak ada deskripsi"}),e.jsxs("div",{className:"grid grid-cols-3 gap-3 sm:gap-4 mb-4 sm:mb-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-8 h-8 sm:w-10 sm:h-10 bg-blue-100 rounded-lg flex items-center justify-center mx-auto mb-2",children:e.jsx(_s,{className:"w-4 h-4 sm:w-5 sm:h-5 text-blue-600"})}),e.jsx("div",{className:"text-base sm:text-lg font-bold text-gray-900",children:!Me||d?e.jsx("div",{className:"w-6 h-5 sm:w-8 sm:h-6 mx-auto bg-gray-200 rounded animate-pulse"}):Me.studentsCount}),e.jsx("div",{className:"text-xs text-gray-500",children:"Siswa"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-8 h-8 sm:w-10 sm:h-10 bg-green-100 rounded-lg flex items-center justify-center mx-auto mb-2",children:e.jsx(jt,{className:"w-4 h-4 sm:w-5 sm:h-5 text-green-600"})}),e.jsx("div",{className:"text-base sm:text-lg font-bold text-gray-900",children:!Me||d?e.jsx("div",{className:"w-6 h-5 sm:w-8 sm:h-6 mx-auto bg-gray-200 rounded animate-pulse"}):Me.assignmentsCount}),e.jsx("div",{className:"text-xs text-gray-500",children:"Tugas"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-8 h-8 sm:w-10 sm:h-10 bg-purple-100 rounded-lg flex items-center justify-center mx-auto mb-2",children:e.jsx(na,{className:"w-4 h-4 sm:w-5 sm:h-5 text-purple-600"})}),e.jsx("div",{className:"text-base sm:text-lg font-bold text-gray-900",children:!Me||d?e.jsx("div",{className:"w-6 h-5 sm:w-8 sm:h-6 mx-auto bg-gray-200 rounded animate-pulse"}):Me.averageGrade!==null?Me.averageGrade.toFixed(1):"-"}),e.jsx("div",{className:"text-xs text-gray-500",children:"Rata-rata"})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(V,{variant:"outline",size:"sm",className:"flex-1 h-8 sm:h-9 text-xs sm:text-sm",children:[e.jsx(Ms,{className:"w-3 h-3 sm:w-4 sm:h-4 mr-1 sm:mr-2"}),e.jsx("span",{className:"hidden sm:inline",children:"Lihat"}),e.jsx("span",{className:"sm:hidden",children:"Detail"})]}),e.jsx(V,{variant:"outline",size:"sm",onClick:()=>X(Y),className:"w-8 h-8 sm:w-9 sm:h-9 p-0",children:e.jsx(ar,{className:"w-3 h-3 sm:w-4 sm:h-4"})}),e.jsx(V,{variant:"outline",size:"sm",className:"text-red-600 hover:text-red-700 hover:bg-red-50 w-8 h-8 sm:w-9 sm:h-9 p-0",onClick:()=>F(Y),children:e.jsx(hs,{className:"w-3 h-3 sm:w-4 sm:h-4"})})]}),e.jsxs("div",{className:"mt-3 sm:mt-4 pt-3 sm:pt-4 border-t flex items-center text-xs text-gray-500",children:[e.jsx(pt,{className:"w-3 h-3 mr-1 flex-shrink-0"}),e.jsxs("span",{className:"truncate",children:["Dibuat ",new Date(Y.createdAt).toLocaleDateString("id-ID",{day:"numeric",month:"short",year:"numeric"})]})]})]})]})})},Y.id)})})}),!i&&t.length===0&&e.jsx(fs,{variant:Ws,delay:.3,children:e.jsx(Ge,{className:"border-0 shadow-lg",children:e.jsxs(We,{className:"text-center py-8 sm:py-12 px-4 sm:px-6",children:[e.jsx("div",{className:"w-20 h-20 sm:w-24 sm:h-24 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4 sm:mb-6",children:e.jsx(ys,{className:"w-10 h-10 sm:w-12 sm:h-12 text-gray-400"})}),e.jsx("h3",{className:"text-lg sm:text-xl font-semibold text-gray-900 mb-2",children:m?"Tidak ada kelas yang ditemukan":"Belum ada kelas"}),e.jsx("p",{className:"text-gray-600 mb-4 sm:mb-6 max-w-md mx-auto text-sm sm:text-base",children:m?"Coba ubah kata kunci pencarian Anda":"Mulai dengan membuat kelas pertama Anda untuk mengelola siswa dan pembelajaran"}),!m&&e.jsxs(V,{onClick:()=>h(!0),className:"bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 h-10 sm:h-11 text-sm sm:text-base",children:[e.jsx(xs,{className:"w-4 h-4 mr-2"}),"Buat Kelas Pertama"]})]})})}),e.jsx(Ve,{children:p&&e.jsxs(e.Fragment,{children:[e.jsx(ge.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 z-40",onClick:()=>!w&&h(!1)}),e.jsx(ge.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:e.jsxs(Ge,{className:"w-full max-w-md bg-white shadow-2xl mx-4",children:[e.jsxs(ms,{className:"p-4 sm:p-6",children:[e.jsx(ls,{className:"text-lg sm:text-xl",children:"Buat Kelas Baru"}),e.jsx(bs,{className:"text-sm sm:text-base",children:"Isi informasi kelas yang akan Anda buat"})]}),e.jsxs("form",{onSubmit:A,children:[e.jsxs(We,{className:"space-y-4 p-4 sm:p-6 pt-0",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Nama Kelas"}),e.jsx(He,{placeholder:"Contoh: 9A, X-IPA-1",value:O.name,onChange:Y=>I(ue=>({...ue,name:Y.target.value})),className:"h-10 sm:h-11 text-sm sm:text-base",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Mata Pelajaran"}),e.jsx(He,{placeholder:"Contoh: Matematika, Fisika, Bahasa Indonesia",value:O.subject,onChange:Y=>I(ue=>({...ue,subject:Y.target.value})),className:"h-10 sm:h-11 text-sm sm:text-base",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Deskripsi"}),e.jsx(He,{placeholder:"Contoh: Kelas pagi, Semester ganjil",value:O.description,onChange:Y=>I(ue=>({...ue,description:Y.target.value})),className:"h-10 sm:h-11 text-sm sm:text-base"})]})]}),e.jsxs("div",{className:"flex gap-3 p-4 sm:p-6 pt-0",children:[e.jsx(V,{type:"button",variant:"outline",className:"flex-1 h-10 sm:h-11 text-sm sm:text-base",onClick:()=>h(!1),disabled:w,children:"Batal"}),e.jsx(V,{type:"submit",className:"flex-1 bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 h-10 sm:h-11 text-sm sm:text-base",disabled:w,children:w?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(dt,{size:"sm"}),e.jsx("span",{children:"Membuat..."})]}):"Buat Kelas"})]})]})]})})]})}),e.jsx(Ve,{children:H&&q&&e.jsxs(e.Fragment,{children:[e.jsx(ge.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 z-40",onClick:()=>!oe&&ae(!1)}),e.jsx(ge.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:e.jsxs(Ge,{className:"w-full max-w-md bg-white shadow-2xl mx-4",children:[e.jsxs(ms,{className:"p-4 sm:p-6",children:[e.jsx(ls,{className:"text-lg sm:text-xl",children:"Edit Kelas"}),e.jsxs(bs,{className:"text-sm sm:text-base",children:['Perbarui informasi kelas "',q.name,'"']})]}),e.jsxs("form",{onSubmit:me,children:[e.jsxs(We,{className:"space-y-4 p-4 sm:p-6 pt-0",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Nama Kelas"}),e.jsx(He,{placeholder:"Contoh: 9A, X-IPA-1",value:G.name,onChange:Y=>ce(ue=>({...ue,name:Y.target.value})),className:"h-10 sm:h-11 text-sm sm:text-base",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Mata Pelajaran"}),e.jsx(He,{placeholder:"Contoh: Matematika, Fisika, Bahasa Indonesia",value:G.subject,onChange:Y=>ce(ue=>({...ue,subject:Y.target.value})),className:"h-10 sm:h-11 text-sm sm:text-base",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Deskripsi"}),e.jsx(He,{placeholder:"Contoh: Kelas pagi, Semester ganjil",value:G.description,onChange:Y=>ce(ue=>({...ue,description:Y.target.value})),className:"h-10 sm:h-11 text-sm sm:text-base"})]})]}),e.jsxs("div",{className:"flex gap-3 p-4 sm:p-6 pt-0",children:[e.jsx(V,{type:"button",variant:"outline",className:"flex-1 h-10 sm:h-11 text-sm sm:text-base",onClick:()=>ae(!1),disabled:oe,children:"Batal"}),e.jsx(V,{type:"submit",className:"flex-1 bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 h-10 sm:h-11 text-sm sm:text-base",disabled:oe,children:oe?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(dt,{size:"sm"}),e.jsx("span",{children:"Memperbarui..."})]}):"Perbarui Kelas"})]})]})]})})]})}),e.jsx(Ve,{children:M&&te&&e.jsxs(e.Fragment,{children:[e.jsx(ge.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 z-40",onClick:()=>!re&&W(!1)}),e.jsx(ge.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:e.jsxs(Ge,{className:"w-full max-w-md bg-white shadow-2xl mx-4",children:[e.jsxs(ms,{className:"p-4 sm:p-6",children:[e.jsxs(ls,{className:"flex items-center gap-2 text-red-600 text-lg sm:text-xl",children:[e.jsx(Zs,{className:"w-4 h-4 sm:w-5 sm:h-5"}),"Konfirmasi Hapus"]}),e.jsx(bs,{className:"text-sm sm:text-base",children:"Tindakan ini tidak dapat dibatalkan"})]}),e.jsxs(We,{className:"p-4 sm:p-6 pt-0",children:[e.jsxs("p",{className:"text-gray-700 text-sm sm:text-base",children:["Apakah Anda yakin ingin menghapus kelas ",e.jsxs("strong",{children:['"',te.name,'"']}),"?"]}),e.jsx("p",{className:"text-xs sm:text-sm text-gray-500 mt-2",children:"Semua data yang terkait dengan kelas ini akan ikut terhapus."})]}),e.jsxs("div",{className:"flex gap-3 p-4 sm:p-6 pt-0",children:[e.jsx(V,{type:"button",variant:"outline",className:"flex-1 h-10 sm:h-11 text-sm sm:text-base",onClick:()=>W(!1),disabled:re,children:"Batal"}),e.jsx(V,{type:"button",variant:"destructive",className:"flex-1 h-10 sm:h-11 text-sm sm:text-base",onClick:J,disabled:re,children:re?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(dt,{size:"sm"}),e.jsx("span",{children:"Menghapus..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(hs,{className:"w-3 h-3 sm:w-4 sm:h-4 mr-2"}),"Hapus Kelas"]})})]})]})})]})})]})},Bo=()=>{const[s,a]=S.useState([]),[t,r]=S.useState([]),[n,l]=S.useState([]),[i,c]=S.useState("all"),[d,o]=S.useState(!0),[m,g]=S.useState(""),[x,f]=S.useState(!1),[p,h]=S.useState(!1),[w,L]=S.useState(!1),[O,I]=S.useState(!1),[H,ae]=S.useState(!1),[oe,D]=S.useState(!1),[q,z]=S.useState({username:"",password:"pass123",fullName:"",classId:""}),[G,ce]=S.useState(null),[M,W]=S.useState({fullName:"",classId:""}),[re,ve]=S.useState(null),[te,ke]=S.useState(null);S.useEffect(()=>{je()},[]),S.useEffect(()=>{t.length>0&&Oe()},[t,i]),S.useEffect(()=>{let F=s;i!=="all"&&(F=F.filter(J=>J.classId===i)),m&&(F=F.filter(J=>J.fullName.toLowerCase().includes(m.toLowerCase())||J.username.toLowerCase().includes(m.toLowerCase())||J.className&&J.className.toLowerCase().includes(m.toLowerCase()))),l(F)},[m,s,i]),S.useEffect(()=>{if(te){const F=setTimeout(()=>{ke(null)},5e3);return()=>clearTimeout(F)}},[te]);const xe=(F,J)=>{ke({type:F,message:J})},Ie=async()=>{try{console.log("🔍 Debug: Current students in state:",s);const F=await ta.getAll();console.log("🔍 Debug: Raw API response:",F),F.success&&F.students&&(console.log("🔍 Debug: Raw students data:",F.students),F.students.forEach((J,U)=>{console.log(`🔍 Debug: Student ${U+1}:`,{id:J.id,studentUsername:J.studentUsername,username:J.username,fullName:J.fullName,classId:J.classId,raw:J})})),xe("success","Data siswa telah dicetak ke console. Buka Developer Tools untuk melihat.")}catch(F){console.error("🔍 Debug error:",F),xe("error","Terjadi kesalahan saat debugging")}},je=async()=>{var F;try{console.log("🔄 Loading classes for student management...");const J=await et.getAll();J.success?(r(J.classes||[]),console.log("✅ Loaded classes:",((F=J.classes)==null?void 0:F.length)||0)):(console.error("❌ Failed to load classes:",J.error),xe("error",J.error||"Gagal memuat data kelas"))}catch(J){console.error("💥 Error loading classes:",J),xe("error","Terjadi kesalahan saat memuat data kelas")}},Oe=async()=>{try{o(!0),console.log("🔄 Loading students...");const F=await ta.getAll();if(console.log("👥 Students response:",F),F.success){const J=(F.students||[]).map(Y=>{const ue=N(Y.classId),Me=Y.username||Y.studentUsername;return Me?{id:Y.id,username:Me,fullName:Y.fullName||"Unknown",classId:Y.classId,className:ue,role:Y.role||"student",joinedAt:Y.joinedAt,backendId:Y.id}:(console.warn("⚠️ Skipping student without username:",Y),null)}).filter(Boolean);a(J),console.log("✅ Loaded students:",J.length),J.forEach((Y,ue)=>{console.log(`✅ Processed Student ${ue+1}:`,{id:Y.id,username:Y.username,backendId:Y.backendId,fullName:Y.fullName})});const U=(F.students||[]).filter(Y=>!Y.username&&!Y.studentUsername);U.length>0&&console.warn("⚠️ Found students without username:",U)}else console.error("❌ Failed to load students:",F.error),xe("error",F.error||"Gagal memuat data siswa")}catch(F){console.error("💥 Error loading students:",F),xe("error","Terjadi kesalahan saat memuat data siswa")}finally{o(!1)}},N=F=>{if(!F||F===""||F==="default")return"Belum ada kelas";const J=t.find(U=>U.id===F);return J?J.name:"Kelas tidak ditemukan"},P=async F=>{F.preventDefault(),I(!0);try{console.log("➕ Creating student:",q);const J=await ta.create(q.classId,q.username,q.fullName,q.password);console.log("📝 Create response:",J),J.success?(z({username:"",password:"pass123",fullName:"",classId:""}),f(!1),xe("success",`Siswa "${q.fullName}" berhasil dibuat!`),await Oe()):(console.error("❌ Failed to create student:",J.error),xe("error",J.error||"Gagal membuat siswa"))}catch(J){console.error("💥 Error creating student:",J),xe("error","Terjadi kesalahan saat membuat siswa")}finally{I(!1)}},T=F=>{ce(F),W({fullName:F.fullName,classId:F.classId||""}),h(!0)},A=async F=>{if(F.preventDefault(),!!G){ae(!0);try{console.log("✏️ Updating student:",G.id,M);const J=await ta.update(G.id,M.fullName);console.log("📝 Update response:",J),J.success?(h(!1),ce(null),xe("success",`Data siswa "${M.fullName}" berhasil diperbarui!`),await Oe()):(console.error("❌ Failed to update student:",J.error),xe("error",J.error||"Gagal memperbarui data siswa"))}catch(J){console.error("💥 Error updating student:",J),xe("error","Terjadi kesalahan saat memperbarui data siswa")}finally{ae(!1)}}},X=F=>{ve(F),L(!0)},me=async()=>{var F;if(re){if(console.log("🔍 DEBUG: Deleting student object:",{id:re.id,username:re.username,fullName:re.fullName,classId:re.classId,backendId:re.backendId,typeof_id:typeof re.id,id_length:(F=re.id)==null?void 0:F.length,id_stringified:JSON.stringify(re.id),full_object:JSON.stringify(re)}),!re.id||re.id==="undefined"||re.id===""||typeof re.id!="string"||re.id.trim()===""){console.error("❌ Cannot delete student: Invalid ID",re),xe("error","Tidak dapat menghapus siswa: ID tidak valid"),L(!1),ve(null);return}D(!0);try{console.log("🗑️ Deleting student with backend ID:",re.id);const J=await ta.delete(re.id);console.log("🗑️ Delete response:",J),J.success?(L(!1),ve(null),xe("success",`Siswa "${re.fullName}" berhasil dihapus!`),await Oe()):(console.error("❌ Failed to delete student:",J.error),xe("error",J.error||"Gagal menghapus siswa"))}catch(J){console.error("💥 Error deleting student:",J),xe("error","Terjadi kesalahan saat menghapus siswa")}finally{D(!1)}}};return d?e.jsxs("div",{className:"space-y-4 sm:space-y-6 p-4 sm:p-6",children:[e.jsx("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold",children:"Siswa"}),e.jsx("p",{className:"text-gray-600 mt-2 text-sm sm:text-base",children:"Kelola semua siswa dan penempatan kelas"})]})}),e.jsx(Ge,{className:"border-0 shadow-lg",children:e.jsx(We,{className:"p-4 sm:p-6",children:e.jsx("div",{className:"space-y-3 sm:space-y-4",children:Array.from({length:8}).map((F,J)=>e.jsxs("div",{className:"flex items-center space-x-3 sm:space-x-4 animate-pulse",children:[e.jsx("div",{className:"w-10 h-10 sm:w-12 sm:h-12 bg-gray-200 rounded-full flex-shrink-0"}),e.jsxs("div",{className:"flex-1 space-y-2 min-w-0",children:[e.jsx("div",{className:"h-3 sm:h-4 bg-gray-200 rounded w-1/4"}),e.jsx("div",{className:"h-2 sm:h-3 bg-gray-200 rounded w-1/3"})]}),e.jsx("div",{className:"h-6 sm:h-8 bg-gray-200 rounded w-16 sm:w-20 flex-shrink-0"}),e.jsx("div",{className:"h-6 sm:h-8 bg-gray-200 rounded w-20 sm:w-24 flex-shrink-0"})]},J))})})})]}):e.jsxs("div",{className:"space-y-4 sm:space-y-6 bg-gray-50/50 min-h-screen p-4 sm:p-6",children:[e.jsx(Ve,{children:te&&e.jsx(ge.div,{initial:{opacity:0,y:-50},animate:{opacity:1,y:0},exit:{opacity:0,y:-50},className:"fixed top-4 left-4 right-4 sm:top-4 sm:right-4 sm:left-auto z-50",children:e.jsxs("div",{className:`flex items-center gap-3 p-3 sm:p-4 rounded-lg shadow-lg ${te.type==="success"?"bg-green-50 text-green-800 border border-green-200":"bg-red-50 text-red-800 border border-red-200"}`,children:[te.type==="success"?e.jsx(Vs,{className:"w-4 h-4 sm:w-5 sm:h-5 flex-shrink-0"}):e.jsx(Zs,{className:"w-4 h-4 sm:w-5 sm:h-5 flex-shrink-0"}),e.jsx("span",{className:"font-medium text-sm sm:text-base flex-1",children:te.message}),e.jsx("button",{onClick:()=>ke(null),className:"ml-2 text-gray-400 hover:text-gray-600 transition-colors flex-shrink-0",children:e.jsx(Ys,{className:"w-4 h-4"})})]})})}),e.jsx(fs,{variant:Ws,children:e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900",children:"Siswa"}),e.jsx("p",{className:"text-gray-600 mt-2 text-sm sm:text-base",children:"Kelola semua siswa dan penempatan kelas"})]}),e.jsxs("div",{className:"flex gap-2 w-full sm:w-auto",children:[e.jsxs(V,{variant:"outline",onClick:Ie,className:"text-blue-600 border-blue-200 hover:bg-blue-50 flex-1 sm:flex-none h-9 sm:h-10 text-xs sm:text-sm",children:[e.jsx(Ms,{className:"w-3 h-3 sm:w-4 sm:h-4 mr-2"}),"Debug Data"]}),e.jsxs(V,{onClick:()=>f(!0),className:"bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 text-white flex-1 sm:flex-none h-9 sm:h-10 text-xs sm:text-sm",children:[e.jsx(Rr,{className:"w-3 h-3 sm:w-4 sm:h-4 mr-2"}),"Tambah Siswa"]})]})]})}),e.jsx(fs,{variant:Aa,delay:.1,children:e.jsx(Ge,{className:"border-0 shadow-lg",children:e.jsx(We,{className:"p-4 sm:p-6",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 sm:gap-4",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(Zt,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),e.jsx(He,{placeholder:"Cari siswa berdasarkan nama, username, atau kelas...",value:m,onChange:F=>g(F.target.value),className:"pl-10 h-10 sm:h-11 text-sm sm:text-base"})]}),e.jsxs("div",{className:"flex gap-2 items-center flex-wrap",children:[e.jsx(al,{className:"w-4 h-4 text-gray-400 flex-shrink-0"}),e.jsxs("select",{className:"px-3 py-2 border border-gray-300 rounded-lg text-xs sm:text-sm bg-white focus:outline-none focus:ring-2 focus:ring-blue-500 flex-1 sm:flex-none min-w-0",value:i,onChange:F=>c(F.target.value),children:[e.jsx("option",{value:"all",children:"Semua Kelas"}),t.map(F=>e.jsx("option",{value:F.id,children:F.name},F.id))]}),e.jsxs(Xs,{variant:"outline",className:"text-xs sm:text-sm whitespace-nowrap",children:[n.length," Siswa"]})]})]})})})}),e.jsx(fs,{variant:Ws,delay:.2,children:e.jsxs(Ge,{className:"border-0 shadow-lg overflow-hidden",children:[e.jsx("div",{className:"hidden md:block overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-gray-200 bg-gray-50/50",children:[e.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Siswa"}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Username"}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Kelas"}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Bergabung"}),e.jsx("th",{className:"px-6 py-4 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Aksi"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:n.length>0?n.map((F,J)=>e.jsxs(ge.tr,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:J*.05},className:"hover:bg-gray-50/50 transition-colors group",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-500 to-purple-600 rounded-full flex items-center justify-center mr-4",children:e.jsx(sr,{className:"w-5 h-5 text-white"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:F.fullName}),e.jsxs("div",{className:"text-sm text-gray-500 flex items-center",children:[e.jsx(ai,{className:"w-3 h-3 mr-1"}),F.username,(!F.username||F.username==="undefined"||F.username==="")&&e.jsxs("div",{className:"text-xs text-red-500 font-mono bg-red-50 px-1 rounded mt-1",children:['⚠️ Invalid Username: "',F.username,'"']})]})]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm text-gray-900 font-mono bg-gray-100 px-2 py-1 rounded",children:F.username})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs(Xs,{variant:F.className==="Belum ada kelas"?"outline":"default",className:`${F.className==="Belum ada kelas"?"text-gray-500 border-gray-300":"bg-blue-100 text-blue-800 border-blue-200"}`,children:[e.jsx(ys,{className:"w-3 h-3 mr-1"}),F.className]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:F.joinedAt?e.jsxs("div",{className:"flex items-center",children:[e.jsx(pt,{className:"w-3 h-3 mr-1"}),new Date(F.joinedAt).toLocaleDateString("id-ID",{day:"numeric",month:"short",year:"numeric"})]}):"-"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:e.jsxs("div",{className:"flex justify-end gap-1",children:[e.jsx(V,{variant:"ghost",size:"sm",className:"opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx(Ms,{className:"w-4 h-4"})}),e.jsx(V,{variant:"ghost",size:"sm",onClick:()=>T(F),className:"opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx(ar,{className:"w-4 h-4"})}),e.jsx(V,{variant:"ghost",size:"sm",onClick:()=>X(F),className:"opacity-0 group-hover:opacity-100 transition-opacity text-red-600 hover:text-red-700 hover:bg-red-50",children:e.jsx(hs,{className:"w-4 h-4"})})]})})]},F.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"px-6 py-12 text-center",children:e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mb-4",children:e.jsx(_s,{className:"w-8 h-8 text-gray-400"})}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-1",children:m?"Tidak ada siswa yang ditemukan":"Belum ada siswa"}),e.jsx("p",{className:"text-gray-500 mb-4",children:m?"Coba ubah kata kunci pencarian atau filter kelas":"Mulai dengan menambahkan siswa pertama untuk mengelola pembelajaran"}),!m&&e.jsxs(V,{onClick:()=>f(!0),className:"bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700",children:[e.jsx(Rr,{className:"w-4 h-4 mr-2"}),"Tambah Siswa Pertama"]})]})})})})]})}),e.jsx("div",{className:"md:hidden",children:n.length>0?e.jsx("div",{className:"p-4 space-y-3",children:n.map((F,J)=>e.jsxs(ge.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:J*.05},className:"bg-white rounded-lg border border-gray-200 p-4 hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center space-x-3 flex-1 min-w-0",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-500 to-purple-600 rounded-full flex items-center justify-center flex-shrink-0",children:e.jsx(sr,{className:"w-5 h-5 text-white"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-900 truncate",children:F.fullName}),e.jsxs("p",{className:"text-xs text-gray-500 flex items-center",children:[e.jsx(ai,{className:"w-3 h-3 mr-1 flex-shrink-0"}),e.jsx("span",{className:"truncate",children:F.username})]}),(!F.username||F.username==="undefined"||F.username==="")&&e.jsxs("div",{className:"text-xs text-red-500 font-mono bg-red-50 px-1 rounded mt-1",children:['⚠️ Invalid Username: "',F.username,'"']})]})]}),e.jsxs("div",{className:"flex gap-1 flex-shrink-0",children:[e.jsx(V,{variant:"ghost",size:"sm",className:"w-8 h-8 p-0",children:e.jsx(Ms,{className:"w-4 h-4"})}),e.jsx(V,{variant:"ghost",size:"sm",onClick:()=>T(F),className:"w-8 h-8 p-0",children:e.jsx(ar,{className:"w-4 h-4"})}),e.jsx(V,{variant:"ghost",size:"sm",onClick:()=>X(F),className:"w-8 h-8 p-0 text-red-600 hover:text-red-700 hover:bg-red-50",children:e.jsx(hs,{className:"w-4 h-4"})})]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-3 text-xs",children:[e.jsx("div",{className:"flex items-center",children:e.jsxs(Xs,{variant:F.className==="Belum ada kelas"?"outline":"default",className:`text-xs ${F.className==="Belum ada kelas"?"text-gray-500 border-gray-300":"bg-blue-100 text-blue-800 border-blue-200"}`,children:[e.jsx(ys,{className:"w-3 h-3 mr-1"}),F.className]})}),F.joinedAt&&e.jsxs("div",{className:"flex items-center text-gray-500",children:[e.jsx(pt,{className:"w-3 h-3 mr-1"}),e.jsx("span",{children:new Date(F.joinedAt).toLocaleDateString("id-ID",{day:"numeric",month:"short",year:"numeric"})})]})]})]},F.id))}):e.jsxs("div",{className:"p-6 text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(_s,{className:"w-8 h-8 text-gray-400"})}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:m?"Tidak ada siswa yang ditemukan":"Belum ada siswa"}),e.jsx("p",{className:"text-gray-500 mb-4 text-sm",children:m?"Coba ubah kata kunci pencarian atau filter kelas":"Mulai dengan menambahkan siswa pertama untuk mengelola pembelajaran"}),!m&&e.jsxs(V,{onClick:()=>f(!0),className:"bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 h-10 text-sm",children:[e.jsx(Rr,{className:"w-4 h-4 mr-2"}),"Tambah Siswa Pertama"]})]})})]})}),e.jsx(Ve,{children:x&&e.jsxs(e.Fragment,{children:[e.jsx(ge.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 z-40",onClick:()=>!O&&f(!1)}),e.jsx(ge.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:e.jsxs(Ge,{className:"w-full max-w-md bg-white shadow-2xl mx-4",children:[e.jsxs(ms,{className:"p-4 sm:p-6",children:[e.jsx(ls,{className:"text-lg sm:text-xl",children:"Tambah Siswa Baru"}),e.jsx(bs,{className:"text-sm sm:text-base",children:"Isi informasi siswa yang akan ditambahkan"})]}),e.jsxs("form",{onSubmit:P,children:[e.jsxs(We,{className:"space-y-4 p-4 sm:p-6 pt-0",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Username"}),e.jsx(He,{placeholder:"Contoh: john_doe, siswa001",value:q.username,onChange:F=>z(J=>({...J,username:F.target.value})),className:"h-10 sm:h-11 text-sm sm:text-base",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Nama Lengkap"}),e.jsx(He,{placeholder:"Contoh: John Doe",value:q.fullName,onChange:F=>z(J=>({...J,fullName:F.target.value})),className:"h-10 sm:h-11 text-sm sm:text-base",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Password"}),e.jsx(He,{type:"password",value:q.password,onChange:F=>z(J=>({...J,password:F.target.value})),className:"h-10 sm:h-11 text-sm sm:text-base",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Kelas"}),e.jsxs("select",{className:"flex h-10 sm:h-11 w-full rounded-md border border-input bg-background px-3 py-2 text-sm sm:text-base",value:q.classId,onChange:F=>z(J=>({...J,classId:F.target.value})),children:[e.jsx("option",{value:"",children:"Pilih Kelas"}),t.map(F=>e.jsx("option",{value:F.id,children:F.name},F.id))]})]})]}),e.jsxs("div",{className:"flex gap-3 p-4 sm:p-6 pt-0",children:[e.jsx(V,{type:"button",variant:"outline",className:"flex-1 h-10 sm:h-11 text-sm sm:text-base",onClick:()=>f(!1),disabled:O,children:"Batal"}),e.jsx(V,{type:"submit",className:"flex-1 bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 h-10 sm:h-11 text-sm sm:text-base",disabled:O,children:O?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(dt,{size:"sm"}),e.jsx("span",{children:"Membuat..."})]}):"Tambah Siswa"})]})]})]})})]})}),e.jsx(Ve,{children:p&&G&&e.jsxs(e.Fragment,{children:[e.jsx(ge.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 z-40",onClick:()=>!H&&h(!1)}),e.jsx(ge.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:e.jsxs(Ge,{className:"w-full max-w-md bg-white shadow-2xl mx-4",children:[e.jsxs(ms,{className:"p-4 sm:p-6",children:[e.jsx(ls,{className:"text-lg sm:text-xl",children:"Edit Siswa"}),e.jsxs(bs,{className:"text-sm sm:text-base",children:['Perbarui informasi siswa "',G.fullName,'"']})]}),e.jsxs("form",{onSubmit:A,children:[e.jsxs(We,{className:"space-y-4 p-4 sm:p-6 pt-0",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Username"}),e.jsx(He,{value:G.username,disabled:!0,className:"bg-gray-100 h-10 sm:h-11 text-sm sm:text-base"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Username tidak dapat diubah"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Nama Lengkap"}),e.jsx(He,{value:M.fullName,onChange:F=>W(J=>({...J,fullName:F.target.value})),className:"h-10 sm:h-11 text-sm sm:text-base",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Kelas"}),e.jsxs("select",{className:"flex h-10 sm:h-11 w-full rounded-md border border-input bg-background px-3 py-2 text-sm sm:text-base",value:M.classId,onChange:F=>W(J=>({...J,classId:F.target.value})),children:[e.jsx("option",{value:"",children:"Pilih Kelas"}),t.map(F=>e.jsx("option",{value:F.id,children:F.name},F.id))]})]})]}),e.jsxs("div",{className:"flex gap-3 p-4 sm:p-6 pt-0",children:[e.jsx(V,{type:"button",variant:"outline",className:"flex-1 h-10 sm:h-11 text-sm sm:text-base",onClick:()=>h(!1),disabled:H,children:"Batal"}),e.jsx(V,{type:"submit",className:"flex-1 bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 h-10 sm:h-11 text-sm sm:text-base",disabled:H,children:H?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(dt,{size:"sm"}),e.jsx("span",{children:"Memperbarui..."})]}):"Perbarui Data"})]})]})]})})]})}),e.jsx(Ve,{children:w&&re&&e.jsxs(e.Fragment,{children:[e.jsx(ge.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 z-40",onClick:()=>!oe&&L(!1)}),e.jsx(ge.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:e.jsxs(Ge,{className:"w-full max-w-md bg-white shadow-2xl",children:[e.jsxs(ms,{children:[e.jsxs(ls,{className:"flex items-center gap-2 text-red-600",children:[e.jsx(Zs,{className:"w-5 h-5"}),"Konfirmasi Hapus"]}),e.jsx(bs,{children:"Tindakan ini tidak dapat dibatalkan"})]}),e.jsxs(We,{children:[e.jsxs("p",{className:"text-gray-700",children:["Apakah Anda yakin ingin menghapus siswa ",e.jsxs("strong",{children:['"',re.fullName,'"']}),"?"]}),e.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Semua data yang terkait dengan siswa ini akan ikut terhapus."})]}),e.jsxs("div",{className:"flex gap-3 p-6 pt-0",children:[e.jsx(V,{type:"button",variant:"outline",className:"flex-1",onClick:()=>L(!1),disabled:oe,children:"Batal"}),e.jsx(V,{type:"button",variant:"destructive",className:"flex-1",onClick:me,disabled:oe,children:oe?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(dt,{size:"sm"}),e.jsx("span",{children:"Menghapus..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(hs,{className:"w-4 h-4 mr-2"}),"Hapus Siswa"]})})]})]})})]})})]})},Uo=()=>{const[s,a]=S.useState([]),[t,r]=S.useState([]),[n,l]=S.useState([]),[i,c]=S.useState("all"),[d,o]=S.useState(!0),[m,g]=S.useState(""),[x,f]=S.useState("dueDate"),[p,h]=S.useState("asc"),[w,L]=S.useState(!1),[O,I]=S.useState(!1),[H,ae]=S.useState(!1),[oe,D]=S.useState(!1),[q,z]=S.useState(!1),[G,ce]=S.useState(!1),[M,W]=S.useState(!1),[re,ve]=S.useState(!1),[te,ke]=S.useState([]),[xe,Ie]=S.useState({title:"",description:"",classId:"",dueDate:"",maxPoints:100}),[je,Oe]=S.useState(null),[N,P]=S.useState({title:"",description:"",classId:"",dueDate:"",maxPoints:100}),[T,A]=S.useState(null),[X,me]=S.useState(null),[F,J]=S.useState(null);S.useEffect(()=>{pe()},[]),S.useEffect(()=>{t.length>0&&E()},[t,i]),S.useEffect(()=>{if(F){const ie=setTimeout(()=>{J(null)},5e3);return()=>clearTimeout(ie)}},[F]),S.useEffect(()=>{let ie=s;i!=="all"&&(ie=ie.filter(_e=>_e.classId===i)),m&&(ie=ie.filter(_e=>_e.title.toLowerCase().includes(m.toLowerCase())||_e.description.toLowerCase().includes(m.toLowerCase())||_e.className&&_e.className.toLowerCase().includes(m.toLowerCase()))),ie=[...ie].sort((_e,Ke)=>{let ps,rs;switch(x){case"title":ps=_e.title.toLowerCase(),rs=Ke.title.toLowerCase();break;case"dueDate":ps=new Date(_e.dueDate).getTime(),rs=new Date(Ke.dueDate).getTime();break;case"created":ps=new Date(_e.createdAt).getTime(),rs=new Date(Ke.createdAt).getTime();break;case"status":const Qs={overdue:0,active:1,completed:2};ps=Qs[_e.status||"active"],rs=Qs[Ke.status||"active"];break;default:ps=new Date(_e.dueDate).getTime(),rs=new Date(Ke.dueDate).getTime()}return p==="asc"?ps<rs?-1:ps>rs?1:0:ps>rs?-1:ps<rs?1:0}),l(ie)},[m,s,i,x,p]);const U=(ie,_e)=>{J({type:ie,message:_e})},Y=()=>{te.length===n.length?ke([]):ke(n.map(ie=>ie.id))},ue=ie=>{ke(_e=>_e.includes(ie)?_e.filter(Ke=>Ke!==ie):[..._e,ie])},Me=async()=>{if(te.length!==0){ve(!0);try{const ie=te.map(_e=>Rt.delete(_e));await Promise.all(ie),U("success",`${te.length} tugas berhasil dihapus!`),ke([]),await E()}catch{U("error","Gagal menghapus beberapa tugas")}finally{ve(!1),z(!1)}}},le=async ie=>{try{(await Rt.create(ie.classId,`${ie.title} (Copy)`,ie.description,ie.dueDate,ie.maxPoints)).success&&(U("success",`Tugas "${ie.title}" berhasil diduplikasi!`),await E())}catch{U("error","Gagal menduplikasi tugas")}},B=async()=>{o(!0),await Promise.all([pe(),E()]),U("success","Data berhasil diperbarui!")},de=()=>{const ie=s.length,_e=s.filter(Ts=>Ts.status==="active").length,Ke=s.filter(Ts=>Ts.status==="overdue").length,ps=s.filter(Ts=>Ts.status==="completed").length,rs=s.filter(Ts=>{const Ye=new Date(Ts.dueDate),_t=new Date,zt=new Date(_t.getTime()+7*24*60*60*1e3);return Ye>=_t&&Ye<=zt}).length,Qs=ie>0?Math.round(s.reduce((Ts,Ye)=>Ts+Ye.maxPoints,0)/ie):0;return{total:ie,active:_e,overdue:Ke,completed:ps,thisWeek:rs,averagePoints:Qs}},pe=async()=>{var ie;try{console.log("🔄 Loading classes for assignment management...");const _e=await et.getAll();_e.success?(r(_e.classes||[]),console.log("✅ Loaded classes:",((ie=_e.classes)==null?void 0:ie.length)||0)):(console.error("❌ Failed to load classes:",_e.error),U("error",_e.error||"Gagal memuat data kelas"))}catch(_e){console.error("💥 Error loading classes:",_e),U("error","Terjadi kesalahan saat memuat data kelas")}},E=async()=>{try{o(!0),console.log("🔄 Loading assignments...");const ie=i==="all"?await Rt.getAll():await Rt.getByClass(i);if(console.log("📚 Assignments response:",ie),ie.success){const _e=(ie.assignments||[]).map(Ke=>{const ps=R(Ke.classId),rs=ye(Ke.dueDate);return{id:Ke.id,title:Ke.title,description:Ke.description,classId:Ke.classId,className:ps,dueDate:Ke.dueDate,maxPoints:Ke.maxPoints||100,createdAt:Ke.createdAt,status:rs,submissionCount:0,totalStudents:0}});a(_e),console.log("✅ Processed assignments:",_e.length)}else console.error("❌ Failed to load assignments:",ie.error),U("error",ie.error||"Gagal memuat data tugas")}catch(ie){console.error("💥 Error loading assignments:",ie),U("error","Terjadi kesalahan saat memuat data tugas")}finally{o(!1)}},R=ie=>{if(!ie)return"Tidak ada kelas";const _e=t.find(Ke=>Ke.id===ie);return _e?_e.name:"Unknown Class"},ye=ie=>{const _e=new Date;return new Date(ie)<_e?"overdue":"active"},ee=async ie=>{ie.preventDefault(),ce(!0);try{console.log("➕ Creating assignment:",xe);const _e=await Rt.create(xe.classId,xe.title,xe.description,xe.dueDate,xe.maxPoints);console.log("📝 Create response:",_e),_e.success?(Ie({title:"",description:"",classId:"",dueDate:"",maxPoints:100}),L(!1),U("success",`Tugas "${xe.title}" berhasil dibuat!`),await E()):(console.error("❌ Failed to create assignment:",_e.error),U("error",_e.error||"Gagal membuat tugas"))}catch(_e){console.error("💥 Error creating assignment:",_e),U("error","Terjadi kesalahan saat membuat tugas")}finally{ce(!1)}},Se=ie=>{Oe(ie),P({title:ie.title,description:ie.description,classId:ie.classId,dueDate:ie.dueDate,maxPoints:ie.maxPoints}),I(!0)},Ce=async ie=>{if(ie.preventDefault(),!!je){W(!0);try{console.log("✏️ Updating assignment:",je.id,N);const _e=await Rt.update(je.id,N.title,N.description,N.dueDate,N.maxPoints);console.log("📝 Update response:",_e),_e.success?(I(!1),Oe(null),U("success",`Tugas "${N.title}" berhasil diperbarui!`),await E()):(console.error("❌ Failed to update assignment:",_e.error),U("error",_e.error||"Gagal memperbarui tugas"))}catch(_e){console.error("💥 Error updating assignment:",_e),U("error","Terjadi kesalahan saat memperbarui tugas")}finally{W(!1)}}},Ue=ie=>{me(ie),ae(!0)},Xe=async()=>{if(X){ve(!0);try{console.log("🗑️ Deleting assignment:",X.id);const ie=await Rt.delete(X.id);console.log("🗑️ Delete response:",ie),ie.success?(ae(!1),me(null),U("success",`Tugas "${X.title}" berhasil dihapus!`),await E()):(console.error("❌ Failed to delete assignment:",ie.error),U("error",ie.error||"Gagal menghapus tugas"))}catch(ie){console.error("💥 Error deleting assignment:",ie),U("error","Terjadi kesalahan saat menghapus tugas")}finally{ve(!1)}}},vs=ie=>{A(ie),D(!0)},as=ie=>{switch(ie){case"active":return e.jsx(ft,{className:"w-4 h-4 text-blue-500"});case"completed":return e.jsx(Vs,{className:"w-4 h-4 text-green-500"});case"overdue":return e.jsx(bn,{className:"w-4 h-4 text-red-500"});default:return e.jsx(ft,{className:"w-4 h-4 text-gray-500"})}},cs=ie=>{switch(ie){case"active":return"Aktif";case"completed":return"Selesai";case"overdue":return"Lewat Deadline";default:return"Aktif"}},qs=ie=>{switch(ie){case"active":return"bg-blue-100 text-blue-800 border-blue-200";case"completed":return"bg-green-100 text-green-800 border-green-200";case"overdue":return"bg-red-100 text-red-800 border-red-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}},Gs=ie=>{const _e=new Date(ie);return new Intl.DateTimeFormat("id-ID",{day:"numeric",month:"long",year:"numeric"}).format(_e)};return d?e.jsxs("div",{className:"p-4 sm:p-6 space-y-4 sm:space-y-6",children:[e.jsx("div",{className:"flex justify-between items-center",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold",children:"Tugas"}),e.jsx("p",{className:"text-gray-600 mt-2 text-sm sm:text-base",children:"Kelola semua tugas dan aktivitas pembelajaran siswa"})]})}),e.jsx(Ge,{className:"border-0 shadow-lg",children:e.jsx(We,{className:"p-4 sm:p-6",children:e.jsx("div",{className:"space-y-3 sm:space-y-4",children:Array.from({length:6}).map((ie,_e)=>e.jsxs("div",{className:"flex items-center space-x-3 sm:space-x-4 animate-pulse",children:[e.jsx("div",{className:"w-10 h-10 sm:w-12 sm:h-12 bg-gray-200 rounded-lg flex-shrink-0"}),e.jsxs("div",{className:"flex-1 space-y-2 min-w-0",children:[e.jsx("div",{className:"h-3 sm:h-4 bg-gray-200 rounded w-3/4"}),e.jsx("div",{className:"h-2 sm:h-3 bg-gray-200 rounded w-1/2"})]}),e.jsx("div",{className:"h-6 sm:h-8 bg-gray-200 rounded w-16 sm:w-20 flex-shrink-0"}),e.jsx("div",{className:"h-6 sm:h-8 bg-gray-200 rounded w-20 sm:w-24 flex-shrink-0"})]},_e))})})})]}):e.jsxs("div",{className:"p-4 sm:p-6 space-y-4 sm:space-y-6 bg-gray-50/50 min-h-screen",children:[e.jsx(Ve,{children:F&&e.jsx(ge.div,{initial:{opacity:0,y:-50},animate:{opacity:1,y:0},exit:{opacity:0,y:-50},className:"fixed top-4 left-4 right-4 sm:top-4 sm:right-4 sm:left-auto z-50 max-w-md",children:e.jsxs("div",{className:`flex items-center gap-2 sm:gap-3 p-3 sm:p-4 rounded-lg shadow-lg ${F.type==="success"?"bg-green-50 text-green-800 border border-green-200":"bg-red-50 text-red-800 border border-red-200"}`,children:[F.type==="success"?e.jsx(Vs,{className:"w-4 h-4 sm:w-5 sm:h-5 flex-shrink-0"}):e.jsx(Zs,{className:"w-4 h-4 sm:w-5 sm:h-5 flex-shrink-0"}),e.jsx("span",{className:"font-medium text-xs sm:text-sm flex-1",children:F.message}),e.jsx("button",{onClick:()=>J(null),className:"ml-2 text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(Ys,{className:"w-3 h-3 sm:w-4 sm:h-4"})})]})})}),e.jsx(fs,{variant:Ws,children:e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center justify-between gap-3 sm:gap-4",children:[e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold bg-gradient-to-r from-gray-900 to-gray-600 bg-clip-text text-transparent",children:"Tugas"}),e.jsx("p",{className:"text-gray-600 mt-2 text-sm sm:text-base",children:"Kelola semua tugas dan aktivitas pembelajaran siswa"})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-center gap-2 sm:gap-3",children:[te.length>0&&e.jsxs(ge.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},className:"flex items-center gap-2 order-3 sm:order-1",children:[e.jsxs(Xs,{variant:"secondary",className:"bg-blue-100 text-blue-800 px-2 sm:px-3 py-1 text-xs sm:text-sm",children:[te.length," dipilih"]}),e.jsxs(V,{variant:"destructive",size:"sm",onClick:()=>z(!0),className:"bg-red-500 hover:bg-red-600 text-xs sm:text-sm h-8 sm:h-9",children:[e.jsx(hs,{className:"w-3 h-3 sm:w-4 sm:h-4 mr-1"}),"Hapus"]})]}),e.jsxs(V,{variant:"outline",size:"sm",onClick:B,disabled:d,className:"border-gray-200 hover:bg-gray-50 order-2 h-8 sm:h-9 text-xs sm:text-sm",children:[e.jsx(ct,{className:`w-3 h-3 sm:w-4 sm:h-4 mr-2 ${d?"animate-spin":""}`}),"Refresh"]}),e.jsxs(V,{onClick:()=>L(!0),className:"bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 shadow-lg order-1 sm:order-3 h-8 sm:h-9 text-xs sm:text-sm",children:[e.jsx(xs,{className:"w-3 h-3 sm:w-4 sm:h-4 mr-2"}),e.jsx("span",{className:"hidden sm:inline",children:"Buat Tugas Baru"}),e.jsx("span",{className:"sm:hidden",children:"Buat Tugas"})]})]})]})}),e.jsx(fs,{variant:Aa,delay:.1,children:e.jsx(Ge,{className:"border-0 shadow-lg",children:e.jsxs(We,{className:"p-4 sm:p-6",children:[e.jsxs("div",{className:"flex flex-col lg:flex-row gap-3 sm:gap-4",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(Zt,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-3 h-3 sm:w-4 sm:h-4"}),e.jsx(He,{placeholder:"Cari tugas berdasarkan judul atau deskripsi...",className:"pl-8 sm:pl-10 border-gray-200 focus:border-blue-500 focus:ring-blue-500 h-9 sm:h-10 text-xs sm:text-sm",value:m,onChange:ie=>g(ie.target.value)})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-center gap-2 sm:gap-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(al,{className:"w-3 h-3 sm:w-4 sm:h-4 text-gray-500 flex-shrink-0"}),e.jsxs("select",{className:"flex h-9 sm:h-10 rounded-md border border-gray-200 bg-background px-2 sm:px-3 py-2 text-xs sm:text-sm focus:border-blue-500 focus:ring-blue-500 min-w-0 flex-1",value:i,onChange:ie=>c(ie.target.value),children:[e.jsx("option",{value:"all",children:"Semua Kelas"}),t.map(ie=>e.jsx("option",{value:ie.id,children:ie.name},ie.id))]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Vt,{className:"w-3 h-3 sm:w-4 sm:h-4 text-gray-500 flex-shrink-0"}),e.jsxs("select",{className:"flex h-9 sm:h-10 rounded-md border border-gray-200 bg-background px-2 sm:px-3 py-2 text-xs sm:text-sm focus:border-blue-500 focus:ring-blue-500 min-w-0 flex-1",value:x,onChange:ie=>f(ie.target.value),children:[e.jsx("option",{value:"dueDate",children:"Urutkan: Deadline"}),e.jsx("option",{value:"title",children:"Urutkan: Judul"}),e.jsx("option",{value:"created",children:"Urutkan: Dibuat"}),e.jsx("option",{value:"status",children:"Urutkan: Status"})]})]}),e.jsx(V,{variant:"outline",size:"sm",onClick:()=>h(p==="asc"?"desc":"asc"),className:"border-gray-200 hover:bg-gray-50 h-9 px-2 sm:px-3",children:p==="asc"?e.jsx(na,{className:"w-3 h-3 sm:w-4 sm:h-4"}):e.jsx(rl,{className:"w-3 h-3 sm:w-4 sm:h-4"})})]})]}),n.length>0&&e.jsxs("div",{className:"mt-3 sm:mt-4 flex flex-col sm:flex-row sm:items-center justify-between gap-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:te.length===n.length,onChange:Y,className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),e.jsxs("span",{className:"text-xs sm:text-sm text-gray-600",children:["Pilih semua (",n.length," tugas)"]})]}),e.jsxs("span",{className:"text-xs sm:text-sm text-gray-500",children:["Menampilkan ",n.length," dari ",s.length," tugas"]})]})]})})}),e.jsx(fs,{variant:Aa,delay:.2,children:e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-3 sm:gap-4",children:[e.jsx(Ge,{className:"border-0 shadow-lg",children:e.jsx(We,{className:"p-3 sm:p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("p",{className:"text-xs sm:text-sm font-medium text-gray-600",children:"Total Tugas"}),e.jsx("p",{className:"text-xl sm:text-2xl font-bold text-blue-600 truncate",children:de().total})]}),e.jsx("div",{className:"w-8 h-8 sm:w-10 sm:h-10 bg-blue-100 rounded-lg flex items-center justify-center flex-shrink-0 ml-2",children:e.jsx(ys,{className:"w-4 h-4 sm:w-5 sm:h-5 text-blue-600"})})]})})}),e.jsx(Ge,{className:"border-0 shadow-lg",children:e.jsx(We,{className:"p-3 sm:p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("p",{className:"text-xs sm:text-sm font-medium text-gray-600",children:"Tugas Aktif"}),e.jsx("p",{className:"text-xl sm:text-2xl font-bold text-green-600 truncate",children:de().active})]}),e.jsx("div",{className:"w-8 h-8 sm:w-10 sm:h-10 bg-green-100 rounded-lg flex items-center justify-center flex-shrink-0 ml-2",children:e.jsx(ft,{className:"w-4 h-4 sm:w-5 sm:h-5 text-green-600"})})]})})}),e.jsx(Ge,{className:"border-0 shadow-lg",children:e.jsx(We,{className:"p-3 sm:p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("p",{className:"text-xs sm:text-sm font-medium text-gray-600",children:"Lewat Deadline"}),e.jsx("p",{className:"text-xl sm:text-2xl font-bold text-red-600 truncate",children:de().overdue})]}),e.jsx("div",{className:"w-8 h-8 sm:w-10 sm:h-10 bg-red-100 rounded-lg flex items-center justify-center flex-shrink-0 ml-2",children:e.jsx(bn,{className:"w-4 h-4 sm:w-5 sm:h-5 text-red-600"})})]})})}),e.jsx(Ge,{className:"border-0 shadow-lg",children:e.jsx(We,{className:"p-3 sm:p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("p",{className:"text-xs sm:text-sm font-medium text-gray-600",children:"Selesai"}),e.jsx("p",{className:"text-xl sm:text-2xl font-bold text-purple-600 truncate",children:de().completed})]}),e.jsx("div",{className:"w-8 h-8 sm:w-10 sm:h-10 bg-purple-100 rounded-lg flex items-center justify-center flex-shrink-0 ml-2",children:e.jsx(Vs,{className:"w-4 h-4 sm:w-5 sm:h-5 text-purple-600"})})]})})}),e.jsx(Ge,{className:"border-0 shadow-lg",children:e.jsx(We,{className:"p-3 sm:p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("p",{className:"text-xs sm:text-sm font-medium text-gray-600",children:"Minggu Ini"}),e.jsx("p",{className:"text-xl sm:text-2xl font-bold text-orange-600 truncate",children:de().thisWeek})]}),e.jsx("div",{className:"w-8 h-8 sm:w-10 sm:h-10 bg-orange-100 rounded-lg flex items-center justify-center flex-shrink-0 ml-2",children:e.jsx(nl,{className:"w-4 h-4 sm:w-5 sm:h-5 text-orange-600"})})]})})}),e.jsx(Ge,{className:"border-0 shadow-lg",children:e.jsx(We,{className:"p-3 sm:p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("p",{className:"text-xs sm:text-sm font-medium text-gray-600",children:"Rata-rata Poin"}),e.jsx("p",{className:"text-xl sm:text-2xl font-bold text-indigo-600 truncate",children:de().averagePoints})]}),e.jsx("div",{className:"w-8 h-8 sm:w-10 sm:h-10 bg-indigo-100 rounded-lg flex items-center justify-center flex-shrink-0 ml-2",children:e.jsx(jt,{className:"w-4 h-4 sm:w-5 sm:h-5 text-indigo-600"})})]})})})]})}),e.jsx(fs,{variant:Ws,delay:.3,children:e.jsxs(Ge,{className:"border-0 shadow-lg",children:[e.jsxs(ms,{className:"border-b border-gray-100 p-4 sm:p-6",children:[e.jsxs(ls,{className:"flex items-center gap-2 text-base sm:text-lg",children:[e.jsx(Ot,{className:"w-4 h-4 sm:w-5 sm:h-5 text-blue-600"}),"Daftar Tugas"]}),e.jsxs(bs,{className:"text-xs sm:text-sm",children:["Menampilkan ",n.length," dari ",s.length," tugas"]})]}),e.jsx(We,{className:"p-0",children:n.length>0?e.jsx("div",{className:"divide-y divide-gray-100",children:e.jsx(Ve,{children:n.map((ie,_e)=>e.jsx(ge.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{delay:_e*.05},className:"p-4 sm:p-6 hover:bg-gray-50 transition-colors",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start gap-3 sm:gap-4 flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 flex-shrink-0",children:[e.jsx("input",{type:"checkbox",checked:te.includes(ie.id),onChange:()=>ue(ie.id),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),e.jsx("div",{className:"w-10 h-10 sm:w-12 sm:h-12 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-lg flex items-center justify-center text-white font-bold text-sm sm:text-base",children:ie.title.charAt(0).toUpperCase()})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-start justify-between mb-2 gap-2",children:[e.jsx("h3",{className:"font-semibold text-gray-900 text-sm sm:text-base truncate",children:ie.title}),e.jsx(Xs,{variant:"outline",className:`${qs(ie.status||"active")} font-medium text-xs flex-shrink-0`,children:e.jsxs("div",{className:"flex items-center gap-1",children:[as(ie.status||"active"),e.jsx("span",{children:cs(ie.status||"active")})]})})]}),e.jsx("p",{className:"text-xs sm:text-sm text-gray-600 mb-3 line-clamp-2",children:ie.description}),e.jsxs("div",{className:"flex flex-wrap items-center gap-3 sm:gap-6 text-xs sm:text-sm text-gray-500",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(er,{className:"w-3 h-3 sm:w-4 sm:h-4 flex-shrink-0"}),e.jsx("span",{className:"truncate",children:ie.className})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(pt,{className:"w-3 h-3 sm:w-4 sm:h-4 flex-shrink-0"}),e.jsx("span",{className:"whitespace-nowrap",children:Gs(ie.dueDate)})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Ot,{className:"w-3 h-3 sm:w-4 sm:h-4 flex-shrink-0"}),e.jsxs("span",{className:"whitespace-nowrap",children:[ie.maxPoints," poin"]})]}),ie.completionRate&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Vt,{className:"w-3 h-3 sm:w-4 sm:h-4 flex-shrink-0"}),e.jsxs("span",{className:"whitespace-nowrap",children:[Math.round(ie.completionRate),"% selesai"]})]})]})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-center gap-1 ml-2 sm:ml-4 flex-shrink-0",children:[e.jsx(V,{variant:"ghost",size:"sm",onClick:()=>vs(ie),className:"hover:bg-blue-50 hover:text-blue-600 w-8 h-8 sm:w-9 sm:h-9 p-0",title:"Lihat Detail",children:e.jsx(Ms,{className:"w-3 h-3 sm:w-4 sm:h-4"})}),e.jsx(V,{variant:"ghost",size:"sm",onClick:()=>le(ie),className:"hover:bg-green-50 hover:text-green-600 w-8 h-8 sm:w-9 sm:h-9 p-0",title:"Duplikasi Tugas",children:e.jsx(to,{className:"w-3 h-3 sm:w-4 sm:h-4"})}),e.jsx(V,{variant:"ghost",size:"sm",onClick:()=>Se(ie),className:"hover:bg-amber-50 hover:text-amber-600 w-8 h-8 sm:w-9 sm:h-9 p-0",title:"Edit Tugas",children:e.jsx(ar,{className:"w-3 h-3 sm:w-4 sm:h-4"})}),e.jsx(V,{variant:"ghost",size:"sm",onClick:()=>Ue(ie),className:"hover:bg-red-50 hover:text-red-600 w-8 h-8 sm:w-9 sm:h-9 p-0",title:"Hapus Tugas",children:e.jsx(hs,{className:"w-3 h-3 sm:w-4 sm:h-4"})})]})]})},ie.id))})}):e.jsxs("div",{className:"text-center py-8 sm:py-12 px-4",children:[e.jsx(ot,{className:"w-10 h-10 sm:w-12 sm:h-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"font-medium text-gray-900 mb-2 text-sm sm:text-base",children:"Belum ada tugas"}),e.jsx("p",{className:"text-gray-500 mb-4 text-xs sm:text-sm",children:m||i!=="all"?"Tidak ada tugas yang sesuai dengan filter Anda":"Mulai dengan membuat tugas pertama untuk siswa Anda"}),!m&&i==="all"&&e.jsxs(V,{onClick:()=>L(!0),className:"bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 text-xs sm:text-sm h-8 sm:h-9",children:[e.jsx(xs,{className:"w-3 h-3 sm:w-4 sm:h-4 mr-2"}),"Buat Tugas Pertama"]})]})})]})}),e.jsx(Ve,{children:w&&e.jsxs(e.Fragment,{children:[e.jsx(ge.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 z-40",onClick:()=>!G&&L(!1)}),e.jsx(ge.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:e.jsxs(Ge,{className:"w-full max-w-2xl bg-white shadow-2xl max-h-[90vh] overflow-y-auto mx-4",children:[e.jsxs(ms,{className:"p-4 sm:p-6",children:[e.jsx(ls,{className:"text-base sm:text-lg",children:"Buat Tugas Baru"}),e.jsx(bs,{className:"text-xs sm:text-sm",children:"Isi informasi tugas yang akan diberikan kepada siswa"})]}),e.jsxs("form",{onSubmit:ee,children:[e.jsxs(We,{className:"space-y-3 sm:space-y-4 p-4 sm:p-6 pt-0",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-xs sm:text-sm font-medium",children:"Judul Tugas"}),e.jsx(He,{placeholder:"Contoh: Tugas Matematika - Persamaan Kuadrat",value:xe.title,onChange:ie=>Ie(_e=>({..._e,title:ie.target.value})),className:"h-9 sm:h-10 text-xs sm:text-sm",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-xs sm:text-sm font-medium",children:"Deskripsi"}),e.jsx("textarea",{placeholder:"Jelaskan detail tugas, instruksi, dan kriteria penilaian...",value:xe.description,onChange:ie=>Ie(_e=>({..._e,description:ie.target.value})),rows:4,className:"flex w-full rounded-md border border-input bg-background px-3 py-2 text-xs sm:text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 resize-none",required:!0})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 sm:gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-xs sm:text-sm font-medium",children:"Kelas"}),e.jsxs("select",{className:"flex h-9 sm:h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-xs sm:text-sm ring-offset-background focus:border-blue-500 focus:ring-blue-500",value:xe.classId,onChange:ie=>Ie(_e=>({..._e,classId:ie.target.value})),required:!0,children:[e.jsx("option",{value:"",children:"Pilih Kelas"}),t.map(ie=>e.jsx("option",{value:ie.id,children:ie.name},ie.id))]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-xs sm:text-sm font-medium",children:"Batas Waktu"}),e.jsx("input",{type:"datetime-local",value:xe.dueDate,onChange:ie=>Ie(_e=>({..._e,dueDate:ie.target.value})),className:"flex h-9 sm:h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-xs sm:text-sm ring-offset-background focus:border-blue-500 focus:ring-blue-500",required:!0})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-xs sm:text-sm font-medium",children:"Nilai Maksimal"}),e.jsx("input",{type:"number",min:"1",max:"1000",placeholder:"100",value:xe.maxPoints,onChange:ie=>Ie(_e=>({..._e,maxPoints:parseInt(ie.target.value)||100})),className:"flex h-9 sm:h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-xs sm:text-sm ring-offset-background focus:border-blue-500 focus:ring-blue-500",required:!0})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 sm:gap-3 p-4 sm:p-6 pt-0",children:[e.jsx(V,{type:"button",variant:"outline",className:"flex-1 h-9 sm:h-10 text-xs sm:text-sm order-2 sm:order-1",onClick:()=>L(!1),disabled:G,children:"Batal"}),e.jsx(V,{type:"submit",className:"flex-1 bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 h-9 sm:h-10 text-xs sm:text-sm order-1 sm:order-2",disabled:G,children:G?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(dt,{size:"sm"}),e.jsx("span",{children:"Membuat..."})]}):"Buat Tugas"})]})]})]})})]})}),e.jsx(Ve,{children:O&&je&&e.jsxs(e.Fragment,{children:[e.jsx(ge.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 z-40",onClick:()=>!M&&I(!1)}),e.jsx(ge.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:e.jsxs(Ge,{className:"w-full max-w-2xl bg-white shadow-2xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(ms,{children:[e.jsx(ls,{children:"Edit Tugas"}),e.jsxs(bs,{children:['Perbarui informasi tugas "',je.title,'"']})]}),e.jsxs("form",{onSubmit:Ce,children:[e.jsxs(We,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Judul Tugas"}),e.jsx(He,{value:N.title,onChange:ie=>P(_e=>({..._e,title:ie.target.value})),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Deskripsi"}),e.jsx("textarea",{value:N.description,onChange:ie=>P(_e=>({..._e,description:ie.target.value})),rows:4,required:!0})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Kelas"}),e.jsxs("select",{className:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-xs sm:text-sm focus:border-blue-500 focus:ring-blue-500",value:N.classId,onChange:ie=>P(_e=>({..._e,classId:ie.target.value})),required:!0,children:[e.jsx("option",{value:"",children:"Pilih Kelas"}),t.map(ie=>e.jsx("option",{value:ie.id,children:ie.name},ie.id))]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Batas Waktu"}),e.jsx("input",{type:"datetime-local",value:N.dueDate,onChange:ie=>P(_e=>({..._e,dueDate:ie.target.value})),required:!0})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Nilai Maksimal"}),e.jsx("input",{type:"number",min:"1",max:"1000",value:N.maxPoints,onChange:ie=>P(_e=>({..._e,maxPoints:parseInt(ie.target.value)||100})),required:!0})]})]}),e.jsxs("div",{className:"flex gap-3 p-6 pt-0",children:[e.jsx(V,{type:"button",variant:"outline",className:"flex-1",onClick:()=>I(!1),disabled:M,children:"Batal"}),e.jsx(V,{type:"submit",className:"flex-1 bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700",disabled:M,children:M?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(dt,{size:"sm"}),e.jsx("span",{children:"Memperbarui..."})]}):"Perbarui Tugas"})]})]})]})})]})}),e.jsx(Ve,{children:H&&X&&e.jsxs(e.Fragment,{children:[e.jsx(ge.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 z-40",onClick:()=>!re&&ae(!1)}),e.jsx(ge.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:e.jsxs(Ge,{className:"w-full max-w-md bg-white shadow-2xl mx-4",children:[e.jsxs(ms,{className:"p-4 sm:p-6",children:[e.jsxs(ls,{className:"flex items-center gap-2 text-red-600 text-base sm:text-lg",children:[e.jsx(Zs,{className:"w-4 h-4 sm:w-5 sm:h-5"}),"Konfirmasi Hapus"]}),e.jsx(bs,{className:"text-xs sm:text-sm",children:"Tindakan ini tidak dapat dibatalkan"})]}),e.jsx(We,{className:"p-4 sm:p-6 pt-0",children:e.jsxs("p",{className:"text-gray-600 text-xs sm:text-sm",children:['Apakah Anda yakin ingin menghapus tugas "',X.title,'"? Semua data terkait termasuk pengumpulan dan nilai akan ikut terhapus.']})}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 sm:gap-3 p-4 sm:p-6 pt-0",children:[e.jsx(V,{variant:"outline",className:"flex-1 h-9 sm:h-10 text-xs sm:text-sm order-2 sm:order-1",onClick:()=>ae(!1),disabled:re,children:"Batal"}),e.jsx(V,{variant:"destructive",className:"flex-1 h-9 sm:h-10 text-xs sm:text-sm order-1 sm:order-2",onClick:Xe,disabled:re,children:re?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(dt,{size:"sm"}),e.jsx("span",{children:"Menghapus..."})]}):"Hapus Tugas"})]})]})})]})}),e.jsx(Ve,{children:oe&&T&&e.jsxs(e.Fragment,{children:[e.jsx(ge.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 z-40",onClick:()=>D(!1)}),e.jsx(ge.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:e.jsxs(Ge,{className:"w-full max-w-2xl bg-white shadow-2xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(ms,{children:[e.jsxs(ls,{className:"flex items-center gap-2",children:[e.jsx(ot,{className:"w-5 h-5 text-blue-600"}),"Detail Tugas"]}),e.jsxs(bs,{children:['Informasi lengkap tugas "',T.title,'"']})]}),e.jsxs(We,{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold mb-2",children:"Judul"}),e.jsx("p",{className:"text-gray-600",children:T.title})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold mb-2",children:"Deskripsi"}),e.jsx("p",{className:"text-gray-600 whitespace-pre-wrap",children:T.description})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold mb-2",children:"Kelas"}),e.jsx("p",{className:"text-gray-600",children:T.className})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold mb-2",children:"Batas Waktu"}),e.jsx("p",{className:"text-gray-600",children:Gs(T.dueDate)})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold mb-2",children:"Nilai Maksimal"}),e.jsxs("p",{className:"text-gray-600",children:[T.maxPoints," poin"]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold mb-2",children:"Status"}),e.jsx(Xs,{variant:"outline",className:`${qs(T.status||"active")} font-medium`,children:e.jsxs("div",{className:"flex items-center gap-1",children:[as(T.status||"active"),e.jsx("span",{children:cs(T.status||"active")})]})})]})]})]}),e.jsxs("div",{className:"flex gap-3 p-6 pt-0",children:[e.jsx(V,{variant:"outline",className:"flex-1",onClick:()=>D(!1),children:"Tutup"}),e.jsxs(V,{className:"flex-1 bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700",onClick:()=>{D(!1),Se(T)},children:[e.jsx(ar,{className:"w-4 h-4 mr-2"}),"Edit Tugas"]})]})]})})]})}),e.jsx(Ve,{children:q&&e.jsxs(e.Fragment,{children:[e.jsx(ge.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 z-40",onClick:()=>!re&&z(!1)}),e.jsx(ge.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:e.jsxs(Ge,{className:"w-full max-w-md bg-white shadow-2xl",children:[e.jsxs(ms,{children:[e.jsxs(ls,{className:"flex items-center gap-2 text-red-600",children:[e.jsx(Zs,{className:"w-5 h-5"}),"Konfirmasi Hapus"]}),e.jsx(bs,{children:"Tindakan ini tidak dapat dibatalkan"})]}),e.jsx(We,{children:e.jsxs("p",{className:"text-gray-600",children:["Apakah Anda yakin ingin menghapus ",te.length>1?"tugas ini":"tugas terpilih","? Semua data terkait termasuk pengumpulan dan nilai akan ikut terhapus."]})}),e.jsxs("div",{className:"flex gap-3 p-6 pt-0",children:[e.jsx(V,{variant:"outline",className:"flex-1",onClick:()=>z(!1),disabled:re,children:"Batal"}),e.jsx(V,{variant:"destructive",className:"flex-1",onClick:Me,disabled:re,children:re?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(dt,{size:"sm"}),e.jsx("span",{children:"Menghapus..."})]}):"Hapus Tugas"})]})]})})]})})]})};/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var Br={};Br.version="0.18.5";var ul=1252,Go=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],fl=function(s){Go.indexOf(s)!=-1&&(ul=s)};function Ho(){fl(1252)}var rr=function(s){fl(s)};function zo(){rr(1200),Ho()}var Tr=function(a){return String.fromCharCode(a)},xi=function(a){return String.fromCharCode(a)},hi,Xt="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function nr(s){for(var a="",t=0,r=0,n=0,l=0,i=0,c=0,d=0,o=0;o<s.length;)t=s.charCodeAt(o++),l=t>>2,r=s.charCodeAt(o++),i=(t&3)<<4|r>>4,n=s.charCodeAt(o++),c=(r&15)<<2|n>>6,d=n&63,isNaN(r)?c=d=64:isNaN(n)&&(d=64),a+=Xt.charAt(l)+Xt.charAt(i)+Xt.charAt(c)+Xt.charAt(d);return a}function Ut(s){var a="",t=0,r=0,n=0,l=0,i=0,c=0,d=0;s=s.replace(/[^\w\+\/\=]/g,"");for(var o=0;o<s.length;)l=Xt.indexOf(s.charAt(o++)),i=Xt.indexOf(s.charAt(o++)),t=l<<2|i>>4,a+=String.fromCharCode(t),c=Xt.indexOf(s.charAt(o++)),r=(i&15)<<4|c>>2,c!==64&&(a+=String.fromCharCode(r)),d=Xt.indexOf(s.charAt(o++)),n=(c&3)<<6|d,d!==64&&(a+=String.fromCharCode(n));return a}var qe=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),Ht=function(){if(typeof Buffer<"u"){var s=!Buffer.from;if(!s)try{Buffer.from("foo","utf8")}catch{s=!0}return s?function(a,t){return t?new Buffer(a,t):new Buffer(a)}:Buffer.from.bind(Buffer)}return function(){}}();function ca(s){return qe?Buffer.alloc?Buffer.alloc(s):new Buffer(s):typeof Uint8Array<"u"?new Uint8Array(s):new Array(s)}function ui(s){return qe?Buffer.allocUnsafe?Buffer.allocUnsafe(s):new Buffer(s):typeof Uint8Array<"u"?new Uint8Array(s):new Array(s)}var St=function(a){return qe?Ht(a,"binary"):a.split("").map(function(t){return t.charCodeAt(0)&255})};function en(s){if(typeof ArrayBuffer>"u")return St(s);for(var a=new ArrayBuffer(s.length),t=new Uint8Array(a),r=0;r!=s.length;++r)t[r]=s.charCodeAt(r)&255;return a}function xr(s){if(Array.isArray(s))return s.map(function(r){return String.fromCharCode(r)}).join("");for(var a=[],t=0;t<s.length;++t)a[t]=String.fromCharCode(s[t]);return a.join("")}function Wo(s){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(s)}var Is=qe?function(s){return Buffer.concat(s.map(function(a){return Buffer.isBuffer(a)?a:Ht(a)}))}:function(s){if(typeof Uint8Array<"u"){var a=0,t=0;for(a=0;a<s.length;++a)t+=s[a].length;var r=new Uint8Array(t),n=0;for(a=0,t=0;a<s.length;t+=n,++a)if(n=s[a].length,s[a]instanceof Uint8Array)r.set(s[a],t);else{if(typeof s[a]=="string")throw"wtf";r.set(new Uint8Array(s[a]),t)}return r}return[].concat.apply([],s.map(function(l){return Array.isArray(l)?l:[].slice.call(l)}))};function $o(s){for(var a=[],t=0,r=s.length+250,n=ca(s.length+255),l=0;l<s.length;++l){var i=s.charCodeAt(l);if(i<128)n[t++]=i;else if(i<2048)n[t++]=192|i>>6&31,n[t++]=128|i&63;else if(i>=55296&&i<57344){i=(i&1023)+64;var c=s.charCodeAt(++l)&1023;n[t++]=240|i>>8&7,n[t++]=128|i>>2&63,n[t++]=128|c>>6&15|(i&3)<<4,n[t++]=128|c&63}else n[t++]=224|i>>12&15,n[t++]=128|i>>6&63,n[t++]=128|i&63;t>r&&(a.push(n.slice(0,t)),t=0,n=ca(65535),r=65530)}return a.push(n.slice(0,t)),Is(a)}var Xa=/\u0000/g,kr=/[\u0001-\u0006]/g;function ka(s){for(var a="",t=s.length-1;t>=0;)a+=s.charAt(t--);return a}function Tt(s,a){var t=""+s;return t.length>=a?t:us("0",a-t.length)+t}function Dn(s,a){var t=""+s;return t.length>=a?t:us(" ",a-t.length)+t}function Ur(s,a){var t=""+s;return t.length>=a?t:t+us(" ",a-t.length)}function Ko(s,a){var t=""+Math.round(s);return t.length>=a?t:us("0",a-t.length)+t}function Vo(s,a){var t=""+s;return t.length>=a?t:us("0",a-t.length)+t}var fi=Math.pow(2,32);function pa(s,a){if(s>fi||s<-fi)return Ko(s,a);var t=Math.round(s);return Vo(t,a)}function Gr(s,a){return a=a||0,s.length>=7+a&&(s.charCodeAt(a)|32)===103&&(s.charCodeAt(a+1)|32)===101&&(s.charCodeAt(a+2)|32)===110&&(s.charCodeAt(a+3)|32)===101&&(s.charCodeAt(a+4)|32)===114&&(s.charCodeAt(a+5)|32)===97&&(s.charCodeAt(a+6)|32)===108}var gi=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],dn=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function Xo(s){return s||(s={}),s[0]="General",s[1]="0",s[2]="0.00",s[3]="#,##0",s[4]="#,##0.00",s[9]="0%",s[10]="0.00%",s[11]="0.00E+00",s[12]="# ?/?",s[13]="# ??/??",s[14]="m/d/yy",s[15]="d-mmm-yy",s[16]="d-mmm",s[17]="mmm-yy",s[18]="h:mm AM/PM",s[19]="h:mm:ss AM/PM",s[20]="h:mm",s[21]="h:mm:ss",s[22]="m/d/yy h:mm",s[37]="#,##0 ;(#,##0)",s[38]="#,##0 ;[Red](#,##0)",s[39]="#,##0.00;(#,##0.00)",s[40]="#,##0.00;[Red](#,##0.00)",s[45]="mm:ss",s[46]="[h]:mm:ss",s[47]="mmss.0",s[48]="##0.0E+0",s[49]="@",s[56]='"上午/下午 "hh"時"mm"分"ss"秒 "',s}var gs={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"上午/下午 "hh"時"mm"分"ss"秒 "'},pi={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},Jo={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Hr(s,a,t){for(var r=s<0?-1:1,n=s*r,l=0,i=1,c=0,d=1,o=0,m=0,g=Math.floor(n);o<a&&(g=Math.floor(n),c=g*i+l,m=g*o+d,!(n-g<5e-8));)n=1/(n-g),l=i,i=c,d=o,o=m;if(m>a&&(o>a?(m=d,c=l):(m=o,c=i)),!t)return[0,r*c,m];var x=Math.floor(r*c/m);return[x,r*c-x*m,m]}function _r(s,a,t){if(s>2958465||s<0)return null;var r=s|0,n=Math.floor(86400*(s-r)),l=0,i=[],c={D:r,T:n,u:86400*(s-r)-n,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(c.u)<1e-6&&(c.u=0),a&&a.date1904&&(r+=1462),c.u>.9999&&(c.u=0,++n==86400&&(c.T=n=0,++r,++c.D)),r===60)i=t?[1317,10,29]:[1900,2,29],l=3;else if(r===0)i=t?[1317,8,29]:[1900,1,0],l=6;else{r>60&&--r;var d=new Date(1900,0,1);d.setDate(d.getDate()+r-1),i=[d.getFullYear(),d.getMonth()+1,d.getDate()],l=d.getDay(),r<60&&(l=(l+6)%7),t&&(l=t0(d,i))}return c.y=i[0],c.m=i[1],c.d=i[2],c.S=n%60,n=Math.floor(n/60),c.M=n%60,n=Math.floor(n/60),c.H=n,c.q=l,c}var gl=new Date(1899,11,31,0,0,0),Yo=gl.getTime(),qo=new Date(1900,2,1,0,0,0);function pl(s,a){var t=s.getTime();return a?t-=1461*24*60*60*1e3:s>=qo&&(t+=24*60*60*1e3),(t-(Yo+(s.getTimezoneOffset()-gl.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function In(s){return s.indexOf(".")==-1?s:s.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function Qo(s){return s.indexOf("E")==-1?s:s.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function Zo(s){var a=s<0?12:11,t=In(s.toFixed(12));return t.length<=a||(t=s.toPrecision(10),t.length<=a)?t:s.toExponential(5)}function e0(s){var a=In(s.toFixed(11));return a.length>(s<0?12:11)||a==="0"||a==="-0"?s.toPrecision(6):a}function s0(s){var a=Math.floor(Math.log(Math.abs(s))*Math.LOG10E),t;return a>=-4&&a<=-1?t=s.toPrecision(10+a):Math.abs(a)<=9?t=Zo(s):a===10?t=s.toFixed(10).substr(0,12):t=e0(s),In(Qo(t.toUpperCase()))}function kn(s,a){switch(typeof s){case"string":return s;case"boolean":return s?"TRUE":"FALSE";case"number":return(s|0)===s?s.toString(10):s0(s);case"undefined":return"";case"object":if(s==null)return"";if(s instanceof Date)return Yt(14,pl(s,a&&a.date1904),a)}throw new Error("unsupported value in General format: "+s)}function t0(s,a){a[0]-=581;var t=s.getDay();return s<60&&(t=(t+6)%7),t}function a0(s,a,t,r){var n="",l=0,i=0,c=t.y,d,o=0;switch(s){case 98:c=t.y+543;case 121:switch(a.length){case 1:case 2:d=c%100,o=2;break;default:d=c%1e4,o=4;break}break;case 109:switch(a.length){case 1:case 2:d=t.m,o=a.length;break;case 3:return dn[t.m-1][1];case 5:return dn[t.m-1][0];default:return dn[t.m-1][2]}break;case 100:switch(a.length){case 1:case 2:d=t.d,o=a.length;break;case 3:return gi[t.q][0];default:return gi[t.q][1]}break;case 104:switch(a.length){case 1:case 2:d=1+(t.H+11)%12,o=a.length;break;default:throw"bad hour format: "+a}break;case 72:switch(a.length){case 1:case 2:d=t.H,o=a.length;break;default:throw"bad hour format: "+a}break;case 77:switch(a.length){case 1:case 2:d=t.M,o=a.length;break;default:throw"bad minute format: "+a}break;case 115:if(a!="s"&&a!="ss"&&a!=".0"&&a!=".00"&&a!=".000")throw"bad second format: "+a;return t.u===0&&(a=="s"||a=="ss")?Tt(t.S,a.length):(r>=2?i=r===3?1e3:100:i=r===1?10:1,l=Math.round(i*(t.S+t.u)),l>=60*i&&(l=0),a==="s"?l===0?"0":""+l/i:(n=Tt(l,2+r),a==="ss"?n.substr(0,2):"."+n.substr(2,a.length-1)));case 90:switch(a){case"[h]":case"[hh]":d=t.D*24+t.H;break;case"[m]":case"[mm]":d=(t.D*24+t.H)*60+t.M;break;case"[s]":case"[ss]":d=((t.D*24+t.H)*60+t.M)*60+Math.round(t.S+t.u);break;default:throw"bad abstime format: "+a}o=a.length===3?1:2;break;case 101:d=c,o=1;break}var m=o>0?Tt(d,o):"";return m}function Jt(s){var a=3;if(s.length<=a)return s;for(var t=s.length%a,r=s.substr(0,t);t!=s.length;t+=a)r+=(r.length>0?",":"")+s.substr(t,a);return r}var vl=/%/g;function r0(s,a,t){var r=a.replace(vl,""),n=a.length-r.length;return Lt(s,r,t*Math.pow(10,2*n))+us("%",n)}function n0(s,a,t){for(var r=a.length-1;a.charCodeAt(r-1)===44;)--r;return Lt(s,a.substr(0,r),t/Math.pow(10,3*(a.length-r)))}function wl(s,a){var t,r=s.indexOf("E")-s.indexOf(".")-1;if(s.match(/^#+0.0E\+0$/)){if(a==0)return"0.0E+0";if(a<0)return"-"+wl(s,-a);var n=s.indexOf(".");n===-1&&(n=s.indexOf("E"));var l=Math.floor(Math.log(a)*Math.LOG10E)%n;if(l<0&&(l+=n),t=(a/Math.pow(10,l)).toPrecision(r+1+(n+l)%n),t.indexOf("e")===-1){var i=Math.floor(Math.log(a)*Math.LOG10E);for(t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(i-t.length+l):t+="E+"+(i-l);t.substr(0,2)==="0.";)t=t.charAt(0)+t.substr(2,n)+"."+t.substr(2+n),t=t.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(c,d,o,m){return d+o+m.substr(0,(n+l)%n)+"."+m.substr(l)+"E"})}else t=a.toExponential(r);return s.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),s.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}var bl=/# (\?+)( ?)\/( ?)(\d+)/;function i0(s,a,t){var r=parseInt(s[4],10),n=Math.round(a*r),l=Math.floor(n/r),i=n-l*r,c=r;return t+(l===0?"":""+l)+" "+(i===0?us(" ",s[1].length+1+s[4].length):Dn(i,s[1].length)+s[2]+"/"+s[3]+Tt(c,s[4].length))}function l0(s,a,t){return t+(a===0?"":""+a)+us(" ",s[1].length+2+s[4].length)}var yl=/^#*0*\.([0#]+)/,Nl=/\).*[0#]/,jl=/\(###\) ###\\?-####/;function Hs(s){for(var a="",t,r=0;r!=s.length;++r)switch(t=s.charCodeAt(r)){case 35:break;case 63:a+=" ";break;case 48:a+="0";break;default:a+=String.fromCharCode(t)}return a}function vi(s,a){var t=Math.pow(10,a);return""+Math.round(s*t)/t}function wi(s,a){var t=s-Math.floor(s),r=Math.pow(10,a);return a<(""+Math.round(t*r)).length?0:Math.round(t*r)}function c0(s,a){return a<(""+Math.round((s-Math.floor(s))*Math.pow(10,a))).length?1:0}function o0(s){return s<2147483647&&s>-2147483648?""+(s>=0?s|0:s-1|0):""+Math.floor(s)}function ht(s,a,t){if(s.charCodeAt(0)===40&&!a.match(Nl)){var r=a.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?ht("n",r,t):"("+ht("n",r,-t)+")"}if(a.charCodeAt(a.length-1)===44)return n0(s,a,t);if(a.indexOf("%")!==-1)return r0(s,a,t);if(a.indexOf("E")!==-1)return wl(a,t);if(a.charCodeAt(0)===36)return"$"+ht(s,a.substr(a.charAt(1)==" "?2:1),t);var n,l,i,c,d=Math.abs(t),o=t<0?"-":"";if(a.match(/^00+$/))return o+pa(d,a.length);if(a.match(/^[#?]+$/))return n=pa(t,0),n==="0"&&(n=""),n.length>a.length?n:Hs(a.substr(0,a.length-n.length))+n;if(l=a.match(bl))return i0(l,d,o);if(a.match(/^#+0+$/))return o+pa(d,a.length-a.indexOf("0"));if(l=a.match(yl))return n=vi(t,l[1].length).replace(/^([^\.]+)$/,"$1."+Hs(l[1])).replace(/\.$/,"."+Hs(l[1])).replace(/\.(\d*)$/,function(p,h){return"."+h+us("0",Hs(l[1]).length-h.length)}),a.indexOf("0.")!==-1?n:n.replace(/^0\./,".");if(a=a.replace(/^#+([0.])/,"$1"),l=a.match(/^(0*)\.(#*)$/))return o+vi(d,l[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,l[1].length?"0.":".");if(l=a.match(/^#{1,3},##0(\.?)$/))return o+Jt(pa(d,0));if(l=a.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+ht(s,a,-t):Jt(""+(Math.floor(t)+c0(t,l[1].length)))+"."+Tt(wi(t,l[1].length),l[1].length);if(l=a.match(/^#,#*,#0/))return ht(s,a.replace(/^#,#*,/,""),t);if(l=a.match(/^([0#]+)(\\?-([0#]+))+$/))return n=ka(ht(s,a.replace(/[\\-]/g,""),t)),i=0,ka(ka(a.replace(/\\/g,"")).replace(/[0#]/g,function(p){return i<n.length?n.charAt(i++):p==="0"?"0":""}));if(a.match(jl))return n=ht(s,"##########",t),"("+n.substr(0,3)+") "+n.substr(3,3)+"-"+n.substr(6);var m="";if(l=a.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(l[4].length,7),c=Hr(d,Math.pow(10,i)-1,!1),n=""+o,m=Lt("n",l[1],c[1]),m.charAt(m.length-1)==" "&&(m=m.substr(0,m.length-1)+"0"),n+=m+l[2]+"/"+l[3],m=Ur(c[2],i),m.length<l[4].length&&(m=Hs(l[4].substr(l[4].length-m.length))+m),n+=m,n;if(l=a.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(l[1].length,l[4].length),7),c=Hr(d,Math.pow(10,i)-1,!0),o+(c[0]||(c[1]?"":"0"))+" "+(c[1]?Dn(c[1],i)+l[2]+"/"+l[3]+Ur(c[2],i):us(" ",2*i+1+l[2].length+l[3].length));if(l=a.match(/^[#0?]+$/))return n=pa(t,0),a.length<=n.length?n:Hs(a.substr(0,a.length-n.length))+n;if(l=a.match(/^([#0?]+)\.([#0]+)$/)){n=""+t.toFixed(Math.min(l[2].length,10)).replace(/([^0])0+$/,"$1"),i=n.indexOf(".");var g=a.indexOf(".")-i,x=a.length-n.length-g;return Hs(a.substr(0,g)+n+a.substr(a.length-x))}if(l=a.match(/^00,000\.([#0]*0)$/))return i=wi(t,l[1].length),t<0?"-"+ht(s,a,-t):Jt(o0(t)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(p){return"00,"+(p.length<3?Tt(0,3-p.length):"")+p})+"."+Tt(i,l[1].length);switch(a){case"###,##0.00":return ht(s,"#,##0.00",t);case"###,###":case"##,###":case"#,###":var f=Jt(pa(d,0));return f!=="0"?o+f:"";case"###,###.00":return ht(s,"###,##0.00",t).replace(/^0\./,".");case"#,###.00":return ht(s,"#,##0.00",t).replace(/^0\./,".")}throw new Error("unsupported format |"+a+"|")}function d0(s,a,t){for(var r=a.length-1;a.charCodeAt(r-1)===44;)--r;return Lt(s,a.substr(0,r),t/Math.pow(10,3*(a.length-r)))}function m0(s,a,t){var r=a.replace(vl,""),n=a.length-r.length;return Lt(s,r,t*Math.pow(10,2*n))+us("%",n)}function Sl(s,a){var t,r=s.indexOf("E")-s.indexOf(".")-1;if(s.match(/^#+0.0E\+0$/)){if(a==0)return"0.0E+0";if(a<0)return"-"+Sl(s,-a);var n=s.indexOf(".");n===-1&&(n=s.indexOf("E"));var l=Math.floor(Math.log(a)*Math.LOG10E)%n;if(l<0&&(l+=n),t=(a/Math.pow(10,l)).toPrecision(r+1+(n+l)%n),!t.match(/[Ee]/)){var i=Math.floor(Math.log(a)*Math.LOG10E);t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(i-t.length+l):t+="E+"+(i-l),t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(c,d,o,m){return d+o+m.substr(0,(n+l)%n)+"."+m.substr(l)+"E"})}else t=a.toExponential(r);return s.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),s.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}function Et(s,a,t){if(s.charCodeAt(0)===40&&!a.match(Nl)){var r=a.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?Et("n",r,t):"("+Et("n",r,-t)+")"}if(a.charCodeAt(a.length-1)===44)return d0(s,a,t);if(a.indexOf("%")!==-1)return m0(s,a,t);if(a.indexOf("E")!==-1)return Sl(a,t);if(a.charCodeAt(0)===36)return"$"+Et(s,a.substr(a.charAt(1)==" "?2:1),t);var n,l,i,c,d=Math.abs(t),o=t<0?"-":"";if(a.match(/^00+$/))return o+Tt(d,a.length);if(a.match(/^[#?]+$/))return n=""+t,t===0&&(n=""),n.length>a.length?n:Hs(a.substr(0,a.length-n.length))+n;if(l=a.match(bl))return l0(l,d,o);if(a.match(/^#+0+$/))return o+Tt(d,a.length-a.indexOf("0"));if(l=a.match(yl))return n=(""+t).replace(/^([^\.]+)$/,"$1."+Hs(l[1])).replace(/\.$/,"."+Hs(l[1])),n=n.replace(/\.(\d*)$/,function(p,h){return"."+h+us("0",Hs(l[1]).length-h.length)}),a.indexOf("0.")!==-1?n:n.replace(/^0\./,".");if(a=a.replace(/^#+([0.])/,"$1"),l=a.match(/^(0*)\.(#*)$/))return o+(""+d).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,l[1].length?"0.":".");if(l=a.match(/^#{1,3},##0(\.?)$/))return o+Jt(""+d);if(l=a.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+Et(s,a,-t):Jt(""+t)+"."+us("0",l[1].length);if(l=a.match(/^#,#*,#0/))return Et(s,a.replace(/^#,#*,/,""),t);if(l=a.match(/^([0#]+)(\\?-([0#]+))+$/))return n=ka(Et(s,a.replace(/[\\-]/g,""),t)),i=0,ka(ka(a.replace(/\\/g,"")).replace(/[0#]/g,function(p){return i<n.length?n.charAt(i++):p==="0"?"0":""}));if(a.match(jl))return n=Et(s,"##########",t),"("+n.substr(0,3)+") "+n.substr(3,3)+"-"+n.substr(6);var m="";if(l=a.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(l[4].length,7),c=Hr(d,Math.pow(10,i)-1,!1),n=""+o,m=Lt("n",l[1],c[1]),m.charAt(m.length-1)==" "&&(m=m.substr(0,m.length-1)+"0"),n+=m+l[2]+"/"+l[3],m=Ur(c[2],i),m.length<l[4].length&&(m=Hs(l[4].substr(l[4].length-m.length))+m),n+=m,n;if(l=a.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(l[1].length,l[4].length),7),c=Hr(d,Math.pow(10,i)-1,!0),o+(c[0]||(c[1]?"":"0"))+" "+(c[1]?Dn(c[1],i)+l[2]+"/"+l[3]+Ur(c[2],i):us(" ",2*i+1+l[2].length+l[3].length));if(l=a.match(/^[#0?]+$/))return n=""+t,a.length<=n.length?n:Hs(a.substr(0,a.length-n.length))+n;if(l=a.match(/^([#0]+)\.([#0]+)$/)){n=""+t.toFixed(Math.min(l[2].length,10)).replace(/([^0])0+$/,"$1"),i=n.indexOf(".");var g=a.indexOf(".")-i,x=a.length-n.length-g;return Hs(a.substr(0,g)+n+a.substr(a.length-x))}if(l=a.match(/^00,000\.([#0]*0)$/))return t<0?"-"+Et(s,a,-t):Jt(""+t).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(p){return"00,"+(p.length<3?Tt(0,3-p.length):"")+p})+"."+Tt(0,l[1].length);switch(a){case"###,###":case"##,###":case"#,###":var f=Jt(""+d);return f!=="0"?o+f:"";default:if(a.match(/\.[0#?]*$/))return Et(s,a.slice(0,a.lastIndexOf(".")),t)+Hs(a.slice(a.lastIndexOf(".")))}throw new Error("unsupported format |"+a+"|")}function Lt(s,a,t){return(t|0)===t?Et(s,a,t):ht(s,a,t)}function x0(s){for(var a=[],t=!1,r=0,n=0;r<s.length;++r)switch(s.charCodeAt(r)){case 34:t=!t;break;case 95:case 42:case 92:++r;break;case 59:a[a.length]=s.substr(n,r-n),n=r+1}if(a[a.length]=s.substr(n),t===!0)throw new Error("Format |"+s+"| unterminated string ");return a}var Tl=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function kl(s){for(var a=0,t="",r="";a<s.length;)switch(t=s.charAt(a)){case"G":Gr(s,a)&&(a+=6),a++;break;case'"':for(;s.charCodeAt(++a)!==34&&a<s.length;);++a;break;case"\\":a+=2;break;case"_":a+=2;break;case"@":++a;break;case"B":case"b":if(s.charAt(a+1)==="1"||s.charAt(a+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"上":if(s.substr(a,3).toUpperCase()==="A/P"||s.substr(a,5).toUpperCase()==="AM/PM"||s.substr(a,5).toUpperCase()==="上午/下午")return!0;++a;break;case"[":for(r=t;s.charAt(a++)!=="]"&&a<s.length;)r+=s.charAt(a);if(r.match(Tl))return!0;break;case".":case"0":case"#":for(;a<s.length&&("0#?.,E+-%".indexOf(t=s.charAt(++a))>-1||t=="\\"&&s.charAt(a+1)=="-"&&"0#".indexOf(s.charAt(a+2))>-1););break;case"?":for(;s.charAt(++a)===t;);break;case"*":++a,(s.charAt(a)==" "||s.charAt(a)=="*")&&++a;break;case"(":case")":++a;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;a<s.length&&"0123456789".indexOf(s.charAt(++a))>-1;);break;case" ":++a;break;default:++a;break}return!1}function h0(s,a,t,r){for(var n=[],l="",i=0,c="",d="t",o,m,g,x="H";i<s.length;)switch(c=s.charAt(i)){case"G":if(!Gr(s,i))throw new Error("unrecognized character "+c+" in "+s);n[n.length]={t:"G",v:"General"},i+=7;break;case'"':for(l="";(g=s.charCodeAt(++i))!==34&&i<s.length;)l+=String.fromCharCode(g);n[n.length]={t:"t",v:l},++i;break;case"\\":var f=s.charAt(++i),p=f==="("||f===")"?f:"t";n[n.length]={t:p,v:f},++i;break;case"_":n[n.length]={t:"t",v:" "},i+=2;break;case"@":n[n.length]={t:"T",v:a},++i;break;case"B":case"b":if(s.charAt(i+1)==="1"||s.charAt(i+1)==="2"){if(o==null&&(o=_r(a,t,s.charAt(i+1)==="2"),o==null))return"";n[n.length]={t:"X",v:s.substr(i,2)},d=c,i+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":c=c.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(a<0||o==null&&(o=_r(a,t),o==null))return"";for(l=c;++i<s.length&&s.charAt(i).toLowerCase()===c;)l+=c;c==="m"&&d.toLowerCase()==="h"&&(c="M"),c==="h"&&(c=x),n[n.length]={t:c,v:l},d=c;break;case"A":case"a":case"上":var h={t:c,v:c};if(o==null&&(o=_r(a,t)),s.substr(i,3).toUpperCase()==="A/P"?(o!=null&&(h.v=o.H>=12?"P":"A"),h.t="T",x="h",i+=3):s.substr(i,5).toUpperCase()==="AM/PM"?(o!=null&&(h.v=o.H>=12?"PM":"AM"),h.t="T",i+=5,x="h"):s.substr(i,5).toUpperCase()==="上午/下午"?(o!=null&&(h.v=o.H>=12?"下午":"上午"),h.t="T",i+=5,x="h"):(h.t="t",++i),o==null&&h.t==="T")return"";n[n.length]=h,d=c;break;case"[":for(l=c;s.charAt(i++)!=="]"&&i<s.length;)l+=s.charAt(i);if(l.slice(-1)!=="]")throw'unterminated "[" block: |'+l+"|";if(l.match(Tl)){if(o==null&&(o=_r(a,t),o==null))return"";n[n.length]={t:"Z",v:l.toLowerCase()},d=l.charAt(1)}else l.indexOf("$")>-1&&(l=(l.match(/\$([^-\[\]]*)/)||[])[1]||"$",kl(s)||(n[n.length]={t:"t",v:l}));break;case".":if(o!=null){for(l=c;++i<s.length&&(c=s.charAt(i))==="0";)l+=c;n[n.length]={t:"s",v:l};break}case"0":case"#":for(l=c;++i<s.length&&"0#?.,E+-%".indexOf(c=s.charAt(i))>-1;)l+=c;n[n.length]={t:"n",v:l};break;case"?":for(l=c;s.charAt(++i)===c;)l+=c;n[n.length]={t:c,v:l},d=c;break;case"*":++i,(s.charAt(i)==" "||s.charAt(i)=="*")&&++i;break;case"(":case")":n[n.length]={t:r===1?"t":c,v:c},++i;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(l=c;i<s.length&&"0123456789".indexOf(s.charAt(++i))>-1;)l+=s.charAt(i);n[n.length]={t:"D",v:l};break;case" ":n[n.length]={t:c,v:c},++i;break;case"$":n[n.length]={t:"t",v:"$"},++i;break;default:if(",$-+/():!^&'~{}<>=€acfijklopqrtuvwxzP".indexOf(c)===-1)throw new Error("unrecognized character "+c+" in "+s);n[n.length]={t:"t",v:c},++i;break}var w=0,L=0,O;for(i=n.length-1,d="t";i>=0;--i)switch(n[i].t){case"h":case"H":n[i].t=x,d="h",w<1&&(w=1);break;case"s":(O=n[i].v.match(/\.0+$/))&&(L=Math.max(L,O[0].length-1)),w<3&&(w=3);case"d":case"y":case"M":case"e":d=n[i].t;break;case"m":d==="s"&&(n[i].t="M",w<2&&(w=2));break;case"X":break;case"Z":w<1&&n[i].v.match(/[Hh]/)&&(w=1),w<2&&n[i].v.match(/[Mm]/)&&(w=2),w<3&&n[i].v.match(/[Ss]/)&&(w=3)}switch(w){case 0:break;case 1:o.u>=.5&&(o.u=0,++o.S),o.S>=60&&(o.S=0,++o.M),o.M>=60&&(o.M=0,++o.H);break;case 2:o.u>=.5&&(o.u=0,++o.S),o.S>=60&&(o.S=0,++o.M);break}var I="",H;for(i=0;i<n.length;++i)switch(n[i].t){case"t":case"T":case" ":case"D":break;case"X":n[i].v="",n[i].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":n[i].v=a0(n[i].t.charCodeAt(0),n[i].v,o,L),n[i].t="t";break;case"n":case"?":for(H=i+1;n[H]!=null&&((c=n[H].t)==="?"||c==="D"||(c===" "||c==="t")&&n[H+1]!=null&&(n[H+1].t==="?"||n[H+1].t==="t"&&n[H+1].v==="/")||n[i].t==="("&&(c===" "||c==="n"||c===")")||c==="t"&&(n[H].v==="/"||n[H].v===" "&&n[H+1]!=null&&n[H+1].t=="?"));)n[i].v+=n[H].v,n[H]={v:"",t:";"},++H;I+=n[i].v,i=H-1;break;case"G":n[i].t="t",n[i].v=kn(a,t);break}var ae="",oe,D;if(I.length>0){I.charCodeAt(0)==40?(oe=a<0&&I.charCodeAt(0)===45?-a:a,D=Lt("n",I,oe)):(oe=a<0&&r>1?-a:a,D=Lt("n",I,oe),oe<0&&n[0]&&n[0].t=="t"&&(D=D.substr(1),n[0].v="-"+n[0].v)),H=D.length-1;var q=n.length;for(i=0;i<n.length;++i)if(n[i]!=null&&n[i].t!="t"&&n[i].v.indexOf(".")>-1){q=i;break}var z=n.length;if(q===n.length&&D.indexOf("E")===-1){for(i=n.length-1;i>=0;--i)n[i]==null||"n?".indexOf(n[i].t)===-1||(H>=n[i].v.length-1?(H-=n[i].v.length,n[i].v=D.substr(H+1,n[i].v.length)):H<0?n[i].v="":(n[i].v=D.substr(0,H+1),H=-1),n[i].t="t",z=i);H>=0&&z<n.length&&(n[z].v=D.substr(0,H+1)+n[z].v)}else if(q!==n.length&&D.indexOf("E")===-1){for(H=D.indexOf(".")-1,i=q;i>=0;--i)if(!(n[i]==null||"n?".indexOf(n[i].t)===-1)){for(m=n[i].v.indexOf(".")>-1&&i===q?n[i].v.indexOf(".")-1:n[i].v.length-1,ae=n[i].v.substr(m+1);m>=0;--m)H>=0&&(n[i].v.charAt(m)==="0"||n[i].v.charAt(m)==="#")&&(ae=D.charAt(H--)+ae);n[i].v=ae,n[i].t="t",z=i}for(H>=0&&z<n.length&&(n[z].v=D.substr(0,H+1)+n[z].v),H=D.indexOf(".")+1,i=q;i<n.length;++i)if(!(n[i]==null||"n?(".indexOf(n[i].t)===-1&&i!==q)){for(m=n[i].v.indexOf(".")>-1&&i===q?n[i].v.indexOf(".")+1:0,ae=n[i].v.substr(0,m);m<n[i].v.length;++m)H<D.length&&(ae+=D.charAt(H++));n[i].v=ae,n[i].t="t",z=i}}}for(i=0;i<n.length;++i)n[i]!=null&&"n?".indexOf(n[i].t)>-1&&(oe=r>1&&a<0&&i>0&&n[i-1].v==="-"?-a:a,n[i].v=Lt(n[i].t,n[i].v,oe),n[i].t="t");var G="";for(i=0;i!==n.length;++i)n[i]!=null&&(G+=n[i].v);return G}var bi=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function yi(s,a){if(a==null)return!1;var t=parseFloat(a[2]);switch(a[1]){case"=":if(s==t)return!0;break;case">":if(s>t)return!0;break;case"<":if(s<t)return!0;break;case"<>":if(s!=t)return!0;break;case">=":if(s>=t)return!0;break;case"<=":if(s<=t)return!0;break}return!1}function u0(s,a){var t=x0(s),r=t.length,n=t[r-1].indexOf("@");if(r<4&&n>-1&&--r,t.length>4)throw new Error("cannot find right format for |"+t.join("|")+"|");if(typeof a!="number")return[4,t.length===4||n>-1?t[t.length-1]:"@"];switch(t.length){case 1:t=n>-1?["General","General","General",t[0]]:[t[0],t[0],t[0],"@"];break;case 2:t=n>-1?[t[0],t[0],t[0],t[1]]:[t[0],t[1],t[0],"@"];break;case 3:t=n>-1?[t[0],t[1],t[0],t[2]]:[t[0],t[1],t[2],"@"];break}var l=a>0?t[0]:a<0?t[1]:t[2];if(t[0].indexOf("[")===-1&&t[1].indexOf("[")===-1)return[r,l];if(t[0].match(/\[[=<>]/)!=null||t[1].match(/\[[=<>]/)!=null){var i=t[0].match(bi),c=t[1].match(bi);return yi(a,i)?[r,t[0]]:yi(a,c)?[r,t[1]]:[r,t[i!=null&&c!=null?2:1]]}return[r,l]}function Yt(s,a,t){t==null&&(t={});var r="";switch(typeof s){case"string":s=="m/d/yy"&&t.dateNF?r=t.dateNF:r=s;break;case"number":s==14&&t.dateNF?r=t.dateNF:r=(t.table!=null?t.table:gs)[s],r==null&&(r=t.table&&t.table[pi[s]]||gs[pi[s]]),r==null&&(r=Jo[s]||"General");break}if(Gr(r,0))return kn(a,t);a instanceof Date&&(a=pl(a,t.date1904));var n=u0(r,a);if(Gr(n[1]))return kn(a,t);if(a===!0)a="TRUE";else if(a===!1)a="FALSE";else if(a===""||a==null)return"";return h0(n[1],a,t,n[0])}function _l(s,a){if(typeof a!="number"){a=+a||-1;for(var t=0;t<392;++t){if(gs[t]==null){a<0&&(a=t);continue}if(gs[t]==s){a=t;break}}a<0&&(a=391)}return gs[a]=s,a}function sn(s){for(var a=0;a!=392;++a)s[a]!==void 0&&_l(s[a],a)}function tn(){gs=Xo()}var El=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function f0(s){var a=typeof s=="number"?gs[s]:s;return a=a.replace(El,"(\\d+)"),new RegExp("^"+a+"$")}function g0(s,a,t){var r=-1,n=-1,l=-1,i=-1,c=-1,d=-1;(a.match(El)||[]).forEach(function(g,x){var f=parseInt(t[x+1],10);switch(g.toLowerCase().charAt(0)){case"y":r=f;break;case"d":l=f;break;case"h":i=f;break;case"s":d=f;break;case"m":i>=0?c=f:n=f;break}}),d>=0&&c==-1&&n>=0&&(c=n,n=-1);var o=(""+(r>=0?r:new Date().getFullYear())).slice(-4)+"-"+("00"+(n>=1?n:1)).slice(-2)+"-"+("00"+(l>=1?l:1)).slice(-2);o.length==7&&(o="0"+o),o.length==8&&(o="20"+o);var m=("00"+(i>=0?i:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2)+":"+("00"+(d>=0?d:0)).slice(-2);return i==-1&&c==-1&&d==-1?o:r==-1&&n==-1&&l==-1?m:o+"T"+m}var p0=function(){var s={};s.version="1.2.0";function a(){for(var D=0,q=new Array(256),z=0;z!=256;++z)D=z,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,q[z]=D;return typeof Int32Array<"u"?new Int32Array(q):q}var t=a();function r(D){var q=0,z=0,G=0,ce=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(G=0;G!=256;++G)ce[G]=D[G];for(G=0;G!=256;++G)for(z=D[G],q=256+G;q<4096;q+=256)z=ce[q]=z>>>8^D[z&255];var M=[];for(G=1;G!=16;++G)M[G-1]=typeof Int32Array<"u"?ce.subarray(G*256,G*256+256):ce.slice(G*256,G*256+256);return M}var n=r(t),l=n[0],i=n[1],c=n[2],d=n[3],o=n[4],m=n[5],g=n[6],x=n[7],f=n[8],p=n[9],h=n[10],w=n[11],L=n[12],O=n[13],I=n[14];function H(D,q){for(var z=q^-1,G=0,ce=D.length;G<ce;)z=z>>>8^t[(z^D.charCodeAt(G++))&255];return~z}function ae(D,q){for(var z=q^-1,G=D.length-15,ce=0;ce<G;)z=I[D[ce++]^z&255]^O[D[ce++]^z>>8&255]^L[D[ce++]^z>>16&255]^w[D[ce++]^z>>>24]^h[D[ce++]]^p[D[ce++]]^f[D[ce++]]^x[D[ce++]]^g[D[ce++]]^m[D[ce++]]^o[D[ce++]]^d[D[ce++]]^c[D[ce++]]^i[D[ce++]]^l[D[ce++]]^t[D[ce++]];for(G+=15;ce<G;)z=z>>>8^t[(z^D[ce++])&255];return~z}function oe(D,q){for(var z=q^-1,G=0,ce=D.length,M=0,W=0;G<ce;)M=D.charCodeAt(G++),M<128?z=z>>>8^t[(z^M)&255]:M<2048?(z=z>>>8^t[(z^(192|M>>6&31))&255],z=z>>>8^t[(z^(128|M&63))&255]):M>=55296&&M<57344?(M=(M&1023)+64,W=D.charCodeAt(G++)&1023,z=z>>>8^t[(z^(240|M>>8&7))&255],z=z>>>8^t[(z^(128|M>>2&63))&255],z=z>>>8^t[(z^(128|W>>6&15|(M&3)<<4))&255],z=z>>>8^t[(z^(128|W&63))&255]):(z=z>>>8^t[(z^(224|M>>12&15))&255],z=z>>>8^t[(z^(128|M>>6&63))&255],z=z>>>8^t[(z^(128|M&63))&255]);return~z}return s.table=t,s.bstr=H,s.buf=ae,s.str=oe,s}(),ts=function(){var a={};a.version="1.2.1";function t(u,b){for(var v=u.split("/"),y=b.split("/"),j=0,_=0,K=Math.min(v.length,y.length);j<K;++j){if(_=v[j].length-y[j].length)return _;if(v[j]!=y[j])return v[j]<y[j]?-1:1}return v.length-y.length}function r(u){if(u.charAt(u.length-1)=="/")return u.slice(0,-1).indexOf("/")===-1?u:r(u.slice(0,-1));var b=u.lastIndexOf("/");return b===-1?u:u.slice(0,b+1)}function n(u){if(u.charAt(u.length-1)=="/")return n(u.slice(0,-1));var b=u.lastIndexOf("/");return b===-1?u:u.slice(b+1)}function l(u,b){typeof b=="string"&&(b=new Date(b));var v=b.getHours();v=v<<6|b.getMinutes(),v=v<<5|b.getSeconds()>>>1,u.write_shift(2,v);var y=b.getFullYear()-1980;y=y<<4|b.getMonth()+1,y=y<<5|b.getDate(),u.write_shift(2,y)}function i(u){var b=u.read_shift(2)&65535,v=u.read_shift(2)&65535,y=new Date,j=v&31;v>>>=5;var _=v&15;v>>>=4,y.setMilliseconds(0),y.setFullYear(v+1980),y.setMonth(_-1),y.setDate(j);var K=b&31;b>>>=5;var Z=b&63;return b>>>=6,y.setHours(b),y.setMinutes(Z),y.setSeconds(K<<1),y}function c(u){nt(u,0);for(var b={},v=0;u.l<=u.length-4;){var y=u.read_shift(2),j=u.read_shift(2),_=u.l+j,K={};switch(y){case 21589:v=u.read_shift(1),v&1&&(K.mtime=u.read_shift(4)),j>5&&(v&2&&(K.atime=u.read_shift(4)),v&4&&(K.ctime=u.read_shift(4))),K.mtime&&(K.mt=new Date(K.mtime*1e3));break}u.l=_,b[y]=K}return b}var d;function o(){return d||(d={})}function m(u,b){if(u[0]==80&&u[1]==75)return zt(u,b);if((u[0]|32)==109&&(u[1]|32)==105)return La(u,b);if(u.length<512)throw new Error("CFB file size "+u.length+" < 512");var v=3,y=512,j=0,_=0,K=0,Z=0,Q=0,se=[],ne=u.slice(0,512);nt(ne,0);var Ne=g(ne);switch(v=Ne[0],v){case 3:y=512;break;case 4:y=4096;break;case 0:if(Ne[1]==0)return zt(u,b);default:throw new Error("Major Version: Expected 3 or 4 saw "+v)}y!==512&&(ne=u.slice(0,y),nt(ne,28));var De=u.slice(0,y);x(ne,v);var Le=ne.read_shift(4,"i");if(v===3&&Le!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Le);ne.l+=4,K=ne.read_shift(4,"i"),ne.l+=4,ne.chk("00100000","Mini Stream Cutoff Size: "),Z=ne.read_shift(4,"i"),j=ne.read_shift(4,"i"),Q=ne.read_shift(4,"i"),_=ne.read_shift(4,"i");for(var Ee=-1,Re=0;Re<109&&(Ee=ne.read_shift(4,"i"),!(Ee<0));++Re)se[Re]=Ee;var ze=f(u,y);w(Q,_,ze,y,se);var os=O(ze,K,se,y);os[K].name="!Directory",j>0&&Z!==W&&(os[Z].name="!MiniFAT"),os[se[0]].name="!FAT",os.fat_addrs=se,os.ssz=y;var ds={},Ls=[],Ma=[],Ba=[];I(K,os,ze,Ls,j,ds,Ma,Z),p(Ma,Ba,Ls),Ls.shift();var Ua={FileIndex:Ma,FullPaths:Ba};return b&&b.raw&&(Ua.raw={header:De,sectors:ze}),Ua}function g(u){if(u[u.l]==80&&u[u.l+1]==75)return[0,0];u.chk(re,"Header Signature: "),u.l+=16;var b=u.read_shift(2,"u");return[u.read_shift(2,"u"),b]}function x(u,b){var v=9;switch(u.l+=2,v=u.read_shift(2)){case 9:if(b!=3)throw new Error("Sector Shift: Expected 9 saw "+v);break;case 12:if(b!=4)throw new Error("Sector Shift: Expected 12 saw "+v);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+v)}u.chk("0600","Mini Sector Shift: "),u.chk("000000000000","Reserved: ")}function f(u,b){for(var v=Math.ceil(u.length/b)-1,y=[],j=1;j<v;++j)y[j-1]=u.slice(j*b,(j+1)*b);return y[v-1]=u.slice(v*b),y}function p(u,b,v){for(var y=0,j=0,_=0,K=0,Z=0,Q=v.length,se=[],ne=[];y<Q;++y)se[y]=ne[y]=y,b[y]=v[y];for(;Z<ne.length;++Z)y=ne[Z],j=u[y].L,_=u[y].R,K=u[y].C,se[y]===y&&(j!==-1&&se[j]!==j&&(se[y]=se[j]),_!==-1&&se[_]!==_&&(se[y]=se[_])),K!==-1&&(se[K]=y),j!==-1&&y!=se[y]&&(se[j]=se[y],ne.lastIndexOf(j)<Z&&ne.push(j)),_!==-1&&y!=se[y]&&(se[_]=se[y],ne.lastIndexOf(_)<Z&&ne.push(_));for(y=1;y<Q;++y)se[y]===y&&(_!==-1&&se[_]!==_?se[y]=se[_]:j!==-1&&se[j]!==j&&(se[y]=se[j]));for(y=1;y<Q;++y)if(u[y].type!==0){if(Z=y,Z!=se[Z])do Z=se[Z],b[y]=b[Z]+"/"+b[y];while(Z!==0&&se[Z]!==-1&&Z!=se[Z]);se[y]=-1}for(b[0]+="/",y=1;y<Q;++y)u[y].type!==2&&(b[y]+="/")}function h(u,b,v){for(var y=u.start,j=u.size,_=[],K=y;v&&j>0&&K>=0;)_.push(b.slice(K*M,K*M+M)),j-=M,K=aa(v,K*4);return _.length===0?he(0):Is(_).slice(0,u.size)}function w(u,b,v,y,j){var _=W;if(u===W){if(b!==0)throw new Error("DIFAT chain shorter than expected")}else if(u!==-1){var K=v[u],Z=(y>>>2)-1;if(!K)return;for(var Q=0;Q<Z&&(_=aa(K,Q*4))!==W;++Q)j.push(_);w(aa(K,y-4),b-1,v,y,j)}}function L(u,b,v,y,j){var _=[],K=[];j||(j=[]);var Z=y-1,Q=0,se=0;for(Q=b;Q>=0;){j[Q]=!0,_[_.length]=Q,K.push(u[Q]);var ne=v[Math.floor(Q*4/y)];if(se=Q*4&Z,y<4+se)throw new Error("FAT boundary crossed: "+Q+" 4 "+y);if(!u[ne])break;Q=aa(u[ne],se)}return{nodes:_,data:Ci([K])}}function O(u,b,v,y){var j=u.length,_=[],K=[],Z=[],Q=[],se=y-1,ne=0,Ne=0,De=0,Le=0;for(ne=0;ne<j;++ne)if(Z=[],De=ne+b,De>=j&&(De-=j),!K[De]){Q=[];var Ee=[];for(Ne=De;Ne>=0;){Ee[Ne]=!0,K[Ne]=!0,Z[Z.length]=Ne,Q.push(u[Ne]);var Re=v[Math.floor(Ne*4/y)];if(Le=Ne*4&se,y<4+Le)throw new Error("FAT boundary crossed: "+Ne+" 4 "+y);if(!u[Re]||(Ne=aa(u[Re],Le),Ee[Ne]))break}_[De]={nodes:Z,data:Ci([Q])}}return _}function I(u,b,v,y,j,_,K,Z){for(var Q=0,se=y.length?2:0,ne=b[u].data,Ne=0,De=0,Le;Ne<ne.length;Ne+=128){var Ee=ne.slice(Ne,Ne+128);nt(Ee,64),De=Ee.read_shift(2),Le=Mn(Ee,0,De-se),y.push(Le);var Re={name:Le,type:Ee.read_shift(1),color:Ee.read_shift(1),L:Ee.read_shift(4,"i"),R:Ee.read_shift(4,"i"),C:Ee.read_shift(4,"i"),clsid:Ee.read_shift(16),state:Ee.read_shift(4,"i"),start:0,size:0},ze=Ee.read_shift(2)+Ee.read_shift(2)+Ee.read_shift(2)+Ee.read_shift(2);ze!==0&&(Re.ct=H(Ee,Ee.l-8));var os=Ee.read_shift(2)+Ee.read_shift(2)+Ee.read_shift(2)+Ee.read_shift(2);os!==0&&(Re.mt=H(Ee,Ee.l-8)),Re.start=Ee.read_shift(4,"i"),Re.size=Ee.read_shift(4,"i"),Re.size<0&&Re.start<0&&(Re.size=Re.type=0,Re.start=W,Re.name=""),Re.type===5?(Q=Re.start,j>0&&Q!==W&&(b[Q].name="!StreamData")):Re.size>=4096?(Re.storage="fat",b[Re.start]===void 0&&(b[Re.start]=L(v,Re.start,b.fat_addrs,b.ssz)),b[Re.start].name=Re.name,Re.content=b[Re.start].data.slice(0,Re.size)):(Re.storage="minifat",Re.size<0?Re.size=0:Q!==W&&Re.start!==W&&b[Q]&&(Re.content=h(Re,b[Q].data,(b[Z]||{}).data))),Re.content&&nt(Re.content,0),_[Le]=Re,K.push(Re)}}function H(u,b){return new Date((lt(u,b+4)/1e7*Math.pow(2,32)+lt(u,b)/1e7-11644473600)*1e3)}function ae(u,b){return o(),m(d.readFileSync(u),b)}function oe(u,b){var v=b&&b.type;switch(v||qe&&Buffer.isBuffer(u)&&(v="buffer"),v||"base64"){case"file":return ae(u,b);case"base64":return m(St(Ut(u)),b);case"binary":return m(St(u),b)}return m(u,b)}function D(u,b){var v=b||{},y=v.root||"Root Entry";if(u.FullPaths||(u.FullPaths=[]),u.FileIndex||(u.FileIndex=[]),u.FullPaths.length!==u.FileIndex.length)throw new Error("inconsistent CFB structure");u.FullPaths.length===0&&(u.FullPaths[0]=y+"/",u.FileIndex[0]={name:y,type:5}),v.CLSID&&(u.FileIndex[0].clsid=v.CLSID),q(u)}function q(u){var b="Sh33tJ5";if(!ts.find(u,"/"+b)){var v=he(4);v[0]=55,v[1]=v[3]=50,v[2]=54,u.FileIndex.push({name:b,type:2,content:v,size:4,L:69,R:69,C:69}),u.FullPaths.push(u.FullPaths[0]+b),z(u)}}function z(u,b){D(u);for(var v=!1,y=!1,j=u.FullPaths.length-1;j>=0;--j){var _=u.FileIndex[j];switch(_.type){case 0:y?v=!0:(u.FileIndex.pop(),u.FullPaths.pop());break;case 1:case 2:case 5:y=!0,isNaN(_.R*_.L*_.C)&&(v=!0),_.R>-1&&_.L>-1&&_.R==_.L&&(v=!0);break;default:v=!0;break}}if(!(!v&&!b)){var K=new Date(1987,1,19),Z=0,Q=Object.create?Object.create(null):{},se=[];for(j=0;j<u.FullPaths.length;++j)Q[u.FullPaths[j]]=!0,u.FileIndex[j].type!==0&&se.push([u.FullPaths[j],u.FileIndex[j]]);for(j=0;j<se.length;++j){var ne=r(se[j][0]);y=Q[ne],y||(se.push([ne,{name:n(ne).replace("/",""),type:1,clsid:te,ct:K,mt:K,content:null}]),Q[ne]=!0)}for(se.sort(function(Le,Ee){return t(Le[0],Ee[0])}),u.FullPaths=[],u.FileIndex=[],j=0;j<se.length;++j)u.FullPaths[j]=se[j][0],u.FileIndex[j]=se[j][1];for(j=0;j<se.length;++j){var Ne=u.FileIndex[j],De=u.FullPaths[j];if(Ne.name=n(De).replace("/",""),Ne.L=Ne.R=Ne.C=-(Ne.color=1),Ne.size=Ne.content?Ne.content.length:0,Ne.start=0,Ne.clsid=Ne.clsid||te,j===0)Ne.C=se.length>1?1:-1,Ne.size=0,Ne.type=5;else if(De.slice(-1)=="/"){for(Z=j+1;Z<se.length&&r(u.FullPaths[Z])!=De;++Z);for(Ne.C=Z>=se.length?-1:Z,Z=j+1;Z<se.length&&r(u.FullPaths[Z])!=r(De);++Z);Ne.R=Z>=se.length?-1:Z,Ne.type=1}else r(u.FullPaths[j+1]||"")==r(De)&&(Ne.R=j+1),Ne.type=2}}}function G(u,b){var v=b||{};if(v.fileType=="mad")return k(u,v);switch(z(u),v.fileType){case"zip":return Dt(u,v)}var y=function(Le){for(var Ee=0,Re=0,ze=0;ze<Le.FileIndex.length;++ze){var os=Le.FileIndex[ze];if(os.content){var ds=os.content.length;ds>0&&(ds<4096?Ee+=ds+63>>6:Re+=ds+511>>9)}}for(var Ls=Le.FullPaths.length+3>>2,Ma=Ee+7>>3,Ba=Ee+127>>7,Ua=Ma+Re+Ls+Ba,sa=Ua+127>>7,on=sa<=109?0:Math.ceil((sa-109)/127);Ua+sa+on+127>>7>sa;)on=++sa<=109?0:Math.ceil((sa-109)/127);var Pt=[1,on,sa,Ba,Ls,Re,Ee,0];return Le.FileIndex[0].size=Ee<<6,Pt[7]=(Le.FileIndex[0].start=Pt[0]+Pt[1]+Pt[2]+Pt[3]+Pt[4]+Pt[5])+(Pt[6]+7>>3),Pt}(u),j=he(y[7]<<9),_=0,K=0;{for(_=0;_<8;++_)j.write_shift(1,ve[_]);for(_=0;_<8;++_)j.write_shift(2,0);for(j.write_shift(2,62),j.write_shift(2,3),j.write_shift(2,65534),j.write_shift(2,9),j.write_shift(2,6),_=0;_<3;++_)j.write_shift(2,0);for(j.write_shift(4,0),j.write_shift(4,y[2]),j.write_shift(4,y[0]+y[1]+y[2]+y[3]-1),j.write_shift(4,0),j.write_shift(4,4096),j.write_shift(4,y[3]?y[0]+y[1]+y[2]-1:W),j.write_shift(4,y[3]),j.write_shift(-4,y[1]?y[0]-1:W),j.write_shift(4,y[1]),_=0;_<109;++_)j.write_shift(-4,_<y[2]?y[1]+_:-1)}if(y[1])for(K=0;K<y[1];++K){for(;_<236+K*127;++_)j.write_shift(-4,_<y[2]?y[1]+_:-1);j.write_shift(-4,K===y[1]-1?W:K+1)}var Z=function(Le){for(K+=Le;_<K-1;++_)j.write_shift(-4,_+1);Le&&(++_,j.write_shift(-4,W))};for(K=_=0,K+=y[1];_<K;++_)j.write_shift(-4,ke.DIFSECT);for(K+=y[2];_<K;++_)j.write_shift(-4,ke.FATSECT);Z(y[3]),Z(y[4]);for(var Q=0,se=0,ne=u.FileIndex[0];Q<u.FileIndex.length;++Q)ne=u.FileIndex[Q],ne.content&&(se=ne.content.length,!(se<4096)&&(ne.start=K,Z(se+511>>9)));for(Z(y[6]+7>>3);j.l&511;)j.write_shift(-4,ke.ENDOFCHAIN);for(K=_=0,Q=0;Q<u.FileIndex.length;++Q)ne=u.FileIndex[Q],ne.content&&(se=ne.content.length,!(!se||se>=4096)&&(ne.start=K,Z(se+63>>6)));for(;j.l&511;)j.write_shift(-4,ke.ENDOFCHAIN);for(_=0;_<y[4]<<2;++_){var Ne=u.FullPaths[_];if(!Ne||Ne.length===0){for(Q=0;Q<17;++Q)j.write_shift(4,0);for(Q=0;Q<3;++Q)j.write_shift(4,-1);for(Q=0;Q<12;++Q)j.write_shift(4,0);continue}ne=u.FileIndex[_],_===0&&(ne.start=ne.size?ne.start-1:W);var De=_===0&&v.root||ne.name;if(se=2*(De.length+1),j.write_shift(64,De,"utf16le"),j.write_shift(2,se),j.write_shift(1,ne.type),j.write_shift(1,ne.color),j.write_shift(-4,ne.L),j.write_shift(-4,ne.R),j.write_shift(-4,ne.C),ne.clsid)j.write_shift(16,ne.clsid,"hex");else for(Q=0;Q<4;++Q)j.write_shift(4,0);j.write_shift(4,ne.state||0),j.write_shift(4,0),j.write_shift(4,0),j.write_shift(4,0),j.write_shift(4,0),j.write_shift(4,ne.start),j.write_shift(4,ne.size),j.write_shift(4,0)}for(_=1;_<u.FileIndex.length;++_)if(ne=u.FileIndex[_],ne.size>=4096)if(j.l=ne.start+1<<9,qe&&Buffer.isBuffer(ne.content))ne.content.copy(j,j.l,0,ne.size),j.l+=ne.size+511&-512;else{for(Q=0;Q<ne.size;++Q)j.write_shift(1,ne.content[Q]);for(;Q&511;++Q)j.write_shift(1,0)}for(_=1;_<u.FileIndex.length;++_)if(ne=u.FileIndex[_],ne.size>0&&ne.size<4096)if(qe&&Buffer.isBuffer(ne.content))ne.content.copy(j,j.l,0,ne.size),j.l+=ne.size+63&-64;else{for(Q=0;Q<ne.size;++Q)j.write_shift(1,ne.content[Q]);for(;Q&63;++Q)j.write_shift(1,0)}if(qe)j.l=j.length;else for(;j.l<j.length;)j.write_shift(1,0);return j}function ce(u,b){var v=u.FullPaths.map(function(Q){return Q.toUpperCase()}),y=v.map(function(Q){var se=Q.split("/");return se[se.length-(Q.slice(-1)=="/"?2:1)]}),j=!1;b.charCodeAt(0)===47?(j=!0,b=v[0].slice(0,-1)+b):j=b.indexOf("/")!==-1;var _=b.toUpperCase(),K=j===!0?v.indexOf(_):y.indexOf(_);if(K!==-1)return u.FileIndex[K];var Z=!_.match(kr);for(_=_.replace(Xa,""),Z&&(_=_.replace(kr,"!")),K=0;K<v.length;++K)if((Z?v[K].replace(kr,"!"):v[K]).replace(Xa,"")==_||(Z?y[K].replace(kr,"!"):y[K]).replace(Xa,"")==_)return u.FileIndex[K];return null}var M=64,W=-2,re="d0cf11e0a1b11ae1",ve=[208,207,17,224,161,177,26,225],te="00000000000000000000000000000000",ke={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:W,FREESECT:-1,HEADER_SIGNATURE:re,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:te,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function xe(u,b,v){o();var y=G(u,v);d.writeFileSync(b,y)}function Ie(u){for(var b=new Array(u.length),v=0;v<u.length;++v)b[v]=String.fromCharCode(u[v]);return b.join("")}function je(u,b){var v=G(u,b);switch(b&&b.type||"buffer"){case"file":return o(),d.writeFileSync(b.filename,v),v;case"binary":return typeof v=="string"?v:Ie(v);case"base64":return nr(typeof v=="string"?v:Ie(v));case"buffer":if(qe)return Buffer.isBuffer(v)?v:Ht(v);case"array":return typeof v=="string"?St(v):v}return v}var Oe;function N(u){try{var b=u.InflateRaw,v=new b;if(v._processChunk(new Uint8Array([3,0]),v._finishFlushFlag),v.bytesRead)Oe=u;else throw new Error("zlib does not expose bytesRead")}catch(y){console.error("cannot use native zlib: "+(y.message||y))}}function P(u,b){if(!Oe)return Ye(u,b);var v=Oe.InflateRaw,y=new v,j=y._processChunk(u.slice(u.l),y._finishFlushFlag);return u.l+=y.bytesRead,j}function T(u){return Oe?Oe.deflateRawSync(u):Gs(u)}var A=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],X=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],me=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function F(u){var b=(u<<1|u<<11)&139536|(u<<5|u<<15)&558144;return(b>>16|b>>8|b)&255}for(var J=typeof Uint8Array<"u",U=J?new Uint8Array(256):[],Y=0;Y<256;++Y)U[Y]=F(Y);function ue(u,b){var v=U[u&255];return b<=8?v>>>8-b:(v=v<<8|U[u>>8&255],b<=16?v>>>16-b:(v=v<<8|U[u>>16&255],v>>>24-b))}function Me(u,b){var v=b&7,y=b>>>3;return(u[y]|(v<=6?0:u[y+1]<<8))>>>v&3}function le(u,b){var v=b&7,y=b>>>3;return(u[y]|(v<=5?0:u[y+1]<<8))>>>v&7}function B(u,b){var v=b&7,y=b>>>3;return(u[y]|(v<=4?0:u[y+1]<<8))>>>v&15}function de(u,b){var v=b&7,y=b>>>3;return(u[y]|(v<=3?0:u[y+1]<<8))>>>v&31}function pe(u,b){var v=b&7,y=b>>>3;return(u[y]|(v<=1?0:u[y+1]<<8))>>>v&127}function E(u,b,v){var y=b&7,j=b>>>3,_=(1<<v)-1,K=u[j]>>>y;return v<8-y||(K|=u[j+1]<<8-y,v<16-y)||(K|=u[j+2]<<16-y,v<24-y)||(K|=u[j+3]<<24-y),K&_}function R(u,b,v){var y=b&7,j=b>>>3;return y<=5?u[j]|=(v&7)<<y:(u[j]|=v<<y&255,u[j+1]=(v&7)>>8-y),b+3}function ye(u,b,v){var y=b&7,j=b>>>3;return v=(v&1)<<y,u[j]|=v,b+1}function ee(u,b,v){var y=b&7,j=b>>>3;return v<<=y,u[j]|=v&255,v>>>=8,u[j+1]=v,b+8}function Se(u,b,v){var y=b&7,j=b>>>3;return v<<=y,u[j]|=v&255,v>>>=8,u[j+1]=v&255,u[j+2]=v>>>8,b+16}function Ce(u,b){var v=u.length,y=2*v>b?2*v:b+5,j=0;if(v>=b)return u;if(qe){var _=ui(y);if(u.copy)u.copy(_);else for(;j<u.length;++j)_[j]=u[j];return _}else if(J){var K=new Uint8Array(y);if(K.set)K.set(u);else for(;j<v;++j)K[j]=u[j];return K}return u.length=y,u}function Ue(u){for(var b=new Array(u),v=0;v<u;++v)b[v]=0;return b}function Xe(u,b,v){var y=1,j=0,_=0,K=0,Z=0,Q=u.length,se=J?new Uint16Array(32):Ue(32);for(_=0;_<32;++_)se[_]=0;for(_=Q;_<v;++_)u[_]=0;Q=u.length;var ne=J?new Uint16Array(Q):Ue(Q);for(_=0;_<Q;++_)se[j=u[_]]++,y<j&&(y=j),ne[_]=0;for(se[0]=0,_=1;_<=y;++_)se[_+16]=Z=Z+se[_-1]<<1;for(_=0;_<Q;++_)Z=u[_],Z!=0&&(ne[_]=se[Z+16]++);var Ne=0;for(_=0;_<Q;++_)if(Ne=u[_],Ne!=0)for(Z=ue(ne[_],y)>>y-Ne,K=(1<<y+4-Ne)-1;K>=0;--K)b[Z|K<<Ne]=Ne&15|_<<4;return y}var vs=J?new Uint16Array(512):Ue(512),as=J?new Uint16Array(32):Ue(32);if(!J){for(var cs=0;cs<512;++cs)vs[cs]=0;for(cs=0;cs<32;++cs)as[cs]=0}(function(){for(var u=[],b=0;b<32;b++)u.push(5);Xe(u,as,32);var v=[];for(b=0;b<=143;b++)v.push(8);for(;b<=255;b++)v.push(9);for(;b<=279;b++)v.push(7);for(;b<=287;b++)v.push(8);Xe(v,vs,288)})();var qs=function(){for(var b=J?new Uint8Array(32768):[],v=0,y=0;v<me.length-1;++v)for(;y<me[v+1];++y)b[y]=v;for(;y<32768;++y)b[y]=29;var j=J?new Uint8Array(259):[];for(v=0,y=0;v<X.length-1;++v)for(;y<X[v+1];++y)j[y]=v;function _(Z,Q){for(var se=0;se<Z.length;){var ne=Math.min(65535,Z.length-se),Ne=se+ne==Z.length;for(Q.write_shift(1,+Ne),Q.write_shift(2,ne),Q.write_shift(2,~ne&65535);ne-- >0;)Q[Q.l++]=Z[se++]}return Q.l}function K(Z,Q){for(var se=0,ne=0,Ne=J?new Uint16Array(32768):[];ne<Z.length;){var De=Math.min(65535,Z.length-ne);if(De<10){for(se=R(Q,se,+(ne+De==Z.length)),se&7&&(se+=8-(se&7)),Q.l=se/8|0,Q.write_shift(2,De),Q.write_shift(2,~De&65535);De-- >0;)Q[Q.l++]=Z[ne++];se=Q.l*8;continue}se=R(Q,se,+(ne+De==Z.length)+2);for(var Le=0;De-- >0;){var Ee=Z[ne];Le=(Le<<5^Ee)&32767;var Re=-1,ze=0;if((Re=Ne[Le])&&(Re|=ne&-32768,Re>ne&&(Re-=32768),Re<ne))for(;Z[Re+ze]==Z[ne+ze]&&ze<250;)++ze;if(ze>2){Ee=j[ze],Ee<=22?se=ee(Q,se,U[Ee+1]>>1)-1:(ee(Q,se,3),se+=5,ee(Q,se,U[Ee-23]>>5),se+=3);var os=Ee<8?0:Ee-4>>2;os>0&&(Se(Q,se,ze-X[Ee]),se+=os),Ee=b[ne-Re],se=ee(Q,se,U[Ee]>>3),se-=3;var ds=Ee<4?0:Ee-2>>1;ds>0&&(Se(Q,se,ne-Re-me[Ee]),se+=ds);for(var Ls=0;Ls<ze;++Ls)Ne[Le]=ne&32767,Le=(Le<<5^Z[ne])&32767,++ne;De-=ze-1}else Ee<=143?Ee=Ee+48:se=ye(Q,se,1),se=ee(Q,se,U[Ee]),Ne[Le]=ne&32767,++ne}se=ee(Q,se,0)-1}return Q.l=(se+7)/8|0,Q.l}return function(Q,se){return Q.length<8?_(Q,se):K(Q,se)}}();function Gs(u){var b=he(50+Math.floor(u.length*1.1)),v=qs(u,b);return b.slice(0,v)}var ie=J?new Uint16Array(32768):Ue(32768),_e=J?new Uint16Array(32768):Ue(32768),Ke=J?new Uint16Array(128):Ue(128),ps=1,rs=1;function Qs(u,b){var v=de(u,b)+257;b+=5;var y=de(u,b)+1;b+=5;var j=B(u,b)+4;b+=4;for(var _=0,K=J?new Uint8Array(19):Ue(19),Z=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],Q=1,se=J?new Uint8Array(8):Ue(8),ne=J?new Uint8Array(8):Ue(8),Ne=K.length,De=0;De<j;++De)K[A[De]]=_=le(u,b),Q<_&&(Q=_),se[_]++,b+=3;var Le=0;for(se[0]=0,De=1;De<=Q;++De)ne[De]=Le=Le+se[De-1]<<1;for(De=0;De<Ne;++De)(Le=K[De])!=0&&(Z[De]=ne[Le]++);var Ee=0;for(De=0;De<Ne;++De)if(Ee=K[De],Ee!=0){Le=U[Z[De]]>>8-Ee;for(var Re=(1<<7-Ee)-1;Re>=0;--Re)Ke[Le|Re<<Ee]=Ee&7|De<<3}var ze=[];for(Q=1;ze.length<v+y;)switch(Le=Ke[pe(u,b)],b+=Le&7,Le>>>=3){case 16:for(_=3+Me(u,b),b+=2,Le=ze[ze.length-1];_-- >0;)ze.push(Le);break;case 17:for(_=3+le(u,b),b+=3;_-- >0;)ze.push(0);break;case 18:for(_=11+pe(u,b),b+=7;_-- >0;)ze.push(0);break;default:ze.push(Le),Q<Le&&(Q=Le);break}var os=ze.slice(0,v),ds=ze.slice(v);for(De=v;De<286;++De)os[De]=0;for(De=y;De<30;++De)ds[De]=0;return ps=Xe(os,ie,286),rs=Xe(ds,_e,30),b}function Ts(u,b){if(u[0]==3&&!(u[1]&3))return[ca(b),2];for(var v=0,y=0,j=ui(b||1<<18),_=0,K=j.length>>>0,Z=0,Q=0;!(y&1);){if(y=le(u,v),v+=3,y>>>1)y>>1==1?(Z=9,Q=5):(v=Qs(u,v),Z=ps,Q=rs);else{v&7&&(v+=8-(v&7));var se=u[v>>>3]|u[(v>>>3)+1]<<8;if(v+=32,se>0)for(!b&&K<_+se&&(j=Ce(j,_+se),K=j.length);se-- >0;)j[_++]=u[v>>>3],v+=8;continue}for(;;){!b&&K<_+32767&&(j=Ce(j,_+32767),K=j.length);var ne=E(u,v,Z),Ne=y>>>1==1?vs[ne]:ie[ne];if(v+=Ne&15,Ne>>>=4,!(Ne>>>8&255))j[_++]=Ne;else{if(Ne==256)break;Ne-=257;var De=Ne<8?0:Ne-4>>2;De>5&&(De=0);var Le=_+X[Ne];De>0&&(Le+=E(u,v,De),v+=De),ne=E(u,v,Q),Ne=y>>>1==1?as[ne]:_e[ne],v+=Ne&15,Ne>>>=4;var Ee=Ne<4?0:Ne-2>>1,Re=me[Ne];for(Ee>0&&(Re+=E(u,v,Ee),v+=Ee),!b&&K<Le&&(j=Ce(j,Le+100),K=j.length);_<Le;)j[_]=j[_-Re],++_}}}return b?[j,v+7>>>3]:[j.slice(0,_),v+7>>>3]}function Ye(u,b){var v=u.slice(u.l||0),y=Ts(v,b);return u.l+=y[1],y[0]}function _t(u,b){if(u)typeof console<"u"&&console.error(b);else throw new Error(b)}function zt(u,b){var v=u;nt(v,0);var y=[],j=[],_={FileIndex:y,FullPaths:j};D(_,{root:b.root});for(var K=v.length-4;(v[K]!=80||v[K+1]!=75||v[K+2]!=5||v[K+3]!=6)&&K>=0;)--K;v.l=K+4,v.l+=4;var Z=v.read_shift(2);v.l+=6;var Q=v.read_shift(4);for(v.l=Q,K=0;K<Z;++K){v.l+=20;var se=v.read_shift(4),ne=v.read_shift(4),Ne=v.read_shift(2),De=v.read_shift(2),Le=v.read_shift(2);v.l+=8;var Ee=v.read_shift(4),Re=c(v.slice(v.l+Ne,v.l+Ne+De));v.l+=Ne+De+Le;var ze=v.l;v.l=Ee+4,ns(v,se,ne,_,Re),v.l=ze}return _}function ns(u,b,v,y,j){u.l+=2;var _=u.read_shift(2),K=u.read_shift(2),Z=i(u);if(_&8257)throw new Error("Unsupported ZIP encryption");for(var Q=u.read_shift(4),se=u.read_shift(4),ne=u.read_shift(4),Ne=u.read_shift(2),De=u.read_shift(2),Le="",Ee=0;Ee<Ne;++Ee)Le+=String.fromCharCode(u[u.l++]);if(De){var Re=c(u.slice(u.l,u.l+De));(Re[21589]||{}).mt&&(Z=Re[21589].mt),((j||{})[21589]||{}).mt&&(Z=j[21589].mt)}u.l+=De;var ze=u.slice(u.l,u.l+se);switch(K){case 8:ze=P(u,ne);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+K)}var os=!1;_&8&&(Q=u.read_shift(4),Q==134695760&&(Q=u.read_shift(4),os=!0),se=u.read_shift(4),ne=u.read_shift(4)),se!=b&&_t(os,"Bad compressed size: "+b+" != "+se),ne!=v&&_t(os,"Bad uncompressed size: "+v+" != "+ne),Be(y,Le,ze,{unsafe:!0,mt:Z})}function Dt(u,b){var v=b||{},y=[],j=[],_=he(1),K=v.compression?8:0,Z=0,Q=0,se=0,ne=0,Ne=0,De=u.FullPaths[0],Le=De,Ee=u.FileIndex[0],Re=[],ze=0;for(Q=1;Q<u.FullPaths.length;++Q)if(Le=u.FullPaths[Q].slice(De.length),Ee=u.FileIndex[Q],!(!Ee.size||!Ee.content||Le=="Sh33tJ5")){var os=ne,ds=he(Le.length);for(se=0;se<Le.length;++se)ds.write_shift(1,Le.charCodeAt(se)&127);ds=ds.slice(0,ds.l),Re[Ne]=p0.buf(Ee.content,0);var Ls=Ee.content;K==8&&(Ls=T(Ls)),_=he(30),_.write_shift(4,67324752),_.write_shift(2,20),_.write_shift(2,Z),_.write_shift(2,K),Ee.mt?l(_,Ee.mt):_.write_shift(4,0),_.write_shift(-4,Re[Ne]),_.write_shift(4,Ls.length),_.write_shift(4,Ee.content.length),_.write_shift(2,ds.length),_.write_shift(2,0),ne+=_.length,y.push(_),ne+=ds.length,y.push(ds),ne+=Ls.length,y.push(Ls),_=he(46),_.write_shift(4,33639248),_.write_shift(2,0),_.write_shift(2,20),_.write_shift(2,Z),_.write_shift(2,K),_.write_shift(4,0),_.write_shift(-4,Re[Ne]),_.write_shift(4,Ls.length),_.write_shift(4,Ee.content.length),_.write_shift(2,ds.length),_.write_shift(2,0),_.write_shift(2,0),_.write_shift(2,0),_.write_shift(2,0),_.write_shift(4,0),_.write_shift(4,os),ze+=_.l,j.push(_),ze+=ds.length,j.push(ds),++Ne}return _=he(22),_.write_shift(4,101010256),_.write_shift(2,0),_.write_shift(2,0),_.write_shift(2,Ne),_.write_shift(2,Ne),_.write_shift(4,ze),_.write_shift(4,ne),_.write_shift(2,0),Is([Is(y),Is(j),_])}var It={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function wt(u,b){if(u.ctype)return u.ctype;var v=u.name||"",y=v.match(/\.([^\.]+)$/);return y&&It[y[1]]||b&&(y=(v=b).match(/[\.\\]([^\.\\])+$/),y&&It[y[1]])?It[y[1]]:"application/octet-stream"}function Wt(u){for(var b=nr(u),v=[],y=0;y<b.length;y+=76)v.push(b.slice(y,y+76));return v.join(`\r
`)+`\r
`}function $t(u){var b=u.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(se){var ne=se.charCodeAt(0).toString(16).toUpperCase();return"="+(ne.length==1?"0"+ne:ne)});b=b.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),b.charAt(0)==`
`&&(b="=0D"+b.slice(1)),b=b.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var v=[],y=b.split(`\r
`),j=0;j<y.length;++j){var _=y[j];if(_.length==0){v.push("");continue}for(var K=0;K<_.length;){var Z=76,Q=_.slice(K,K+Z);Q.charAt(Z-1)=="="?Z--:Q.charAt(Z-2)=="="?Z-=2:Q.charAt(Z-3)=="="&&(Z-=3),Q=_.slice(K,K+Z),K+=Z,K<_.length&&(Q+="="),v.push(Q)}}return v.join(`\r
`)}function ga(u){for(var b=[],v=0;v<u.length;++v){for(var y=u[v];v<=u.length&&y.charAt(y.length-1)=="=";)y=y.slice(0,y.length-1)+u[++v];b.push(y)}for(var j=0;j<b.length;++j)b[j]=b[j].replace(/[=][0-9A-Fa-f]{2}/g,function(_){return String.fromCharCode(parseInt(_.slice(1),16))});return St(b.join(`\r
`))}function Oa(u,b,v){for(var y="",j="",_="",K,Z=0;Z<10;++Z){var Q=b[Z];if(!Q||Q.match(/^\s*$/))break;var se=Q.match(/^(.*?):\s*([^\s].*)$/);if(se)switch(se[1].toLowerCase()){case"content-location":y=se[2].trim();break;case"content-type":_=se[2].trim();break;case"content-transfer-encoding":j=se[2].trim();break}}switch(++Z,j.toLowerCase()){case"base64":K=St(Ut(b.slice(Z).join("")));break;case"quoted-printable":K=ga(b.slice(Z));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+j)}var ne=Be(u,y.slice(v.length),K,{unsafe:!0});_&&(ne.ctype=_)}function La(u,b){if(Ie(u.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var v=b&&b.root||"",y=(qe&&Buffer.isBuffer(u)?u.toString("binary"):Ie(u)).split(`\r
`),j=0,_="";for(j=0;j<y.length;++j)if(_=y[j],!!/^Content-Location:/i.test(_)&&(_=_.slice(_.indexOf("file")),v||(v=_.slice(0,_.lastIndexOf("/")+1)),_.slice(0,v.length)!=v))for(;v.length>0&&(v=v.slice(0,v.length-1),v=v.slice(0,v.lastIndexOf("/")+1),_.slice(0,v.length)!=v););var K=(y[1]||"").match(/boundary="(.*?)"/);if(!K)throw new Error("MAD cannot find boundary");var Z="--"+(K[1]||""),Q=[],se=[],ne={FileIndex:Q,FullPaths:se};D(ne);var Ne,De=0;for(j=0;j<y.length;++j){var Le=y[j];Le!==Z&&Le!==Z+"--"||(De++&&Oa(ne,y.slice(Ne,j),v),Ne=j)}return ne}function k(u,b){var v=b||{},y=v.boundary||"SheetJS";y="------="+y;for(var j=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+y.slice(2)+'"',"","",""],_=u.FullPaths[0],K=_,Z=u.FileIndex[0],Q=1;Q<u.FullPaths.length;++Q)if(K=u.FullPaths[Q].slice(_.length),Z=u.FileIndex[Q],!(!Z.size||!Z.content||K=="Sh33tJ5")){K=K.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(ze){return"_x"+ze.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(ze){return"_u"+ze.charCodeAt(0).toString(16)+"_"});for(var se=Z.content,ne=qe&&Buffer.isBuffer(se)?se.toString("binary"):Ie(se),Ne=0,De=Math.min(1024,ne.length),Le=0,Ee=0;Ee<=De;++Ee)(Le=ne.charCodeAt(Ee))>=32&&Le<128&&++Ne;var Re=Ne>=De*4/5;j.push(y),j.push("Content-Location: "+(v.root||"file:///C:/SheetJS/")+K),j.push("Content-Transfer-Encoding: "+(Re?"quoted-printable":"base64")),j.push("Content-Type: "+wt(Z,K)),j.push(""),j.push(Re?$t(ne):Wt(ne))}return j.push(y+`--\r
`),j.join(`\r
`)}function fe(u){var b={};return D(b,u),b}function Be(u,b,v,y){var j=y&&y.unsafe;j||D(u);var _=!j&&ts.find(u,b);if(!_){var K=u.FullPaths[0];b.slice(0,K.length)==K?K=b:(K.slice(-1)!="/"&&(K+="/"),K=(K+b).replace("//","/")),_={name:n(b),type:2},u.FileIndex.push(_),u.FullPaths.push(K),j||ts.utils.cfb_gc(u)}return _.content=v,_.size=v?v.length:0,y&&(y.CLSID&&(_.clsid=y.CLSID),y.mt&&(_.mt=y.mt),y.ct&&(_.ct=y.ct)),_}function C(u,b){D(u);var v=ts.find(u,b);if(v){for(var y=0;y<u.FileIndex.length;++y)if(u.FileIndex[y]==v)return u.FileIndex.splice(y,1),u.FullPaths.splice(y,1),!0}return!1}function Te(u,b,v){D(u);var y=ts.find(u,b);if(y){for(var j=0;j<u.FileIndex.length;++j)if(u.FileIndex[j]==y)return u.FileIndex[j].name=n(v),u.FullPaths[j]=v,!0}return!1}function Pe(u){z(u,!0)}return a.find=ce,a.read=oe,a.parse=m,a.write=je,a.writeFile=xe,a.utils={cfb_new:fe,cfb_add:Be,cfb_del:C,cfb_mov:Te,cfb_gc:Pe,ReadShift:Ya,CheckField:Kl,prep_blob:nt,bconcat:Is,use_zlib:N,_deflateRaw:Gs,_inflateRaw:Ye,consts:ke},a}();function v0(s){return typeof s=="string"?en(s):Array.isArray(s)?Wo(s):s}function hr(s,a,t){if(typeof Deno<"u"){if(t&&typeof a=="string")switch(t){case"utf8":a=new TextEncoder(t).encode(a);break;case"binary":a=en(a);break;default:throw new Error("Unsupported encoding "+t)}return Deno.writeFileSync(s,a)}var r=t=="utf8"?lr(a):a;if(typeof IE_SaveFile<"u")return IE_SaveFile(r,s);if(typeof Blob<"u"){var n=new Blob([v0(r)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(n,s);if(typeof saveAs<"u")return saveAs(n,s);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var l=URL.createObjectURL(n);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(l)},6e4),chrome.downloads.download({url:l,filename:s,saveAs:!0});var i=document.createElement("a");if(i.download!=null)return i.download=s,i.href=l,document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(l)},6e4),l}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var c=File(s);return c.open("w"),c.encoding="binary",Array.isArray(a)&&(a=xr(a)),c.write(a),c.close(),a}catch(d){if(!d.message||!d.message.match(/onstruct/))throw d}throw new Error("cannot save file "+s)}function Os(s){for(var a=Object.keys(s),t=[],r=0;r<a.length;++r)Object.prototype.hasOwnProperty.call(s,a[r])&&t.push(a[r]);return t}function Ni(s,a){for(var t=[],r=Os(s),n=0;n!==r.length;++n)t[s[r[n]][a]]==null&&(t[s[r[n]][a]]=r[n]);return t}function Pn(s){for(var a=[],t=Os(s),r=0;r!==t.length;++r)a[s[t[r]]]=t[r];return a}function an(s){for(var a=[],t=Os(s),r=0;r!==t.length;++r)a[s[t[r]]]=parseInt(t[r],10);return a}function w0(s){for(var a=[],t=Os(s),r=0;r!==t.length;++r)a[s[t[r]]]==null&&(a[s[t[r]]]=[]),a[s[t[r]]].push(t[r]);return a}var zr=new Date(1899,11,30,0,0,0);function tt(s,a){var t=s.getTime(),r=zr.getTime()+(s.getTimezoneOffset()-zr.getTimezoneOffset())*6e4;return(t-r)/(24*60*60*1e3)}var Cl=new Date,b0=zr.getTime()+(Cl.getTimezoneOffset()-zr.getTimezoneOffset())*6e4,ji=Cl.getTimezoneOffset();function Al(s){var a=new Date;return a.setTime(s*24*60*60*1e3+b0),a.getTimezoneOffset()!==ji&&a.setTime(a.getTime()+(a.getTimezoneOffset()-ji)*6e4),a}var Si=new Date("2017-02-19T19:06:09.000Z"),Fl=isNaN(Si.getFullYear())?new Date("2/19/17"):Si,y0=Fl.getFullYear()==2017;function Js(s,a){var t=new Date(s);if(y0)return a>0?t.setTime(t.getTime()+t.getTimezoneOffset()*60*1e3):a<0&&t.setTime(t.getTime()-t.getTimezoneOffset()*60*1e3),t;if(s instanceof Date)return s;if(Fl.getFullYear()==1917&&!isNaN(t.getFullYear())){var r=t.getFullYear();return s.indexOf(""+r)>-1||t.setFullYear(t.getFullYear()+100),t}var n=s.match(/\d+/g)||["2017","2","19","0","0","0"],l=new Date(+n[0],+n[1]-1,+n[2],+n[3]||0,+n[4]||0,+n[5]||0);return s.indexOf("Z")>-1&&(l=new Date(l.getTime()-l.getTimezoneOffset()*60*1e3)),l}function rn(s,a){if(qe&&Buffer.isBuffer(s))return s.toString("binary");if(typeof TextDecoder<"u")try{var t={"€":"","‚":"",ƒ:"","„":"","…":"","†":"","‡":"","ˆ":"","‰":"",Š:"","‹":"",Œ:"",Ž:"","‘":"","’":"","“":"","”":"","•":"","–":"","—":"","˜":"","™":"",š:"","›":"",œ:"",ž:"",Ÿ:""};return Array.isArray(s)&&(s=new Uint8Array(s)),new TextDecoder("latin1").decode(s).replace(/[€‚ƒ„…†‡ˆ‰Š‹ŒŽ‘’“”•–—˜™š›œžŸ]/g,function(l){return t[l]||l})}catch{}for(var r=[],n=0;n!=s.length;++n)r.push(String.fromCharCode(s[n]));return r.join("")}function at(s){if(typeof JSON<"u"&&!Array.isArray(s))return JSON.parse(JSON.stringify(s));if(typeof s!="object"||s==null)return s;if(s instanceof Date)return new Date(s.getTime());var a={};for(var t in s)Object.prototype.hasOwnProperty.call(s,t)&&(a[t]=at(s[t]));return a}function us(s,a){for(var t="";t.length<a;)t+=s;return t}function Mt(s){var a=Number(s);if(!isNaN(a))return isFinite(a)?a:NaN;if(!/\d/.test(s))return a;var t=1,r=s.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return t*=100,""});return!isNaN(a=Number(r))||(r=r.replace(/[(](.*)[)]/,function(n,l){return t=-t,l}),!isNaN(a=Number(r)))?a/t:a}var N0=["january","february","march","april","may","june","july","august","september","october","november","december"];function ir(s){var a=new Date(s),t=new Date(NaN),r=a.getYear(),n=a.getMonth(),l=a.getDate();if(isNaN(l))return t;var i=s.toLowerCase();if(i.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(i=i.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),i.length>3&&N0.indexOf(i)==-1)return t}else if(i.match(/[a-z]/))return t;return r<0||r>8099?t:(n>0||l>1)&&r!=101?a:s.match(/[^-0-9:,\/\\]/)?t:a}function $e(s,a,t){if(s.FullPaths){if(typeof t=="string"){var r;return qe?r=Ht(t):r=$o(t),ts.utils.cfb_add(s,a,r)}ts.utils.cfb_add(s,a,t)}else s.file(a,t)}function Rn(){return ts.utils.cfb_new()}var js=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,j0={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},On=Pn(j0),Ln=/[&<>'"]/g,S0=/[\u0000-\u0008\u000b-\u001f]/g;function es(s){var a=s+"";return a.replace(Ln,function(t){return On[t]}).replace(S0,function(t){return"_x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+"_"})}function Ti(s){return es(s).replace(/ /g,"_x0020_")}var Dl=/[\u0000-\u001f]/g;function T0(s){var a=s+"";return a.replace(Ln,function(t){return On[t]}).replace(/\n/g,"<br/>").replace(Dl,function(t){return"&#x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+";"})}function k0(s){var a=s+"";return a.replace(Ln,function(t){return On[t]}).replace(Dl,function(t){return"&#x"+t.charCodeAt(0).toString(16).toUpperCase()+";"})}function _0(s){return s.replace(/(\r\n|[\r\n])/g,"&#10;")}function E0(s){switch(s){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function mn(s){for(var a="",t=0,r=0,n=0,l=0,i=0,c=0;t<s.length;){if(r=s.charCodeAt(t++),r<128){a+=String.fromCharCode(r);continue}if(n=s.charCodeAt(t++),r>191&&r<224){i=(r&31)<<6,i|=n&63,a+=String.fromCharCode(i);continue}if(l=s.charCodeAt(t++),r<240){a+=String.fromCharCode((r&15)<<12|(n&63)<<6|l&63);continue}i=s.charCodeAt(t++),c=((r&7)<<18|(n&63)<<12|(l&63)<<6|i&63)-65536,a+=String.fromCharCode(55296+(c>>>10&1023)),a+=String.fromCharCode(56320+(c&1023))}return a}function ki(s){var a=ca(2*s.length),t,r,n=1,l=0,i=0,c;for(r=0;r<s.length;r+=n)n=1,(c=s.charCodeAt(r))<128?t=c:c<224?(t=(c&31)*64+(s.charCodeAt(r+1)&63),n=2):c<240?(t=(c&15)*4096+(s.charCodeAt(r+1)&63)*64+(s.charCodeAt(r+2)&63),n=3):(n=4,t=(c&7)*262144+(s.charCodeAt(r+1)&63)*4096+(s.charCodeAt(r+2)&63)*64+(s.charCodeAt(r+3)&63),t-=65536,i=55296+(t>>>10&1023),t=56320+(t&1023)),i!==0&&(a[l++]=i&255,a[l++]=i>>>8,i=0),a[l++]=t%256,a[l++]=t>>>8;return a.slice(0,l).toString("ucs2")}function _i(s){return Ht(s,"binary").toString("utf8")}var Er="foo bar bazâð£",Ja=qe&&(_i(Er)==mn(Er)&&_i||ki(Er)==mn(Er)&&ki)||mn,lr=qe?function(s){return Ht(s,"utf8").toString("binary")}:function(s){for(var a=[],t=0,r=0,n=0;t<s.length;)switch(r=s.charCodeAt(t++),!0){case r<128:a.push(String.fromCharCode(r));break;case r<2048:a.push(String.fromCharCode(192+(r>>6))),a.push(String.fromCharCode(128+(r&63)));break;case(r>=55296&&r<57344):r-=55296,n=s.charCodeAt(t++)-56320+(r<<10),a.push(String.fromCharCode(240+(n>>18&7))),a.push(String.fromCharCode(144+(n>>12&63))),a.push(String.fromCharCode(128+(n>>6&63))),a.push(String.fromCharCode(128+(n&63)));break;default:a.push(String.fromCharCode(224+(r>>12))),a.push(String.fromCharCode(128+(r>>6&63))),a.push(String.fromCharCode(128+(r&63)))}return a.join("")},C0=function(){var s=[["nbsp"," "],["middot","·"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(a){return[new RegExp("&"+a[0]+";","ig"),a[1]]});return function(t){for(var r=t.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),n=0;n<s.length;++n)r=r.replace(s[n][0],s[n][1]);return r}}(),Il=/(^\s|\s$|\n)/;function Ps(s,a){return"<"+s+(a.match(Il)?' xml:space="preserve"':"")+">"+a+"</"+s+">"}function cr(s){return Os(s).map(function(a){return" "+a+'="'+s[a]+'"'}).join("")}function Ae(s,a,t){return"<"+s+(t!=null?cr(t):"")+(a!=null?(a.match(Il)?' xml:space="preserve"':"")+">"+a+"</"+s:"/")+">"}function _n(s,a){try{return s.toISOString().replace(/\.\d*/,"")}catch(t){if(a)throw t}return""}function A0(s,a){switch(typeof s){case"string":var t=Ae("vt:lpwstr",es(s));return t=t.replace(/&quot;/g,"_x0022_"),t;case"number":return Ae((s|0)==s?"vt:i4":"vt:r8",es(String(s)));case"boolean":return Ae("vt:bool",s?"true":"false")}if(s instanceof Date)return Ae("vt:filetime",_n(s));throw new Error("Unable to serialize "+s)}var Es={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Da=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],it={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function F0(s,a){for(var t=1-2*(s[a+7]>>>7),r=((s[a+7]&127)<<4)+(s[a+6]>>>4&15),n=s[a+6]&15,l=5;l>=0;--l)n=n*256+s[a+l];return r==2047?n==0?t*(1/0):NaN:(r==0?r=-1022:(r-=1023,n+=Math.pow(2,52)),t*Math.pow(2,r-52)*n)}function D0(s,a,t){var r=(a<0||1/a==-1/0?1:0)<<7,n=0,l=0,i=r?-a:a;isFinite(i)?i==0?n=l=0:(n=Math.floor(Math.log(i)/Math.LN2),l=i*Math.pow(2,52-n),n<=-1023&&(!isFinite(l)||l<Math.pow(2,52))?n=-1022:(l-=Math.pow(2,52),n+=1023)):(n=2047,l=isNaN(a)?26985:0);for(var c=0;c<=5;++c,l/=256)s[t+c]=l&255;s[t+6]=(n&15)<<4|l&15,s[t+7]=n>>4|r}var Ei=function(s){for(var a=[],t=10240,r=0;r<s[0].length;++r)if(s[0][r])for(var n=0,l=s[0][r].length;n<l;n+=t)a.push.apply(a,s[0][r].slice(n,n+t));return a},Ci=qe?function(s){return s[0].length>0&&Buffer.isBuffer(s[0][0])?Buffer.concat(s[0].map(function(a){return Buffer.isBuffer(a)?a:Ht(a)})):Ei(s)}:Ei,Ai=function(s,a,t){for(var r=[],n=a;n<t;n+=2)r.push(String.fromCharCode(Ka(s,n)));return r.join("").replace(Xa,"")},Mn=qe?function(s,a,t){return Buffer.isBuffer(s)?s.toString("utf16le",a,t).replace(Xa,""):Ai(s,a,t)}:Ai,Fi=function(s,a,t){for(var r=[],n=a;n<a+t;++n)r.push(("0"+s[n].toString(16)).slice(-2));return r.join("")},Pl=qe?function(s,a,t){return Buffer.isBuffer(s)?s.toString("hex",a,a+t):Fi(s,a,t)}:Fi,Di=function(s,a,t){for(var r=[],n=a;n<t;n++)r.push(String.fromCharCode(Na(s,n)));return r.join("")},ur=qe?function(a,t,r){return Buffer.isBuffer(a)?a.toString("utf8",t,r):Di(a,t,r)}:Di,Rl=function(s,a){var t=lt(s,a);return t>0?ur(s,a+4,a+4+t-1):""},Ol=Rl,Ll=function(s,a){var t=lt(s,a);return t>0?ur(s,a+4,a+4+t-1):""},Ml=Ll,Bl=function(s,a){var t=2*lt(s,a);return t>0?ur(s,a+4,a+4+t-1):""},Ul=Bl,Gl=function(a,t){var r=lt(a,t);return r>0?Mn(a,t+4,t+4+r):""},Hl=Gl,zl=function(s,a){var t=lt(s,a);return t>0?ur(s,a+4,a+4+t):""},Wl=zl,$l=function(s,a){return F0(s,a)},Wr=$l,Bn=function(a){return Array.isArray(a)||typeof Uint8Array<"u"&&a instanceof Uint8Array};qe&&(Ol=function(a,t){if(!Buffer.isBuffer(a))return Rl(a,t);var r=a.readUInt32LE(t);return r>0?a.toString("utf8",t+4,t+4+r-1):""},Ml=function(a,t){if(!Buffer.isBuffer(a))return Ll(a,t);var r=a.readUInt32LE(t);return r>0?a.toString("utf8",t+4,t+4+r-1):""},Ul=function(a,t){if(!Buffer.isBuffer(a))return Bl(a,t);var r=2*a.readUInt32LE(t);return a.toString("utf16le",t+4,t+4+r-1)},Hl=function(a,t){if(!Buffer.isBuffer(a))return Gl(a,t);var r=a.readUInt32LE(t);return a.toString("utf16le",t+4,t+4+r)},Wl=function(a,t){if(!Buffer.isBuffer(a))return zl(a,t);var r=a.readUInt32LE(t);return a.toString("utf8",t+4,t+4+r)},Wr=function(a,t){return Buffer.isBuffer(a)?a.readDoubleLE(t):$l(a,t)},Bn=function(a){return Buffer.isBuffer(a)||Array.isArray(a)||typeof Uint8Array<"u"&&a instanceof Uint8Array});var Na=function(s,a){return s[a]},Ka=function(s,a){return s[a+1]*256+s[a]},I0=function(s,a){var t=s[a+1]*256+s[a];return t<32768?t:(65535-t+1)*-1},lt=function(s,a){return s[a+3]*(1<<24)+(s[a+2]<<16)+(s[a+1]<<8)+s[a]},aa=function(s,a){return s[a+3]<<24|s[a+2]<<16|s[a+1]<<8|s[a]},P0=function(s,a){return s[a]<<24|s[a+1]<<16|s[a+2]<<8|s[a+3]};function Ya(s,a){var t="",r,n,l=[],i,c,d,o;switch(a){case"dbcs":if(o=this.l,qe&&Buffer.isBuffer(this))t=this.slice(this.l,this.l+2*s).toString("utf16le");else for(d=0;d<s;++d)t+=String.fromCharCode(Ka(this,o)),o+=2;s*=2;break;case"utf8":t=ur(this,this.l,this.l+s);break;case"utf16le":s*=2,t=Mn(this,this.l,this.l+s);break;case"wstr":return Ya.call(this,s,"dbcs");case"lpstr-ansi":t=Ol(this,this.l),s=4+lt(this,this.l);break;case"lpstr-cp":t=Ml(this,this.l),s=4+lt(this,this.l);break;case"lpwstr":t=Ul(this,this.l),s=4+2*lt(this,this.l);break;case"lpp4":s=4+lt(this,this.l),t=Hl(this,this.l),s&2&&(s+=2);break;case"8lpp4":s=4+lt(this,this.l),t=Wl(this,this.l),s&3&&(s+=4-(s&3));break;case"cstr":for(s=0,t="";(i=Na(this,this.l+s++))!==0;)l.push(Tr(i));t=l.join("");break;case"_wstr":for(s=0,t="";(i=Ka(this,this.l+s))!==0;)l.push(Tr(i)),s+=2;s+=2,t=l.join("");break;case"dbcs-cont":for(t="",o=this.l,d=0;d<s;++d){if(this.lens&&this.lens.indexOf(o)!==-1)return i=Na(this,o),this.l=o+1,c=Ya.call(this,s-d,i?"dbcs-cont":"sbcs-cont"),l.join("")+c;l.push(Tr(Ka(this,o))),o+=2}t=l.join(""),s*=2;break;case"cpstr":case"sbcs-cont":for(t="",o=this.l,d=0;d!=s;++d){if(this.lens&&this.lens.indexOf(o)!==-1)return i=Na(this,o),this.l=o+1,c=Ya.call(this,s-d,i?"dbcs-cont":"sbcs-cont"),l.join("")+c;l.push(Tr(Na(this,o))),o+=1}t=l.join("");break;default:switch(s){case 1:return r=Na(this,this.l),this.l++,r;case 2:return r=(a==="i"?I0:Ka)(this,this.l),this.l+=2,r;case 4:case-4:return a==="i"||!(this[this.l+3]&128)?(r=(s>0?aa:P0)(this,this.l),this.l+=4,r):(n=lt(this,this.l),this.l+=4,n);case 8:case-8:if(a==="f")return s==8?n=Wr(this,this.l):n=Wr([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,n;s=8;case 16:t=Pl(this,this.l,s);break}}return this.l+=s,t}var R0=function(s,a,t){s[t]=a&255,s[t+1]=a>>>8&255,s[t+2]=a>>>16&255,s[t+3]=a>>>24&255},O0=function(s,a,t){s[t]=a&255,s[t+1]=a>>8&255,s[t+2]=a>>16&255,s[t+3]=a>>24&255},L0=function(s,a,t){s[t]=a&255,s[t+1]=a>>>8&255};function M0(s,a,t){var r=0,n=0;if(t==="dbcs"){for(n=0;n!=a.length;++n)L0(this,a.charCodeAt(n),this.l+2*n);r=2*a.length}else if(t==="sbcs"){for(a=a.replace(/[^\x00-\x7F]/g,"_"),n=0;n!=a.length;++n)this[this.l+n]=a.charCodeAt(n)&255;r=a.length}else if(t==="hex"){for(;n<s;++n)this[this.l++]=parseInt(a.slice(2*n,2*n+2),16)||0;return this}else if(t==="utf16le"){var l=Math.min(this.l+s,this.length);for(n=0;n<Math.min(a.length,s);++n){var i=a.charCodeAt(n);this[this.l++]=i&255,this[this.l++]=i>>8}for(;this.l<l;)this[this.l++]=0;return this}else switch(s){case 1:r=1,this[this.l]=a&255;break;case 2:r=2,this[this.l]=a&255,a>>>=8,this[this.l+1]=a&255;break;case 3:r=3,this[this.l]=a&255,a>>>=8,this[this.l+1]=a&255,a>>>=8,this[this.l+2]=a&255;break;case 4:r=4,R0(this,a,this.l);break;case 8:if(r=8,t==="f"){D0(this,a,this.l);break}case 16:break;case-4:r=4,O0(this,a,this.l);break}return this.l+=r,this}function Kl(s,a){var t=Pl(this,this.l,s.length>>1);if(t!==s)throw new Error(a+"Expected "+s+" saw "+t);this.l+=s.length>>1}function nt(s,a){s.l=a,s.read_shift=Ya,s.chk=Kl,s.write_shift=M0}function Ft(s,a){s.l+=a}function he(s){var a=ca(s);return nt(a,0),a}function st(){var s=[],a=qe?256:2048,t=function(o){var m=he(o);return nt(m,0),m},r=t(a),n=function(){r&&(r.length>r.l&&(r=r.slice(0,r.l),r.l=r.length),r.length>0&&s.push(r),r=null)},l=function(o){return r&&o<r.length-r.l?r:(n(),r=t(Math.max(o+1,a)))},i=function(){return n(),Is(s)},c=function(o){n(),r=o,r.l==null&&(r.l=r.length),l(a)};return{next:l,push:c,end:i,_bufs:s}}function we(s,a,t,r){var n=+a,l;if(!isNaN(n)){r||(r=Df[n].p||(t||[]).length||0),l=1+(n>=128?1:0)+1,r>=128&&++l,r>=16384&&++l,r>=2097152&&++l;var i=s.next(l);n<=127?i.write_shift(1,n):(i.write_shift(1,(n&127)+128),i.write_shift(1,n>>7));for(var c=0;c!=4;++c)if(r>=128)i.write_shift(1,(r&127)+128),r>>=7;else{i.write_shift(1,r);break}r>0&&Bn(t)&&s.push(t)}}function qa(s,a,t){var r=at(s);if(a.s?(r.cRel&&(r.c+=a.s.c),r.rRel&&(r.r+=a.s.r)):(r.cRel&&(r.c+=a.c),r.rRel&&(r.r+=a.r)),!t||t.biff<12){for(;r.c>=256;)r.c-=256;for(;r.r>=65536;)r.r-=65536}return r}function Ii(s,a,t){var r=at(s);return r.s=qa(r.s,a.s,t),r.e=qa(r.e,a.s,t),r}function Qa(s,a){if(s.cRel&&s.c<0)for(s=at(s);s.c<0;)s.c+=a>8?16384:256;if(s.rRel&&s.r<0)for(s=at(s);s.r<0;)s.r+=a>8?1048576:a>5?65536:16384;var t=ss(s);return!s.cRel&&s.cRel!=null&&(t=G0(t)),!s.rRel&&s.rRel!=null&&(t=B0(t)),t}function xn(s,a){return s.s.r==0&&!s.s.rRel&&s.e.r==(a.biff>=12?1048575:a.biff>=8?65536:16384)&&!s.e.rRel?(s.s.cRel?"":"$")+Bs(s.s.c)+":"+(s.e.cRel?"":"$")+Bs(s.e.c):s.s.c==0&&!s.s.cRel&&s.e.c==(a.biff>=12?16383:255)&&!s.e.cRel?(s.s.rRel?"":"$")+Rs(s.s.r)+":"+(s.e.rRel?"":"$")+Rs(s.e.r):Qa(s.s,a.biff)+":"+Qa(s.e,a.biff)}function Un(s){return parseInt(U0(s),10)-1}function Rs(s){return""+(s+1)}function B0(s){return s.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function U0(s){return s.replace(/\$(\d+)$/,"$1")}function Gn(s){for(var a=H0(s),t=0,r=0;r!==a.length;++r)t=26*t+a.charCodeAt(r)-64;return t-1}function Bs(s){if(s<0)throw new Error("invalid column "+s);var a="";for(++s;s;s=Math.floor((s-1)/26))a=String.fromCharCode((s-1)%26+65)+a;return a}function G0(s){return s.replace(/^([A-Z])/,"$$$1")}function H0(s){return s.replace(/^\$([A-Z])/,"$1")}function z0(s){return s.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Cs(s){for(var a=0,t=0,r=0;r<s.length;++r){var n=s.charCodeAt(r);n>=48&&n<=57?a=10*a+(n-48):n>=65&&n<=90&&(t=26*t+(n-64))}return{c:t-1,r:a-1}}function ss(s){for(var a=s.c+1,t="";a;a=(a-1)/26|0)t=String.fromCharCode((a-1)%26+65)+t;return t+(s.r+1)}function mt(s){var a=s.indexOf(":");return a==-1?{s:Cs(s),e:Cs(s)}:{s:Cs(s.slice(0,a)),e:Cs(s.slice(a+1))}}function Ns(s,a){return typeof a>"u"||typeof a=="number"?Ns(s.s,s.e):(typeof s!="string"&&(s=ss(s)),typeof a!="string"&&(a=ss(a)),s==a?s:s+":"+a)}function is(s){var a={s:{c:0,r:0},e:{c:0,r:0}},t=0,r=0,n=0,l=s.length;for(t=0;r<l&&!((n=s.charCodeAt(r)-64)<1||n>26);++r)t=26*t+n;for(a.s.c=--t,t=0;r<l&&!((n=s.charCodeAt(r)-48)<0||n>9);++r)t=10*t+n;if(a.s.r=--t,r===l||n!=10)return a.e.c=a.s.c,a.e.r=a.s.r,a;for(++r,t=0;r!=l&&!((n=s.charCodeAt(r)-64)<1||n>26);++r)t=26*t+n;for(a.e.c=--t,t=0;r!=l&&!((n=s.charCodeAt(r)-48)<0||n>9);++r)t=10*t+n;return a.e.r=--t,a}function Pi(s,a){var t=s.t=="d"&&a instanceof Date;if(s.z!=null)try{return s.w=Yt(s.z,t?tt(a):a)}catch{}try{return s.w=Yt((s.XF||{}).numFmtId||(t?14:0),t?tt(a):a)}catch{return""+a}}function Gt(s,a,t){return s==null||s.t==null||s.t=="z"?"":s.w!==void 0?s.w:(s.t=="d"&&!s.z&&t&&t.dateNF&&(s.z=t.dateNF),s.t=="e"?fr[s.v]||s.v:a==null?Pi(s,s.v):Pi(s,a))}function ma(s,a){var t=a&&a.sheet?a.sheet:"Sheet1",r={};return r[t]=s,{SheetNames:[t],Sheets:r}}function Vl(s,a,t){var r=t||{},n=s?Array.isArray(s):r.dense,l=s||(n?[]:{}),i=0,c=0;if(l&&r.origin!=null){if(typeof r.origin=="number")i=r.origin;else{var d=typeof r.origin=="string"?Cs(r.origin):r.origin;i=d.r,c=d.c}l["!ref"]||(l["!ref"]="A1:A1")}var o={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(l["!ref"]){var m=is(l["!ref"]);o.s.c=m.s.c,o.s.r=m.s.r,o.e.c=Math.max(o.e.c,m.e.c),o.e.r=Math.max(o.e.r,m.e.r),i==-1&&(o.e.r=i=m.e.r+1)}for(var g=0;g!=a.length;++g)if(a[g]){if(!Array.isArray(a[g]))throw new Error("aoa_to_sheet expects an array of arrays");for(var x=0;x!=a[g].length;++x)if(!(typeof a[g][x]>"u")){var f={v:a[g][x]},p=i+g,h=c+x;if(o.s.r>p&&(o.s.r=p),o.s.c>h&&(o.s.c=h),o.e.r<p&&(o.e.r=p),o.e.c<h&&(o.e.c=h),a[g][x]&&typeof a[g][x]=="object"&&!Array.isArray(a[g][x])&&!(a[g][x]instanceof Date))f=a[g][x];else if(Array.isArray(f.v)&&(f.f=a[g][x][1],f.v=f.v[0]),f.v===null)if(f.f)f.t="n";else if(r.nullError)f.t="e",f.v=0;else if(r.sheetStubs)f.t="z";else continue;else typeof f.v=="number"?f.t="n":typeof f.v=="boolean"?f.t="b":f.v instanceof Date?(f.z=r.dateNF||gs[14],r.cellDates?(f.t="d",f.w=Yt(f.z,tt(f.v))):(f.t="n",f.v=tt(f.v),f.w=Yt(f.z,f.v))):f.t="s";if(n)l[p]||(l[p]=[]),l[p][h]&&l[p][h].z&&(f.z=l[p][h].z),l[p][h]=f;else{var w=ss({c:h,r:p});l[w]&&l[w].z&&(f.z=l[w].z),l[w]=f}}}return o.s.c<1e7&&(l["!ref"]=Ns(o)),l}function Ia(s,a){return Vl(null,s,a)}function W0(s){return s.read_shift(4,"i")}function kt(s,a){return a||(a=he(4)),a.write_shift(4,s),a}function Us(s){var a=s.read_shift(4);return a===0?"":s.read_shift(a,"dbcs")}function As(s,a){var t=!1;return a==null&&(t=!0,a=he(4+2*s.length)),a.write_shift(4,s.length),s.length>0&&a.write_shift(0,s,"dbcs"),t?a.slice(0,a.l):a}function $0(s){return{ich:s.read_shift(2),ifnt:s.read_shift(2)}}function K0(s,a){return a||(a=he(4)),a.write_shift(2,0),a.write_shift(2,0),a}function Hn(s,a){var t=s.l,r=s.read_shift(1),n=Us(s),l=[],i={t:n,h:n};if(r&1){for(var c=s.read_shift(4),d=0;d!=c;++d)l.push($0(s));i.r=l}else i.r=[{ich:0,ifnt:0}];return s.l=t+a,i}function V0(s,a){var t=!1;return a==null&&(t=!0,a=he(15+4*s.t.length)),a.write_shift(1,0),As(s.t,a),t?a.slice(0,a.l):a}var X0=Hn;function J0(s,a){var t=!1;return a==null&&(t=!0,a=he(23+4*s.t.length)),a.write_shift(1,1),As(s.t,a),a.write_shift(4,1),K0({},a),t?a.slice(0,a.l):a}function vt(s){var a=s.read_shift(4),t=s.read_shift(2);return t+=s.read_shift(1)<<16,s.l++,{c:a,iStyleRef:t}}function xa(s,a){return a==null&&(a=he(8)),a.write_shift(-4,s.c),a.write_shift(3,s.iStyleRef||s.s),a.write_shift(1,0),a}function ha(s){var a=s.read_shift(2);return a+=s.read_shift(1)<<16,s.l++,{c:-1,iStyleRef:a}}function ua(s,a){return a==null&&(a=he(4)),a.write_shift(3,s.iStyleRef||s.s),a.write_shift(1,0),a}var Y0=Us,Xl=As;function zn(s){var a=s.read_shift(4);return a===0||a===4294967295?"":s.read_shift(a,"dbcs")}function $r(s,a){var t=!1;return a==null&&(t=!0,a=he(127)),a.write_shift(4,s.length>0?s.length:4294967295),s.length>0&&a.write_shift(0,s,"dbcs"),t?a.slice(0,a.l):a}var q0=Us,En=zn,Wn=$r;function Jl(s){var a=s.slice(s.l,s.l+4),t=a[0]&1,r=a[0]&2;s.l+=4;var n=r===0?Wr([0,0,0,0,a[0]&252,a[1],a[2],a[3]],0):aa(a,0)>>2;return t?n/100:n}function Yl(s,a){a==null&&(a=he(4));var t=0,r=0,n=s*100;if(s==(s|0)&&s>=-536870912&&s<1<<29?r=1:n==(n|0)&&n>=-536870912&&n<1<<29&&(r=1,t=1),r)a.write_shift(-4,((t?n:s)<<2)+(t+2));else throw new Error("unsupported RkNumber "+s)}function ql(s){var a={s:{},e:{}};return a.s.r=s.read_shift(4),a.e.r=s.read_shift(4),a.s.c=s.read_shift(4),a.e.c=s.read_shift(4),a}function Q0(s,a){return a||(a=he(16)),a.write_shift(4,s.s.r),a.write_shift(4,s.e.r),a.write_shift(4,s.s.c),a.write_shift(4,s.e.c),a}var fa=ql,Pa=Q0;function Ra(s){if(s.length-s.l<8)throw"XLS Xnum Buffer underflow";return s.read_shift(8,"f")}function oa(s,a){return(a||he(8)).write_shift(8,s,"f")}function Z0(s){var a={},t=s.read_shift(1),r=t>>>1,n=s.read_shift(1),l=s.read_shift(2,"i"),i=s.read_shift(1),c=s.read_shift(1),d=s.read_shift(1);switch(s.l++,r){case 0:a.auto=1;break;case 1:a.index=n;var o=cd[n];o&&(a.rgb=$i(o));break;case 2:a.rgb=$i([i,c,d]);break;case 3:a.theme=n;break}return l!=0&&(a.tint=l>0?l/32767:l/32768),a}function Kr(s,a){if(a||(a=he(8)),!s||s.auto)return a.write_shift(4,0),a.write_shift(4,0),a;s.index!=null?(a.write_shift(1,2),a.write_shift(1,s.index)):s.theme!=null?(a.write_shift(1,6),a.write_shift(1,s.theme)):(a.write_shift(1,5),a.write_shift(1,0));var t=s.tint||0;if(t>0?t*=32767:t<0&&(t*=32768),a.write_shift(2,t),!s.rgb||s.theme!=null)a.write_shift(2,0),a.write_shift(1,0),a.write_shift(1,0);else{var r=s.rgb||"FFFFFF";typeof r=="number"&&(r=("000000"+r.toString(16)).slice(-6)),a.write_shift(1,parseInt(r.slice(0,2),16)),a.write_shift(1,parseInt(r.slice(2,4),16)),a.write_shift(1,parseInt(r.slice(4,6),16)),a.write_shift(1,255)}return a}function ed(s){var a=s.read_shift(1);s.l++;var t={fBold:a&1,fItalic:a&2,fUnderline:a&4,fStrikeout:a&8,fOutline:a&16,fShadow:a&32,fCondense:a&64,fExtend:a&128};return t}function sd(s,a){a||(a=he(2));var t=(s.italic?2:0)|(s.strike?8:0)|(s.outline?16:0)|(s.shadow?32:0)|(s.condense?64:0)|(s.extend?128:0);return a.write_shift(1,t),a.write_shift(1,0),a}var Ql=2,rt=3,Cr=11,Vr=19,Ar=64,td=65,ad=71,rd=4108,nd=4126,Ds=80,Ri={1:{n:"CodePage",t:Ql},2:{n:"Category",t:Ds},3:{n:"PresentationFormat",t:Ds},4:{n:"ByteCount",t:rt},5:{n:"LineCount",t:rt},6:{n:"ParagraphCount",t:rt},7:{n:"SlideCount",t:rt},8:{n:"NoteCount",t:rt},9:{n:"HiddenCount",t:rt},10:{n:"MultimediaClipCount",t:rt},11:{n:"ScaleCrop",t:Cr},12:{n:"HeadingPairs",t:rd},13:{n:"TitlesOfParts",t:nd},14:{n:"Manager",t:Ds},15:{n:"Company",t:Ds},16:{n:"LinksUpToDate",t:Cr},17:{n:"CharacterCount",t:rt},19:{n:"SharedDoc",t:Cr},22:{n:"HyperlinksChanged",t:Cr},23:{n:"AppVersion",t:rt,p:"version"},24:{n:"DigSig",t:td},26:{n:"ContentType",t:Ds},27:{n:"ContentStatus",t:Ds},28:{n:"Language",t:Ds},29:{n:"Version",t:Ds},255:{},2147483648:{n:"Locale",t:Vr},2147483651:{n:"Behavior",t:Vr},1919054434:{}},Oi={1:{n:"CodePage",t:Ql},2:{n:"Title",t:Ds},3:{n:"Subject",t:Ds},4:{n:"Author",t:Ds},5:{n:"Keywords",t:Ds},6:{n:"Comments",t:Ds},7:{n:"Template",t:Ds},8:{n:"LastAuthor",t:Ds},9:{n:"RevNumber",t:Ds},10:{n:"EditTime",t:Ar},11:{n:"LastPrinted",t:Ar},12:{n:"CreatedDate",t:Ar},13:{n:"ModifiedDate",t:Ar},14:{n:"PageCount",t:rt},15:{n:"WordCount",t:rt},16:{n:"CharCount",t:rt},17:{n:"Thumbnail",t:ad},18:{n:"Application",t:Ds},19:{n:"DocSecurity",t:rt},255:{},2147483648:{n:"Locale",t:Vr},2147483651:{n:"Behavior",t:Vr},1919054434:{}};function id(s){return s.map(function(a){return[a>>16&255,a>>8&255,a&255]})}var ld=id([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),cd=at(ld),fr={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},od={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},Fr={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function Zl(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function ec(s,a){var t=w0(od),r=[],n;r[r.length]=js,r[r.length]=Ae("Types",null,{xmlns:Es.CT,"xmlns:xsd":Es.xsd,"xmlns:xsi":Es.xsi}),r=r.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(d){return Ae("Default",null,{Extension:d[0],ContentType:d[1]})}));var l=function(d){s[d]&&s[d].length>0&&(n=s[d][0],r[r.length]=Ae("Override",null,{PartName:(n[0]=="/"?"":"/")+n,ContentType:Fr[d][a.bookType]||Fr[d].xlsx}))},i=function(d){(s[d]||[]).forEach(function(o){r[r.length]=Ae("Override",null,{PartName:(o[0]=="/"?"":"/")+o,ContentType:Fr[d][a.bookType]||Fr[d].xlsx})})},c=function(d){(s[d]||[]).forEach(function(o){r[r.length]=Ae("Override",null,{PartName:(o[0]=="/"?"":"/")+o,ContentType:t[d][0]})})};return l("workbooks"),i("sheets"),i("charts"),c("themes"),["strs","styles"].forEach(l),["coreprops","extprops","custprops"].forEach(c),c("vba"),c("comments"),c("threadedcomments"),c("drawings"),i("metadata"),c("people"),r.length>2&&(r[r.length]="</Types>",r[1]=r[1].replace("/>",">")),r.join("")}var Je={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function sc(s){var a=s.lastIndexOf("/");return s.slice(0,a+1)+"_rels/"+s.slice(a+1)+".rels"}function _a(s){var a=[js,Ae("Relationships",null,{xmlns:Es.RELS})];return Os(s["!id"]).forEach(function(t){a[a.length]=Ae("Relationship",null,s["!id"][t])}),a.length>2&&(a[a.length]="</Relationships>",a[1]=a[1].replace("/>",">")),a.join("")}function Ze(s,a,t,r,n,l){if(n||(n={}),s["!id"]||(s["!id"]={}),s["!idx"]||(s["!idx"]=1),a<0)for(a=s["!idx"];s["!id"]["rId"+a];++a);if(s["!idx"]=a+1,n.Id="rId"+a,n.Type=r,n.Target=t,[Je.HLINK,Je.XPATH,Je.XMISS].indexOf(n.Type)>-1&&(n.TargetMode="External"),s["!id"][n.Id])throw new Error("Cannot rewrite rId "+a);return s["!id"][n.Id]=n,s[("/"+n.Target).replace("//","/")]=n,a}function dd(s){var a=[js];a.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),a.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var t=0;t<s.length;++t)a.push('  <manifest:file-entry manifest:full-path="'+s[t][0]+'" manifest:media-type="'+s[t][1]+`"/>
`);return a.push("</manifest:manifest>"),a.join("")}function Li(s,a,t){return['  <rdf:Description rdf:about="'+s+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(t||"odf")+"#"+a+`"/>
`,`  </rdf:Description>
`].join("")}function md(s,a){return['  <rdf:Description rdf:about="'+s+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+a+`"/>
`,`  </rdf:Description>
`].join("")}function xd(s){var a=[js];a.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var t=0;t!=s.length;++t)a.push(Li(s[t][0],s[t][1])),a.push(md("",s[t][0]));return a.push(Li("","Document","pkg")),a.push("</rdf:RDF>"),a.join("")}function tc(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+Br.version+"</meta:generator></office:meta></office:document-meta>"}var ia=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function hn(s,a,t,r,n){n[s]!=null||a==null||a===""||(n[s]=a,a=es(a),r[r.length]=t?Ae(s,a,t):Ps(s,a))}function ac(s,a){var t=a||{},r=[js,Ae("cp:coreProperties",null,{"xmlns:cp":Es.CORE_PROPS,"xmlns:dc":Es.dc,"xmlns:dcterms":Es.dcterms,"xmlns:dcmitype":Es.dcmitype,"xmlns:xsi":Es.xsi})],n={};if(!s&&!t.Props)return r.join("");s&&(s.CreatedDate!=null&&hn("dcterms:created",typeof s.CreatedDate=="string"?s.CreatedDate:_n(s.CreatedDate,t.WTF),{"xsi:type":"dcterms:W3CDTF"},r,n),s.ModifiedDate!=null&&hn("dcterms:modified",typeof s.ModifiedDate=="string"?s.ModifiedDate:_n(s.ModifiedDate,t.WTF),{"xsi:type":"dcterms:W3CDTF"},r,n));for(var l=0;l!=ia.length;++l){var i=ia[l],c=t.Props&&t.Props[i[1]]!=null?t.Props[i[1]]:s?s[i[1]]:null;c===!0?c="1":c===!1?c="0":typeof c=="number"&&(c=String(c)),c!=null&&hn(i[0],c,null,r,n)}return r.length>2&&(r[r.length]="</cp:coreProperties>",r[1]=r[1].replace("/>",">")),r.join("")}var Ea=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],rc=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function nc(s){var a=[],t=Ae;return s||(s={}),s.Application="SheetJS",a[a.length]=js,a[a.length]=Ae("Properties",null,{xmlns:Es.EXT_PROPS,"xmlns:vt":Es.vt}),Ea.forEach(function(r){if(s[r[1]]!==void 0){var n;switch(r[2]){case"string":n=es(String(s[r[1]]));break;case"bool":n=s[r[1]]?"true":"false";break}n!==void 0&&(a[a.length]=t(r[0],n))}}),a[a.length]=t("HeadingPairs",t("vt:vector",t("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+t("vt:variant",t("vt:i4",String(s.Worksheets))),{size:2,baseType:"variant"})),a[a.length]=t("TitlesOfParts",t("vt:vector",s.SheetNames.map(function(r){return"<vt:lpstr>"+es(r)+"</vt:lpstr>"}).join(""),{size:s.Worksheets,baseType:"lpstr"})),a.length>2&&(a[a.length]="</Properties>",a[1]=a[1].replace("/>",">")),a.join("")}function ic(s){var a=[js,Ae("Properties",null,{xmlns:Es.CUST_PROPS,"xmlns:vt":Es.vt})];if(!s)return a.join("");var t=1;return Os(s).forEach(function(n){++t,a[a.length]=Ae("property",A0(s[n]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:t,name:es(n)})}),a.length>2&&(a[a.length]="</Properties>",a[1]=a[1].replace("/>",">")),a.join("")}var Mi={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function hd(s,a){var t=[];return Os(Mi).map(function(r){for(var n=0;n<ia.length;++n)if(ia[n][1]==r)return ia[n];for(n=0;n<Ea.length;++n)if(Ea[n][1]==r)return Ea[n];throw r}).forEach(function(r){if(s[r[1]]!=null){var n=a&&a.Props&&a.Props[r[1]]!=null?a.Props[r[1]]:s[r[1]];switch(r[2]){case"date":n=new Date(n).toISOString().replace(/\.\d*Z/,"Z");break}typeof n=="number"?n=String(n):n===!0||n===!1?n=n?"1":"0":n instanceof Date&&(n=new Date(n).toISOString().replace(/\.\d*Z/,"")),t.push(Ps(Mi[r[1]]||r[1],n))}}),Ae("DocumentProperties",t.join(""),{xmlns:it.o})}function ud(s,a){var t=["Worksheets","SheetNames"],r="CustomDocumentProperties",n=[];return s&&Os(s).forEach(function(l){if(Object.prototype.hasOwnProperty.call(s,l)){for(var i=0;i<ia.length;++i)if(l==ia[i][1])return;for(i=0;i<Ea.length;++i)if(l==Ea[i][1])return;for(i=0;i<t.length;++i)if(l==t[i])return;var c=s[l],d="string";typeof c=="number"?(d="float",c=String(c)):c===!0||c===!1?(d="boolean",c=c?"1":"0"):c=String(c),n.push(Ae(Ti(l),c,{"dt:dt":d}))}}),a&&Os(a).forEach(function(l){if(Object.prototype.hasOwnProperty.call(a,l)&&!(s&&Object.prototype.hasOwnProperty.call(s,l))){var i=a[l],c="string";typeof i=="number"?(c="float",i=String(i)):i===!0||i===!1?(c="boolean",i=i?"1":"0"):i instanceof Date?(c="dateTime.tz",i=i.toISOString()):i=String(i),n.push(Ae(Ti(l),i,{"dt:dt":c}))}}),"<"+r+' xmlns="'+it.o+'">'+n.join("")+"</"+r+">"}function fd(s){var a=typeof s=="string"?new Date(Date.parse(s)):s,t=a.getTime()/1e3+11644473600,r=t%Math.pow(2,32),n=(t-r)/Math.pow(2,32);r*=1e7,n*=1e7;var l=r/Math.pow(2,32)|0;l>0&&(r=r%Math.pow(2,32),n+=l);var i=he(8);return i.write_shift(4,r),i.write_shift(4,n),i}function Bi(s,a){var t=he(4),r=he(4);switch(t.write_shift(4,s==80?31:s),s){case 3:r.write_shift(-4,a);break;case 5:r=he(8),r.write_shift(8,a,"f");break;case 11:r.write_shift(4,a?1:0);break;case 64:r=fd(a);break;case 31:case 80:for(r=he(4+2*(a.length+1)+(a.length%2?0:2)),r.write_shift(4,a.length+1),r.write_shift(0,a,"dbcs");r.l!=r.length;)r.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+s+" "+a)}return Is([t,r])}var lc=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function gd(s){switch(typeof s){case"boolean":return 11;case"number":return(s|0)==s?3:5;case"string":return 31;case"object":if(s instanceof Date)return 64;break}return-1}function Ui(s,a,t){var r=he(8),n=[],l=[],i=8,c=0,d=he(8),o=he(8);if(d.write_shift(4,2),d.write_shift(4,1200),o.write_shift(4,1),l.push(d),n.push(o),i+=8+d.length,!a){o=he(8),o.write_shift(4,0),n.unshift(o);var m=[he(4)];for(m[0].write_shift(4,s.length),c=0;c<s.length;++c){var g=s[c][0];for(d=he(8+2*(g.length+1)+(g.length%2?0:2)),d.write_shift(4,c+2),d.write_shift(4,g.length+1),d.write_shift(0,g,"dbcs");d.l!=d.length;)d.write_shift(1,0);m.push(d)}d=Is(m),l.unshift(d),i+=8+d.length}for(c=0;c<s.length;++c)if(!(a&&!a[s[c][0]])&&!(lc.indexOf(s[c][0])>-1||rc.indexOf(s[c][0])>-1)&&s[c][1]!=null){var x=s[c][1],f=0;if(a){f=+a[s[c][0]];var p=t[f];if(p.p=="version"&&typeof x=="string"){var h=x.split(".");x=(+h[0]<<16)+(+h[1]||0)}d=Bi(p.t,x)}else{var w=gd(x);w==-1&&(w=31,x=String(x)),d=Bi(w,x)}l.push(d),o=he(8),o.write_shift(4,a?f:2+c),n.push(o),i+=8+d.length}var L=8*(l.length+1);for(c=0;c<l.length;++c)n[c].write_shift(4,L),L+=l[c].length;return r.write_shift(4,i),r.write_shift(4,l.length),Is([r].concat(n).concat(l))}function Gi(s,a,t,r,n,l){var i=he(n?68:48),c=[i];i.write_shift(2,65534),i.write_shift(2,0),i.write_shift(4,842412599),i.write_shift(16,ts.utils.consts.HEADER_CLSID,"hex"),i.write_shift(4,n?2:1),i.write_shift(16,a,"hex"),i.write_shift(4,n?68:48);var d=Ui(s,t,r);if(c.push(d),n){var o=Ui(n,null,null);i.write_shift(16,l,"hex"),i.write_shift(4,68+d.length),c.push(o)}return Is(c)}function pd(s,a){a||(a=he(s));for(var t=0;t<s;++t)a.write_shift(1,0);return a}function vd(s,a){return s.read_shift(a)===1}function zs(s,a){return a||(a=he(2)),a.write_shift(2,+!!s),a}function cc(s){return s.read_shift(2,"u")}function ut(s,a){return a||(a=he(2)),a.write_shift(2,s),a}function oc(s,a,t){return t||(t=he(2)),t.write_shift(1,a=="e"?+s:+!!s),t.write_shift(1,a=="e"?1:0),t}function dc(s,a,t){var r=s.read_shift(t&&t.biff>=12?2:1),n="sbcs-cont";if(t&&t.biff>=8,!t||t.biff==8){var l=s.read_shift(1);l&&(n="dbcs-cont")}else t.biff==12&&(n="wstr");t.biff>=2&&t.biff<=5&&(n="cpstr");var i=r?s.read_shift(r,n):"";return i}function wd(s){var a=s.t||"",t=he(3);t.write_shift(2,a.length),t.write_shift(1,1);var r=he(2*a.length);r.write_shift(2*a.length,a,"utf16le");var n=[t,r];return Is(n)}function bd(s,a,t){var r;if(t){if(t.biff>=2&&t.biff<=5)return s.read_shift(a,"cpstr");if(t.biff>=12)return s.read_shift(a,"dbcs-cont")}var n=s.read_shift(1);return n===0?r=s.read_shift(a,"sbcs-cont"):r=s.read_shift(a,"dbcs-cont"),r}function yd(s,a,t){var r=s.read_shift(t&&t.biff==2?1:2);return r===0?(s.l++,""):bd(s,r,t)}function Nd(s,a,t){if(t.biff>5)return yd(s,a,t);var r=s.read_shift(1);return r===0?(s.l++,""):s.read_shift(r,t.biff<=4||!s.lens?"cpstr":"sbcs-cont")}function mc(s,a,t){return t||(t=he(3+2*s.length)),t.write_shift(2,s.length),t.write_shift(1,1),t.write_shift(31,s,"utf16le"),t}function Hi(s,a){a||(a=he(6+s.length*2)),a.write_shift(4,1+s.length);for(var t=0;t<s.length;++t)a.write_shift(2,s.charCodeAt(t));return a.write_shift(2,0),a}function jd(s){var a=he(512),t=0,r=s.Target;r.slice(0,7)=="file://"&&(r=r.slice(7));var n=r.indexOf("#"),l=n>-1?31:23;switch(r.charAt(0)){case"#":l=28;break;case".":l&=-3;break}a.write_shift(4,2),a.write_shift(4,l);var i=[8,6815827,6619237,4849780,83];for(t=0;t<i.length;++t)a.write_shift(4,i[t]);if(l==28)r=r.slice(1),Hi(r,a);else if(l&2){for(i="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),t=0;t<i.length;++t)a.write_shift(1,parseInt(i[t],16));var c=n>-1?r.slice(0,n):r;for(a.write_shift(4,2*(c.length+1)),t=0;t<c.length;++t)a.write_shift(2,c.charCodeAt(t));a.write_shift(2,0),l&8&&Hi(n>-1?r.slice(n+1):"",a)}else{for(i="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),t=0;t<i.length;++t)a.write_shift(1,parseInt(i[t],16));for(var d=0;r.slice(d*3,d*3+3)=="../"||r.slice(d*3,d*3+3)=="..\\";)++d;for(a.write_shift(2,d),a.write_shift(4,r.length-3*d+1),t=0;t<r.length-3*d;++t)a.write_shift(1,r.charCodeAt(t+3*d)&255);for(a.write_shift(1,0),a.write_shift(2,65535),a.write_shift(2,57005),t=0;t<6;++t)a.write_shift(4,0)}return a.slice(0,a.l)}function da(s,a,t,r){return r||(r=he(6)),r.write_shift(2,s),r.write_shift(2,a),r.write_shift(2,t||0),r}function Sd(s,a,t){var r=t.biff>8?4:2,n=s.read_shift(r),l=s.read_shift(r,"i"),i=s.read_shift(r,"i");return[n,l,i]}function Td(s){var a=s.read_shift(2),t=s.read_shift(2),r=s.read_shift(2),n=s.read_shift(2);return{s:{c:r,r:a},e:{c:n,r:t}}}function xc(s,a){return a||(a=he(8)),a.write_shift(2,s.s.r),a.write_shift(2,s.e.r),a.write_shift(2,s.s.c),a.write_shift(2,s.e.c),a}function $n(s,a,t){var r=1536,n=16;switch(t.bookType){case"biff8":break;case"biff5":r=1280,n=8;break;case"biff4":r=4,n=6;break;case"biff3":r=3,n=6;break;case"biff2":r=2,n=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var l=he(n);return l.write_shift(2,r),l.write_shift(2,a),n>4&&l.write_shift(2,29282),n>6&&l.write_shift(2,1997),n>8&&(l.write_shift(2,49161),l.write_shift(2,1),l.write_shift(2,1798),l.write_shift(2,0)),l}function kd(s,a){var t=!a||a.biff==8,r=he(t?112:54);for(r.write_shift(a.biff==8?2:1,7),t&&r.write_shift(1,0),r.write_shift(4,859007059),r.write_shift(4,5458548|(t?0:536870912));r.l<r.length;)r.write_shift(1,t?0:32);return r}function _d(s,a){var t=!a||a.biff>=8?2:1,r=he(8+t*s.name.length);r.write_shift(4,s.pos),r.write_shift(1,s.hs||0),r.write_shift(1,s.dt),r.write_shift(1,s.name.length),a.biff>=8&&r.write_shift(1,1),r.write_shift(t*s.name.length,s.name,a.biff<8?"sbcs":"utf16le");var n=r.slice(0,r.l);return n.l=r.l,n}function Ed(s,a){var t=he(8);t.write_shift(4,s.Count),t.write_shift(4,s.Unique);for(var r=[],n=0;n<s.length;++n)r[n]=wd(s[n]);var l=Is([t].concat(r));return l.parts=[t.length].concat(r.map(function(i){return i.length})),l}function Cd(){var s=he(18);return s.write_shift(2,0),s.write_shift(2,0),s.write_shift(2,29280),s.write_shift(2,17600),s.write_shift(2,56),s.write_shift(2,0),s.write_shift(2,0),s.write_shift(2,1),s.write_shift(2,500),s}function Ad(s){var a=he(18),t=1718;return s&&s.RTL&&(t|=64),a.write_shift(2,t),a.write_shift(4,0),a.write_shift(4,64),a.write_shift(4,0),a.write_shift(4,0),a}function Fd(s,a){var t=s.name||"Arial",r=a&&a.biff==5,n=r?15+t.length:16+2*t.length,l=he(n);return l.write_shift(2,s.sz*20),l.write_shift(4,0),l.write_shift(2,400),l.write_shift(4,0),l.write_shift(2,0),l.write_shift(1,t.length),r||l.write_shift(1,1),l.write_shift((r?1:2)*t.length,t,r?"sbcs":"utf16le"),l}function Dd(s,a,t,r){var n=he(10);return da(s,a,r,n),n.write_shift(4,t),n}function Id(s,a,t,r,n){var l=!n||n.biff==8,i=he(8+ +l+(1+l)*t.length);return da(s,a,r,i),i.write_shift(2,t.length),l&&i.write_shift(1,1),i.write_shift((1+l)*t.length,t,l?"utf16le":"sbcs"),i}function Pd(s,a,t,r){var n=t&&t.biff==5;r||(r=he(n?3+a.length:5+2*a.length)),r.write_shift(2,s),r.write_shift(n?1:2,a.length),n||r.write_shift(1,1),r.write_shift((n?1:2)*a.length,a,n?"sbcs":"utf16le");var l=r.length>r.l?r.slice(0,r.l):r;return l.l==null&&(l.l=l.length),l}function Rd(s,a){var t=a.biff==8||!a.biff?4:2,r=he(2*t+6);return r.write_shift(t,s.s.r),r.write_shift(t,s.e.r+1),r.write_shift(2,s.s.c),r.write_shift(2,s.e.c+1),r.write_shift(2,0),r}function zi(s,a,t,r){var n=t&&t.biff==5;r||(r=he(n?16:20)),r.write_shift(2,0),s.style?(r.write_shift(2,s.numFmtId||0),r.write_shift(2,65524)):(r.write_shift(2,s.numFmtId||0),r.write_shift(2,a<<4));var l=0;return s.numFmtId>0&&n&&(l|=1024),r.write_shift(4,l),r.write_shift(4,0),n||r.write_shift(4,0),r.write_shift(2,0),r}function Od(s){var a=he(8);return a.write_shift(4,0),a.write_shift(2,0),a.write_shift(2,0),a}function Ld(s,a,t,r,n,l){var i=he(8);return da(s,a,r,i),oc(t,l,i),i}function Md(s,a,t,r){var n=he(14);return da(s,a,r,n),oa(t,n),n}function Bd(s,a,t){if(t.biff<8)return Ud(s,a,t);for(var r=[],n=s.l+a,l=s.read_shift(t.biff>8?4:2);l--!==0;)r.push(Sd(s,t.biff>8?12:6,t));if(s.l!=n)throw new Error("Bad ExternSheet: "+s.l+" != "+n);return r}function Ud(s,a,t){s[s.l+1]==3&&s[s.l]++;var r=dc(s,a,t);return r.charCodeAt(0)==3?r.slice(1):r}function Gd(s){var a=he(2+s.length*8);a.write_shift(2,s.length);for(var t=0;t<s.length;++t)xc(s[t],a);return a}function Hd(s){var a=he(24),t=Cs(s[0]);a.write_shift(2,t.r),a.write_shift(2,t.r),a.write_shift(2,t.c),a.write_shift(2,t.c);for(var r="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),n=0;n<16;++n)a.write_shift(1,parseInt(r[n],16));return Is([a,jd(s[1])])}function zd(s){var a=s[1].Tooltip,t=he(10+2*(a.length+1));t.write_shift(2,2048);var r=Cs(s[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var n=0;n<a.length;++n)t.write_shift(2,a.charCodeAt(n));return t.write_shift(2,0),t}function Wd(s){return s||(s=he(4)),s.write_shift(2,1),s.write_shift(2,1),s}function $d(s,a,t){if(!t.cellStyles)return Ft(s,a);var r=t&&t.biff>=12?4:2,n=s.read_shift(r),l=s.read_shift(r),i=s.read_shift(r),c=s.read_shift(r),d=s.read_shift(2);r==2&&(s.l+=2);var o={s:n,e:l,w:i,ixfe:c,flags:d};return(t.biff>=5||!t.biff)&&(o.level=d>>8&7),o}function Kd(s,a){var t=he(12);t.write_shift(2,a),t.write_shift(2,a),t.write_shift(2,s.width*256),t.write_shift(2,0);var r=0;return s.hidden&&(r|=1),t.write_shift(1,r),r=s.level||0,t.write_shift(1,r),t.write_shift(2,0),t}function Vd(s){for(var a=he(2*s),t=0;t<s;++t)a.write_shift(2,t+1);return a}function Xd(s,a,t){var r=he(15);return pr(r,s,a),r.write_shift(8,t,"f"),r}function Jd(s,a,t){var r=he(9);return pr(r,s,a),r.write_shift(2,t),r}var Yd=function(){var s={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},a=Pn({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function t(c,d){var o=[],m=ca(1);switch(d.type){case"base64":m=St(Ut(c));break;case"binary":m=St(c);break;case"buffer":case"array":m=c;break}nt(m,0);var g=m.read_shift(1),x=!!(g&136),f=!1,p=!1;switch(g){case 2:break;case 3:break;case 48:f=!0,x=!0;break;case 49:f=!0,x=!0;break;case 131:break;case 139:break;case 140:p=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+g.toString(16))}var h=0,w=521;g==2&&(h=m.read_shift(2)),m.l+=3,g!=2&&(h=m.read_shift(4)),h>1048576&&(h=1e6),g!=2&&(w=m.read_shift(2));var L=m.read_shift(2),O=d.codepage||1252;g!=2&&(m.l+=16,m.read_shift(1),m[m.l]!==0&&(O=s[m[m.l]]),m.l+=1,m.l+=2),p&&(m.l+=36);for(var I=[],H={},ae=Math.min(m.length,g==2?521:w-10-(f?264:0)),oe=p?32:11;m.l<ae&&m[m.l]!=13;)switch(H={},H.name=hi.utils.decode(O,m.slice(m.l,m.l+oe)).replace(/[\u0000\r\n].*$/g,""),m.l+=oe,H.type=String.fromCharCode(m.read_shift(1)),g!=2&&!p&&(H.offset=m.read_shift(4)),H.len=m.read_shift(1),g==2&&(H.offset=m.read_shift(2)),H.dec=m.read_shift(1),H.name.length&&I.push(H),g!=2&&(m.l+=p?13:14),H.type){case"B":(!f||H.len!=8)&&d.WTF&&console.log("Skipping "+H.name+":"+H.type);break;case"G":case"P":d.WTF&&console.log("Skipping "+H.name+":"+H.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+H.type)}if(m[m.l]!==13&&(m.l=w-1),m.read_shift(1)!==13)throw new Error("DBF Terminator not found "+m.l+" "+m[m.l]);m.l=w;var D=0,q=0;for(o[0]=[],q=0;q!=I.length;++q)o[0][q]=I[q].name;for(;h-- >0;){if(m[m.l]===42){m.l+=L;continue}for(++m.l,o[++D]=[],q=0,q=0;q!=I.length;++q){var z=m.slice(m.l,m.l+I[q].len);m.l+=I[q].len,nt(z,0);var G=hi.utils.decode(O,z);switch(I[q].type){case"C":G.trim().length&&(o[D][q]=G.replace(/\s+$/,""));break;case"D":G.length===8?o[D][q]=new Date(+G.slice(0,4),+G.slice(4,6)-1,+G.slice(6,8)):o[D][q]=G;break;case"F":o[D][q]=parseFloat(G.trim());break;case"+":case"I":o[D][q]=p?z.read_shift(-4,"i")^2147483648:z.read_shift(4,"i");break;case"L":switch(G.trim().toUpperCase()){case"Y":case"T":o[D][q]=!0;break;case"N":case"F":o[D][q]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+G+"|")}break;case"M":if(!x)throw new Error("DBF Unexpected MEMO for type "+g.toString(16));o[D][q]="##MEMO##"+(p?parseInt(G.trim(),10):z.read_shift(4));break;case"N":G=G.replace(/\u0000/g,"").trim(),G&&G!="."&&(o[D][q]=+G||0);break;case"@":o[D][q]=new Date(z.read_shift(-8,"f")-621356832e5);break;case"T":o[D][q]=new Date((z.read_shift(4)-2440588)*864e5+z.read_shift(4));break;case"Y":o[D][q]=z.read_shift(4,"i")/1e4+z.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":o[D][q]=-z.read_shift(-8,"f");break;case"B":if(f&&I[q].len==8){o[D][q]=z.read_shift(8,"f");break}case"G":case"P":z.l+=I[q].len;break;case"0":if(I[q].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+I[q].type)}}}if(g!=2&&m.l<m.length&&m[m.l++]!=26)throw new Error("DBF EOF Marker missing "+(m.l-1)+" of "+m.length+" "+m[m.l-1].toString(16));return d&&d.sheetRows&&(o=o.slice(0,d.sheetRows)),d.DBF=I,o}function r(c,d){var o=d||{};o.dateNF||(o.dateNF="yyyymmdd");var m=Ia(t(c,o),o);return m["!cols"]=o.DBF.map(function(g){return{wch:g.len,DBF:g}}),delete o.DBF,m}function n(c,d){try{return ma(r(c,d),d)}catch(o){if(d&&d.WTF)throw o}return{SheetNames:[],Sheets:{}}}var l={B:8,C:250,L:1,D:8,"?":0,"":0};function i(c,d){var o=d||{};if(+o.codepage>=0&&rr(+o.codepage),o.type=="string")throw new Error("Cannot write DBF to JS string");var m=st(),g=Qr(c,{header:1,raw:!0,cellDates:!0}),x=g[0],f=g.slice(1),p=c["!cols"]||[],h=0,w=0,L=0,O=1;for(h=0;h<x.length;++h){if(((p[h]||{}).DBF||{}).name){x[h]=p[h].DBF.name,++L;continue}if(x[h]!=null){if(++L,typeof x[h]=="number"&&(x[h]=x[h].toString(10)),typeof x[h]!="string")throw new Error("DBF Invalid column name "+x[h]+" |"+typeof x[h]+"|");if(x.indexOf(x[h])!==h){for(w=0;w<1024;++w)if(x.indexOf(x[h]+"_"+w)==-1){x[h]+="_"+w;break}}}}var I=is(c["!ref"]),H=[],ae=[],oe=[];for(h=0;h<=I.e.c-I.s.c;++h){var D="",q="",z=0,G=[];for(w=0;w<f.length;++w)f[w][h]!=null&&G.push(f[w][h]);if(G.length==0||x[h]==null){H[h]="?";continue}for(w=0;w<G.length;++w){switch(typeof G[w]){case"number":q="B";break;case"string":q="C";break;case"boolean":q="L";break;case"object":q=G[w]instanceof Date?"D":"C";break;default:q="C"}z=Math.max(z,String(G[w]).length),D=D&&D!=q?"C":q}z>250&&(z=250),q=((p[h]||{}).DBF||{}).type,q=="C"&&p[h].DBF.len>z&&(z=p[h].DBF.len),D=="B"&&q=="N"&&(D="N",oe[h]=p[h].DBF.dec,z=p[h].DBF.len),ae[h]=D=="C"||q=="N"?z:l[D]||0,O+=ae[h],H[h]=D}var ce=m.next(32);for(ce.write_shift(4,318902576),ce.write_shift(4,f.length),ce.write_shift(2,296+32*L),ce.write_shift(2,O),h=0;h<4;++h)ce.write_shift(4,0);for(ce.write_shift(4,0|(+a[ul]||3)<<8),h=0,w=0;h<x.length;++h)if(x[h]!=null){var M=m.next(32),W=(x[h].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);M.write_shift(1,W,"sbcs"),M.write_shift(1,H[h]=="?"?"C":H[h],"sbcs"),M.write_shift(4,w),M.write_shift(1,ae[h]||l[H[h]]||0),M.write_shift(1,oe[h]||0),M.write_shift(1,2),M.write_shift(4,0),M.write_shift(1,0),M.write_shift(4,0),M.write_shift(4,0),w+=ae[h]||l[H[h]]||0}var re=m.next(264);for(re.write_shift(4,13),h=0;h<65;++h)re.write_shift(4,0);for(h=0;h<f.length;++h){var ve=m.next(O);for(ve.write_shift(1,0),w=0;w<x.length;++w)if(x[w]!=null)switch(H[w]){case"L":ve.write_shift(1,f[h][w]==null?63:f[h][w]?84:70);break;case"B":ve.write_shift(8,f[h][w]||0,"f");break;case"N":var te="0";for(typeof f[h][w]=="number"&&(te=f[h][w].toFixed(oe[w]||0)),L=0;L<ae[w]-te.length;++L)ve.write_shift(1,32);ve.write_shift(1,te,"sbcs");break;case"D":f[h][w]?(ve.write_shift(4,("0000"+f[h][w].getFullYear()).slice(-4),"sbcs"),ve.write_shift(2,("00"+(f[h][w].getMonth()+1)).slice(-2),"sbcs"),ve.write_shift(2,("00"+f[h][w].getDate()).slice(-2),"sbcs")):ve.write_shift(8,"00000000","sbcs");break;case"C":var ke=String(f[h][w]!=null?f[h][w]:"").slice(0,ae[w]);for(ve.write_shift(1,ke,"sbcs"),L=0;L<ae[w]-ke.length;++L)ve.write_shift(1,32);break}}return m.next(1).write_shift(1,26),m.end()}return{to_workbook:n,to_sheet:r,from_sheet:i}}(),qd=function(){var s={AA:"À",BA:"Á",CA:"Â",DA:195,HA:"Ä",JA:197,AE:"È",BE:"É",CE:"Ê",HE:"Ë",AI:"Ì",BI:"Í",CI:"Î",HI:"Ï",AO:"Ò",BO:"Ó",CO:"Ô",DO:213,HO:"Ö",AU:"Ù",BU:"Ú",CU:"Û",HU:"Ü",Aa:"à",Ba:"á",Ca:"â",Da:227,Ha:"ä",Ja:229,Ae:"è",Be:"é",Ce:"ê",He:"ë",Ai:"ì",Bi:"í",Ci:"î",Hi:"ï",Ao:"ò",Bo:"ó",Co:"ô",Do:245,Ho:"ö",Au:"ù",Bu:"ú",Cu:"û",Hu:"ü",KC:"Ç",Kc:"ç",q:"æ",z:"œ",a:"Æ",j:"Œ",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},a=new RegExp("\x1BN("+Os(s).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),t=function(x,f){var p=s[f];return typeof p=="number"?xi(p):p},r=function(x,f,p){var h=f.charCodeAt(0)-32<<4|p.charCodeAt(0)-48;return h==59?x:xi(h)};s["|"]=254;function n(x,f){switch(f.type){case"base64":return l(Ut(x),f);case"binary":return l(x,f);case"buffer":return l(qe&&Buffer.isBuffer(x)?x.toString("binary"):xr(x),f);case"array":return l(rn(x),f)}throw new Error("Unrecognized type "+f.type)}function l(x,f){var p=x.split(/[\n\r]+/),h=-1,w=-1,L=0,O=0,I=[],H=[],ae=null,oe={},D=[],q=[],z=[],G=0,ce;for(+f.codepage>=0&&rr(+f.codepage);L!==p.length;++L){G=0;var M=p[L].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,r).replace(a,t),W=M.replace(/;;/g,"\0").split(";").map(function(A){return A.replace(/\u0000/g,";")}),re=W[0],ve;if(M.length>0)switch(re){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":W[1].charAt(0)=="P"&&H.push(M.slice(3).replace(/;;/g,";"));break;case"C":var te=!1,ke=!1,xe=!1,Ie=!1,je=-1,Oe=-1;for(O=1;O<W.length;++O)switch(W[O].charAt(0)){case"A":break;case"X":w=parseInt(W[O].slice(1))-1,ke=!0;break;case"Y":for(h=parseInt(W[O].slice(1))-1,ke||(w=0),ce=I.length;ce<=h;++ce)I[ce]=[];break;case"K":ve=W[O].slice(1),ve.charAt(0)==='"'?ve=ve.slice(1,ve.length-1):ve==="TRUE"?ve=!0:ve==="FALSE"?ve=!1:isNaN(Mt(ve))?isNaN(ir(ve).getDate())||(ve=Js(ve)):(ve=Mt(ve),ae!==null&&kl(ae)&&(ve=Al(ve))),te=!0;break;case"E":Ie=!0;var N=Jm(W[O].slice(1),{r:h,c:w});I[h][w]=[I[h][w],N];break;case"S":xe=!0,I[h][w]=[I[h][w],"S5S"];break;case"G":break;case"R":je=parseInt(W[O].slice(1))-1;break;case"C":Oe=parseInt(W[O].slice(1))-1;break;default:if(f&&f.WTF)throw new Error("SYLK bad record "+M)}if(te&&(I[h][w]&&I[h][w].length==2?I[h][w][0]=ve:I[h][w]=ve,ae=null),xe){if(Ie)throw new Error("SYLK shared formula cannot have own formula");var P=je>-1&&I[je][Oe];if(!P||!P[1])throw new Error("SYLK shared formula cannot find base");I[h][w][1]=Ym(P[1],{r:h-je,c:w-Oe})}break;case"F":var T=0;for(O=1;O<W.length;++O)switch(W[O].charAt(0)){case"X":w=parseInt(W[O].slice(1))-1,++T;break;case"Y":for(h=parseInt(W[O].slice(1))-1,ce=I.length;ce<=h;++ce)I[ce]=[];break;case"M":G=parseInt(W[O].slice(1))/20;break;case"F":break;case"G":break;case"P":ae=H[parseInt(W[O].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(z=W[O].slice(1).split(" "),ce=parseInt(z[0],10);ce<=parseInt(z[1],10);++ce)G=parseInt(z[2],10),q[ce-1]=G===0?{hidden:!0}:{wch:G},Kn(q[ce-1]);break;case"C":w=parseInt(W[O].slice(1))-1,q[w]||(q[w]={});break;case"R":h=parseInt(W[O].slice(1))-1,D[h]||(D[h]={}),G>0?(D[h].hpt=G,D[h].hpx=pc(G)):G===0&&(D[h].hidden=!0);break;default:if(f&&f.WTF)throw new Error("SYLK bad record "+M)}T<1&&(ae=null);break;default:if(f&&f.WTF)throw new Error("SYLK bad record "+M)}}return D.length>0&&(oe["!rows"]=D),q.length>0&&(oe["!cols"]=q),f&&f.sheetRows&&(I=I.slice(0,f.sheetRows)),[I,oe]}function i(x,f){var p=n(x,f),h=p[0],w=p[1],L=Ia(h,f);return Os(w).forEach(function(O){L[O]=w[O]}),L}function c(x,f){return ma(i(x,f),f)}function d(x,f,p,h){var w="C;Y"+(p+1)+";X"+(h+1)+";K";switch(x.t){case"n":w+=x.v||0,x.f&&!x.F&&(w+=";E"+Xn(x.f,{r:p,c:h}));break;case"b":w+=x.v?"TRUE":"FALSE";break;case"e":w+=x.w||x.v;break;case"d":w+='"'+(x.w||x.v)+'"';break;case"s":w+='"'+x.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return w}function o(x,f){f.forEach(function(p,h){var w="F;W"+(h+1)+" "+(h+1)+" ";p.hidden?w+="0":(typeof p.width=="number"&&!p.wpx&&(p.wpx=Xr(p.width)),typeof p.wpx=="number"&&!p.wch&&(p.wch=Jr(p.wpx)),typeof p.wch=="number"&&(w+=Math.round(p.wch))),w.charAt(w.length-1)!=" "&&x.push(w)})}function m(x,f){f.forEach(function(p,h){var w="F;";p.hidden?w+="M0;":p.hpt?w+="M"+20*p.hpt+";":p.hpx&&(w+="M"+20*Yr(p.hpx)+";"),w.length>2&&x.push(w+"R"+(h+1))})}function g(x,f){var p=["ID;PWXL;N;E"],h=[],w=is(x["!ref"]),L,O=Array.isArray(x),I=`\r
`;p.push("P;PGeneral"),p.push("F;P0;DG0G8;M255"),x["!cols"]&&o(p,x["!cols"]),x["!rows"]&&m(p,x["!rows"]),p.push("B;Y"+(w.e.r-w.s.r+1)+";X"+(w.e.c-w.s.c+1)+";D"+[w.s.c,w.s.r,w.e.c,w.e.r].join(" "));for(var H=w.s.r;H<=w.e.r;++H)for(var ae=w.s.c;ae<=w.e.c;++ae){var oe=ss({r:H,c:ae});L=O?(x[H]||[])[ae]:x[oe],!(!L||L.v==null&&(!L.f||L.F))&&h.push(d(L,x,H,ae))}return p.join(I)+I+h.join(I)+I+"E"+I}return{to_workbook:c,to_sheet:i,from_sheet:g}}(),Qd=function(){function s(l,i){switch(i.type){case"base64":return a(Ut(l),i);case"binary":return a(l,i);case"buffer":return a(qe&&Buffer.isBuffer(l)?l.toString("binary"):xr(l),i);case"array":return a(rn(l),i)}throw new Error("Unrecognized type "+i.type)}function a(l,i){for(var c=l.split(`
`),d=-1,o=-1,m=0,g=[];m!==c.length;++m){if(c[m].trim()==="BOT"){g[++d]=[],o=0;continue}if(!(d<0)){var x=c[m].trim().split(","),f=x[0],p=x[1];++m;for(var h=c[m]||"";(h.match(/["]/g)||[]).length&1&&m<c.length-1;)h+=`
`+c[++m];switch(h=h.trim(),+f){case-1:if(h==="BOT"){g[++d]=[],o=0;continue}else if(h!=="EOD")throw new Error("Unrecognized DIF special command "+h);break;case 0:h==="TRUE"?g[d][o]=!0:h==="FALSE"?g[d][o]=!1:isNaN(Mt(p))?isNaN(ir(p).getDate())?g[d][o]=p:g[d][o]=Js(p):g[d][o]=Mt(p),++o;break;case 1:h=h.slice(1,h.length-1),h=h.replace(/""/g,'"'),h&&h.match(/^=".*"$/)&&(h=h.slice(2,-1)),g[d][o++]=h!==""?h:null;break}if(h==="EOD")break}}return i&&i.sheetRows&&(g=g.slice(0,i.sheetRows)),g}function t(l,i){return Ia(s(l,i),i)}function r(l,i){return ma(t(l,i),i)}var n=function(){var l=function(d,o,m,g,x){d.push(o),d.push(m+","+g),d.push('"'+x.replace(/"/g,'""')+'"')},i=function(d,o,m,g){d.push(o+","+m),d.push(o==1?'"'+g.replace(/"/g,'""')+'"':g)};return function(d){var o=[],m=is(d["!ref"]),g,x=Array.isArray(d);l(o,"TABLE",0,1,"sheetjs"),l(o,"VECTORS",0,m.e.r-m.s.r+1,""),l(o,"TUPLES",0,m.e.c-m.s.c+1,""),l(o,"DATA",0,0,"");for(var f=m.s.r;f<=m.e.r;++f){i(o,-1,0,"BOT");for(var p=m.s.c;p<=m.e.c;++p){var h=ss({r:f,c:p});if(g=x?(d[f]||[])[p]:d[h],!g){i(o,1,0,"");continue}switch(g.t){case"n":var w=g.w;!w&&g.v!=null&&(w=g.v),w==null?g.f&&!g.F?i(o,1,0,"="+g.f):i(o,1,0,""):i(o,0,w,"V");break;case"b":i(o,0,g.v?1:0,g.v?"TRUE":"FALSE");break;case"s":i(o,1,0,isNaN(g.v)?g.v:'="'+g.v+'"');break;case"d":g.w||(g.w=Yt(g.z||gs[14],tt(Js(g.v)))),i(o,0,g.w,"V");break;default:i(o,1,0,"")}}}i(o,-1,0,"EOD");var L=`\r
`,O=o.join(L);return O}}();return{to_workbook:r,to_sheet:t,from_sheet:n}}(),hc=function(){function s(g){return g.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function a(g){return g.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function t(g,x){for(var f=g.split(`
`),p=-1,h=-1,w=0,L=[];w!==f.length;++w){var O=f[w].trim().split(":");if(O[0]==="cell"){var I=Cs(O[1]);if(L.length<=I.r)for(p=L.length;p<=I.r;++p)L[p]||(L[p]=[]);switch(p=I.r,h=I.c,O[2]){case"t":L[p][h]=s(O[3]);break;case"v":L[p][h]=+O[3];break;case"vtf":var H=O[O.length-1];case"vtc":switch(O[3]){case"nl":L[p][h]=!!+O[4];break;default:L[p][h]=+O[4];break}O[2]=="vtf"&&(L[p][h]=[L[p][h],H])}}}return x&&x.sheetRows&&(L=L.slice(0,x.sheetRows)),L}function r(g,x){return Ia(t(g,x),x)}function n(g,x){return ma(r(g,x),x)}var l=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),i=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,c=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),d="--SocialCalcSpreadsheetControlSave--";function o(g){if(!g||!g["!ref"])return"";for(var x=[],f=[],p,h="",w=mt(g["!ref"]),L=Array.isArray(g),O=w.s.r;O<=w.e.r;++O)for(var I=w.s.c;I<=w.e.c;++I)if(h=ss({r:O,c:I}),p=L?(g[O]||[])[I]:g[h],!(!p||p.v==null||p.t==="z")){switch(f=["cell",h,"t"],p.t){case"s":case"str":f.push(a(p.v));break;case"n":p.f?(f[2]="vtf",f[3]="n",f[4]=p.v,f[5]=a(p.f)):(f[2]="v",f[3]=p.v);break;case"b":f[2]="vt"+(p.f?"f":"c"),f[3]="nl",f[4]=p.v?"1":"0",f[5]=a(p.f||(p.v?"TRUE":"FALSE"));break;case"d":var H=tt(Js(p.v));f[2]="vtc",f[3]="nd",f[4]=""+H,f[5]=p.w||Yt(p.z||gs[14],H);break;case"e":continue}x.push(f.join(":"))}return x.push("sheet:c:"+(w.e.c-w.s.c+1)+":r:"+(w.e.r-w.s.r+1)+":tvf:1"),x.push("valueformat:1:text-wiki"),x.join(`
`)}function m(g){return[l,i,c,i,o(g),d].join(`
`)}return{to_workbook:n,to_sheet:r,from_sheet:m}}(),Zd=function(){function s(m,g,x,f,p){p.raw?g[x][f]=m:m===""||(m==="TRUE"?g[x][f]=!0:m==="FALSE"?g[x][f]=!1:isNaN(Mt(m))?isNaN(ir(m).getDate())?g[x][f]=m:g[x][f]=Js(m):g[x][f]=Mt(m))}function a(m,g){var x=g||{},f=[];if(!m||m.length===0)return f;for(var p=m.split(/[\r\n]/),h=p.length-1;h>=0&&p[h].length===0;)--h;for(var w=10,L=0,O=0;O<=h;++O)L=p[O].indexOf(" "),L==-1?L=p[O].length:L++,w=Math.max(w,L);for(O=0;O<=h;++O){f[O]=[];var I=0;for(s(p[O].slice(0,w).trim(),f,O,I,x),I=1;I<=(p[O].length-w)/10+1;++I)s(p[O].slice(w+(I-1)*10,w+I*10).trim(),f,O,I,x)}return x.sheetRows&&(f=f.slice(0,x.sheetRows)),f}var t={44:",",9:"	",59:";",124:"|"},r={44:3,9:2,59:1,124:0};function n(m){for(var g={},x=!1,f=0,p=0;f<m.length;++f)(p=m.charCodeAt(f))==34?x=!x:!x&&p in t&&(g[p]=(g[p]||0)+1);p=[];for(f in g)Object.prototype.hasOwnProperty.call(g,f)&&p.push([g[f],f]);if(!p.length){g=r;for(f in g)Object.prototype.hasOwnProperty.call(g,f)&&p.push([g[f],f])}return p.sort(function(h,w){return h[0]-w[0]||r[h[1]]-r[w[1]]}),t[p.pop()[1]]||44}function l(m,g){var x=g||{},f="",p=x.dense?[]:{},h={s:{c:0,r:0},e:{c:0,r:0}};m.slice(0,4)=="sep="?m.charCodeAt(5)==13&&m.charCodeAt(6)==10?(f=m.charAt(4),m=m.slice(7)):m.charCodeAt(5)==13||m.charCodeAt(5)==10?(f=m.charAt(4),m=m.slice(6)):f=n(m.slice(0,1024)):x&&x.FS?f=x.FS:f=n(m.slice(0,1024));var w=0,L=0,O=0,I=0,H=0,ae=f.charCodeAt(0),oe=!1,D=0,q=m.charCodeAt(0);m=m.replace(/\r\n/mg,`
`);var z=x.dateNF!=null?f0(x.dateNF):null;function G(){var ce=m.slice(I,H),M={};if(ce.charAt(0)=='"'&&ce.charAt(ce.length-1)=='"'&&(ce=ce.slice(1,-1).replace(/""/g,'"')),ce.length===0)M.t="z";else if(x.raw)M.t="s",M.v=ce;else if(ce.trim().length===0)M.t="s",M.v=ce;else if(ce.charCodeAt(0)==61)ce.charCodeAt(1)==34&&ce.charCodeAt(ce.length-1)==34?(M.t="s",M.v=ce.slice(2,-1).replace(/""/g,'"')):qm(ce)?(M.t="n",M.f=ce.slice(1)):(M.t="s",M.v=ce);else if(ce=="TRUE")M.t="b",M.v=!0;else if(ce=="FALSE")M.t="b",M.v=!1;else if(!isNaN(O=Mt(ce)))M.t="n",x.cellText!==!1&&(M.w=ce),M.v=O;else if(!isNaN(ir(ce).getDate())||z&&ce.match(z)){M.z=x.dateNF||gs[14];var W=0;z&&ce.match(z)&&(ce=g0(ce,x.dateNF,ce.match(z)||[]),W=1),x.cellDates?(M.t="d",M.v=Js(ce,W)):(M.t="n",M.v=tt(Js(ce,W))),x.cellText!==!1&&(M.w=Yt(M.z,M.v instanceof Date?tt(M.v):M.v)),x.cellNF||delete M.z}else M.t="s",M.v=ce;if(M.t=="z"||(x.dense?(p[w]||(p[w]=[]),p[w][L]=M):p[ss({c:L,r:w})]=M),I=H+1,q=m.charCodeAt(I),h.e.c<L&&(h.e.c=L),h.e.r<w&&(h.e.r=w),D==ae)++L;else if(L=0,++w,x.sheetRows&&x.sheetRows<=w)return!0}e:for(;H<m.length;++H)switch(D=m.charCodeAt(H)){case 34:q===34&&(oe=!oe);break;case ae:case 10:case 13:if(!oe&&G())break e;break}return H-I>0&&G(),p["!ref"]=Ns(h),p}function i(m,g){return!(g&&g.PRN)||g.FS||m.slice(0,4)=="sep="||m.indexOf("	")>=0||m.indexOf(",")>=0||m.indexOf(";")>=0?l(m,g):Ia(a(m,g),g)}function c(m,g){var x="",f=g.type=="string"?[0,0,0,0]:xg(m,g);switch(g.type){case"base64":x=Ut(m);break;case"binary":x=m;break;case"buffer":g.codepage==65001?x=m.toString("utf8"):(g.codepage,x=qe&&Buffer.isBuffer(m)?m.toString("binary"):xr(m));break;case"array":x=rn(m);break;case"string":x=m;break;default:throw new Error("Unrecognized type "+g.type)}return f[0]==239&&f[1]==187&&f[2]==191?x=Ja(x.slice(3)):g.type!="string"&&g.type!="buffer"&&g.codepage==65001?x=Ja(x):g.type=="binary",x.slice(0,19)=="socialcalc:version:"?hc.to_sheet(g.type=="string"?x:Ja(x),g):i(x,g)}function d(m,g){return ma(c(m,g),g)}function o(m){for(var g=[],x=is(m["!ref"]),f,p=Array.isArray(m),h=x.s.r;h<=x.e.r;++h){for(var w=[],L=x.s.c;L<=x.e.c;++L){var O=ss({r:h,c:L});if(f=p?(m[h]||[])[L]:m[O],!f||f.v==null){w.push("          ");continue}for(var I=(f.w||(Gt(f),f.w)||"").slice(0,10);I.length<10;)I+=" ";w.push(I+(L===0?" ":""))}g.push(w.join(""))}return g.join(`
`)}return{to_workbook:d,to_sheet:c,from_sheet:o}}(),Wi=function(){function s(N,P,T){if(N){nt(N,N.l||0);for(var A=T.Enum||je;N.l<N.length;){var X=N.read_shift(2),me=A[X]||A[65535],F=N.read_shift(2),J=N.l+F,U=me.f&&me.f(N,F,T);if(N.l=J,P(U,me,X))return}}}function a(N,P){switch(P.type){case"base64":return t(St(Ut(N)),P);case"binary":return t(St(N),P);case"buffer":case"array":return t(N,P)}throw"Unsupported type "+P.type}function t(N,P){if(!N)return N;var T=P||{},A=T.dense?[]:{},X="Sheet1",me="",F=0,J={},U=[],Y=[],ue={s:{r:0,c:0},e:{r:0,c:0}},Me=T.sheetRows||0;if(N[2]==0&&(N[3]==8||N[3]==9)&&N.length>=16&&N[14]==5&&N[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(N[2]==2)T.Enum=je,s(N,function(pe,E,R){switch(R){case 0:T.vers=pe,pe>=4096&&(T.qpro=!0);break;case 6:ue=pe;break;case 204:pe&&(me=pe);break;case 222:me=pe;break;case 15:case 51:T.qpro||(pe[1].v=pe[1].v.slice(1));case 13:case 14:case 16:R==14&&(pe[2]&112)==112&&(pe[2]&15)>1&&(pe[2]&15)<15&&(pe[1].z=T.dateNF||gs[14],T.cellDates&&(pe[1].t="d",pe[1].v=Al(pe[1].v))),T.qpro&&pe[3]>F&&(A["!ref"]=Ns(ue),J[X]=A,U.push(X),A=T.dense?[]:{},ue={s:{r:0,c:0},e:{r:0,c:0}},F=pe[3],X=me||"Sheet"+(F+1),me="");var ye=T.dense?(A[pe[0].r]||[])[pe[0].c]:A[ss(pe[0])];if(ye){ye.t=pe[1].t,ye.v=pe[1].v,pe[1].z!=null&&(ye.z=pe[1].z),pe[1].f!=null&&(ye.f=pe[1].f);break}T.dense?(A[pe[0].r]||(A[pe[0].r]=[]),A[pe[0].r][pe[0].c]=pe[1]):A[ss(pe[0])]=pe[1];break}},T);else if(N[2]==26||N[2]==14)T.Enum=Oe,N[2]==14&&(T.qpro=!0,N.l=0),s(N,function(pe,E,R){switch(R){case 204:X=pe;break;case 22:pe[1].v=pe[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(pe[3]>F&&(A["!ref"]=Ns(ue),J[X]=A,U.push(X),A=T.dense?[]:{},ue={s:{r:0,c:0},e:{r:0,c:0}},F=pe[3],X="Sheet"+(F+1)),Me>0&&pe[0].r>=Me)break;T.dense?(A[pe[0].r]||(A[pe[0].r]=[]),A[pe[0].r][pe[0].c]=pe[1]):A[ss(pe[0])]=pe[1],ue.e.c<pe[0].c&&(ue.e.c=pe[0].c),ue.e.r<pe[0].r&&(ue.e.r=pe[0].r);break;case 27:pe[14e3]&&(Y[pe[14e3][0]]=pe[14e3][1]);break;case 1537:Y[pe[0]]=pe[1],pe[0]==F&&(X=pe[1]);break}},T);else throw new Error("Unrecognized LOTUS BOF "+N[2]);if(A["!ref"]=Ns(ue),J[me||X]=A,U.push(me||X),!Y.length)return{SheetNames:U,Sheets:J};for(var le={},B=[],de=0;de<Y.length;++de)J[U[de]]?(B.push(Y[de]||U[de]),le[Y[de]]=J[Y[de]]||J[U[de]]):(B.push(Y[de]),le[Y[de]]={"!ref":"A1"});return{SheetNames:B,Sheets:le}}function r(N,P){var T=P||{};if(+T.codepage>=0&&rr(+T.codepage),T.type=="string")throw new Error("Cannot write WK1 to JS string");var A=st(),X=is(N["!ref"]),me=Array.isArray(N),F=[];Fe(A,0,l(1030)),Fe(A,6,d(X));for(var J=Math.min(X.e.r,8191),U=X.s.r;U<=J;++U)for(var Y=Rs(U),ue=X.s.c;ue<=X.e.c;++ue){U===X.s.r&&(F[ue]=Bs(ue));var Me=F[ue]+Y,le=me?(N[U]||[])[ue]:N[Me];if(!(!le||le.t=="z"))if(le.t=="n")(le.v|0)==le.v&&le.v>=-32768&&le.v<=32767?Fe(A,13,f(U,ue,le.v)):Fe(A,14,h(U,ue,le.v));else{var B=Gt(le);Fe(A,15,g(U,ue,B.slice(0,239)))}}return Fe(A,1),A.end()}function n(N,P){var T=P||{};if(+T.codepage>=0&&rr(+T.codepage),T.type=="string")throw new Error("Cannot write WK3 to JS string");var A=st();Fe(A,0,i(N));for(var X=0,me=0;X<N.SheetNames.length;++X)(N.Sheets[N.SheetNames[X]]||{})["!ref"]&&Fe(A,27,Ie(N.SheetNames[X],me++));var F=0;for(X=0;X<N.SheetNames.length;++X){var J=N.Sheets[N.SheetNames[X]];if(!(!J||!J["!ref"])){for(var U=is(J["!ref"]),Y=Array.isArray(J),ue=[],Me=Math.min(U.e.r,8191),le=U.s.r;le<=Me;++le)for(var B=Rs(le),de=U.s.c;de<=U.e.c;++de){le===U.s.r&&(ue[de]=Bs(de));var pe=ue[de]+B,E=Y?(J[le]||[])[de]:J[pe];if(!(!E||E.t=="z"))if(E.t=="n")Fe(A,23,G(le,de,F,E.v));else{var R=Gt(E);Fe(A,22,D(le,de,F,R.slice(0,239)))}}++F}}return Fe(A,1),A.end()}function l(N){var P=he(2);return P.write_shift(2,N),P}function i(N){var P=he(26);P.write_shift(2,4096),P.write_shift(2,4),P.write_shift(4,0);for(var T=0,A=0,X=0,me=0;me<N.SheetNames.length;++me){var F=N.SheetNames[me],J=N.Sheets[F];if(!(!J||!J["!ref"])){++X;var U=mt(J["!ref"]);T<U.e.r&&(T=U.e.r),A<U.e.c&&(A=U.e.c)}}return T>8191&&(T=8191),P.write_shift(2,T),P.write_shift(1,X),P.write_shift(1,A),P.write_shift(2,0),P.write_shift(2,0),P.write_shift(1,1),P.write_shift(1,2),P.write_shift(4,0),P.write_shift(4,0),P}function c(N,P,T){var A={s:{c:0,r:0},e:{c:0,r:0}};return P==8&&T.qpro?(A.s.c=N.read_shift(1),N.l++,A.s.r=N.read_shift(2),A.e.c=N.read_shift(1),N.l++,A.e.r=N.read_shift(2),A):(A.s.c=N.read_shift(2),A.s.r=N.read_shift(2),P==12&&T.qpro&&(N.l+=2),A.e.c=N.read_shift(2),A.e.r=N.read_shift(2),P==12&&T.qpro&&(N.l+=2),A.s.c==65535&&(A.s.c=A.e.c=A.s.r=A.e.r=0),A)}function d(N){var P=he(8);return P.write_shift(2,N.s.c),P.write_shift(2,N.s.r),P.write_shift(2,N.e.c),P.write_shift(2,N.e.r),P}function o(N,P,T){var A=[{c:0,r:0},{t:"n",v:0},0,0];return T.qpro&&T.vers!=20768?(A[0].c=N.read_shift(1),A[3]=N.read_shift(1),A[0].r=N.read_shift(2),N.l+=2):(A[2]=N.read_shift(1),A[0].c=N.read_shift(2),A[0].r=N.read_shift(2)),A}function m(N,P,T){var A=N.l+P,X=o(N,P,T);if(X[1].t="s",T.vers==20768){N.l++;var me=N.read_shift(1);return X[1].v=N.read_shift(me,"utf8"),X}return T.qpro&&N.l++,X[1].v=N.read_shift(A-N.l,"cstr"),X}function g(N,P,T){var A=he(7+T.length);A.write_shift(1,255),A.write_shift(2,P),A.write_shift(2,N),A.write_shift(1,39);for(var X=0;X<A.length;++X){var me=T.charCodeAt(X);A.write_shift(1,me>=128?95:me)}return A.write_shift(1,0),A}function x(N,P,T){var A=o(N,P,T);return A[1].v=N.read_shift(2,"i"),A}function f(N,P,T){var A=he(7);return A.write_shift(1,255),A.write_shift(2,P),A.write_shift(2,N),A.write_shift(2,T,"i"),A}function p(N,P,T){var A=o(N,P,T);return A[1].v=N.read_shift(8,"f"),A}function h(N,P,T){var A=he(13);return A.write_shift(1,255),A.write_shift(2,P),A.write_shift(2,N),A.write_shift(8,T,"f"),A}function w(N,P,T){var A=N.l+P,X=o(N,P,T);if(X[1].v=N.read_shift(8,"f"),T.qpro)N.l=A;else{var me=N.read_shift(2);H(N.slice(N.l,N.l+me),X),N.l+=me}return X}function L(N,P,T){var A=P&32768;return P&=-32769,P=(A?N:0)+(P>=8192?P-16384:P),(A?"":"$")+(T?Bs(P):Rs(P))}var O={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},I=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function H(N,P){nt(N,0);for(var T=[],A=0,X="",me="",F="",J="";N.l<N.length;){var U=N[N.l++];switch(U){case 0:T.push(N.read_shift(8,"f"));break;case 1:me=L(P[0].c,N.read_shift(2),!0),X=L(P[0].r,N.read_shift(2),!1),T.push(me+X);break;case 2:{var Y=L(P[0].c,N.read_shift(2),!0),ue=L(P[0].r,N.read_shift(2),!1);me=L(P[0].c,N.read_shift(2),!0),X=L(P[0].r,N.read_shift(2),!1),T.push(Y+ue+":"+me+X)}break;case 3:if(N.l<N.length){console.error("WK1 premature formula end");return}break;case 4:T.push("("+T.pop()+")");break;case 5:T.push(N.read_shift(2));break;case 6:{for(var Me="";U=N[N.l++];)Me+=String.fromCharCode(U);T.push('"'+Me.replace(/"/g,'""')+'"')}break;case 8:T.push("-"+T.pop());break;case 23:T.push("+"+T.pop());break;case 22:T.push("NOT("+T.pop()+")");break;case 20:case 21:J=T.pop(),F=T.pop(),T.push(["AND","OR"][U-20]+"("+F+","+J+")");break;default:if(U<32&&I[U])J=T.pop(),F=T.pop(),T.push(F+I[U]+J);else if(O[U]){if(A=O[U][1],A==69&&(A=N[N.l++]),A>T.length){console.error("WK1 bad formula parse 0x"+U.toString(16)+":|"+T.join("|")+"|");return}var le=T.slice(-A);T.length-=A,T.push(O[U][0]+"("+le.join(",")+")")}else return U<=7?console.error("WK1 invalid opcode "+U.toString(16)):U<=24?console.error("WK1 unsupported op "+U.toString(16)):U<=30?console.error("WK1 invalid opcode "+U.toString(16)):U<=115?console.error("WK1 unsupported function opcode "+U.toString(16)):console.error("WK1 unrecognized opcode "+U.toString(16))}}T.length==1?P[1].f=""+T[0]:console.error("WK1 bad formula parse |"+T.join("|")+"|")}function ae(N){var P=[{c:0,r:0},{t:"n",v:0},0];return P[0].r=N.read_shift(2),P[3]=N[N.l++],P[0].c=N[N.l++],P}function oe(N,P){var T=ae(N);return T[1].t="s",T[1].v=N.read_shift(P-4,"cstr"),T}function D(N,P,T,A){var X=he(6+A.length);X.write_shift(2,N),X.write_shift(1,T),X.write_shift(1,P),X.write_shift(1,39);for(var me=0;me<A.length;++me){var F=A.charCodeAt(me);X.write_shift(1,F>=128?95:F)}return X.write_shift(1,0),X}function q(N,P){var T=ae(N);T[1].v=N.read_shift(2);var A=T[1].v>>1;if(T[1].v&1)switch(A&7){case 0:A=(A>>3)*5e3;break;case 1:A=(A>>3)*500;break;case 2:A=(A>>3)/20;break;case 3:A=(A>>3)/200;break;case 4:A=(A>>3)/2e3;break;case 5:A=(A>>3)/2e4;break;case 6:A=(A>>3)/16;break;case 7:A=(A>>3)/64;break}return T[1].v=A,T}function z(N,P){var T=ae(N),A=N.read_shift(4),X=N.read_shift(4),me=N.read_shift(2);if(me==65535)return A===0&&X===3221225472?(T[1].t="e",T[1].v=15):A===0&&X===3489660928?(T[1].t="e",T[1].v=42):T[1].v=0,T;var F=me&32768;return me=(me&32767)-16446,T[1].v=(1-F*2)*(X*Math.pow(2,me+32)+A*Math.pow(2,me)),T}function G(N,P,T,A){var X=he(14);if(X.write_shift(2,N),X.write_shift(1,T),X.write_shift(1,P),A==0)return X.write_shift(4,0),X.write_shift(4,0),X.write_shift(2,65535),X;var me=0,F=0,J=0,U=0;return A<0&&(me=1,A=-A),F=Math.log2(A)|0,A/=Math.pow(2,F-31),U=A>>>0,U&2147483648||(A/=2,++F,U=A>>>0),A-=U,U|=2147483648,U>>>=0,A*=Math.pow(2,32),J=A>>>0,X.write_shift(4,J),X.write_shift(4,U),F+=16383+(me?32768:0),X.write_shift(2,F),X}function ce(N,P){var T=z(N);return N.l+=P-14,T}function M(N,P){var T=ae(N),A=N.read_shift(4);return T[1].v=A>>6,T}function W(N,P){var T=ae(N),A=N.read_shift(8,"f");return T[1].v=A,T}function re(N,P){var T=W(N);return N.l+=P-10,T}function ve(N,P){return N[N.l+P-1]==0?N.read_shift(P,"cstr"):""}function te(N,P){var T=N[N.l++];T>P-1&&(T=P-1);for(var A="";A.length<T;)A+=String.fromCharCode(N[N.l++]);return A}function ke(N,P,T){if(!(!T.qpro||P<21)){var A=N.read_shift(1);N.l+=17,N.l+=1,N.l+=2;var X=N.read_shift(P-21,"cstr");return[A,X]}}function xe(N,P){for(var T={},A=N.l+P;N.l<A;){var X=N.read_shift(2);if(X==14e3){for(T[X]=[0,""],T[X][0]=N.read_shift(2);N[N.l];)T[X][1]+=String.fromCharCode(N[N.l]),N.l++;N.l++}}return T}function Ie(N,P){var T=he(5+N.length);T.write_shift(2,14e3),T.write_shift(2,P);for(var A=0;A<N.length;++A){var X=N.charCodeAt(A);T[T.l++]=X>127?95:X}return T[T.l++]=0,T}var je={0:{n:"BOF",f:cc},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:c},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:x},14:{n:"NUMBER",f:p},15:{n:"LABEL",f:m},16:{n:"FORMULA",f:w},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:m},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:ve},222:{n:"SHEETNAMELP",f:te},65535:{n:""}},Oe={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:oe},23:{n:"NUMBER17",f:z},24:{n:"NUMBER18",f:q},25:{n:"FORMULA19",f:ce},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:xe},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:M},38:{n:"??"},39:{n:"NUMBER27",f:W},40:{n:"FORMULA28",f:re},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:ve},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:ke},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:r,book_to_wk3:n,to_workbook:a}}(),em=/^\s|\s$|[\t\n\r]/;function uc(s,a){if(!a.bookSST)return"";var t=[js];t[t.length]=Ae("sst",null,{xmlns:Da[0],count:s.Count,uniqueCount:s.Unique});for(var r=0;r!=s.length;++r)if(s[r]!=null){var n=s[r],l="<si>";n.r?l+=n.r:(l+="<t",n.t||(n.t=""),n.t.match(em)&&(l+=' xml:space="preserve"'),l+=">"+es(n.t)+"</t>"),l+="</si>",t[t.length]=l}return t.length>2&&(t[t.length]="</sst>",t[1]=t[1].replace("/>",">")),t.join("")}function sm(s){return[s.read_shift(4),s.read_shift(4)]}function tm(s,a){return a||(a=he(8)),a.write_shift(4,s.Count),a.write_shift(4,s.Unique),a}var am=V0;function rm(s){var a=st();we(a,159,tm(s));for(var t=0;t<s.length;++t)we(a,19,am(s[t]));return we(a,160),a.end()}function nm(s){for(var a=[],t=s.split(""),r=0;r<t.length;++r)a[r]=t[r].charCodeAt(0);return a}function fc(s){var a=0,t,r=nm(s),n=r.length+1,l,i,c,d,o;for(t=ca(n),t[0]=r.length,l=1;l!=n;++l)t[l]=r[l-1];for(l=n-1;l>=0;--l)i=t[l],c=a&16384?1:0,d=a<<1&32767,o=c|d,a=o^i;return a^52811}var im=function(){function s(n,l){switch(l.type){case"base64":return a(Ut(n),l);case"binary":return a(n,l);case"buffer":return a(qe&&Buffer.isBuffer(n)?n.toString("binary"):xr(n),l);case"array":return a(rn(n),l)}throw new Error("Unrecognized type "+l.type)}function a(n,l){var i=l||{},c=i.dense?[]:{},d=n.match(/\\trowd.*?\\row\b/g);if(!d.length)throw new Error("RTF missing table");var o={s:{c:0,r:0},e:{c:0,r:d.length-1}};return d.forEach(function(m,g){Array.isArray(c)&&(c[g]=[]);for(var x=/\\\w+\b/g,f=0,p,h=-1;p=x.exec(m);){switch(p[0]){case"\\cell":var w=m.slice(f,x.lastIndex-p[0].length);if(w[0]==" "&&(w=w.slice(1)),++h,w.length){var L={v:w,t:"s"};Array.isArray(c)?c[g][h]=L:c[ss({r:g,c:h})]=L}break}f=x.lastIndex}h>o.e.c&&(o.e.c=h)}),c["!ref"]=Ns(o),c}function t(n,l){return ma(s(n,l),l)}function r(n){for(var l=["{\\rtf1\\ansi"],i=is(n["!ref"]),c,d=Array.isArray(n),o=i.s.r;o<=i.e.r;++o){l.push("\\trowd\\trautofit1");for(var m=i.s.c;m<=i.e.c;++m)l.push("\\cellx"+(m+1));for(l.push("\\pard\\intbl"),m=i.s.c;m<=i.e.c;++m){var g=ss({r:o,c:m});c=d?(n[o]||[])[m]:n[g],!(!c||c.v==null&&(!c.f||c.F))&&(l.push(" "+(c.w||(Gt(c),c.w))),l.push("\\cell"))}l.push("\\pard\\intbl\\row")}return l.join("")+"}"}return{to_workbook:t,to_sheet:s,from_sheet:r}}();function $i(s){for(var a=0,t=1;a!=3;++a)t=t*256+(s[a]>255?255:s[a]<0?0:s[a]);return t.toString(16).toUpperCase().slice(1)}var lm=6,Bt=lm;function Xr(s){return Math.floor((s+Math.round(128/Bt)/256)*Bt)}function Jr(s){return Math.floor((s-5)/Bt*100+.5)/100}function Cn(s){return Math.round((s*Bt+5)/Bt*256)/256}function Kn(s){s.width?(s.wpx=Xr(s.width),s.wch=Jr(s.wpx),s.MDW=Bt):s.wpx?(s.wch=Jr(s.wpx),s.width=Cn(s.wch),s.MDW=Bt):typeof s.wch=="number"&&(s.width=Cn(s.wch),s.wpx=Xr(s.width),s.MDW=Bt),s.customWidth&&delete s.customWidth}var cm=96,gc=cm;function Yr(s){return s*96/gc}function pc(s){return s*gc/96}function om(s){var a=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(t){for(var r=t[0];r<=t[1];++r)s[r]!=null&&(a[a.length]=Ae("numFmt",null,{numFmtId:r,formatCode:es(s[r])}))}),a.length===1?"":(a[a.length]="</numFmts>",a[0]=Ae("numFmts",null,{count:a.length-2}).replace("/>",">"),a.join(""))}function dm(s){var a=[];return a[a.length]=Ae("cellXfs",null),s.forEach(function(t){a[a.length]=Ae("xf",null,t)}),a[a.length]="</cellXfs>",a.length===2?"":(a[0]=Ae("cellXfs",null,{count:a.length-2}).replace("/>",">"),a.join(""))}function vc(s,a){var t=[js,Ae("styleSheet",null,{xmlns:Da[0],"xmlns:vt":Es.vt})],r;return s.SSF&&(r=om(s.SSF))!=null&&(t[t.length]=r),t[t.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',t[t.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',t[t.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',t[t.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(r=dm(a.cellXfs))&&(t[t.length]=r),t[t.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',t[t.length]='<dxfs count="0"/>',t[t.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',t.length>2&&(t[t.length]="</styleSheet>",t[1]=t[1].replace("/>",">")),t.join("")}function mm(s,a){var t=s.read_shift(2),r=Us(s);return[t,r]}function xm(s,a,t){t||(t=he(6+4*a.length)),t.write_shift(2,s),As(a,t);var r=t.length>t.l?t.slice(0,t.l):t;return t.l==null&&(t.l=t.length),r}function hm(s,a,t){var r={};r.sz=s.read_shift(2)/20;var n=ed(s);n.fItalic&&(r.italic=1),n.fCondense&&(r.condense=1),n.fExtend&&(r.extend=1),n.fShadow&&(r.shadow=1),n.fOutline&&(r.outline=1),n.fStrikeout&&(r.strike=1);var l=s.read_shift(2);switch(l===700&&(r.bold=1),s.read_shift(2)){case 1:r.vertAlign="superscript";break;case 2:r.vertAlign="subscript";break}var i=s.read_shift(1);i!=0&&(r.underline=i);var c=s.read_shift(1);c>0&&(r.family=c);var d=s.read_shift(1);switch(d>0&&(r.charset=d),s.l++,r.color=Z0(s),s.read_shift(1)){case 1:r.scheme="major";break;case 2:r.scheme="minor";break}return r.name=Us(s),r}function um(s,a){a||(a=he(25+4*32)),a.write_shift(2,s.sz*20),sd(s,a),a.write_shift(2,s.bold?700:400);var t=0;s.vertAlign=="superscript"?t=1:s.vertAlign=="subscript"&&(t=2),a.write_shift(2,t),a.write_shift(1,s.underline||0),a.write_shift(1,s.family||0),a.write_shift(1,s.charset||0),a.write_shift(1,0),Kr(s.color,a);var r=0;return r=2,a.write_shift(1,r),As(s.name,a),a.length>a.l?a.slice(0,a.l):a}var fm=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],un,gm=Ft;function Ki(s,a){a||(a=he(4*3+8*7+16*1)),un||(un=Pn(fm));var t=un[s.patternType];t==null&&(t=40),a.write_shift(4,t);var r=0;if(t!=40)for(Kr({auto:1},a),Kr({auto:1},a);r<12;++r)a.write_shift(4,0);else{for(;r<4;++r)a.write_shift(4,0);for(;r<12;++r)a.write_shift(4,0)}return a.length>a.l?a.slice(0,a.l):a}function pm(s,a){var t=s.l+a,r=s.read_shift(2),n=s.read_shift(2);return s.l=t,{ixfe:r,numFmtId:n}}function wc(s,a,t){t||(t=he(16)),t.write_shift(2,a||0),t.write_shift(2,s.numFmtId||0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);var r=0;return t.write_shift(1,r),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(1,0),t}function Ha(s,a){return a||(a=he(10)),a.write_shift(1,0),a.write_shift(1,0),a.write_shift(4,0),a.write_shift(4,0),a}var vm=Ft;function wm(s,a){return a||(a=he(51)),a.write_shift(1,0),Ha(null,a),Ha(null,a),Ha(null,a),Ha(null,a),Ha(null,a),a.length>a.l?a.slice(0,a.l):a}function bm(s,a){return a||(a=he(12+4*10)),a.write_shift(4,s.xfId),a.write_shift(2,1),a.write_shift(1,0),a.write_shift(1,0),$r(s.name||"",a),a.length>a.l?a.slice(0,a.l):a}function ym(s,a,t){var r=he(2052);return r.write_shift(4,s),$r(a,r),$r(t,r),r.length>r.l?r.slice(0,r.l):r}function Nm(s,a){if(a){var t=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)a[n]!=null&&++t}),t!=0&&(we(s,615,kt(t)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)a[n]!=null&&we(s,44,xm(n,a[n]))}),we(s,616))}}function jm(s){var a=1;we(s,611,kt(a)),we(s,43,um({sz:12,color:{theme:1},name:"Calibri",family:2})),we(s,612)}function Sm(s){var a=2;we(s,603,kt(a)),we(s,45,Ki({patternType:"none"})),we(s,45,Ki({patternType:"gray125"})),we(s,604)}function Tm(s){var a=1;we(s,613,kt(a)),we(s,46,wm()),we(s,614)}function km(s){var a=1;we(s,626,kt(a)),we(s,47,wc({numFmtId:0},65535)),we(s,627)}function _m(s,a){we(s,617,kt(a.length)),a.forEach(function(t){we(s,47,wc(t,0))}),we(s,618)}function Em(s){var a=1;we(s,619,kt(a)),we(s,48,bm({xfId:0,name:"Normal"})),we(s,620)}function Cm(s){var a=0;we(s,505,kt(a)),we(s,506)}function Am(s){var a=0;we(s,508,ym(a,"TableStyleMedium9","PivotStyleMedium4")),we(s,509)}function Fm(s,a){var t=st();return we(t,278),Nm(t,s.SSF),jm(t),Sm(t),Tm(t),km(t),_m(t,a.cellXfs),Em(t),Cm(t),Am(t),we(t,279),t.end()}function bc(s,a){if(a&&a.themeXLSX)return a.themeXLSX;if(s&&typeof s.raw=="string")return s.raw;var t=[js];return t[t.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',t[t.length]="<a:themeElements>",t[t.length]='<a:clrScheme name="Office">',t[t.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',t[t.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',t[t.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',t[t.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',t[t.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',t[t.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',t[t.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',t[t.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',t[t.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',t[t.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',t[t.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',t[t.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',t[t.length]="</a:clrScheme>",t[t.length]='<a:fontScheme name="Office">',t[t.length]="<a:majorFont>",t[t.length]='<a:latin typeface="Cambria"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',t[t.length]='<a:font script="Hang" typeface="맑은 고딕"/>',t[t.length]='<a:font script="Hans" typeface="宋体"/>',t[t.length]='<a:font script="Hant" typeface="新細明體"/>',t[t.length]='<a:font script="Arab" typeface="Times New Roman"/>',t[t.length]='<a:font script="Hebr" typeface="Times New Roman"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="MoolBoran"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Times New Roman"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:majorFont>",t[t.length]="<a:minorFont>",t[t.length]='<a:latin typeface="Calibri"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',t[t.length]='<a:font script="Hang" typeface="맑은 고딕"/>',t[t.length]='<a:font script="Hans" typeface="宋体"/>',t[t.length]='<a:font script="Hant" typeface="新細明體"/>',t[t.length]='<a:font script="Arab" typeface="Arial"/>',t[t.length]='<a:font script="Hebr" typeface="Arial"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="DaunPenh"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Arial"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:minorFont>",t[t.length]="</a:fontScheme>",t[t.length]='<a:fmtScheme name="Office">',t[t.length]="<a:fillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="1"/>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="0"/>',t[t.length]="</a:gradFill>",t[t.length]="</a:fillStyleLst>",t[t.length]="<a:lnStyleLst>",t[t.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]="</a:lnStyleLst>",t[t.length]="<a:effectStyleLst>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',t[t.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',t[t.length]="</a:effectStyle>",t[t.length]="</a:effectStyleLst>",t[t.length]="<a:bgFillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]="</a:bgFillStyleLst>",t[t.length]="</a:fmtScheme>",t[t.length]="</a:themeElements>",t[t.length]="<a:objectDefaults>",t[t.length]="<a:spDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',t[t.length]="</a:spDef>",t[t.length]="<a:lnDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',t[t.length]="</a:lnDef>",t[t.length]="</a:objectDefaults>",t[t.length]="<a:extraClrSchemeLst/>",t[t.length]="</a:theme>",t.join("")}function Dm(s,a){return{flags:s.read_shift(4),version:s.read_shift(4),name:Us(s)}}function Im(s){var a=he(12+2*s.name.length);return a.write_shift(4,s.flags),a.write_shift(4,s.version),As(s.name,a),a.slice(0,a.l)}function Pm(s){for(var a=[],t=s.read_shift(4);t-- >0;)a.push([s.read_shift(4),s.read_shift(4)]);return a}function Rm(s){var a=he(4+8*s.length);a.write_shift(4,s.length);for(var t=0;t<s.length;++t)a.write_shift(4,s[t][0]),a.write_shift(4,s[t][1]);return a}function Om(s,a){var t=he(8+2*a.length);return t.write_shift(4,s),As(a,t),t.slice(0,t.l)}function Lm(s){return s.l+=4,s.read_shift(4)!=0}function Mm(s,a){var t=he(8);return t.write_shift(4,s),t.write_shift(4,1),t}function Bm(){var s=st();return we(s,332),we(s,334,kt(1)),we(s,335,Im({name:"XLDAPR",version:12e4,flags:3496657072})),we(s,336),we(s,339,Om(1,"XLDAPR")),we(s,52),we(s,35,kt(514)),we(s,4096,kt(0)),we(s,4097,ut(1)),we(s,36),we(s,53),we(s,340),we(s,337,Mm(1)),we(s,51,Rm([[1,0]])),we(s,338),we(s,333),s.end()}function yc(){var s=[js];return s.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),s.join("")}function Um(s){var a={};a.i=s.read_shift(4);var t={};t.r=s.read_shift(4),t.c=s.read_shift(4),a.r=ss(t);var r=s.read_shift(1);return r&2&&(a.l="1"),r&8&&(a.a="1"),a}var Ta=1024;function Nc(s,a){for(var t=[21600,21600],r=["m0,0l0",t[1],t[0],t[1],t[0],"0xe"].join(","),n=[Ae("xml",null,{"xmlns:v":it.v,"xmlns:o":it.o,"xmlns:x":it.x,"xmlns:mv":it.mv}).replace(/\/>/,">"),Ae("o:shapelayout",Ae("o:idmap",null,{"v:ext":"edit",data:s}),{"v:ext":"edit"}),Ae("v:shapetype",[Ae("v:stroke",null,{joinstyle:"miter"}),Ae("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:t.join(","),path:r})];Ta<s*1e3;)Ta+=1e3;return a.forEach(function(l){var i=Cs(l[0]),c={color2:"#BEFF82",type:"gradient"};c.type=="gradient"&&(c.angle="-180");var d=c.type=="gradient"?Ae("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,o=Ae("v:fill",d,c),m={on:"t",obscured:"t"};++Ta,n=n.concat(["<v:shape"+cr({id:"_x0000_s"+Ta,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(l[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",o,Ae("v:shadow",null,m),Ae("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Ps("x:Anchor",[i.c+1,0,i.r+1,0,i.c+3,20,i.r+5,20].join(",")),Ps("x:AutoFill","False"),Ps("x:Row",String(i.r)),Ps("x:Column",String(i.c)),l[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),n.push("</xml>"),n.join("")}function jc(s){var a=[js,Ae("comments",null,{xmlns:Da[0]})],t=[];return a.push("<authors>"),s.forEach(function(r){r[1].forEach(function(n){var l=es(n.a);t.indexOf(l)==-1&&(t.push(l),a.push("<author>"+l+"</author>")),n.T&&n.ID&&t.indexOf("tc="+n.ID)==-1&&(t.push("tc="+n.ID),a.push("<author>tc="+n.ID+"</author>"))})}),t.length==0&&(t.push("SheetJ5"),a.push("<author>SheetJ5</author>")),a.push("</authors>"),a.push("<commentList>"),s.forEach(function(r){var n=0,l=[];if(r[1][0]&&r[1][0].T&&r[1][0].ID?n=t.indexOf("tc="+r[1][0].ID):r[1].forEach(function(d){d.a&&(n=t.indexOf(es(d.a))),l.push(d.t||"")}),a.push('<comment ref="'+r[0]+'" authorId="'+n+'"><text>'),l.length<=1)a.push(Ps("t",es(l[0]||"")));else{for(var i=`Comment:
    `+l[0]+`
`,c=1;c<l.length;++c)i+=`Reply:
    `+l[c]+`
`;a.push(Ps("t",es(i)))}a.push("</text></comment>")}),a.push("</commentList>"),a.length>2&&(a[a.length]="</comments>",a[1]=a[1].replace("/>",">")),a.join("")}function Gm(s,a,t){var r=[js,Ae("ThreadedComments",null,{xmlns:Es.TCMNT}).replace(/[\/]>/,">")];return s.forEach(function(n){var l="";(n[1]||[]).forEach(function(i,c){if(!i.T){delete i.ID;return}i.a&&a.indexOf(i.a)==-1&&a.push(i.a);var d={ref:n[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+t.tcid++).slice(-12)+"}"};c==0?l=d.id:d.parentId=l,i.ID=d.id,i.a&&(d.personId="{54EE7950-7262-4200-6969-"+("000000000000"+a.indexOf(i.a)).slice(-12)+"}"),r.push(Ae("threadedComment",Ps("text",i.t||""),d))})}),r.push("</ThreadedComments>"),r.join("")}function Hm(s){var a=[js,Ae("personList",null,{xmlns:Es.TCMNT,"xmlns:x":Da[0]}).replace(/[\/]>/,">")];return s.forEach(function(t,r){a.push(Ae("person",null,{displayName:t,id:"{54EE7950-7262-4200-6969-"+("000000000000"+r).slice(-12)+"}",userId:t,providerId:"None"}))}),a.push("</personList>"),a.join("")}function zm(s){var a={};a.iauthor=s.read_shift(4);var t=fa(s);return a.rfx=t.s,a.ref=ss(t.s),s.l+=16,a}function Wm(s,a){return a==null&&(a=he(36)),a.write_shift(4,s[1].iauthor),Pa(s[0],a),a.write_shift(4,0),a.write_shift(4,0),a.write_shift(4,0),a.write_shift(4,0),a}var $m=Us;function Km(s){return As(s.slice(0,54))}function Vm(s){var a=st(),t=[];return we(a,628),we(a,630),s.forEach(function(r){r[1].forEach(function(n){t.indexOf(n.a)>-1||(t.push(n.a.slice(0,54)),we(a,632,Km(n.a)))})}),we(a,631),we(a,633),s.forEach(function(r){r[1].forEach(function(n){n.iauthor=t.indexOf(n.a);var l={s:Cs(r[0]),e:Cs(r[0])};we(a,635,Wm([l,n])),n.t&&n.t.length>0&&we(a,637,J0(n)),we(a,636),delete n.iauthor})}),we(a,634),we(a,629),a.end()}function Xm(s,a){a.FullPaths.forEach(function(t,r){if(r!=0){var n=t.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");n.slice(-1)!=="/"&&ts.utils.cfb_add(s,n,a.FileIndex[r].content)}})}var Sc=["xlsb","xlsm","xlam","biff8","xla"],Jm=function(){var s=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,a={r:0,c:0};function t(r,n,l,i){var c=!1,d=!1;l.length==0?d=!0:l.charAt(0)=="["&&(d=!0,l=l.slice(1,-1)),i.length==0?c=!0:i.charAt(0)=="["&&(c=!0,i=i.slice(1,-1));var o=l.length>0?parseInt(l,10)|0:0,m=i.length>0?parseInt(i,10)|0:0;return c?m+=a.c:--m,d?o+=a.r:--o,n+(c?"":"$")+Bs(m)+(d?"":"$")+Rs(o)}return function(n,l){return a=l,n.replace(s,t)}}(),Vn=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,Xn=function(){return function(a,t){return a.replace(Vn,function(r,n,l,i,c,d){var o=Gn(i)-(l?0:t.c),m=Un(d)-(c?0:t.r),g=m==0?"":c?m+1:"["+m+"]",x=o==0?"":l?o+1:"["+o+"]";return n+"R"+g+"C"+x})}}();function Ym(s,a){return s.replace(Vn,function(t,r,n,l,i,c){return r+(n=="$"?n+l:Bs(Gn(l)+a.c))+(i=="$"?i+c:Rs(Un(c)+a.r))})}function qm(s){return s.length!=1}function ws(s){s.l+=1}function qt(s,a){var t=s.read_shift(2);return[t&16383,t>>14&1,t>>15&1]}function Tc(s,a,t){var r=2;if(t){if(t.biff>=2&&t.biff<=5)return kc(s);t.biff==12&&(r=4)}var n=s.read_shift(r),l=s.read_shift(r),i=qt(s),c=qt(s);return{s:{r:n,c:i[0],cRel:i[1],rRel:i[2]},e:{r:l,c:c[0],cRel:c[1],rRel:c[2]}}}function kc(s){var a=qt(s),t=qt(s),r=s.read_shift(1),n=s.read_shift(1);return{s:{r:a[0],c:r,cRel:a[1],rRel:a[2]},e:{r:t[0],c:n,cRel:t[1],rRel:t[2]}}}function Qm(s,a,t){if(t.biff<8)return kc(s);var r=s.read_shift(t.biff==12?4:2),n=s.read_shift(t.biff==12?4:2),l=qt(s),i=qt(s);return{s:{r,c:l[0],cRel:l[1],rRel:l[2]},e:{r:n,c:i[0],cRel:i[1],rRel:i[2]}}}function _c(s,a,t){if(t&&t.biff>=2&&t.biff<=5)return Zm(s);var r=s.read_shift(t&&t.biff==12?4:2),n=qt(s);return{r,c:n[0],cRel:n[1],rRel:n[2]}}function Zm(s){var a=qt(s),t=s.read_shift(1);return{r:a[0],c:t,cRel:a[1],rRel:a[2]}}function ex(s){var a=s.read_shift(2),t=s.read_shift(2);return{r:a,c:t&255,fQuoted:!!(t&16384),cRel:t>>15,rRel:t>>15}}function sx(s,a,t){var r=t&&t.biff?t.biff:8;if(r>=2&&r<=5)return tx(s);var n=s.read_shift(r>=12?4:2),l=s.read_shift(2),i=(l&16384)>>14,c=(l&32768)>>15;if(l&=16383,c==1)for(;n>524287;)n-=1048576;if(i==1)for(;l>8191;)l=l-16384;return{r:n,c:l,cRel:i,rRel:c}}function tx(s){var a=s.read_shift(2),t=s.read_shift(1),r=(a&32768)>>15,n=(a&16384)>>14;return a&=16383,r==1&&a>=8192&&(a=a-16384),n==1&&t>=128&&(t=t-256),{r:a,c:t,cRel:n,rRel:r}}function ax(s,a,t){var r=(s[s.l++]&96)>>5,n=Tc(s,t.biff>=2&&t.biff<=5?6:8,t);return[r,n]}function rx(s,a,t){var r=(s[s.l++]&96)>>5,n=s.read_shift(2,"i"),l=8;if(t)switch(t.biff){case 5:s.l+=12,l=6;break;case 12:l=12;break}var i=Tc(s,l,t);return[r,n,i]}function nx(s,a,t){var r=(s[s.l++]&96)>>5;return s.l+=t&&t.biff>8?12:t.biff<8?6:8,[r]}function ix(s,a,t){var r=(s[s.l++]&96)>>5,n=s.read_shift(2),l=8;if(t)switch(t.biff){case 5:s.l+=12,l=6;break;case 12:l=12;break}return s.l+=l,[r,n]}function lx(s,a,t){var r=(s[s.l++]&96)>>5,n=Qm(s,a-1,t);return[r,n]}function cx(s,a,t){var r=(s[s.l++]&96)>>5;return s.l+=t.biff==2?6:t.biff==12?14:7,[r]}function Vi(s){var a=s[s.l+1]&1,t=1;return s.l+=4,[a,t]}function ox(s,a,t){s.l+=2;for(var r=s.read_shift(t&&t.biff==2?1:2),n=[],l=0;l<=r;++l)n.push(s.read_shift(t&&t.biff==2?1:2));return n}function dx(s,a,t){var r=s[s.l+1]&255?1:0;return s.l+=2,[r,s.read_shift(t&&t.biff==2?1:2)]}function mx(s,a,t){var r=s[s.l+1]&255?1:0;return s.l+=2,[r,s.read_shift(t&&t.biff==2?1:2)]}function xx(s){var a=s[s.l+1]&255?1:0;return s.l+=2,[a,s.read_shift(2)]}function hx(s,a,t){var r=s[s.l+1]&255?1:0;return s.l+=t&&t.biff==2?3:4,[r]}function Ec(s){var a=s.read_shift(1),t=s.read_shift(1);return[a,t]}function ux(s){return s.read_shift(2),Ec(s)}function fx(s){return s.read_shift(2),Ec(s)}function gx(s,a,t){var r=(s[s.l]&96)>>5;s.l+=1;var n=_c(s,0,t);return[r,n]}function px(s,a,t){var r=(s[s.l]&96)>>5;s.l+=1;var n=sx(s,0,t);return[r,n]}function vx(s,a,t){var r=(s[s.l]&96)>>5;s.l+=1;var n=s.read_shift(2);t&&t.biff==5&&(s.l+=12);var l=_c(s,0,t);return[r,n,l]}function wx(s,a,t){var r=(s[s.l]&96)>>5;s.l+=1;var n=s.read_shift(t&&t.biff<=3?1:2);return[wh[n],Fc[n],r]}function bx(s,a,t){var r=s[s.l++],n=s.read_shift(1),l=t&&t.biff<=3?[r==88?-1:0,s.read_shift(1)]:yx(s);return[n,(l[0]===0?Fc:vh)[l[1]]]}function yx(s){return[s[s.l+1]>>7,s.read_shift(2)&32767]}function Nx(s,a,t){s.l+=t&&t.biff==2?3:4}function jx(s,a,t){if(s.l++,t&&t.biff==12)return[s.read_shift(4,"i"),0];var r=s.read_shift(2),n=s.read_shift(t&&t.biff==2?1:2);return[r,n]}function Sx(s){return s.l++,fr[s.read_shift(1)]}function Tx(s){return s.l++,s.read_shift(2)}function kx(s){return s.l++,s.read_shift(1)!==0}function _x(s){return s.l++,Ra(s)}function Ex(s,a,t){return s.l++,dc(s,a-1,t)}function Cx(s,a){var t=[s.read_shift(1)];if(a==12)switch(t[0]){case 2:t[0]=4;break;case 4:t[0]=16;break;case 0:t[0]=1;break;case 1:t[0]=2;break}switch(t[0]){case 4:t[1]=vd(s,1)?"TRUE":"FALSE",a!=12&&(s.l+=7);break;case 37:case 16:t[1]=fr[s[s.l]],s.l+=a==12?4:8;break;case 0:s.l+=8;break;case 1:t[1]=Ra(s);break;case 2:t[1]=Nd(s,0,{biff:a>0&&a<8?2:a});break;default:throw new Error("Bad SerAr: "+t[0])}return t}function Ax(s,a,t){for(var r=s.read_shift(t.biff==12?4:2),n=[],l=0;l!=r;++l)n.push((t.biff==12?fa:Td)(s));return n}function Fx(s,a,t){var r=0,n=0;t.biff==12?(r=s.read_shift(4),n=s.read_shift(4)):(n=1+s.read_shift(1),r=1+s.read_shift(2)),t.biff>=2&&t.biff<8&&(--r,--n==0&&(n=256));for(var l=0,i=[];l!=r&&(i[l]=[]);++l)for(var c=0;c!=n;++c)i[l][c]=Cx(s,t.biff);return i}function Dx(s,a,t){var r=s.read_shift(1)>>>5&3,n=!t||t.biff>=8?4:2,l=s.read_shift(n);switch(t.biff){case 2:s.l+=5;break;case 3:case 4:s.l+=8;break;case 5:s.l+=12;break}return[r,0,l]}function Ix(s,a,t){if(t.biff==5)return Px(s);var r=s.read_shift(1)>>>5&3,n=s.read_shift(2),l=s.read_shift(4);return[r,n,l]}function Px(s){var a=s.read_shift(1)>>>5&3,t=s.read_shift(2,"i");s.l+=8;var r=s.read_shift(2);return s.l+=12,[a,t,r]}function Rx(s,a,t){var r=s.read_shift(1)>>>5&3;s.l+=t&&t.biff==2?3:4;var n=s.read_shift(t&&t.biff==2?1:2);return[r,n]}function Ox(s,a,t){var r=s.read_shift(1)>>>5&3,n=s.read_shift(t&&t.biff==2?1:2);return[r,n]}function Lx(s,a,t){var r=s.read_shift(1)>>>5&3;return s.l+=4,t.biff<8&&s.l--,t.biff==12&&(s.l+=2),[r]}function Mx(s,a,t){var r=(s[s.l++]&96)>>5,n=s.read_shift(2),l=4;if(t)switch(t.biff){case 5:l=15;break;case 12:l=6;break}return s.l+=l,[r,n]}var Bx=Ft,Ux=Ft,Gx=Ft;function gr(s,a,t){return s.l+=2,[ex(s)]}function Jn(s){return s.l+=6,[]}var Hx=gr,zx=Jn,Wx=Jn,$x=gr;function Cc(s){return s.l+=2,[cc(s),s.read_shift(2)&1]}var Kx=gr,Vx=Cc,Xx=Jn,Jx=gr,Yx=gr,qx=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function Qx(s){s.l+=2;var a=s.read_shift(2),t=s.read_shift(2),r=s.read_shift(4),n=s.read_shift(2),l=s.read_shift(2),i=qx[t>>2&31];return{ixti:a,coltype:t&3,rt:i,idx:r,c:n,C:l}}function Zx(s){return s.l+=2,[s.read_shift(4)]}function eh(s,a,t){return s.l+=5,s.l+=2,s.l+=t.biff==2?1:4,["PTGSHEET"]}function sh(s,a,t){return s.l+=t.biff==2?4:5,["PTGENDSHEET"]}function th(s){var a=s.read_shift(1)>>>5&3,t=s.read_shift(2);return[a,t]}function ah(s){var a=s.read_shift(1)>>>5&3,t=s.read_shift(2);return[a,t]}function rh(s){return s.l+=4,[0,0]}var Xi={1:{n:"PtgExp",f:jx},2:{n:"PtgTbl",f:Gx},3:{n:"PtgAdd",f:ws},4:{n:"PtgSub",f:ws},5:{n:"PtgMul",f:ws},6:{n:"PtgDiv",f:ws},7:{n:"PtgPower",f:ws},8:{n:"PtgConcat",f:ws},9:{n:"PtgLt",f:ws},10:{n:"PtgLe",f:ws},11:{n:"PtgEq",f:ws},12:{n:"PtgGe",f:ws},13:{n:"PtgGt",f:ws},14:{n:"PtgNe",f:ws},15:{n:"PtgIsect",f:ws},16:{n:"PtgUnion",f:ws},17:{n:"PtgRange",f:ws},18:{n:"PtgUplus",f:ws},19:{n:"PtgUminus",f:ws},20:{n:"PtgPercent",f:ws},21:{n:"PtgParen",f:ws},22:{n:"PtgMissArg",f:ws},23:{n:"PtgStr",f:Ex},26:{n:"PtgSheet",f:eh},27:{n:"PtgEndSheet",f:sh},28:{n:"PtgErr",f:Sx},29:{n:"PtgBool",f:kx},30:{n:"PtgInt",f:Tx},31:{n:"PtgNum",f:_x},32:{n:"PtgArray",f:cx},33:{n:"PtgFunc",f:wx},34:{n:"PtgFuncVar",f:bx},35:{n:"PtgName",f:Dx},36:{n:"PtgRef",f:gx},37:{n:"PtgArea",f:ax},38:{n:"PtgMemArea",f:Rx},39:{n:"PtgMemErr",f:Bx},40:{n:"PtgMemNoMem",f:Ux},41:{n:"PtgMemFunc",f:Ox},42:{n:"PtgRefErr",f:Lx},43:{n:"PtgAreaErr",f:nx},44:{n:"PtgRefN",f:px},45:{n:"PtgAreaN",f:lx},46:{n:"PtgMemAreaN",f:th},47:{n:"PtgMemNoMemN",f:ah},57:{n:"PtgNameX",f:Ix},58:{n:"PtgRef3d",f:vx},59:{n:"PtgArea3d",f:rx},60:{n:"PtgRefErr3d",f:Mx},61:{n:"PtgAreaErr3d",f:ix},255:{}},nh={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},ih={1:{n:"PtgElfLel",f:Cc},2:{n:"PtgElfRw",f:Jx},3:{n:"PtgElfCol",f:Hx},6:{n:"PtgElfRwV",f:Yx},7:{n:"PtgElfColV",f:$x},10:{n:"PtgElfRadical",f:Kx},11:{n:"PtgElfRadicalS",f:Xx},13:{n:"PtgElfColS",f:zx},15:{n:"PtgElfColSV",f:Wx},16:{n:"PtgElfRadicalLel",f:Vx},25:{n:"PtgList",f:Qx},29:{n:"PtgSxName",f:Zx},255:{}},lh={0:{n:"PtgAttrNoop",f:rh},1:{n:"PtgAttrSemi",f:hx},2:{n:"PtgAttrIf",f:mx},4:{n:"PtgAttrChoose",f:ox},8:{n:"PtgAttrGoto",f:dx},16:{n:"PtgAttrSum",f:Nx},32:{n:"PtgAttrBaxcel",f:Vi},33:{n:"PtgAttrBaxcel",f:Vi},64:{n:"PtgAttrSpace",f:ux},65:{n:"PtgAttrSpaceSemi",f:fx},128:{n:"PtgAttrIfError",f:xx},255:{}};function ch(s,a,t,r){if(r.biff<8)return Ft(s,a);for(var n=s.l+a,l=[],i=0;i!==t.length;++i)switch(t[i][0]){case"PtgArray":t[i][1]=Fx(s,0,r),l.push(t[i][1]);break;case"PtgMemArea":t[i][2]=Ax(s,t[i][1],r),l.push(t[i][2]);break;case"PtgExp":r&&r.biff==12&&(t[i][1][1]=s.read_shift(4),l.push(t[i][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+t[i][0]}return a=n-s.l,a!==0&&l.push(Ft(s,a)),l}function oh(s,a,t){for(var r=s.l+a,n,l,i=[];r!=s.l;)a=r-s.l,l=s[s.l],n=Xi[l]||Xi[nh[l]],(l===24||l===25)&&(n=(l===24?ih:lh)[s[s.l+1]]),!n||!n.f?Ft(s,a):i.push([n.n,n.f(s,a,t)]);return i}function dh(s){for(var a=[],t=0;t<s.length;++t){for(var r=s[t],n=[],l=0;l<r.length;++l){var i=r[l];if(i)switch(i[0]){case 2:n.push('"'+i[1].replace(/"/g,'""')+'"');break;default:n.push(i[1])}else n.push("")}a.push(n.join(","))}return a.join(";")}var mh={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function xh(s,a){if(!s&&!(a&&a.biff<=5&&a.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(s)?"'"+s+"'":s}function Ac(s,a,t){if(!s)return"SH33TJSERR0";if(t.biff>8&&(!s.XTI||!s.XTI[a]))return s.SheetNames[a];if(!s.XTI)return"SH33TJSERR6";var r=s.XTI[a];if(t.biff<8)return a>1e4&&(a-=65536),a<0&&(a=-a),a==0?"":s.XTI[a-1];if(!r)return"SH33TJSERR1";var n="";if(t.biff>8)switch(s[r[0]][0]){case 357:return n=r[1]==-1?"#REF":s.SheetNames[r[1]],r[1]==r[2]?n:n+":"+s.SheetNames[r[2]];case 358:return t.SID!=null?s.SheetNames[t.SID]:"SH33TJSSAME"+s[r[0]][0];case 355:default:return"SH33TJSSRC"+s[r[0]][0]}switch(s[r[0]][0][0]){case 1025:return n=r[1]==-1?"#REF":s.SheetNames[r[1]]||"SH33TJSERR3",r[1]==r[2]?n:n+":"+s.SheetNames[r[2]];case 14849:return s[r[0]].slice(1).map(function(l){return l.Name}).join(";;");default:return s[r[0]][0][3]?(n=r[1]==-1?"#REF":s[r[0]][0][3][r[1]]||"SH33TJSERR4",r[1]==r[2]?n:n+":"+s[r[0]][0][3][r[2]]):"SH33TJSERR2"}}function Ji(s,a,t){var r=Ac(s,a,t);return r=="#REF"?r:xh(r,t)}function Fa(s,a,t,r,n){var l=n&&n.biff||8,i={s:{c:0,r:0}},c=[],d,o,m,g=0,x=0,f,p="";if(!s[0]||!s[0][0])return"";for(var h=-1,w="",L=0,O=s[0].length;L<O;++L){var I=s[0][L];switch(I[0]){case"PtgUminus":c.push("-"+c.pop());break;case"PtgUplus":c.push("+"+c.pop());break;case"PtgPercent":c.push(c.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(d=c.pop(),o=c.pop(),h>=0){switch(s[0][h][1][0]){case 0:w=us(" ",s[0][h][1][1]);break;case 1:w=us("\r",s[0][h][1][1]);break;default:if(w="",n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+s[0][h][1][0])}o=o+w,h=-1}c.push(o+mh[I[0]]+d);break;case"PtgIsect":d=c.pop(),o=c.pop(),c.push(o+" "+d);break;case"PtgUnion":d=c.pop(),o=c.pop(),c.push(o+","+d);break;case"PtgRange":d=c.pop(),o=c.pop(),c.push(o+":"+d);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":m=qa(I[1][1],i,n),c.push(Qa(m,l));break;case"PtgRefN":m=t?qa(I[1][1],t,n):I[1][1],c.push(Qa(m,l));break;case"PtgRef3d":g=I[1][1],m=qa(I[1][2],i,n),p=Ji(r,g,n),c.push(p+"!"+Qa(m,l));break;case"PtgFunc":case"PtgFuncVar":var H=I[1][0],ae=I[1][1];H||(H=0),H&=127;var oe=H==0?[]:c.slice(-H);c.length-=H,ae==="User"&&(ae=oe.shift()),c.push(ae+"("+oe.join(",")+")");break;case"PtgBool":c.push(I[1]?"TRUE":"FALSE");break;case"PtgInt":c.push(I[1]);break;case"PtgNum":c.push(String(I[1]));break;case"PtgStr":c.push('"'+I[1].replace(/"/g,'""')+'"');break;case"PtgErr":c.push(I[1]);break;case"PtgAreaN":f=Ii(I[1][1],t?{s:t}:i,n),c.push(xn(f,n));break;case"PtgArea":f=Ii(I[1][1],i,n),c.push(xn(f,n));break;case"PtgArea3d":g=I[1][1],f=I[1][2],p=Ji(r,g,n),c.push(p+"!"+xn(f,n));break;case"PtgAttrSum":c.push("SUM("+c.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":x=I[1][2];var D=(r.names||[])[x-1]||(r[0]||[])[x],q=D?D.Name:"SH33TJSNAME"+String(x);q&&q.slice(0,6)=="_xlfn."&&!n.xlfn&&(q=q.slice(6)),c.push(q);break;case"PtgNameX":var z=I[1][1];x=I[1][2];var G;if(n.biff<=5)z<0&&(z=-z),r[z]&&(G=r[z][x]);else{var ce="";if(((r[z]||[])[0]||[])[0]==14849||(((r[z]||[])[0]||[])[0]==1025?r[z][x]&&r[z][x].itab>0&&(ce=r.SheetNames[r[z][x].itab-1]+"!"):ce=r.SheetNames[x-1]+"!"),r[z]&&r[z][x])ce+=r[z][x].Name;else if(r[0]&&r[0][x])ce+=r[0][x].Name;else{var M=(Ac(r,z,n)||"").split(";;");M[x-1]?ce=M[x-1]:ce+="SH33TJSERRX"}c.push(ce);break}G||(G={Name:"SH33TJSERRY"}),c.push(G.Name);break;case"PtgParen":var W="(",re=")";if(h>=0){switch(w="",s[0][h][1][0]){case 2:W=us(" ",s[0][h][1][1])+W;break;case 3:W=us("\r",s[0][h][1][1])+W;break;case 4:re=us(" ",s[0][h][1][1])+re;break;case 5:re=us("\r",s[0][h][1][1])+re;break;default:if(n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+s[0][h][1][0])}h=-1}c.push(W+c.pop()+re);break;case"PtgRefErr":c.push("#REF!");break;case"PtgRefErr3d":c.push("#REF!");break;case"PtgExp":m={c:I[1][1],r:I[1][0]};var ve={c:t.c,r:t.r};if(r.sharedf[ss(m)]){var te=r.sharedf[ss(m)];c.push(Fa(te,i,ve,r,n))}else{var ke=!1;for(d=0;d!=r.arrayf.length;++d)if(o=r.arrayf[d],!(m.c<o[0].s.c||m.c>o[0].e.c)&&!(m.r<o[0].s.r||m.r>o[0].e.r)){c.push(Fa(o[1],i,ve,r,n)),ke=!0;break}ke||c.push(I[1])}break;case"PtgArray":c.push("{"+dh(I[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":h=L;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":c.push("");break;case"PtgAreaErr":c.push("#REF!");break;case"PtgAreaErr3d":c.push("#REF!");break;case"PtgList":c.push("Table"+I[1].idx+"[#"+I[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(I));default:throw new Error("Unrecognized Formula Token: "+String(I))}var xe=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(n.biff!=3&&h>=0&&xe.indexOf(s[0][L][0])==-1){I=s[0][h];var Ie=!0;switch(I[1][0]){case 4:Ie=!1;case 0:w=us(" ",I[1][1]);break;case 5:Ie=!1;case 1:w=us("\r",I[1][1]);break;default:if(w="",n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+I[1][0])}c.push((Ie?w:"")+c.pop()+(Ie?"":w)),h=-1}}if(c.length>1&&n.WTF)throw new Error("bad formula stack");return c[0]}function hh(s){if(s==null){var a=he(8);return a.write_shift(1,3),a.write_shift(1,0),a.write_shift(2,0),a.write_shift(2,0),a.write_shift(2,65535),a}else if(typeof s=="number")return oa(s);return oa(0)}function uh(s,a,t,r,n){var l=da(a,t,n),i=hh(s.v),c=he(6),d=33;c.write_shift(2,d),c.write_shift(4,0);for(var o=he(s.bf.length),m=0;m<s.bf.length;++m)o[m]=s.bf[m];var g=Is([l,i,c,o]);return g}function nn(s,a,t){var r=s.read_shift(4),n=oh(s,r,t),l=s.read_shift(4),i=l>0?ch(s,l,n,t):null;return[n,i]}var fh=nn,ln=nn,gh=nn,ph=nn,vh={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},Fc={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},wh={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function bh(s){var a="of:="+s.replace(Vn,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return a.replace(/;/g,"|").replace(/,/g,";")}function yh(s){return s.replace(/\./,"!")}var Za=typeof Map<"u";function Yn(s,a,t){var r=0,n=s.length;if(t){if(Za?t.has(a):Object.prototype.hasOwnProperty.call(t,a)){for(var l=Za?t.get(a):t[a];r<l.length;++r)if(s[l[r]].t===a)return s.Count++,l[r]}}else for(;r<n;++r)if(s[r].t===a)return s.Count++,r;return s[n]={t:a},s.Count++,s.Unique++,t&&(Za?(t.has(a)||t.set(a,[]),t.get(a).push(n)):(Object.prototype.hasOwnProperty.call(t,a)||(t[a]=[]),t[a].push(n))),n}function cn(s,a){var t={min:s+1,max:s+1},r=-1;return a.MDW&&(Bt=a.MDW),a.width!=null?t.customWidth=1:a.wpx!=null?r=Jr(a.wpx):a.wch!=null&&(r=a.wch),r>-1?(t.width=Cn(r),t.customWidth=1):a.width!=null&&(t.width=a.width),a.hidden&&(t.hidden=!0),a.level!=null&&(t.outlineLevel=t.level=a.level),t}function Dc(s,a){if(s){var t=[.7,.7,.75,.75,.3,.3];s.left==null&&(s.left=t[0]),s.right==null&&(s.right=t[1]),s.top==null&&(s.top=t[2]),s.bottom==null&&(s.bottom=t[3]),s.header==null&&(s.header=t[4]),s.footer==null&&(s.footer=t[5])}}function ea(s,a,t){var r=t.revssf[a.z!=null?a.z:"General"],n=60,l=s.length;if(r==null&&t.ssf){for(;n<392;++n)if(t.ssf[n]==null){_l(a.z,n),t.ssf[n]=a.z,t.revssf[a.z]=r=n;break}}for(n=0;n!=l;++n)if(s[n].numFmtId===r)return n;return s[l]={numFmtId:r,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},l}function Nh(s,a,t){if(s&&s["!ref"]){var r=is(s["!ref"]);if(r.e.c<r.s.c||r.e.r<r.s.r)throw new Error("Bad range ("+t+"): "+s["!ref"])}}function jh(s){if(s.length===0)return"";for(var a='<mergeCells count="'+s.length+'">',t=0;t!=s.length;++t)a+='<mergeCell ref="'+Ns(s[t])+'"/>';return a+"</mergeCells>"}function Sh(s,a,t,r,n){var l=!1,i={},c=null;if(r.bookType!=="xlsx"&&a.vbaraw){var d=a.SheetNames[t];try{a.Workbook&&(d=a.Workbook.Sheets[t].CodeName||d)}catch{}l=!0,i.codeName=lr(es(d))}if(s&&s["!outline"]){var o={summaryBelow:1,summaryRight:1};s["!outline"].above&&(o.summaryBelow=0),s["!outline"].left&&(o.summaryRight=0),c=(c||"")+Ae("outlinePr",null,o)}!l&&!c||(n[n.length]=Ae("sheetPr",c,i))}var Th=["objects","scenarios","selectLockedCells","selectUnlockedCells"],kh=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function _h(s){var a={sheet:1};return Th.forEach(function(t){s[t]!=null&&s[t]&&(a[t]="1")}),kh.forEach(function(t){s[t]!=null&&!s[t]&&(a[t]="0")}),s.password&&(a.password=fc(s.password).toString(16).toUpperCase()),Ae("sheetProtection",null,a)}function Eh(s){return Dc(s),Ae("pageMargins",null,s)}function Ch(s,a){for(var t=["<cols>"],r,n=0;n!=a.length;++n)(r=a[n])&&(t[t.length]=Ae("col",null,cn(n,r)));return t[t.length]="</cols>",t.join("")}function Ah(s,a,t,r){var n=typeof s.ref=="string"?s.ref:Ns(s.ref);t.Workbook||(t.Workbook={Sheets:[]}),t.Workbook.Names||(t.Workbook.Names=[]);var l=t.Workbook.Names,i=mt(n);i.s.r==i.e.r&&(i.e.r=mt(a["!ref"]).e.r,n=Ns(i));for(var c=0;c<l.length;++c){var d=l[c];if(d.Name=="_xlnm._FilterDatabase"&&d.Sheet==r){d.Ref="'"+t.SheetNames[r]+"'!"+n;break}}return c==l.length&&l.push({Name:"_xlnm._FilterDatabase",Sheet:r,Ref:"'"+t.SheetNames[r]+"'!"+n}),Ae("autoFilter",null,{ref:n})}function Fh(s,a,t,r){var n={workbookViewId:"0"};return(((r||{}).Workbook||{}).Views||[])[0]&&(n.rightToLeft=r.Workbook.Views[0].RTL?"1":"0"),Ae("sheetViews",Ae("sheetView",null,n),{})}function Dh(s,a,t,r){if(s.c&&t["!comments"].push([a,s.c]),s.v===void 0&&typeof s.f!="string"||s.t==="z"&&!s.f)return"";var n="",l=s.t,i=s.v;if(s.t!=="z")switch(s.t){case"b":n=s.v?"1":"0";break;case"n":n=""+s.v;break;case"e":n=fr[s.v];break;case"d":r&&r.cellDates?n=Js(s.v,-1).toISOString():(s=at(s),s.t="n",n=""+(s.v=tt(Js(s.v)))),typeof s.z>"u"&&(s.z=gs[14]);break;default:n=s.v;break}var c=Ps("v",es(n)),d={r:a},o=ea(r.cellXfs,s,r);switch(o!==0&&(d.s=o),s.t){case"n":break;case"d":d.t="d";break;case"b":d.t="b";break;case"e":d.t="e";break;case"z":break;default:if(s.v==null){delete s.t;break}if(s.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(r&&r.bookSST){c=Ps("v",""+Yn(r.Strings,s.v,r.revStrings)),d.t="s";break}d.t="str";break}if(s.t!=l&&(s.t=l,s.v=i),typeof s.f=="string"&&s.f){var m=s.F&&s.F.slice(0,a.length)==a?{t:"array",ref:s.F}:null;c=Ae("f",es(s.f),m)+(s.v!=null?c:"")}return s.l&&t["!links"].push([a,s.l]),s.D&&(d.cm=1),Ae("c",c,d)}function Ih(s,a,t,r){var n=[],l=[],i=is(s["!ref"]),c="",d,o="",m=[],g=0,x=0,f=s["!rows"],p=Array.isArray(s),h={r:o},w,L=-1;for(x=i.s.c;x<=i.e.c;++x)m[x]=Bs(x);for(g=i.s.r;g<=i.e.r;++g){for(l=[],o=Rs(g),x=i.s.c;x<=i.e.c;++x){d=m[x]+o;var O=p?(s[g]||[])[x]:s[d];O!==void 0&&(c=Dh(O,d,s,a))!=null&&l.push(c)}(l.length>0||f&&f[g])&&(h={r:o},f&&f[g]&&(w=f[g],w.hidden&&(h.hidden=1),L=-1,w.hpx?L=Yr(w.hpx):w.hpt&&(L=w.hpt),L>-1&&(h.ht=L,h.customHeight=1),w.level&&(h.outlineLevel=w.level)),n[n.length]=Ae("row",l.join(""),h))}if(f)for(;g<f.length;++g)f&&f[g]&&(h={r:g+1},w=f[g],w.hidden&&(h.hidden=1),L=-1,w.hpx?L=Yr(w.hpx):w.hpt&&(L=w.hpt),L>-1&&(h.ht=L,h.customHeight=1),w.level&&(h.outlineLevel=w.level),n[n.length]=Ae("row","",h));return n.join("")}function Ic(s,a,t,r){var n=[js,Ae("worksheet",null,{xmlns:Da[0],"xmlns:r":Es.r})],l=t.SheetNames[s],i=0,c="",d=t.Sheets[l];d==null&&(d={});var o=d["!ref"]||"A1",m=is(o);if(m.e.c>16383||m.e.r>1048575){if(a.WTF)throw new Error("Range "+o+" exceeds format limit A1:XFD1048576");m.e.c=Math.min(m.e.c,16383),m.e.r=Math.min(m.e.c,1048575),o=Ns(m)}r||(r={}),d["!comments"]=[];var g=[];Sh(d,t,s,a,n),n[n.length]=Ae("dimension",null,{ref:o}),n[n.length]=Fh(d,a,s,t),a.sheetFormat&&(n[n.length]=Ae("sheetFormatPr",null,{defaultRowHeight:a.sheetFormat.defaultRowHeight||"16",baseColWidth:a.sheetFormat.baseColWidth||"10",outlineLevelRow:a.sheetFormat.outlineLevelRow||"7"})),d["!cols"]!=null&&d["!cols"].length>0&&(n[n.length]=Ch(d,d["!cols"])),n[i=n.length]="<sheetData/>",d["!links"]=[],d["!ref"]!=null&&(c=Ih(d,a),c.length>0&&(n[n.length]=c)),n.length>i+1&&(n[n.length]="</sheetData>",n[i]=n[i].replace("/>",">")),d["!protect"]&&(n[n.length]=_h(d["!protect"])),d["!autofilter"]!=null&&(n[n.length]=Ah(d["!autofilter"],d,t,s)),d["!merges"]!=null&&d["!merges"].length>0&&(n[n.length]=jh(d["!merges"]));var x=-1,f,p=-1;return d["!links"].length>0&&(n[n.length]="<hyperlinks>",d["!links"].forEach(function(h){h[1].Target&&(f={ref:h[0]},h[1].Target.charAt(0)!="#"&&(p=Ze(r,-1,es(h[1].Target).replace(/#.*$/,""),Je.HLINK),f["r:id"]="rId"+p),(x=h[1].Target.indexOf("#"))>-1&&(f.location=es(h[1].Target.slice(x+1))),h[1].Tooltip&&(f.tooltip=es(h[1].Tooltip)),n[n.length]=Ae("hyperlink",null,f))}),n[n.length]="</hyperlinks>"),delete d["!links"],d["!margins"]!=null&&(n[n.length]=Eh(d["!margins"])),(!a||a.ignoreEC||a.ignoreEC==null)&&(n[n.length]=Ps("ignoredErrors",Ae("ignoredError",null,{numberStoredAsText:1,sqref:o}))),g.length>0&&(p=Ze(r,-1,"../drawings/drawing"+(s+1)+".xml",Je.DRAW),n[n.length]=Ae("drawing",null,{"r:id":"rId"+p}),d["!drawing"]=g),d["!comments"].length>0&&(p=Ze(r,-1,"../drawings/vmlDrawing"+(s+1)+".vml",Je.VML),n[n.length]=Ae("legacyDrawing",null,{"r:id":"rId"+p}),d["!legacy"]=p),n.length>1&&(n[n.length]="</worksheet>",n[1]=n[1].replace("/>",">")),n.join("")}function Ph(s,a){var t={},r=s.l+a;t.r=s.read_shift(4),s.l+=4;var n=s.read_shift(2);s.l+=1;var l=s.read_shift(1);return s.l=r,l&7&&(t.level=l&7),l&16&&(t.hidden=!0),l&32&&(t.hpt=n/20),t}function Rh(s,a,t){var r=he(145),n=(t["!rows"]||[])[s]||{};r.write_shift(4,s),r.write_shift(4,0);var l=320;n.hpx?l=Yr(n.hpx)*20:n.hpt&&(l=n.hpt*20),r.write_shift(2,l),r.write_shift(1,0);var i=0;n.level&&(i|=n.level),n.hidden&&(i|=16),(n.hpx||n.hpt)&&(i|=32),r.write_shift(1,i),r.write_shift(1,0);var c=0,d=r.l;r.l+=4;for(var o={r:s,c:0},m=0;m<16;++m)if(!(a.s.c>m+1<<10||a.e.c<m<<10)){for(var g=-1,x=-1,f=m<<10;f<m+1<<10;++f){o.c=f;var p=Array.isArray(t)?(t[o.r]||[])[o.c]:t[ss(o)];p&&(g<0&&(g=f),x=f)}g<0||(++c,r.write_shift(4,g),r.write_shift(4,x))}var h=r.l;return r.l=d,r.write_shift(4,c),r.l=h,r.length>r.l?r.slice(0,r.l):r}function Oh(s,a,t,r){var n=Rh(r,t,a);(n.length>17||(a["!rows"]||[])[r])&&we(s,0,n)}var Lh=fa,Mh=Pa;function Bh(){}function Uh(s,a){var t={},r=s[s.l];return++s.l,t.above=!(r&64),t.left=!(r&128),s.l+=18,t.name=Y0(s),t}function Gh(s,a,t){t==null&&(t=he(84+4*s.length));var r=192;a&&(a.above&&(r&=-65),a.left&&(r&=-129)),t.write_shift(1,r);for(var n=1;n<3;++n)t.write_shift(1,0);return Kr({auto:1},t),t.write_shift(-4,-1),t.write_shift(-4,-1),Xl(s,t),t.slice(0,t.l)}function Hh(s){var a=vt(s);return[a]}function zh(s,a,t){return t==null&&(t=he(8)),xa(a,t)}function Wh(s){var a=ha(s);return[a]}function $h(s,a,t){return t==null&&(t=he(4)),ua(a,t)}function Kh(s){var a=vt(s),t=s.read_shift(1);return[a,t,"b"]}function Vh(s,a,t){return t==null&&(t=he(9)),xa(a,t),t.write_shift(1,s.v?1:0),t}function Xh(s){var a=ha(s),t=s.read_shift(1);return[a,t,"b"]}function Jh(s,a,t){return t==null&&(t=he(5)),ua(a,t),t.write_shift(1,s.v?1:0),t}function Yh(s){var a=vt(s),t=s.read_shift(1);return[a,t,"e"]}function qh(s,a,t){return t==null&&(t=he(9)),xa(a,t),t.write_shift(1,s.v),t}function Qh(s){var a=ha(s),t=s.read_shift(1);return[a,t,"e"]}function Zh(s,a,t){return t==null&&(t=he(8)),ua(a,t),t.write_shift(1,s.v),t.write_shift(2,0),t.write_shift(1,0),t}function eu(s){var a=vt(s),t=s.read_shift(4);return[a,t,"s"]}function su(s,a,t){return t==null&&(t=he(12)),xa(a,t),t.write_shift(4,a.v),t}function tu(s){var a=ha(s),t=s.read_shift(4);return[a,t,"s"]}function au(s,a,t){return t==null&&(t=he(8)),ua(a,t),t.write_shift(4,a.v),t}function ru(s){var a=vt(s),t=Ra(s);return[a,t,"n"]}function nu(s,a,t){return t==null&&(t=he(16)),xa(a,t),oa(s.v,t),t}function iu(s){var a=ha(s),t=Ra(s);return[a,t,"n"]}function lu(s,a,t){return t==null&&(t=he(12)),ua(a,t),oa(s.v,t),t}function cu(s){var a=vt(s),t=Jl(s);return[a,t,"n"]}function ou(s,a,t){return t==null&&(t=he(12)),xa(a,t),Yl(s.v,t),t}function du(s){var a=ha(s),t=Jl(s);return[a,t,"n"]}function mu(s,a,t){return t==null&&(t=he(8)),ua(a,t),Yl(s.v,t),t}function xu(s){var a=vt(s),t=Hn(s);return[a,t,"is"]}function hu(s){var a=vt(s),t=Us(s);return[a,t,"str"]}function uu(s,a,t){return t==null&&(t=he(12+4*s.v.length)),xa(a,t),As(s.v,t),t.length>t.l?t.slice(0,t.l):t}function fu(s){var a=ha(s),t=Us(s);return[a,t,"str"]}function gu(s,a,t){return t==null&&(t=he(8+4*s.v.length)),ua(a,t),As(s.v,t),t.length>t.l?t.slice(0,t.l):t}function pu(s,a,t){var r=s.l+a,n=vt(s);n.r=t["!row"];var l=s.read_shift(1),i=[n,l,"b"];if(t.cellFormula){s.l+=2;var c=ln(s,r-s.l,t);i[3]=Fa(c,null,n,t.supbooks,t)}else s.l=r;return i}function vu(s,a,t){var r=s.l+a,n=vt(s);n.r=t["!row"];var l=s.read_shift(1),i=[n,l,"e"];if(t.cellFormula){s.l+=2;var c=ln(s,r-s.l,t);i[3]=Fa(c,null,n,t.supbooks,t)}else s.l=r;return i}function wu(s,a,t){var r=s.l+a,n=vt(s);n.r=t["!row"];var l=Ra(s),i=[n,l,"n"];if(t.cellFormula){s.l+=2;var c=ln(s,r-s.l,t);i[3]=Fa(c,null,n,t.supbooks,t)}else s.l=r;return i}function bu(s,a,t){var r=s.l+a,n=vt(s);n.r=t["!row"];var l=Us(s),i=[n,l,"str"];if(t.cellFormula){s.l+=2;var c=ln(s,r-s.l,t);i[3]=Fa(c,null,n,t.supbooks,t)}else s.l=r;return i}var yu=fa,Nu=Pa;function ju(s,a){return a==null&&(a=he(4)),a.write_shift(4,s),a}function Su(s,a){var t=s.l+a,r=fa(s),n=zn(s),l=Us(s),i=Us(s),c=Us(s);s.l=t;var d={rfx:r,relId:n,loc:l,display:c};return i&&(d.Tooltip=i),d}function Tu(s,a){var t=he(50+4*(s[1].Target.length+(s[1].Tooltip||"").length));Pa({s:Cs(s[0]),e:Cs(s[0])},t),Wn("rId"+a,t);var r=s[1].Target.indexOf("#"),n=r==-1?"":s[1].Target.slice(r+1);return As(n||"",t),As(s[1].Tooltip||"",t),As("",t),t.slice(0,t.l)}function ku(){}function _u(s,a,t){var r=s.l+a,n=ql(s),l=s.read_shift(1),i=[n];if(i[2]=l,t.cellFormula){var c=fh(s,r-s.l,t);i[1]=c}else s.l=r;return i}function Eu(s,a,t){var r=s.l+a,n=fa(s),l=[n];if(t.cellFormula){var i=ph(s,r-s.l,t);l[1]=i,s.l=r}else s.l=r;return l}function Cu(s,a,t){t==null&&(t=he(18));var r=cn(s,a);t.write_shift(-4,s),t.write_shift(-4,s),t.write_shift(4,(r.width||10)*256),t.write_shift(4,0);var n=0;return a.hidden&&(n|=1),typeof r.width=="number"&&(n|=2),a.level&&(n|=a.level<<8),t.write_shift(2,n),t}var Pc=["left","right","top","bottom","header","footer"];function Au(s){var a={};return Pc.forEach(function(t){a[t]=Ra(s)}),a}function Fu(s,a){return a==null&&(a=he(6*8)),Dc(s),Pc.forEach(function(t){oa(s[t],a)}),a}function Du(s){var a=s.read_shift(2);return s.l+=28,{RTL:a&32}}function Iu(s,a,t){t==null&&(t=he(30));var r=924;return(((a||{}).Views||[])[0]||{}).RTL&&(r|=32),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,100),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(4,0),t}function Pu(s){var a=he(24);return a.write_shift(4,4),a.write_shift(4,1),Pa(s,a),a}function Ru(s,a){return a==null&&(a=he(16*4+2)),a.write_shift(2,s.password?fc(s.password):0),a.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(t){t[1]?a.write_shift(4,s[t[0]]!=null&&!s[t[0]]?1:0):a.write_shift(4,s[t[0]]!=null&&s[t[0]]?0:1)}),a}function Ou(){}function Lu(){}function Mu(s,a,t,r,n,l,i){if(a.v===void 0)return!1;var c="";switch(a.t){case"b":c=a.v?"1":"0";break;case"d":a=at(a),a.z=a.z||gs[14],a.v=tt(Js(a.v)),a.t="n";break;case"n":case"e":c=""+a.v;break;default:c=a.v;break}var d={r:t,c:r};switch(d.s=ea(n.cellXfs,a,n),a.l&&l["!links"].push([ss(d),a.l]),a.c&&l["!comments"].push([ss(d),a.c]),a.t){case"s":case"str":return n.bookSST?(c=Yn(n.Strings,a.v,n.revStrings),d.t="s",d.v=c,i?we(s,18,au(a,d)):we(s,7,su(a,d))):(d.t="str",i?we(s,17,gu(a,d)):we(s,6,uu(a,d))),!0;case"n":return a.v==(a.v|0)&&a.v>-1e3&&a.v<1e3?i?we(s,13,mu(a,d)):we(s,2,ou(a,d)):i?we(s,16,lu(a,d)):we(s,5,nu(a,d)),!0;case"b":return d.t="b",i?we(s,15,Jh(a,d)):we(s,4,Vh(a,d)),!0;case"e":return d.t="e",i?we(s,14,Zh(a,d)):we(s,3,qh(a,d)),!0}return i?we(s,12,$h(a,d)):we(s,1,zh(a,d)),!0}function Bu(s,a,t,r){var n=is(a["!ref"]||"A1"),l,i="",c=[];we(s,145);var d=Array.isArray(a),o=n.e.r;a["!rows"]&&(o=Math.max(n.e.r,a["!rows"].length-1));for(var m=n.s.r;m<=o;++m){i=Rs(m),Oh(s,a,n,m);var g=!1;if(m<=n.e.r)for(var x=n.s.c;x<=n.e.c;++x){m===n.s.r&&(c[x]=Bs(x)),l=c[x]+i;var f=d?(a[m]||[])[x]:a[l];if(!f){g=!1;continue}g=Mu(s,f,m,x,r,a,g)}}we(s,146)}function Uu(s,a){!a||!a["!merges"]||(we(s,177,ju(a["!merges"].length)),a["!merges"].forEach(function(t){we(s,176,Nu(t))}),we(s,178))}function Gu(s,a){!a||!a["!cols"]||(we(s,390),a["!cols"].forEach(function(t,r){t&&we(s,60,Cu(r,t))}),we(s,391))}function Hu(s,a){!a||!a["!ref"]||(we(s,648),we(s,649,Pu(is(a["!ref"]))),we(s,650))}function zu(s,a,t){a["!links"].forEach(function(r){if(r[1].Target){var n=Ze(t,-1,r[1].Target.replace(/#.*$/,""),Je.HLINK);we(s,494,Tu(r,n))}}),delete a["!links"]}function Wu(s,a,t,r){if(a["!comments"].length>0){var n=Ze(r,-1,"../drawings/vmlDrawing"+(t+1)+".vml",Je.VML);we(s,551,Wn("rId"+n)),a["!legacy"]=n}}function $u(s,a,t,r){if(a["!autofilter"]){var n=a["!autofilter"],l=typeof n.ref=="string"?n.ref:Ns(n.ref);t.Workbook||(t.Workbook={Sheets:[]}),t.Workbook.Names||(t.Workbook.Names=[]);var i=t.Workbook.Names,c=mt(l);c.s.r==c.e.r&&(c.e.r=mt(a["!ref"]).e.r,l=Ns(c));for(var d=0;d<i.length;++d){var o=i[d];if(o.Name=="_xlnm._FilterDatabase"&&o.Sheet==r){o.Ref="'"+t.SheetNames[r]+"'!"+l;break}}d==i.length&&i.push({Name:"_xlnm._FilterDatabase",Sheet:r,Ref:"'"+t.SheetNames[r]+"'!"+l}),we(s,161,Pa(is(l))),we(s,162)}}function Ku(s,a,t){we(s,133),we(s,137,Iu(a,t)),we(s,138),we(s,134)}function Vu(s,a){a["!protect"]&&we(s,535,Ru(a["!protect"]))}function Xu(s,a,t,r){var n=st(),l=t.SheetNames[s],i=t.Sheets[l]||{},c=l;try{t&&t.Workbook&&(c=t.Workbook.Sheets[s].CodeName||c)}catch{}var d=is(i["!ref"]||"A1");if(d.e.c>16383||d.e.r>1048575){if(a.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");d.e.c=Math.min(d.e.c,16383),d.e.r=Math.min(d.e.c,1048575)}return i["!links"]=[],i["!comments"]=[],we(n,129),(t.vbaraw||i["!outline"])&&we(n,147,Gh(c,i["!outline"])),we(n,148,Mh(d)),Ku(n,i,t.Workbook),Gu(n,i),Bu(n,i,s,a),Vu(n,i),$u(n,i,t,s),Uu(n,i),zu(n,i,r),i["!margins"]&&we(n,476,Fu(i["!margins"])),(!a||a.ignoreEC||a.ignoreEC==null)&&Hu(n,i),Wu(n,i,s,r),we(n,130),n.end()}function Ju(s,a){s.l+=10;var t=Us(s);return{name:t}}var Yu=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]];function qu(s){return!s.Workbook||!s.Workbook.WBProps?"false":E0(s.Workbook.WBProps.date1904)?"true":"false"}var Qu="][*?/\\".split("");function Rc(s,a){if(s.length>31)throw new Error("Sheet names cannot exceed 31 chars");var t=!0;return Qu.forEach(function(r){if(s.indexOf(r)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),t}function Zu(s,a,t){s.forEach(function(r,n){Rc(r);for(var l=0;l<n;++l)if(r==s[l])throw new Error("Duplicate Sheet Name: "+r);if(t){var i=a&&a[n]&&a[n].CodeName||r;if(i.charCodeAt(0)==95&&i.length>22)throw new Error("Bad Code Name: Worksheet"+i)}})}function ef(s){if(!s||!s.SheetNames||!s.Sheets)throw new Error("Invalid Workbook");if(!s.SheetNames.length)throw new Error("Workbook is empty");var a=s.Workbook&&s.Workbook.Sheets||[];Zu(s.SheetNames,a,!!s.vbaraw);for(var t=0;t<s.SheetNames.length;++t)Nh(s.Sheets[s.SheetNames[t]],s.SheetNames[t],t)}function Oc(s){var a=[js];a[a.length]=Ae("workbook",null,{xmlns:Da[0],"xmlns:r":Es.r});var t=s.Workbook&&(s.Workbook.Names||[]).length>0,r={codeName:"ThisWorkbook"};s.Workbook&&s.Workbook.WBProps&&(Yu.forEach(function(c){s.Workbook.WBProps[c[0]]!=null&&s.Workbook.WBProps[c[0]]!=c[1]&&(r[c[0]]=s.Workbook.WBProps[c[0]])}),s.Workbook.WBProps.CodeName&&(r.codeName=s.Workbook.WBProps.CodeName,delete r.CodeName)),a[a.length]=Ae("workbookPr",null,r);var n=s.Workbook&&s.Workbook.Sheets||[],l=0;if(n&&n[0]&&n[0].Hidden){for(a[a.length]="<bookViews>",l=0;l!=s.SheetNames.length&&!(!n[l]||!n[l].Hidden);++l);l==s.SheetNames.length&&(l=0),a[a.length]='<workbookView firstSheet="'+l+'" activeTab="'+l+'"/>',a[a.length]="</bookViews>"}for(a[a.length]="<sheets>",l=0;l!=s.SheetNames.length;++l){var i={name:es(s.SheetNames[l].slice(0,31))};if(i.sheetId=""+(l+1),i["r:id"]="rId"+(l+1),n[l])switch(n[l].Hidden){case 1:i.state="hidden";break;case 2:i.state="veryHidden";break}a[a.length]=Ae("sheet",null,i)}return a[a.length]="</sheets>",t&&(a[a.length]="<definedNames>",s.Workbook&&s.Workbook.Names&&s.Workbook.Names.forEach(function(c){var d={name:c.Name};c.Comment&&(d.comment=c.Comment),c.Sheet!=null&&(d.localSheetId=""+c.Sheet),c.Hidden&&(d.hidden="1"),c.Ref&&(a[a.length]=Ae("definedName",es(c.Ref),d))}),a[a.length]="</definedNames>"),a.length>2&&(a[a.length]="</workbook>",a[1]=a[1].replace("/>",">")),a.join("")}function sf(s,a){var t={};return t.Hidden=s.read_shift(4),t.iTabID=s.read_shift(4),t.strRelID=En(s),t.name=Us(s),t}function tf(s,a){return a||(a=he(127)),a.write_shift(4,s.Hidden),a.write_shift(4,s.iTabID),Wn(s.strRelID,a),As(s.name.slice(0,31),a),a.length>a.l?a.slice(0,a.l):a}function af(s,a){var t={},r=s.read_shift(4);t.defaultThemeVersion=s.read_shift(4);var n=a>8?Us(s):"";return n.length>0&&(t.CodeName=n),t.autoCompressPictures=!!(r&65536),t.backupFile=!!(r&64),t.checkCompatibility=!!(r&4096),t.date1904=!!(r&1),t.filterPrivacy=!!(r&8),t.hidePivotFieldList=!!(r&1024),t.promptedSolutions=!!(r&16),t.publishItems=!!(r&2048),t.refreshAllConnections=!!(r&262144),t.saveExternalLinkValues=!!(r&128),t.showBorderUnselectedTables=!!(r&4),t.showInkAnnotation=!!(r&32),t.showObjects=["all","placeholders","none"][r>>13&3],t.showPivotChartFilter=!!(r&32768),t.updateLinks=["userSet","never","always"][r>>8&3],t}function rf(s,a){a||(a=he(72));var t=0;return s&&s.filterPrivacy&&(t|=8),a.write_shift(4,t),a.write_shift(4,0),Xl(s&&s.CodeName||"ThisWorkbook",a),a.slice(0,a.l)}function nf(s,a,t){var r=s.l+a;s.l+=4,s.l+=1;var n=s.read_shift(4),l=q0(s),i=gh(s,0,t),c=zn(s);s.l=r;var d={Name:l,Ptg:i};return n<268435455&&(d.Sheet=n),c&&(d.Comment=c),d}function lf(s,a){we(s,143);for(var t=0;t!=a.SheetNames.length;++t){var r=a.Workbook&&a.Workbook.Sheets&&a.Workbook.Sheets[t]&&a.Workbook.Sheets[t].Hidden||0,n={Hidden:r,iTabID:t+1,strRelID:"rId"+(t+1),name:a.SheetNames[t]};we(s,156,tf(n))}we(s,144)}function cf(s,a){a||(a=he(127));for(var t=0;t!=4;++t)a.write_shift(4,0);return As("SheetJS",a),As(Br.version,a),As(Br.version,a),As("7262",a),a.length>a.l?a.slice(0,a.l):a}function of(s,a){a||(a=he(29)),a.write_shift(-4,0),a.write_shift(-4,460),a.write_shift(4,28800),a.write_shift(4,17600),a.write_shift(4,500),a.write_shift(4,s),a.write_shift(4,s);var t=120;return a.write_shift(1,t),a.length>a.l?a.slice(0,a.l):a}function df(s,a){if(!(!a.Workbook||!a.Workbook.Sheets)){for(var t=a.Workbook.Sheets,r=0,n=-1,l=-1;r<t.length;++r)!t[r]||!t[r].Hidden&&n==-1?n=r:t[r].Hidden==1&&l==-1&&(l=r);l>n||(we(s,135),we(s,158,of(n)),we(s,136))}}function mf(s,a){var t=st();return we(t,131),we(t,128,cf()),we(t,153,rf(s.Workbook&&s.Workbook.WBProps||null)),df(t,s),lf(t,s),we(t,132),t.end()}function xf(s,a,t){return(a.slice(-4)===".bin"?mf:Oc)(s)}function hf(s,a,t,r,n){return(a.slice(-4)===".bin"?Xu:Ic)(s,t,r,n)}function uf(s,a,t){return(a.slice(-4)===".bin"?Fm:vc)(s,t)}function ff(s,a,t){return(a.slice(-4)===".bin"?rm:uc)(s,t)}function gf(s,a,t){return(a.slice(-4)===".bin"?Vm:jc)(s)}function pf(s){return(s.slice(-4)===".bin"?Bm:yc)()}function vf(s,a){var t=[];return s.Props&&t.push(hd(s.Props,a)),s.Custprops&&t.push(ud(s.Props,s.Custprops)),t.join("")}function wf(){return""}function bf(s,a){var t=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return a.cellXfs.forEach(function(r,n){var l=[];l.push(Ae("NumberFormat",null,{"ss:Format":es(gs[r.numFmtId])}));var i={"ss:ID":"s"+(21+n)};t.push(Ae("Style",l.join(""),i))}),Ae("Styles",t.join(""))}function Lc(s){return Ae("NamedRange",null,{"ss:Name":s.Name,"ss:RefersTo":"="+Xn(s.Ref,{r:0,c:0})})}function yf(s){if(!((s||{}).Workbook||{}).Names)return"";for(var a=s.Workbook.Names,t=[],r=0;r<a.length;++r){var n=a[r];n.Sheet==null&&(n.Name.match(/^_xlfn\./)||t.push(Lc(n)))}return Ae("Names",t.join(""))}function Nf(s,a,t,r){if(!s||!((r||{}).Workbook||{}).Names)return"";for(var n=r.Workbook.Names,l=[],i=0;i<n.length;++i){var c=n[i];c.Sheet==t&&(c.Name.match(/^_xlfn\./)||l.push(Lc(c)))}return l.join("")}function jf(s,a,t,r){if(!s)return"";var n=[];if(s["!margins"]&&(n.push("<PageSetup>"),s["!margins"].header&&n.push(Ae("Header",null,{"x:Margin":s["!margins"].header})),s["!margins"].footer&&n.push(Ae("Footer",null,{"x:Margin":s["!margins"].footer})),n.push(Ae("PageMargins",null,{"x:Bottom":s["!margins"].bottom||"0.75","x:Left":s["!margins"].left||"0.7","x:Right":s["!margins"].right||"0.7","x:Top":s["!margins"].top||"0.75"})),n.push("</PageSetup>")),r&&r.Workbook&&r.Workbook.Sheets&&r.Workbook.Sheets[t])if(r.Workbook.Sheets[t].Hidden)n.push(Ae("Visible",r.Workbook.Sheets[t].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var l=0;l<t&&!(r.Workbook.Sheets[l]&&!r.Workbook.Sheets[l].Hidden);++l);l==t&&n.push("<Selected/>")}return((((r||{}).Workbook||{}).Views||[])[0]||{}).RTL&&n.push("<DisplayRightToLeft/>"),s["!protect"]&&(n.push(Ps("ProtectContents","True")),s["!protect"].objects&&n.push(Ps("ProtectObjects","True")),s["!protect"].scenarios&&n.push(Ps("ProtectScenarios","True")),s["!protect"].selectLockedCells!=null&&!s["!protect"].selectLockedCells?n.push(Ps("EnableSelection","NoSelection")):s["!protect"].selectUnlockedCells!=null&&!s["!protect"].selectUnlockedCells&&n.push(Ps("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(i){s["!protect"][i[0]]&&n.push("<"+i[1]+"/>")})),n.length==0?"":Ae("WorksheetOptions",n.join(""),{xmlns:it.x})}function Sf(s){return s.map(function(a){var t=_0(a.t||""),r=Ae("ss:Data",t,{xmlns:"http://www.w3.org/TR/REC-html40"});return Ae("Comment",r,{"ss:Author":a.a})}).join("")}function Tf(s,a,t,r,n,l,i){if(!s||s.v==null&&s.f==null)return"";var c={};if(s.f&&(c["ss:Formula"]="="+es(Xn(s.f,i))),s.F&&s.F.slice(0,a.length)==a){var d=Cs(s.F.slice(a.length+1));c["ss:ArrayRange"]="RC:R"+(d.r==i.r?"":"["+(d.r-i.r)+"]")+"C"+(d.c==i.c?"":"["+(d.c-i.c)+"]")}if(s.l&&s.l.Target&&(c["ss:HRef"]=es(s.l.Target),s.l.Tooltip&&(c["x:HRefScreenTip"]=es(s.l.Tooltip))),t["!merges"])for(var o=t["!merges"],m=0;m!=o.length;++m)o[m].s.c!=i.c||o[m].s.r!=i.r||(o[m].e.c>o[m].s.c&&(c["ss:MergeAcross"]=o[m].e.c-o[m].s.c),o[m].e.r>o[m].s.r&&(c["ss:MergeDown"]=o[m].e.r-o[m].s.r));var g="",x="";switch(s.t){case"z":if(!r.sheetStubs)return"";break;case"n":g="Number",x=String(s.v);break;case"b":g="Boolean",x=s.v?"1":"0";break;case"e":g="Error",x=fr[s.v];break;case"d":g="DateTime",x=new Date(s.v).toISOString(),s.z==null&&(s.z=s.z||gs[14]);break;case"s":g="String",x=k0(s.v||"");break}var f=ea(r.cellXfs,s,r);c["ss:StyleID"]="s"+(21+f),c["ss:Index"]=i.c+1;var p=s.v!=null?x:"",h=s.t=="z"?"":'<Data ss:Type="'+g+'">'+p+"</Data>";return(s.c||[]).length>0&&(h+=Sf(s.c)),Ae("Cell",h,c)}function kf(s,a){var t='<Row ss:Index="'+(s+1)+'"';return a&&(a.hpt&&!a.hpx&&(a.hpx=pc(a.hpt)),a.hpx&&(t+=' ss:AutoFitHeight="0" ss:Height="'+a.hpx+'"'),a.hidden&&(t+=' ss:Hidden="1"')),t+">"}function _f(s,a,t,r){if(!s["!ref"])return"";var n=is(s["!ref"]),l=s["!merges"]||[],i=0,c=[];s["!cols"]&&s["!cols"].forEach(function(w,L){Kn(w);var O=!!w.width,I=cn(L,w),H={"ss:Index":L+1};O&&(H["ss:Width"]=Xr(I.width)),w.hidden&&(H["ss:Hidden"]="1"),c.push(Ae("Column",null,H))});for(var d=Array.isArray(s),o=n.s.r;o<=n.e.r;++o){for(var m=[kf(o,(s["!rows"]||[])[o])],g=n.s.c;g<=n.e.c;++g){var x=!1;for(i=0;i!=l.length;++i)if(!(l[i].s.c>g)&&!(l[i].s.r>o)&&!(l[i].e.c<g)&&!(l[i].e.r<o)){(l[i].s.c!=g||l[i].s.r!=o)&&(x=!0);break}if(!x){var f={r:o,c:g},p=ss(f),h=d?(s[o]||[])[g]:s[p];m.push(Tf(h,p,s,a,t,r,f))}}m.push("</Row>"),m.length>2&&c.push(m.join(""))}return c.join("")}function Ef(s,a,t){var r=[],n=t.SheetNames[s],l=t.Sheets[n],i=l?Nf(l,a,s,t):"";return i.length>0&&r.push("<Names>"+i+"</Names>"),i=l?_f(l,a,s,t):"",i.length>0&&r.push("<Table>"+i+"</Table>"),r.push(jf(l,a,s,t)),r.join("")}function Cf(s,a){a||(a={}),s.SSF||(s.SSF=at(gs)),s.SSF&&(tn(),sn(s.SSF),a.revssf=an(s.SSF),a.revssf[s.SSF[65535]]=0,a.ssf=s.SSF,a.cellXfs=[],ea(a.cellXfs,{},{revssf:{General:0}}));var t=[];t.push(vf(s,a)),t.push(wf()),t.push(""),t.push("");for(var r=0;r<s.SheetNames.length;++r)t.push(Ae("Worksheet",Ef(r,a,s),{"ss:Name":es(s.SheetNames[r])}));return t[2]=bf(s,a),t[3]=yf(s),js+Ae("Workbook",t.join(""),{xmlns:it.ss,"xmlns:o":it.o,"xmlns:x":it.x,"xmlns:ss":it.ss,"xmlns:dt":it.dt,"xmlns:html":it.html})}var fn={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function Af(s,a){var t=[],r=[],n=[],l=0,i,c=Ni(Ri,"n"),d=Ni(Oi,"n");if(s.Props)for(i=Os(s.Props),l=0;l<i.length;++l)(Object.prototype.hasOwnProperty.call(c,i[l])?t:Object.prototype.hasOwnProperty.call(d,i[l])?r:n).push([i[l],s.Props[i[l]]]);if(s.Custprops)for(i=Os(s.Custprops),l=0;l<i.length;++l)Object.prototype.hasOwnProperty.call(s.Props||{},i[l])||(Object.prototype.hasOwnProperty.call(c,i[l])?t:Object.prototype.hasOwnProperty.call(d,i[l])?r:n).push([i[l],s.Custprops[i[l]]]);var o=[];for(l=0;l<n.length;++l)lc.indexOf(n[l][0])>-1||rc.indexOf(n[l][0])>-1||n[l][1]!=null&&o.push(n[l]);r.length&&ts.utils.cfb_add(a,"/SummaryInformation",Gi(r,fn.SI,d,Oi)),(t.length||o.length)&&ts.utils.cfb_add(a,"/DocumentSummaryInformation",Gi(t,fn.DSI,c,Ri,o.length?o:null,fn.UDI))}function Ff(s,a){var t=a||{},r=ts.utils.cfb_new({root:"R"}),n="/Workbook";switch(t.bookType||"xls"){case"xls":t.bookType="biff8";case"xla":t.bookType||(t.bookType="xla");case"biff8":n="/Workbook",t.biff=8;break;case"biff5":n="/Book",t.biff=5;break;default:throw new Error("invalid type "+t.bookType+" for XLS CFB")}return ts.utils.cfb_add(r,n,Mc(s,t)),t.biff==8&&(s.Props||s.Custprops)&&Af(s,r),t.biff==8&&s.vbaraw&&Xm(r,ts.read(s.vbaraw,{type:typeof s.vbaraw=="string"?"binary":"buffer"})),r}var Df={0:{f:Ph},1:{f:Hh},2:{f:cu},3:{f:Yh},4:{f:Kh},5:{f:ru},6:{f:hu},7:{f:eu},8:{f:bu},9:{f:wu},10:{f:pu},11:{f:vu},12:{f:Wh},13:{f:du},14:{f:Qh},15:{f:Xh},16:{f:iu},17:{f:fu},18:{f:tu},19:{f:Hn},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:nf},40:{},42:{},43:{f:hm},44:{f:mm},45:{f:gm},46:{f:vm},47:{f:pm},48:{},49:{f:W0},50:{},51:{f:Pm},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:$d},62:{f:xu},63:{f:Um},64:{f:Ou},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Ft,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:Du},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:Uh},148:{f:Lh,p:16},151:{f:ku},152:{},153:{f:af},154:{},155:{},156:{f:sf},157:{},158:{},159:{T:1,f:sm},160:{T:-1},161:{T:1,f:fa},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:yu},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:Dm},336:{T:-1},337:{f:Lm,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:En},357:{},358:{},359:{},360:{T:1},361:{},362:{f:Bd},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:_u},427:{f:Eu},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:Au},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:Bh},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:Su},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:En},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:$m},633:{T:1},634:{T:-1},635:{T:1,f:zm},636:{T:-1},637:{f:X0},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:Ju},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:Lu},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}};function Fe(s,a,t,r){var n=a;if(!isNaN(n)){var l=r||(t||[]).length||0,i=s.next(4);i.write_shift(2,n),i.write_shift(2,l),l>0&&Bn(t)&&s.push(t)}}function If(s,a,t,r){var n=(t||[]).length||0;if(n<=8224)return Fe(s,a,t,n);var l=a;if(!isNaN(l)){for(var i=t.parts||[],c=0,d=0,o=0;o+(i[c]||8224)<=8224;)o+=i[c]||8224,c++;var m=s.next(4);for(m.write_shift(2,l),m.write_shift(2,o),s.push(t.slice(d,d+o)),d+=o;d<n;){for(m=s.next(4),m.write_shift(2,60),o=0;o+(i[c]||8224)<=8224;)o+=i[c]||8224,c++;m.write_shift(2,o),s.push(t.slice(d,d+o)),d+=o}}}function pr(s,a,t){return s||(s=he(7)),s.write_shift(2,a),s.write_shift(2,t),s.write_shift(2,0),s.write_shift(1,0),s}function Pf(s,a,t,r){var n=he(9);return pr(n,s,a),oc(t,r||"b",n),n}function Rf(s,a,t){var r=he(8+2*t.length);return pr(r,s,a),r.write_shift(1,t.length),r.write_shift(t.length,t,"sbcs"),r.l<r.length?r.slice(0,r.l):r}function Of(s,a,t,r){if(a.v!=null)switch(a.t){case"d":case"n":var n=a.t=="d"?tt(Js(a.v)):a.v;n==(n|0)&&n>=0&&n<65536?Fe(s,2,Jd(t,r,n)):Fe(s,3,Xd(t,r,n));return;case"b":case"e":Fe(s,5,Pf(t,r,a.v,a.t));return;case"s":case"str":Fe(s,4,Rf(t,r,(a.v||"").slice(0,255)));return}Fe(s,1,pr(null,t,r))}function Lf(s,a,t,r){var n=Array.isArray(a),l=is(a["!ref"]||"A1"),i,c="",d=[];if(l.e.c>255||l.e.r>16383){if(r.WTF)throw new Error("Range "+(a["!ref"]||"A1")+" exceeds format limit A1:IV16384");l.e.c=Math.min(l.e.c,255),l.e.r=Math.min(l.e.c,16383),i=Ns(l)}for(var o=l.s.r;o<=l.e.r;++o){c=Rs(o);for(var m=l.s.c;m<=l.e.c;++m){o===l.s.r&&(d[m]=Bs(m)),i=d[m]+c;var g=n?(a[o]||[])[m]:a[i];g&&Of(s,g,o,m)}}}function Mf(s,a){for(var t=a||{},r=st(),n=0,l=0;l<s.SheetNames.length;++l)s.SheetNames[l]==t.sheet&&(n=l);if(n==0&&t.sheet&&s.SheetNames[0]!=t.sheet)throw new Error("Sheet not found: "+t.sheet);return Fe(r,t.biff==4?1033:t.biff==3?521:9,$n(s,16,t)),Lf(r,s.Sheets[s.SheetNames[n]],n,t),Fe(r,10),r.end()}function Bf(s,a,t){Fe(s,49,Fd({sz:12,name:"Arial"},t))}function Uf(s,a,t){a&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)a[n]!=null&&Fe(s,1054,Pd(n,a[n],t))})}function Gf(s,a){var t=he(19);t.write_shift(4,2151),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(2,3),t.write_shift(1,1),t.write_shift(4,0),Fe(s,2151,t),t=he(39),t.write_shift(4,2152),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(2,3),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(2,1),t.write_shift(4,4),t.write_shift(2,0),xc(is(a["!ref"]||"A1"),t),t.write_shift(4,4),Fe(s,2152,t)}function Hf(s,a){for(var t=0;t<16;++t)Fe(s,224,zi({numFmtId:0,style:!0},0,a));a.cellXfs.forEach(function(r){Fe(s,224,zi(r,0,a))})}function zf(s,a){for(var t=0;t<a["!links"].length;++t){var r=a["!links"][t];Fe(s,440,Hd(r)),r[1].Tooltip&&Fe(s,2048,zd(r))}delete a["!links"]}function Wf(s,a){if(a){var t=0;a.forEach(function(r,n){++t<=256&&r&&Fe(s,125,Kd(cn(n,r),n))})}}function $f(s,a,t,r,n){var l=16+ea(n.cellXfs,a,n);if(a.v==null&&!a.bf){Fe(s,513,da(t,r,l));return}if(a.bf)Fe(s,6,uh(a,t,r,n,l));else switch(a.t){case"d":case"n":var i=a.t=="d"?tt(Js(a.v)):a.v;Fe(s,515,Md(t,r,i,l));break;case"b":case"e":Fe(s,517,Ld(t,r,a.v,l,n,a.t));break;case"s":case"str":if(n.bookSST){var c=Yn(n.Strings,a.v,n.revStrings);Fe(s,253,Dd(t,r,c,l))}else Fe(s,516,Id(t,r,(a.v||"").slice(0,255),l,n));break;default:Fe(s,513,da(t,r,l))}}function Kf(s,a,t){var r=st(),n=t.SheetNames[s],l=t.Sheets[n]||{},i=(t||{}).Workbook||{},c=(i.Sheets||[])[s]||{},d=Array.isArray(l),o=a.biff==8,m,g="",x=[],f=is(l["!ref"]||"A1"),p=o?65536:16384;if(f.e.c>255||f.e.r>=p){if(a.WTF)throw new Error("Range "+(l["!ref"]||"A1")+" exceeds format limit A1:IV16384");f.e.c=Math.min(f.e.c,255),f.e.r=Math.min(f.e.c,p-1)}Fe(r,2057,$n(t,16,a)),Fe(r,13,ut(1)),Fe(r,12,ut(100)),Fe(r,15,zs(!0)),Fe(r,17,zs(!1)),Fe(r,16,oa(.001)),Fe(r,95,zs(!0)),Fe(r,42,zs(!1)),Fe(r,43,zs(!1)),Fe(r,130,ut(1)),Fe(r,128,Od()),Fe(r,131,zs(!1)),Fe(r,132,zs(!1)),o&&Wf(r,l["!cols"]),Fe(r,512,Rd(f,a)),o&&(l["!links"]=[]);for(var h=f.s.r;h<=f.e.r;++h){g=Rs(h);for(var w=f.s.c;w<=f.e.c;++w){h===f.s.r&&(x[w]=Bs(w)),m=x[w]+g;var L=d?(l[h]||[])[w]:l[m];L&&($f(r,L,h,w,a),o&&L.l&&l["!links"].push([m,L.l]))}}var O=c.CodeName||c.name||n;return o&&Fe(r,574,Ad((i.Views||[])[0])),o&&(l["!merges"]||[]).length&&Fe(r,229,Gd(l["!merges"])),o&&zf(r,l),Fe(r,442,mc(O)),o&&Gf(r,l),Fe(r,10),r.end()}function Vf(s,a,t){var r=st(),n=(s||{}).Workbook||{},l=n.Sheets||[],i=n.WBProps||{},c=t.biff==8,d=t.biff==5;if(Fe(r,2057,$n(s,5,t)),t.bookType=="xla"&&Fe(r,135),Fe(r,225,c?ut(1200):null),Fe(r,193,pd(2)),d&&Fe(r,191),d&&Fe(r,192),Fe(r,226),Fe(r,92,kd("SheetJS",t)),Fe(r,66,ut(c?1200:1252)),c&&Fe(r,353,ut(0)),c&&Fe(r,448),Fe(r,317,Vd(s.SheetNames.length)),c&&s.vbaraw&&Fe(r,211),c&&s.vbaraw){var o=i.CodeName||"ThisWorkbook";Fe(r,442,mc(o))}Fe(r,156,ut(17)),Fe(r,25,zs(!1)),Fe(r,18,zs(!1)),Fe(r,19,ut(0)),c&&Fe(r,431,zs(!1)),c&&Fe(r,444,ut(0)),Fe(r,61,Cd()),Fe(r,64,zs(!1)),Fe(r,141,ut(0)),Fe(r,34,zs(qu(s)=="true")),Fe(r,14,zs(!0)),c&&Fe(r,439,zs(!1)),Fe(r,218,ut(0)),Bf(r,s,t),Uf(r,s.SSF,t),Hf(r,t),c&&Fe(r,352,zs(!1));var m=r.end(),g=st();c&&Fe(g,140,Wd()),c&&t.Strings&&If(g,252,Ed(t.Strings)),Fe(g,10);var x=g.end(),f=st(),p=0,h=0;for(h=0;h<s.SheetNames.length;++h)p+=(c?12:11)+(c?2:1)*s.SheetNames[h].length;var w=m.length+p+x.length;for(h=0;h<s.SheetNames.length;++h){var L=l[h]||{};Fe(f,133,_d({pos:w,hs:L.Hidden||0,dt:0,name:s.SheetNames[h]},t)),w+=a[h].length}var O=f.end();if(p!=O.length)throw new Error("BS8 "+p+" != "+O.length);var I=[];return m.length&&I.push(m),O.length&&I.push(O),x.length&&I.push(x),Is(I)}function Xf(s,a){var t=a||{},r=[];s&&!s.SSF&&(s.SSF=at(gs)),s&&s.SSF&&(tn(),sn(s.SSF),t.revssf=an(s.SSF),t.revssf[s.SSF[65535]]=0,t.ssf=s.SSF),t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,qn(t),t.cellXfs=[],ea(t.cellXfs,{},{revssf:{General:0}}),s.Props||(s.Props={});for(var n=0;n<s.SheetNames.length;++n)r[r.length]=Kf(n,t,s);return r.unshift(Vf(s,r,t)),Is(r)}function Mc(s,a){for(var t=0;t<=s.SheetNames.length;++t){var r=s.Sheets[s.SheetNames[t]];if(!(!r||!r["!ref"])){var n=mt(r["!ref"]);n.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+s.SheetNames[t]+"' extends beyond column IV (255).  Data may be lost.")}}var l=a||{};switch(l.biff||2){case 8:case 5:return Xf(s,a);case 4:case 3:case 2:return Mf(s,a)}throw new Error("invalid type "+l.bookType+" for BIFF")}function Jf(s,a,t,r){for(var n=s["!merges"]||[],l=[],i=a.s.c;i<=a.e.c;++i){for(var c=0,d=0,o=0;o<n.length;++o)if(!(n[o].s.r>t||n[o].s.c>i)&&!(n[o].e.r<t||n[o].e.c<i)){if(n[o].s.r<t||n[o].s.c<i){c=-1;break}c=n[o].e.r-n[o].s.r+1,d=n[o].e.c-n[o].s.c+1;break}if(!(c<0)){var m=ss({r:t,c:i}),g=r.dense?(s[t]||[])[i]:s[m],x=g&&g.v!=null&&(g.h||T0(g.w||(Gt(g),g.w)||""))||"",f={};c>1&&(f.rowspan=c),d>1&&(f.colspan=d),r.editable?x='<span contenteditable="true">'+x+"</span>":g&&(f["data-t"]=g&&g.t||"z",g.v!=null&&(f["data-v"]=g.v),g.z!=null&&(f["data-z"]=g.z),g.l&&(g.l.Target||"#").charAt(0)!="#"&&(x='<a href="'+g.l.Target+'">'+x+"</a>")),f.id=(r.id||"sjs")+"-"+m,l.push(Ae("td",x,f))}}var p="<tr>";return p+l.join("")+"</tr>"}var Yf='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',qf="</body></html>";function Qf(s,a,t){var r=[];return r.join("")+"<table"+(t&&t.id?' id="'+t.id+'"':"")+">"}function Bc(s,a){var t=a||{},r=t.header!=null?t.header:Yf,n=t.footer!=null?t.footer:qf,l=[r],i=mt(s["!ref"]);t.dense=Array.isArray(s),l.push(Qf(s,i,t));for(var c=i.s.r;c<=i.e.r;++c)l.push(Jf(s,i,c,t));return l.push("</table>"+n),l.join("")}function Uc(s,a,t){var r=t||{},n=0,l=0;if(r.origin!=null)if(typeof r.origin=="number")n=r.origin;else{var i=typeof r.origin=="string"?Cs(r.origin):r.origin;n=i.r,l=i.c}var c=a.getElementsByTagName("tr"),d=Math.min(r.sheetRows||1e7,c.length),o={s:{r:0,c:0},e:{r:n,c:l}};if(s["!ref"]){var m=mt(s["!ref"]);o.s.r=Math.min(o.s.r,m.s.r),o.s.c=Math.min(o.s.c,m.s.c),o.e.r=Math.max(o.e.r,m.e.r),o.e.c=Math.max(o.e.c,m.e.c),n==-1&&(o.e.r=n=m.e.r+1)}var g=[],x=0,f=s["!rows"]||(s["!rows"]=[]),p=0,h=0,w=0,L=0,O=0,I=0;for(s["!cols"]||(s["!cols"]=[]);p<c.length&&h<d;++p){var H=c[p];if(Yi(H)){if(r.display)continue;f[h]={hidden:!0}}var ae=H.children;for(w=L=0;w<ae.length;++w){var oe=ae[w];if(!(r.display&&Yi(oe))){var D=oe.hasAttribute("data-v")?oe.getAttribute("data-v"):oe.hasAttribute("v")?oe.getAttribute("v"):C0(oe.innerHTML),q=oe.getAttribute("data-z")||oe.getAttribute("z");for(x=0;x<g.length;++x){var z=g[x];z.s.c==L+l&&z.s.r<h+n&&h+n<=z.e.r&&(L=z.e.c+1-l,x=-1)}I=+oe.getAttribute("colspan")||1,((O=+oe.getAttribute("rowspan")||1)>1||I>1)&&g.push({s:{r:h+n,c:L+l},e:{r:h+n+(O||1)-1,c:L+l+(I||1)-1}});var G={t:"s",v:D},ce=oe.getAttribute("data-t")||oe.getAttribute("t")||"";D!=null&&(D.length==0?G.t=ce||"z":r.raw||D.trim().length==0||ce=="s"||(D==="TRUE"?G={t:"b",v:!0}:D==="FALSE"?G={t:"b",v:!1}:isNaN(Mt(D))?isNaN(ir(D).getDate())||(G={t:"d",v:Js(D)},r.cellDates||(G={t:"n",v:tt(G.v)}),G.z=r.dateNF||gs[14]):G={t:"n",v:Mt(D)})),G.z===void 0&&q!=null&&(G.z=q);var M="",W=oe.getElementsByTagName("A");if(W&&W.length)for(var re=0;re<W.length&&!(W[re].hasAttribute("href")&&(M=W[re].getAttribute("href"),M.charAt(0)!="#"));++re);M&&M.charAt(0)!="#"&&(G.l={Target:M}),r.dense?(s[h+n]||(s[h+n]=[]),s[h+n][L+l]=G):s[ss({c:L+l,r:h+n})]=G,o.e.c<L+l&&(o.e.c=L+l),L+=I}}++h}return g.length&&(s["!merges"]=(s["!merges"]||[]).concat(g)),o.e.r=Math.max(o.e.r,h-1+n),s["!ref"]=Ns(o),h>=d&&(s["!fullref"]=Ns((o.e.r=c.length-p+h-1+n,o))),s}function Gc(s,a){var t=a||{},r=t.dense?[]:{};return Uc(r,s,a)}function Zf(s,a){return ma(Gc(s,a),a)}function Yi(s){var a="",t=eg(s);return t&&(a=t(s).getPropertyValue("display")),a||(a=s.style&&s.style.display),a==="none"}function eg(s){return s.ownerDocument.defaultView&&typeof s.ownerDocument.defaultView.getComputedStyle=="function"?s.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}var sg=function(){var s=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),a="<office:document-styles "+cr({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+s+"</office:document-styles>";return function(){return js+a}}(),qi=function(){var s=function(l){return es(l).replace(/  +/g,function(i){return'<text:s text:c="'+i.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},a=`          <table:table-cell />
`,t=`          <table:covered-table-cell/>
`,r=function(l,i,c){var d=[];d.push('      <table:table table:name="'+es(i.SheetNames[c])+`" table:style-name="ta1">
`);var o=0,m=0,g=mt(l["!ref"]||"A1"),x=l["!merges"]||[],f=0,p=Array.isArray(l);if(l["!cols"])for(m=0;m<=g.e.c;++m)d.push("        <table:table-column"+(l["!cols"][m]?' table:style-name="co'+l["!cols"][m].ods+'"':"")+`></table:table-column>
`);var h="",w=l["!rows"]||[];for(o=0;o<g.s.r;++o)h=w[o]?' table:style-name="ro'+w[o].ods+'"':"",d.push("        <table:table-row"+h+`></table:table-row>
`);for(;o<=g.e.r;++o){for(h=w[o]?' table:style-name="ro'+w[o].ods+'"':"",d.push("        <table:table-row"+h+`>
`),m=0;m<g.s.c;++m)d.push(a);for(;m<=g.e.c;++m){var L=!1,O={},I="";for(f=0;f!=x.length;++f)if(!(x[f].s.c>m)&&!(x[f].s.r>o)&&!(x[f].e.c<m)&&!(x[f].e.r<o)){(x[f].s.c!=m||x[f].s.r!=o)&&(L=!0),O["table:number-columns-spanned"]=x[f].e.c-x[f].s.c+1,O["table:number-rows-spanned"]=x[f].e.r-x[f].s.r+1;break}if(L){d.push(t);continue}var H=ss({r:o,c:m}),ae=p?(l[o]||[])[m]:l[H];if(ae&&ae.f&&(O["table:formula"]=es(bh(ae.f)),ae.F&&ae.F.slice(0,H.length)==H)){var oe=mt(ae.F);O["table:number-matrix-columns-spanned"]=oe.e.c-oe.s.c+1,O["table:number-matrix-rows-spanned"]=oe.e.r-oe.s.r+1}if(!ae){d.push(a);continue}switch(ae.t){case"b":I=ae.v?"TRUE":"FALSE",O["office:value-type"]="boolean",O["office:boolean-value"]=ae.v?"true":"false";break;case"n":I=ae.w||String(ae.v||0),O["office:value-type"]="float",O["office:value"]=ae.v||0;break;case"s":case"str":I=ae.v==null?"":ae.v,O["office:value-type"]="string";break;case"d":I=ae.w||Js(ae.v).toISOString(),O["office:value-type"]="date",O["office:date-value"]=Js(ae.v).toISOString(),O["table:style-name"]="ce1";break;default:d.push(a);continue}var D=s(I);if(ae.l&&ae.l.Target){var q=ae.l.Target;q=q.charAt(0)=="#"?"#"+yh(q.slice(1)):q,q.charAt(0)!="#"&&!q.match(/^\w+:/)&&(q="../"+q),D=Ae("text:a",D,{"xlink:href":q.replace(/&/g,"&amp;")})}d.push("          "+Ae("table:table-cell",Ae("text:p",D,{}),O)+`
`)}d.push(`        </table:table-row>
`)}return d.push(`      </table:table>
`),d.join("")},n=function(l,i){l.push(` <office:automatic-styles>
`),l.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),l.push(`   <number:month number:style="long"/>
`),l.push(`   <number:text>/</number:text>
`),l.push(`   <number:day number:style="long"/>
`),l.push(`   <number:text>/</number:text>
`),l.push(`   <number:year/>
`),l.push(`  </number:date-style>
`);var c=0;i.SheetNames.map(function(o){return i.Sheets[o]}).forEach(function(o){if(o&&o["!cols"]){for(var m=0;m<o["!cols"].length;++m)if(o["!cols"][m]){var g=o["!cols"][m];if(g.width==null&&g.wpx==null&&g.wch==null)continue;Kn(g),g.ods=c;var x=o["!cols"][m].wpx+"px";l.push('  <style:style style:name="co'+c+`" style:family="table-column">
`),l.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+x+`"/>
`),l.push(`  </style:style>
`),++c}}});var d=0;i.SheetNames.map(function(o){return i.Sheets[o]}).forEach(function(o){if(o&&o["!rows"]){for(var m=0;m<o["!rows"].length;++m)if(o["!rows"][m]){o["!rows"][m].ods=d;var g=o["!rows"][m].hpx+"px";l.push('  <style:style style:name="ro'+d+`" style:family="table-row">
`),l.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+g+`"/>
`),l.push(`  </style:style>
`),++d}}}),l.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),l.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),l.push(`  </style:style>
`),l.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),l.push(` </office:automatic-styles>
`)};return function(i,c){var d=[js],o=cr({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),m=cr({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});c.bookType=="fods"?(d.push("<office:document"+o+m+`>
`),d.push(tc().replace(/office:document-meta/g,"office:meta"))):d.push("<office:document-content"+o+`>
`),n(d,i),d.push(`  <office:body>
`),d.push(`    <office:spreadsheet>
`);for(var g=0;g!=i.SheetNames.length;++g)d.push(r(i.Sheets[i.SheetNames[g]],i,g));return d.push(`    </office:spreadsheet>
`),d.push(`  </office:body>
`),c.bookType=="fods"?d.push("</office:document>"):d.push("</office:document-content>"),d.join("")}}();function Hc(s,a){if(a.bookType=="fods")return qi(s,a);var t=Rn(),r="",n=[],l=[];return r="mimetype",$e(t,r,"application/vnd.oasis.opendocument.spreadsheet"),r="content.xml",$e(t,r,qi(s,a)),n.push([r,"text/xml"]),l.push([r,"ContentFile"]),r="styles.xml",$e(t,r,sg(s,a)),n.push([r,"text/xml"]),l.push([r,"StylesFile"]),r="meta.xml",$e(t,r,js+tc()),n.push([r,"text/xml"]),l.push([r,"MetadataFile"]),r="manifest.rdf",$e(t,r,xd(l)),n.push([r,"application/rdf+xml"]),r="META-INF/manifest.xml",$e(t,r,dd(n)),t}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function qr(s){return new DataView(s.buffer,s.byteOffset,s.byteLength)}function tg(s){return typeof TextEncoder<"u"?new TextEncoder().encode(s):St(lr(s))}function ag(s,a){e:for(var t=0;t<=s.length-a.length;++t){for(var r=0;r<a.length;++r)if(s[t+r]!=a[r])continue e;return!0}return!1}function Qt(s){var a=s.reduce(function(n,l){return n+l.length},0),t=new Uint8Array(a),r=0;return s.forEach(function(n){t.set(n,r),r+=n.length}),t}function rg(s,a,t){var r=Math.floor(t==0?0:Math.LOG10E*Math.log(Math.abs(t)))+6176-20,n=t/Math.pow(10,r-6176);s[a+15]|=r>>7,s[a+14]|=(r&127)<<1;for(var l=0;n>=1;++l,n/=256)s[a+l]=n&255;s[a+15]|=t>=0?0:128}function or(s,a){var t=a?a[0]:0,r=s[t]&127;e:if(s[t++]>=128&&(r|=(s[t]&127)<<7,s[t++]<128||(r|=(s[t]&127)<<14,s[t++]<128)||(r|=(s[t]&127)<<21,s[t++]<128)||(r+=(s[t]&127)*Math.pow(2,28),++t,s[t++]<128)||(r+=(s[t]&127)*Math.pow(2,35),++t,s[t++]<128)||(r+=(s[t]&127)*Math.pow(2,42),++t,s[t++]<128)))break e;return a&&(a[0]=t),r}function Qe(s){var a=new Uint8Array(7);a[0]=s&127;var t=1;e:if(s>127){if(a[t-1]|=128,a[t]=s>>7&127,++t,s<=16383||(a[t-1]|=128,a[t]=s>>14&127,++t,s<=2097151)||(a[t-1]|=128,a[t]=s>>21&127,++t,s<=268435455)||(a[t-1]|=128,a[t]=s/256>>>21&127,++t,s<=34359738367)||(a[t-1]|=128,a[t]=s/65536>>>21&127,++t,s<=4398046511103))break e;a[t-1]|=128,a[t]=s/16777216>>>21&127,++t}return a.slice(0,t)}function Ca(s){var a=0,t=s[a]&127;e:if(s[a++]>=128){if(t|=(s[a]&127)<<7,s[a++]<128||(t|=(s[a]&127)<<14,s[a++]<128)||(t|=(s[a]&127)<<21,s[a++]<128))break e;t|=(s[a]&127)<<28}return t}function Ss(s){for(var a=[],t=[0];t[0]<s.length;){var r=t[0],n=or(s,t),l=n&7;n=Math.floor(n/8);var i=0,c;if(n==0)break;switch(l){case 0:{for(var d=t[0];s[t[0]++]>=128;);c=s.slice(d,t[0])}break;case 5:i=4,c=s.slice(t[0],t[0]+i),t[0]+=i;break;case 1:i=8,c=s.slice(t[0],t[0]+i),t[0]+=i;break;case 2:i=or(s,t),c=s.slice(t[0],t[0]+i),t[0]+=i;break;case 3:case 4:default:throw new Error("PB Type ".concat(l," for Field ").concat(n," at offset ").concat(r))}var o={data:c,type:l};a[n]==null?a[n]=[o]:a[n].push(o)}return a}function Fs(s){var a=[];return s.forEach(function(t,r){t.forEach(function(n){n.data&&(a.push(Qe(r*8+n.type)),n.type==2&&a.push(Qe(n.data.length)),a.push(n.data))})}),Qt(a)}function bt(s){for(var a,t=[],r=[0];r[0]<s.length;){var n=or(s,r),l=Ss(s.slice(r[0],r[0]+n));r[0]+=n;var i={id:Ca(l[1][0].data),messages:[]};l[2].forEach(function(c){var d=Ss(c.data),o=Ca(d[3][0].data);i.messages.push({meta:d,data:s.slice(r[0],r[0]+o)}),r[0]+=o}),(a=l[3])!=null&&a[0]&&(i.merge=Ca(l[3][0].data)>>>0>0),t.push(i)}return t}function va(s){var a=[];return s.forEach(function(t){var r=[];r[1]=[{data:Qe(t.id),type:0}],r[2]=[],t.merge!=null&&(r[3]=[{data:Qe(+!!t.merge),type:0}]);var n=[];t.messages.forEach(function(i){n.push(i.data),i.meta[3]=[{type:0,data:Qe(i.data.length)}],r[2].push({data:Fs(i.meta),type:2})});var l=Fs(r);a.push(Qe(l.length)),a.push(l),n.forEach(function(i){return a.push(i)})}),Qt(a)}function ng(s,a){if(s!=0)throw new Error("Unexpected Snappy chunk type ".concat(s));for(var t=[0],r=or(a,t),n=[];t[0]<a.length;){var l=a[t[0]]&3;if(l==0){var i=a[t[0]++]>>2;if(i<60)++i;else{var c=i-59;i=a[t[0]],c>1&&(i|=a[t[0]+1]<<8),c>2&&(i|=a[t[0]+2]<<16),c>3&&(i|=a[t[0]+3]<<24),i>>>=0,i++,t[0]+=c}n.push(a.slice(t[0],t[0]+i)),t[0]+=i;continue}else{var d=0,o=0;if(l==1?(o=(a[t[0]]>>2&7)+4,d=(a[t[0]++]&224)<<3,d|=a[t[0]++]):(o=(a[t[0]++]>>2)+1,l==2?(d=a[t[0]]|a[t[0]+1]<<8,t[0]+=2):(d=(a[t[0]]|a[t[0]+1]<<8|a[t[0]+2]<<16|a[t[0]+3]<<24)>>>0,t[0]+=4)),n=[Qt(n)],d==0)throw new Error("Invalid offset 0");if(d>n[0].length)throw new Error("Invalid offset beyond length");if(o>=d)for(n.push(n[0].slice(-d)),o-=d;o>=n[n.length-1].length;)n.push(n[n.length-1]),o-=n[n.length-1].length;n.push(n[0].slice(-d,-d+o))}}var m=Qt(n);if(m.length!=r)throw new Error("Unexpected length: ".concat(m.length," != ").concat(r));return m}function yt(s){for(var a=[],t=0;t<s.length;){var r=s[t++],n=s[t]|s[t+1]<<8|s[t+2]<<16;t+=3,a.push(ng(r,s.slice(t,t+n))),t+=n}if(t!==s.length)throw new Error("data is not a valid framed stream!");return Qt(a)}function wa(s){for(var a=[],t=0;t<s.length;){var r=Math.min(s.length-t,268435455),n=new Uint8Array(4);a.push(n);var l=Qe(r),i=l.length;a.push(l),r<=60?(i++,a.push(new Uint8Array([r-1<<2]))):r<=256?(i+=2,a.push(new Uint8Array([240,r-1&255]))):r<=65536?(i+=3,a.push(new Uint8Array([244,r-1&255,r-1>>8&255]))):r<=16777216?(i+=4,a.push(new Uint8Array([248,r-1&255,r-1>>8&255,r-1>>16&255]))):r<=4294967296&&(i+=5,a.push(new Uint8Array([252,r-1&255,r-1>>8&255,r-1>>16&255,r-1>>>24&255]))),a.push(s.slice(t,t+r)),i+=r,n[0]=0,n[1]=i&255,n[2]=i>>8&255,n[3]=i>>16&255,t+=r}return Qt(a)}function gn(s,a){var t=new Uint8Array(32),r=qr(t),n=12,l=0;switch(t[0]=5,s.t){case"n":t[1]=2,rg(t,n,s.v),l|=1,n+=16;break;case"b":t[1]=6,r.setFloat64(n,s.v?1:0,!0),l|=2,n+=8;break;case"s":if(a.indexOf(s.v)==-1)throw new Error("Value ".concat(s.v," missing from SST!"));t[1]=3,r.setUint32(n,a.indexOf(s.v),!0),l|=8,n+=4;break;default:throw"unsupported cell type "+s.t}return r.setUint32(8,l,!0),t.slice(0,n)}function pn(s,a){var t=new Uint8Array(32),r=qr(t),n=12,l=0;switch(t[0]=3,s.t){case"n":t[2]=2,r.setFloat64(n,s.v,!0),l|=32,n+=8;break;case"b":t[2]=6,r.setFloat64(n,s.v?1:0,!0),l|=32,n+=8;break;case"s":if(a.indexOf(s.v)==-1)throw new Error("Value ".concat(s.v," missing from SST!"));t[2]=3,r.setUint32(n,a.indexOf(s.v),!0),l|=16,n+=4;break;default:throw"unsupported cell type "+s.t}return r.setUint32(4,l,!0),t.slice(0,n)}function Kt(s){var a=Ss(s);return or(a[1][0].data)}function ig(s,a,t){var r,n,l,i;if(!((r=s[6])!=null&&r[0])||!((n=s[7])!=null&&n[0]))throw"Mutation only works on post-BNC storages!";var c=((i=(l=s[8])==null?void 0:l[0])==null?void 0:i.data)&&Ca(s[8][0].data)>0||!1;if(c)throw"Math only works with normal offsets";for(var d=0,o=qr(s[7][0].data),m=0,g=[],x=qr(s[4][0].data),f=0,p=[],h=0;h<a.length;++h){if(a[h]==null){o.setUint16(h*2,65535,!0),x.setUint16(h*2,65535);continue}o.setUint16(h*2,m,!0),x.setUint16(h*2,f,!0);var w,L;switch(typeof a[h]){case"string":w=gn({t:"s",v:a[h]},t),L=pn({t:"s",v:a[h]},t);break;case"number":w=gn({t:"n",v:a[h]},t),L=pn({t:"n",v:a[h]},t);break;case"boolean":w=gn({t:"b",v:a[h]},t),L=pn({t:"b",v:a[h]},t);break;default:throw new Error("Unsupported value "+a[h])}g.push(w),m+=w.length,p.push(L),f+=L.length,++d}for(s[2][0].data=Qe(d);h<s[7][0].data.length/2;++h)o.setUint16(h*2,65535,!0),x.setUint16(h*2,65535,!0);return s[6][0].data=Qt(g),s[3][0].data=Qt(p),d}function lg(s,a){if(!a||!a.numbers)throw new Error("Must pass a `numbers` option -- check the README");var t=s.Sheets[s.SheetNames[0]];s.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var r=mt(t["!ref"]);r.s.r=r.s.c=0;var n=!1;r.e.c>9&&(n=!0,r.e.c=9),r.e.r>49&&(n=!0,r.e.r=49),n&&console.error("The Numbers writer is currently limited to ".concat(Ns(r)));var l=Qr(t,{range:r,header:1}),i=["~Sh33tJ5~"];l.forEach(function(P){return P.forEach(function(T){typeof T=="string"&&i.push(T)})});var c={},d=[],o=ts.read(a.numbers,{type:"base64"});o.FileIndex.map(function(P,T){return[P,o.FullPaths[T]]}).forEach(function(P){var T=P[0],A=P[1];if(T.type==2&&T.name.match(/\.iwa/)){var X=T.content,me=yt(X),F=bt(me);F.forEach(function(J){d.push(J.id),c[J.id]={deps:[],location:A,type:Ca(J.messages[0].meta[1][0].data)}})}}),d.sort(function(P,T){return P-T});var m=d.filter(function(P){return P>1}).map(function(P){return[P,Qe(P)]});o.FileIndex.map(function(P,T){return[P,o.FullPaths[T]]}).forEach(function(P){var T=P[0];if(P[1],!!T.name.match(/\.iwa/)){var A=bt(yt(T.content));A.forEach(function(X){X.messages.forEach(function(me){m.forEach(function(F){X.messages.some(function(J){return Ca(J.meta[1][0].data)!=11006&&ag(J.data,F[1])})&&c[F[0]].deps.push(X.id)})})})}});for(var g=ts.find(o,c[1].location),x=bt(yt(g.content)),f,p=0;p<x.length;++p){var h=x[p];h.id==1&&(f=h)}var w=Kt(Ss(f.messages[0].data)[1][0].data);for(g=ts.find(o,c[w].location),x=bt(yt(g.content)),p=0;p<x.length;++p)h=x[p],h.id==w&&(f=h);for(w=Kt(Ss(f.messages[0].data)[2][0].data),g=ts.find(o,c[w].location),x=bt(yt(g.content)),p=0;p<x.length;++p)h=x[p],h.id==w&&(f=h);for(w=Kt(Ss(f.messages[0].data)[2][0].data),g=ts.find(o,c[w].location),x=bt(yt(g.content)),p=0;p<x.length;++p)h=x[p],h.id==w&&(f=h);var L=Ss(f.messages[0].data);{L[6][0].data=Qe(r.e.r+1),L[7][0].data=Qe(r.e.c+1);var O=Kt(L[46][0].data),I=ts.find(o,c[O].location),H=bt(yt(I.content));{for(var ae=0;ae<H.length&&H[ae].id!=O;++ae);if(H[ae].id!=O)throw"Bad ColumnRowUIDMapArchive";var oe=Ss(H[ae].messages[0].data);oe[1]=[],oe[2]=[],oe[3]=[];for(var D=0;D<=r.e.c;++D){var q=[];q[1]=q[2]=[{type:0,data:Qe(D+420690)}],oe[1].push({type:2,data:Fs(q)}),oe[2].push({type:0,data:Qe(D)}),oe[3].push({type:0,data:Qe(D)})}oe[4]=[],oe[5]=[],oe[6]=[];for(var z=0;z<=r.e.r;++z)q=[],q[1]=q[2]=[{type:0,data:Qe(z+726270)}],oe[4].push({type:2,data:Fs(q)}),oe[5].push({type:0,data:Qe(z)}),oe[6].push({type:0,data:Qe(z)});H[ae].messages[0].data=Fs(oe)}I.content=wa(va(H)),I.size=I.content.length,delete L[46];var G=Ss(L[4][0].data);{G[7][0].data=Qe(r.e.r+1);var ce=Ss(G[1][0].data),M=Kt(ce[2][0].data);I=ts.find(o,c[M].location),H=bt(yt(I.content));{if(H[0].id!=M)throw"Bad HeaderStorageBucket";var W=Ss(H[0].messages[0].data);for(z=0;z<l.length;++z){var re=Ss(W[2][0].data);re[1][0].data=Qe(z),re[4][0].data=Qe(l[z].length),W[2][z]={type:W[2][0].type,data:Fs(re)}}H[0].messages[0].data=Fs(W)}I.content=wa(va(H)),I.size=I.content.length;var ve=Kt(G[2][0].data);I=ts.find(o,c[ve].location),H=bt(yt(I.content));{if(H[0].id!=ve)throw"Bad HeaderStorageBucket";for(W=Ss(H[0].messages[0].data),D=0;D<=r.e.c;++D)re=Ss(W[2][0].data),re[1][0].data=Qe(D),re[4][0].data=Qe(r.e.r+1),W[2][D]={type:W[2][0].type,data:Fs(re)};H[0].messages[0].data=Fs(W)}I.content=wa(va(H)),I.size=I.content.length;var te=Kt(G[4][0].data);(function(){for(var P=ts.find(o,c[te].location),T=bt(yt(P.content)),A,X=0;X<T.length;++X){var me=T[X];me.id==te&&(A=me)}var F=Ss(A.messages[0].data);{F[3]=[];var J=[];i.forEach(function(ue,Me){J[1]=[{type:0,data:Qe(Me)}],J[2]=[{type:0,data:Qe(1)}],J[3]=[{type:2,data:tg(ue)}],F[3].push({type:2,data:Fs(J)})})}A.messages[0].data=Fs(F);var U=va(T),Y=wa(U);P.content=Y,P.size=P.content.length})();var ke=Ss(G[3][0].data);{var xe=ke[1][0];delete ke[2];var Ie=Ss(xe.data);{var je=Kt(Ie[2][0].data);(function(){for(var P=ts.find(o,c[je].location),T=bt(yt(P.content)),A,X=0;X<T.length;++X){var me=T[X];me.id==je&&(A=me)}var F=Ss(A.messages[0].data);{delete F[6],delete ke[7];var J=new Uint8Array(F[5][0].data);F[5]=[];for(var U=0,Y=0;Y<=r.e.r;++Y){var ue=Ss(J);U+=ig(ue,l[Y],i),ue[1][0].data=Qe(Y),F[5].push({data:Fs(ue),type:2})}F[1]=[{type:0,data:Qe(r.e.c+1)}],F[2]=[{type:0,data:Qe(r.e.r+1)}],F[3]=[{type:0,data:Qe(U)}],F[4]=[{type:0,data:Qe(r.e.r+1)}]}A.messages[0].data=Fs(F);var Me=va(T),le=wa(Me);P.content=le,P.size=P.content.length})()}xe.data=Fs(Ie)}G[3][0].data=Fs(ke)}L[4][0].data=Fs(G)}f.messages[0].data=Fs(L);var Oe=va(x),N=wa(Oe);return g.content=N,g.size=g.content.length,o}function cg(s){return function(t){for(var r=0;r!=s.length;++r){var n=s[r];t[n[0]]===void 0&&(t[n[0]]=n[1]),n[2]==="n"&&(t[n[0]]=Number(t[n[0]]))}}}function qn(s){cg([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(s)}function og(s,a){return a.bookType=="ods"?Hc(s,a):a.bookType=="numbers"?lg(s,a):a.bookType=="xlsb"?dg(s,a):mg(s,a)}function dg(s,a){Ta=1024,s&&!s.SSF&&(s.SSF=at(gs)),s&&s.SSF&&(tn(),sn(s.SSF),a.revssf=an(s.SSF),a.revssf[s.SSF[65535]]=0,a.ssf=s.SSF),a.rels={},a.wbrels={},a.Strings=[],a.Strings.Count=0,a.Strings.Unique=0,Za?a.revStrings=new Map:(a.revStrings={},a.revStrings.foo=[],delete a.revStrings.foo);var t=a.bookType=="xlsb"?"bin":"xml",r=Sc.indexOf(a.bookType)>-1,n=Zl();qn(a=a||{});var l=Rn(),i="",c=0;if(a.cellXfs=[],ea(a.cellXfs,{},{revssf:{General:0}}),s.Props||(s.Props={}),i="docProps/core.xml",$e(l,i,ac(s.Props,a)),n.coreprops.push(i),Ze(a.rels,2,i,Je.CORE_PROPS),i="docProps/app.xml",!(s.Props&&s.Props.SheetNames))if(!s.Workbook||!s.Workbook.Sheets)s.Props.SheetNames=s.SheetNames;else{for(var d=[],o=0;o<s.SheetNames.length;++o)(s.Workbook.Sheets[o]||{}).Hidden!=2&&d.push(s.SheetNames[o]);s.Props.SheetNames=d}for(s.Props.Worksheets=s.Props.SheetNames.length,$e(l,i,nc(s.Props)),n.extprops.push(i),Ze(a.rels,3,i,Je.EXT_PROPS),s.Custprops!==s.Props&&Os(s.Custprops||{}).length>0&&(i="docProps/custom.xml",$e(l,i,ic(s.Custprops)),n.custprops.push(i),Ze(a.rels,4,i,Je.CUST_PROPS)),c=1;c<=s.SheetNames.length;++c){var m={"!id":{}},g=s.Sheets[s.SheetNames[c-1]],x=(g||{})["!type"]||"sheet";switch(x){case"chart":default:i="xl/worksheets/sheet"+c+"."+t,$e(l,i,hf(c-1,i,a,s,m)),n.sheets.push(i),Ze(a.wbrels,-1,"worksheets/sheet"+c+"."+t,Je.WS[0])}if(g){var f=g["!comments"],p=!1,h="";f&&f.length>0&&(h="xl/comments"+c+"."+t,$e(l,h,gf(f,h)),n.comments.push(h),Ze(m,-1,"../comments"+c+"."+t,Je.CMNT),p=!0),g["!legacy"]&&p&&$e(l,"xl/drawings/vmlDrawing"+c+".vml",Nc(c,g["!comments"])),delete g["!comments"],delete g["!legacy"]}m["!id"].rId1&&$e(l,sc(i),_a(m))}return a.Strings!=null&&a.Strings.length>0&&(i="xl/sharedStrings."+t,$e(l,i,ff(a.Strings,i,a)),n.strs.push(i),Ze(a.wbrels,-1,"sharedStrings."+t,Je.SST)),i="xl/workbook."+t,$e(l,i,xf(s,i)),n.workbooks.push(i),Ze(a.rels,1,i,Je.WB),i="xl/theme/theme1.xml",$e(l,i,bc(s.Themes,a)),n.themes.push(i),Ze(a.wbrels,-1,"theme/theme1.xml",Je.THEME),i="xl/styles."+t,$e(l,i,uf(s,i,a)),n.styles.push(i),Ze(a.wbrels,-1,"styles."+t,Je.STY),s.vbaraw&&r&&(i="xl/vbaProject.bin",$e(l,i,s.vbaraw),n.vba.push(i),Ze(a.wbrels,-1,"vbaProject.bin",Je.VBA)),i="xl/metadata."+t,$e(l,i,pf(i)),n.metadata.push(i),Ze(a.wbrels,-1,"metadata."+t,Je.XLMETA),$e(l,"[Content_Types].xml",ec(n,a)),$e(l,"_rels/.rels",_a(a.rels)),$e(l,"xl/_rels/workbook."+t+".rels",_a(a.wbrels)),delete a.revssf,delete a.ssf,l}function mg(s,a){Ta=1024,s&&!s.SSF&&(s.SSF=at(gs)),s&&s.SSF&&(tn(),sn(s.SSF),a.revssf=an(s.SSF),a.revssf[s.SSF[65535]]=0,a.ssf=s.SSF),a.rels={},a.wbrels={},a.Strings=[],a.Strings.Count=0,a.Strings.Unique=0,Za?a.revStrings=new Map:(a.revStrings={},a.revStrings.foo=[],delete a.revStrings.foo);var t="xml",r=Sc.indexOf(a.bookType)>-1,n=Zl();qn(a=a||{});var l=Rn(),i="",c=0;if(a.cellXfs=[],ea(a.cellXfs,{},{revssf:{General:0}}),s.Props||(s.Props={}),i="docProps/core.xml",$e(l,i,ac(s.Props,a)),n.coreprops.push(i),Ze(a.rels,2,i,Je.CORE_PROPS),i="docProps/app.xml",!(s.Props&&s.Props.SheetNames))if(!s.Workbook||!s.Workbook.Sheets)s.Props.SheetNames=s.SheetNames;else{for(var d=[],o=0;o<s.SheetNames.length;++o)(s.Workbook.Sheets[o]||{}).Hidden!=2&&d.push(s.SheetNames[o]);s.Props.SheetNames=d}s.Props.Worksheets=s.Props.SheetNames.length,$e(l,i,nc(s.Props)),n.extprops.push(i),Ze(a.rels,3,i,Je.EXT_PROPS),s.Custprops!==s.Props&&Os(s.Custprops||{}).length>0&&(i="docProps/custom.xml",$e(l,i,ic(s.Custprops)),n.custprops.push(i),Ze(a.rels,4,i,Je.CUST_PROPS));var m=["SheetJ5"];for(a.tcid=0,c=1;c<=s.SheetNames.length;++c){var g={"!id":{}},x=s.Sheets[s.SheetNames[c-1]],f=(x||{})["!type"]||"sheet";switch(f){case"chart":default:i="xl/worksheets/sheet"+c+"."+t,$e(l,i,Ic(c-1,a,s,g)),n.sheets.push(i),Ze(a.wbrels,-1,"worksheets/sheet"+c+"."+t,Je.WS[0])}if(x){var p=x["!comments"],h=!1,w="";if(p&&p.length>0){var L=!1;p.forEach(function(O){O[1].forEach(function(I){I.T==!0&&(L=!0)})}),L&&(w="xl/threadedComments/threadedComment"+c+"."+t,$e(l,w,Gm(p,m,a)),n.threadedcomments.push(w),Ze(g,-1,"../threadedComments/threadedComment"+c+"."+t,Je.TCMNT)),w="xl/comments"+c+"."+t,$e(l,w,jc(p)),n.comments.push(w),Ze(g,-1,"../comments"+c+"."+t,Je.CMNT),h=!0}x["!legacy"]&&h&&$e(l,"xl/drawings/vmlDrawing"+c+".vml",Nc(c,x["!comments"])),delete x["!comments"],delete x["!legacy"]}g["!id"].rId1&&$e(l,sc(i),_a(g))}return a.Strings!=null&&a.Strings.length>0&&(i="xl/sharedStrings."+t,$e(l,i,uc(a.Strings,a)),n.strs.push(i),Ze(a.wbrels,-1,"sharedStrings."+t,Je.SST)),i="xl/workbook."+t,$e(l,i,Oc(s)),n.workbooks.push(i),Ze(a.rels,1,i,Je.WB),i="xl/theme/theme1.xml",$e(l,i,bc(s.Themes,a)),n.themes.push(i),Ze(a.wbrels,-1,"theme/theme1.xml",Je.THEME),i="xl/styles."+t,$e(l,i,vc(s,a)),n.styles.push(i),Ze(a.wbrels,-1,"styles."+t,Je.STY),s.vbaraw&&r&&(i="xl/vbaProject.bin",$e(l,i,s.vbaraw),n.vba.push(i),Ze(a.wbrels,-1,"vbaProject.bin",Je.VBA)),i="xl/metadata."+t,$e(l,i,yc()),n.metadata.push(i),Ze(a.wbrels,-1,"metadata."+t,Je.XLMETA),m.length>1&&(i="xl/persons/person.xml",$e(l,i,Hm(m)),n.people.push(i),Ze(a.wbrels,-1,"persons/person.xml",Je.PEOPLE)),$e(l,"[Content_Types].xml",ec(n,a)),$e(l,"_rels/.rels",_a(a.rels)),$e(l,"xl/_rels/workbook."+t+".rels",_a(a.wbrels)),delete a.revssf,delete a.ssf,l}function xg(s,a){var t="";switch((a||{}).type||"base64"){case"buffer":return[s[0],s[1],s[2],s[3],s[4],s[5],s[6],s[7]];case"base64":t=Ut(s.slice(0,12));break;case"binary":t=s;break;case"array":return[s[0],s[1],s[2],s[3],s[4],s[5],s[6],s[7]];default:throw new Error("Unrecognized type "+(a&&a.type||"undefined"))}return[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3),t.charCodeAt(4),t.charCodeAt(5),t.charCodeAt(6),t.charCodeAt(7)]}function zc(s,a){switch(a.type){case"base64":case"binary":break;case"buffer":case"array":a.type="";break;case"file":return hr(a.file,ts.write(s,{type:qe?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+a.bookType+"' files");default:throw new Error("Unrecognized type "+a.type)}return ts.write(s,a)}function hg(s,a){var t=at(a||{}),r=og(s,t);return ug(r,t)}function ug(s,a){var t={},r=qe?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(a.compression&&(t.compression="DEFLATE"),a.password)t.type=r;else switch(a.type){case"base64":t.type="base64";break;case"binary":t.type="string";break;case"string":throw new Error("'string' output type invalid for '"+a.bookType+"' files");case"buffer":case"file":t.type=r;break;default:throw new Error("Unrecognized type "+a.type)}var n=s.FullPaths?ts.write(s,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[t.type]||t.type,compression:!!a.compression}):s.generate(t);if(typeof Deno<"u"&&typeof n=="string"){if(a.type=="binary"||a.type=="base64")return n;n=new Uint8Array(en(n))}return a.password&&typeof encrypt_agile<"u"?zc(encrypt_agile(n,a.password),a):a.type==="file"?hr(a.file,n):a.type=="string"?Ja(n):n}function fg(s,a){var t=a||{},r=Ff(s,t);return zc(r,t)}function Ct(s,a,t){t||(t="");var r=t+s;switch(a.type){case"base64":return nr(lr(r));case"binary":return lr(r);case"string":return s;case"file":return hr(a.file,r,"utf8");case"buffer":return qe?Ht(r,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(r):Ct(r,{type:"binary"}).split("").map(function(n){return n.charCodeAt(0)})}throw new Error("Unrecognized type "+a.type)}function gg(s,a){switch(a.type){case"base64":return nr(s);case"binary":return s;case"string":return s;case"file":return hr(a.file,s,"binary");case"buffer":return qe?Ht(s,"binary"):s.split("").map(function(t){return t.charCodeAt(0)})}throw new Error("Unrecognized type "+a.type)}function Dr(s,a){switch(a.type){case"string":case"base64":case"binary":for(var t="",r=0;r<s.length;++r)t+=String.fromCharCode(s[r]);return a.type=="base64"?nr(t):a.type=="string"?Ja(t):t;case"file":return hr(a.file,s);case"buffer":return s;default:throw new Error("Unrecognized type "+a.type)}}function Wc(s,a){zo(),ef(s);var t=at(a||{});if(t.cellStyles&&(t.cellNF=!0,t.sheetStubs=!0),t.type=="array"){t.type="binary";var r=Wc(s,t);return t.type="array",en(r)}var n=0;if(t.sheet&&(typeof t.sheet=="number"?n=t.sheet:n=s.SheetNames.indexOf(t.sheet),!s.SheetNames[n]))throw new Error("Sheet not found: "+t.sheet+" : "+typeof t.sheet);switch(t.bookType||"xlsb"){case"xml":case"xlml":return Ct(Cf(s,t),t);case"slk":case"sylk":return Ct(qd.from_sheet(s.Sheets[s.SheetNames[n]],t),t);case"htm":case"html":return Ct(Bc(s.Sheets[s.SheetNames[n]],t),t);case"txt":return gg(Kc(s.Sheets[s.SheetNames[n]],t),t);case"csv":return Ct(Qn(s.Sheets[s.SheetNames[n]],t),t,"\uFEFF");case"dif":return Ct(Qd.from_sheet(s.Sheets[s.SheetNames[n]],t),t);case"dbf":return Dr(Yd.from_sheet(s.Sheets[s.SheetNames[n]],t),t);case"prn":return Ct(Zd.from_sheet(s.Sheets[s.SheetNames[n]],t),t);case"rtf":return Ct(im.from_sheet(s.Sheets[s.SheetNames[n]],t),t);case"eth":return Ct(hc.from_sheet(s.Sheets[s.SheetNames[n]],t),t);case"fods":return Ct(Hc(s,t),t);case"wk1":return Dr(Wi.sheet_to_wk1(s.Sheets[s.SheetNames[n]],t),t);case"wk3":return Dr(Wi.book_to_wk3(s,t),t);case"biff2":t.biff||(t.biff=2);case"biff3":t.biff||(t.biff=3);case"biff4":return t.biff||(t.biff=4),Dr(Mc(s,t),t);case"biff5":t.biff||(t.biff=5);case"biff8":case"xla":case"xls":return t.biff||(t.biff=8),fg(s,t);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return hg(s,t);default:throw new Error("Unrecognized bookType |"+t.bookType+"|")}}function pg(s){if(!s.bookType){var a={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},t=s.file.slice(s.file.lastIndexOf(".")).toLowerCase();t.match(/^\.[a-z]+$/)&&(s.bookType=t.slice(1)),s.bookType=a[s.bookType]||s.bookType}}function $c(s,a,t){var r={};return r.type="file",r.file=a,pg(r),Wc(s,r)}function vg(s,a,t,r,n,l,i,c){var d=Rs(t),o=c.defval,m=c.raw||!Object.prototype.hasOwnProperty.call(c,"raw"),g=!0,x=n===1?[]:{};if(n!==1)if(Object.defineProperty)try{Object.defineProperty(x,"__rowNum__",{value:t,enumerable:!1})}catch{x.__rowNum__=t}else x.__rowNum__=t;if(!i||s[t])for(var f=a.s.c;f<=a.e.c;++f){var p=i?s[t][f]:s[r[f]+d];if(p===void 0||p.t===void 0){if(o===void 0)continue;l[f]!=null&&(x[l[f]]=o);continue}var h=p.v;switch(p.t){case"z":if(h==null)break;continue;case"e":h=h==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+p.t)}if(l[f]!=null){if(h==null)if(p.t=="e"&&h===null)x[l[f]]=null;else if(o!==void 0)x[l[f]]=o;else if(m&&h===null)x[l[f]]=null;else continue;else x[l[f]]=m&&(p.t!=="n"||p.t==="n"&&c.rawNumbers!==!1)?h:Gt(p,h,c);h!=null&&(g=!1)}}return{row:x,isempty:g}}function Qr(s,a){if(s==null||s["!ref"]==null)return[];var t={t:"n",v:0},r=0,n=1,l=[],i=0,c="",d={s:{r:0,c:0},e:{r:0,c:0}},o=a||{},m=o.range!=null?o.range:s["!ref"];switch(o.header===1?r=1:o.header==="A"?r=2:Array.isArray(o.header)?r=3:o.header==null&&(r=0),typeof m){case"string":d=is(m);break;case"number":d=is(s["!ref"]),d.s.r=m;break;default:d=m}r>0&&(n=0);var g=Rs(d.s.r),x=[],f=[],p=0,h=0,w=Array.isArray(s),L=d.s.r,O=0,I={};w&&!s[L]&&(s[L]=[]);var H=o.skipHidden&&s["!cols"]||[],ae=o.skipHidden&&s["!rows"]||[];for(O=d.s.c;O<=d.e.c;++O)if(!(H[O]||{}).hidden)switch(x[O]=Bs(O),t=w?s[L][O]:s[x[O]+g],r){case 1:l[O]=O-d.s.c;break;case 2:l[O]=x[O];break;case 3:l[O]=o.header[O-d.s.c];break;default:if(t==null&&(t={w:"__EMPTY",t:"s"}),c=i=Gt(t,null,o),h=I[i]||0,!h)I[i]=1;else{do c=i+"_"+h++;while(I[c]);I[i]=h,I[c]=1}l[O]=c}for(L=d.s.r+n;L<=d.e.r;++L)if(!(ae[L]||{}).hidden){var oe=vg(s,d,L,x,r,l,w,o);(oe.isempty===!1||(r===1?o.blankrows!==!1:o.blankrows))&&(f[p++]=oe.row)}return f.length=p,f}var Qi=/"/g;function wg(s,a,t,r,n,l,i,c){for(var d=!0,o=[],m="",g=Rs(t),x=a.s.c;x<=a.e.c;++x)if(r[x]){var f=c.dense?(s[t]||[])[x]:s[r[x]+g];if(f==null)m="";else if(f.v!=null){d=!1,m=""+(c.rawNumbers&&f.t=="n"?f.v:Gt(f,null,c));for(var p=0,h=0;p!==m.length;++p)if((h=m.charCodeAt(p))===n||h===l||h===34||c.forceQuotes){m='"'+m.replace(Qi,'""')+'"';break}m=="ID"&&(m='"ID"')}else f.f!=null&&!f.F?(d=!1,m="="+f.f,m.indexOf(",")>=0&&(m='"'+m.replace(Qi,'""')+'"')):m="";o.push(m)}return c.blankrows===!1&&d?null:o.join(i)}function Qn(s,a){var t=[],r=a??{};if(s==null||s["!ref"]==null)return"";var n=is(s["!ref"]),l=r.FS!==void 0?r.FS:",",i=l.charCodeAt(0),c=r.RS!==void 0?r.RS:`
`,d=c.charCodeAt(0),o=new RegExp((l=="|"?"\\|":l)+"+$"),m="",g=[];r.dense=Array.isArray(s);for(var x=r.skipHidden&&s["!cols"]||[],f=r.skipHidden&&s["!rows"]||[],p=n.s.c;p<=n.e.c;++p)(x[p]||{}).hidden||(g[p]=Bs(p));for(var h=0,w=n.s.r;w<=n.e.r;++w)(f[w]||{}).hidden||(m=wg(s,n,w,g,i,d,l,r),m!=null&&(r.strip&&(m=m.replace(o,"")),(m||r.blankrows!==!1)&&t.push((h++?c:"")+m)));return delete r.dense,t.join("")}function Kc(s,a){a||(a={}),a.FS="	",a.RS=`
`;var t=Qn(s,a);return t}function bg(s){var a="",t,r="";if(s==null||s["!ref"]==null)return[];var n=is(s["!ref"]),l="",i=[],c,d=[],o=Array.isArray(s);for(c=n.s.c;c<=n.e.c;++c)i[c]=Bs(c);for(var m=n.s.r;m<=n.e.r;++m)for(l=Rs(m),c=n.s.c;c<=n.e.c;++c)if(a=i[c]+l,t=o?(s[m]||[])[c]:s[a],r="",t!==void 0){if(t.F!=null){if(a=t.F,!t.f)continue;r=t.f,a.indexOf(":")==-1&&(a=a+":"+a)}if(t.f!=null)r=t.f;else{if(t.t=="z")continue;if(t.t=="n"&&t.v!=null)r=""+t.v;else if(t.t=="b")r=t.v?"TRUE":"FALSE";else if(t.w!==void 0)r="'"+t.w;else{if(t.v===void 0)continue;t.t=="s"?r="'"+t.v:r=""+t.v}}d[d.length]=a+"="+r}return d}function Vc(s,a,t){var r=t||{},n=+!r.skipHeader,l=s||{},i=0,c=0;if(l&&r.origin!=null)if(typeof r.origin=="number")i=r.origin;else{var d=typeof r.origin=="string"?Cs(r.origin):r.origin;i=d.r,c=d.c}var o,m={s:{c:0,r:0},e:{c,r:i+a.length-1+n}};if(l["!ref"]){var g=is(l["!ref"]);m.e.c=Math.max(m.e.c,g.e.c),m.e.r=Math.max(m.e.r,g.e.r),i==-1&&(i=g.e.r+1,m.e.r=i+a.length-1+n)}else i==-1&&(i=0,m.e.r=a.length-1+n);var x=r.header||[],f=0;a.forEach(function(h,w){Os(h).forEach(function(L){(f=x.indexOf(L))==-1&&(x[f=x.length]=L);var O=h[L],I="z",H="",ae=ss({c:c+f,r:i+w+n});o=dr(l,ae),O&&typeof O=="object"&&!(O instanceof Date)?l[ae]=O:(typeof O=="number"?I="n":typeof O=="boolean"?I="b":typeof O=="string"?I="s":O instanceof Date?(I="d",r.cellDates||(I="n",O=tt(O)),H=r.dateNF||gs[14]):O===null&&r.nullError&&(I="e",O=0),o?(o.t=I,o.v=O,delete o.w,delete o.R,H&&(o.z=H)):l[ae]=o={t:I,v:O},H&&(o.z=H))})}),m.e.c=Math.max(m.e.c,c+x.length-1);var p=Rs(i);if(n)for(f=0;f<x.length;++f)l[Bs(f+c)+p]={t:"s",v:x[f]};return l["!ref"]=Ns(m),l}function yg(s,a){return Vc(null,s,a)}function dr(s,a,t){if(typeof a=="string"){if(Array.isArray(s)){var r=Cs(a);return s[r.r]||(s[r.r]=[]),s[r.r][r.c]||(s[r.r][r.c]={t:"z"})}return s[a]||(s[a]={t:"z"})}return typeof a!="number"?dr(s,ss(a)):dr(s,ss({r:a,c:t||0}))}function Ng(s,a){if(typeof a=="number"){if(a>=0&&s.SheetNames.length>a)return a;throw new Error("Cannot find sheet # "+a)}else if(typeof a=="string"){var t=s.SheetNames.indexOf(a);if(t>-1)return t;throw new Error("Cannot find sheet name |"+a+"|")}else throw new Error("Cannot find sheet |"+a+"|")}function jg(){return{SheetNames:[],Sheets:{}}}function Sg(s,a,t,r){var n=1;if(!t)for(;n<=65535&&s.SheetNames.indexOf(t="Sheet"+n)!=-1;++n,t=void 0);if(!t||s.SheetNames.length>=65535)throw new Error("Too many worksheets");if(r&&s.SheetNames.indexOf(t)>=0){var l=t.match(/(^.*?)(\d+)$/);n=l&&+l[2]||0;var i=l&&l[1]||t;for(++n;n<=65535&&s.SheetNames.indexOf(t=i+n)!=-1;++n);}if(Rc(t),s.SheetNames.indexOf(t)>=0)throw new Error("Worksheet with name |"+t+"| already exists!");return s.SheetNames.push(t),s.Sheets[t]=a,t}function Tg(s,a,t){s.Workbook||(s.Workbook={}),s.Workbook.Sheets||(s.Workbook.Sheets=[]);var r=Ng(s,a);switch(s.Workbook.Sheets[r]||(s.Workbook.Sheets[r]={}),t){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+t)}s.Workbook.Sheets[r].Hidden=t}function kg(s,a){return s.z=a,s}function Xc(s,a,t){return a?(s.l={Target:a},t&&(s.l.Tooltip=t)):delete s.l,s}function _g(s,a,t){return Xc(s,"#"+a,t)}function Eg(s,a,t){s.c||(s.c=[]),s.c.push({t:a,a:t||"SheetJS"})}function Cg(s,a,t,r){for(var n=typeof a!="string"?a:is(a),l=typeof a=="string"?a:Ns(a),i=n.s.r;i<=n.e.r;++i)for(var c=n.s.c;c<=n.e.c;++c){var d=dr(s,i,c);d.t="n",d.F=l,delete d.v,i==n.s.r&&c==n.s.c&&(d.f=t,r&&(d.D=!0))}return s}var Nt={encode_col:Bs,encode_row:Rs,encode_cell:ss,encode_range:Ns,decode_col:Gn,decode_row:Un,split_cell:z0,decode_cell:Cs,decode_range:mt,format_cell:Gt,sheet_add_aoa:Vl,sheet_add_json:Vc,sheet_add_dom:Uc,aoa_to_sheet:Ia,json_to_sheet:yg,table_to_sheet:Gc,table_to_book:Zf,sheet_to_csv:Qn,sheet_to_txt:Kc,sheet_to_json:Qr,sheet_to_html:Bc,sheet_to_formulae:bg,sheet_to_row_object_array:Qr,sheet_get_cell:dr,book_new:jg,book_append_sheet:Sg,book_set_sheet_visibility:Tg,cell_set_number_format:kg,cell_set_hyperlink:Xc,cell_set_internal_link:_g,cell_add_comment:Eg,sheet_set_array_formula:Cg,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const Ag=()=>{var Be;const[s,a]=S.useState(!0),[t,r]=S.useState(""),[n,l]=S.useState("grades"),[i,c]=S.useState(""),[d,o]=S.useState("date"),[m,g]=S.useState("desc"),[x,f]=S.useState([]),[p,h]=S.useState(!1),[w,L]=S.useState(!1),[O,I]=S.useState(null),[H,ae]=S.useState([]),[oe,D]=S.useState([]),[q,z]=S.useState([]),[G,ce]=S.useState([]),[M,W]=S.useState("all"),[re,ve]=S.useState("all"),[te,ke]=S.useState(!1),[xe,Ie]=S.useState(!1),[je,Oe]=S.useState(!1),[N,P]=S.useState(null),[T,A]=S.useState(!1),[X,me]=S.useState({id:"",assignmentId:"",studentUsername:"",points:"",feedback:""}),[F,J]=S.useState(null),[U,Y]=S.useState(!1),[ue,Me]=S.useState(!1),[le,B]=S.useState(!1);S.useEffect(()=>{pe()},[]),S.useEffect(()=>{if(O){const C=setTimeout(()=>{I(null)},5e3);return()=>clearTimeout(C)}},[O]);const de=(C,Te)=>{I({type:C,message:Te})},pe=async()=>{a(!0);try{console.log("=== FETCHING INITIAL DATA ==="),await Promise.all([E(),R(),ye(),ee()]),console.log("=== INITIAL DATA FETCH COMPLETE ===")}catch(C){console.error("Error in fetchInitialData:",C),r("Gagal mengambil data. Silakan refresh halaman.")}finally{a(!1)}},E=async()=>{try{console.log("Fetching classes...");const C=await et.getAll();console.log("Classes API response:",C),C.success?(z(C.classes||[]),console.log("Classes set to state:",C.classes)):console.error("Failed to fetch classes:",C.error)}catch(C){console.error("Error fetching classes:",C)}},R=async()=>{try{console.log("Fetching assignments...");const C=await Rt.getAll();console.log("Assignments API response:",C),C.success?(D(C.assignments||[]),console.log("Assignments set to state:",C.assignments)):console.error("Failed to fetch assignments:",C.error)}catch(C){console.error("Error fetching assignments:",C)}},ye=async()=>{try{console.log("Fetching students...");const C=await _o.getAll();console.log("Students API response:",C),C.success?(ce(C.students||[]),console.log("Students set to state:",C.students)):console.error("Failed to fetch students:",C.error)}catch(C){console.error("Error fetching students:",C)}},ee=async()=>{try{console.log("Fetching all grades...");const C=await ya.getAll();if(console.log("Grades API response:",C),C.success){const Pe=(C.grades||[]).map(u=>{const b=oe.find(K=>K.id===u.assignmentId),v=(b==null?void 0:b.maxPoints)||100,y=u.points/v*100,j=Dt(u.points,v);let _=u.studentName;if(!_){const K=G.find(Z=>Z.username===u.studentUsername);_=(K==null?void 0:K.fullName)||u.studentUsername}return{...u,studentName:_,maxPoints:v,percentage:Math.round(y),status:j}});console.log("Setting enhanced grades to state:",Pe),ae(Pe)}else console.error("Failed to fetch grades:",C.error),r(C.error||"Gagal mengambil data nilai")}catch(C){console.error("Error fetching grades:",C),r("Terjadi kesalahan saat mengambil data nilai")}},Se=C=>{W(C),ve("all")},Ce=C=>{ve(C)},Ue=async()=>{A(!0);try{const C=Ye.map((Z,Q)=>{const se=oe.find(Ne=>Ne.id===Z.assignmentId),ne=G.find(Ne=>Ne.username===Z.studentUsername);return{No:Q+1,"Nama Siswa":Z.studentName,Username:Z.studentUsername,Kelas:Qs(Z.studentUsername,Z.assignmentId),Tugas:Ke(Z.assignmentId),Nilai:Z.points,"Nilai Maksimal":(se==null?void 0:se.maxPoints)||100,Persentase:se!=null&&se.maxPoints?Math.round(Z.points/se.maxPoints*100):Math.round(Z.points),Feedback:Z.feedback||"-","Tanggal Dinilai":Ts(Z.gradedAt),"Tanggal Deadline":se!=null&&se.dueDate?Ts(se.dueDate):"-"}});if(C.length===0){alert("Tidak ada data nilai untuk diekspor");return}const Te=Nt.book_new(),Pe=Nt.json_to_sheet(C),u=[{wch:5},{wch:20},{wch:15},{wch:10},{wch:25},{wch:8},{wch:12},{wch:10},{wch:30},{wch:15},{wch:15}];Pe["!cols"]=u;const b=Nt.decode_range(Pe["!ref"]||"A1");for(let Z=b.s.c;Z<=b.e.c;Z++){const Q=Nt.encode_cell({r:0,c:Z});Pe[Q]&&(Pe[Q].s={font:{bold:!0,color:{rgb:"FFFFFF"}},fill:{fgColor:{rgb:"4472C4"}},alignment:{horizontal:"center",vertical:"center"}})}for(let Z=1;Z<=C.length;Z++){const Q=Nt.encode_cell({r:Z,c:7});Pe[Q]&&(Pe[Q].z='0"%"')}let j=`Laporan_Nilai_${new Date().toISOString().split("T")[0]}`;if(M!=="all"){const Z=rs(M);j+=`_${Z.replace(/[^a-zA-Z0-9]/g,"_")}`}if(re!=="all"){const Z=Ke(re);j+=`_${Z.replace(/[^a-zA-Z0-9]/g,"_")}`}Nt.book_append_sheet(Te,Pe,"Data Nilai");const _=[{Informasi:"Total Nilai",Nilai:C.length},{Informasi:"Rata-rata",Nilai:C.length>0?Math.round(C.reduce((Z,Q)=>Z+Q.Nilai,0)/C.length*100)/100:0},{Informasi:"Nilai Tertinggi",Nilai:C.length>0?Math.max(...C.map(Z=>Z.Nilai)):0},{Informasi:"Nilai Terendah",Nilai:C.length>0?Math.min(...C.map(Z=>Z.Nilai)):0},{Informasi:"Tanggal Ekspor",Nilai:new Date().toLocaleDateString("id-ID")},{Informasi:"Filter Kelas",Nilai:M==="all"?"Semua Kelas":rs(M)},{Informasi:"Filter Tugas",Nilai:re==="all"?"Semua Tugas":Ke(re)}],K=Nt.json_to_sheet(_);K["!cols"]=[{wch:20},{wch:30}],["A1","B1"].forEach(Z=>{K[Z]&&(K[Z].s={font:{bold:!0,color:{rgb:"FFFFFF"}},fill:{fgColor:{rgb:"4472C4"}},alignment:{horizontal:"center",vertical:"center"}})}),Nt.book_append_sheet(Te,K,"Ringkasan"),$c(Te,`${j}.xlsx`),alert(`Data nilai berhasil diekspor! File: ${j}.xlsx`)}catch(C){console.error("Error exporting grades:",C),alert("Terjadi kesalahan saat mengekspor data nilai")}finally{A(!1)}},Xe=()=>{me({id:"",assignmentId:re!=="all"?re:"",studentUsername:"",points:"",feedback:""}),ke(!0)},vs=C=>{me({id:C.id,assignmentId:C.assignmentId,studentUsername:C.studentUsername,points:C.points.toString(),feedback:C.feedback}),Ie(!0)},as=C=>{J(C),Oe(!0)},cs=C=>{const{name:Te,value:Pe}=C.target;me(u=>({...u,[Te]:Pe}))},qs=(C,Te)=>{me(Pe=>({...Pe,[C]:Te}))},Gs=async C=>{if(C.preventDefault(),r(""),!X.assignmentId||!X.studentUsername||!X.points){r("Tugas, siswa, dan nilai wajib diisi");return}Y(!0);try{const Te=await ya.create(X.assignmentId,X.studentUsername,parseFloat(X.points),X.feedback);Te.success?(await ee(),ke(!1),me({id:"",assignmentId:"",studentUsername:"",points:"",feedback:""}),de("success","Nilai berhasil ditambahkan!")):r(Te.error||"Gagal menambahkan nilai")}catch(Te){r("Terjadi kesalahan saat menambah nilai"),console.error(Te)}finally{Y(!1)}},ie=async C=>{if(C.preventDefault(),r(""),!X.points){r("Nilai wajib diisi");return}Y(!0);try{const Te=await ya.update(X.id,parseFloat(X.points),X.feedback);Te.success?(await ee(),Ie(!1),de("success","Nilai berhasil diperbarui!")):r(Te.error||"Gagal mengubah nilai")}catch(Te){r("Terjadi kesalahan saat mengubah nilai"),console.error(Te)}finally{Y(!1)}},_e=async C=>{r(""),Me(!0);try{const Te=await ya.delete(C);Te.success?(await ee(),P(null),de("success","Nilai berhasil dihapus!")):r(Te.error||"Gagal menghapus nilai")}catch(Te){r("Terjadi kesalahan saat menghapus nilai"),console.error(Te)}finally{Me(!1)}},Ke=C=>{const Te=oe.find(Pe=>Pe.id===C);return Te?Te.title:"Tugas tidak ditemukan"},ps=C=>{const Te=oe.find(Pe=>Pe.id===C);return Te?rs(Te.classId):"Kelas tidak ditemukan"},rs=C=>{if(console.log("Looking for class with ID:",C),console.log("Available classes:",q),!C)return console.log("No classId provided"),"ID kelas tidak valid";if(!q||q.length===0)return console.log("No classes available"),"Data kelas tidak tersedia";const Te=q.find(Pe=>Pe.id===C);return console.log("Found class:",Te),Te?Te.name||"Nama kelas tidak tersedia":(console.log(`Class with ID ${C} not found`),console.log("Available class IDs:",q.map(Pe=>Pe.id)),"Kelas tidak ditemukan")},Qs=(C,Te)=>{if(console.log("Getting class name for student:",C,"assignmentId:",Te),!C)return"Username tidak valid";if(G&&G.length>0){const b=G.find(v=>v.username===C);if(b&&b.classId){const v=rs(b.classId);if(v!=="Kelas tidak ditemukan")return v}}if(Te){const b=ps(Te);if(b!=="Kelas tidak ditemukan")return b}const Pe=H.find(b=>b.studentUsername===C);if(Pe&&Pe.assignmentId){const b=ps(Pe.assignmentId);if(b!=="Kelas tidak ditemukan")return b}const u=G.find(b=>b.username===C);return u&&u.classId?`Kelas ID: ${u.classId}`:"Kelas tidak ditemukan"},Ts=C=>{if(!C)return"-";try{return new Date(C).toLocaleDateString("id-ID",{day:"2-digit",month:"2-digit",year:"numeric"})}catch{return C}},Ye=H.filter(C=>{const Te=!i||C.studentName.toLowerCase().includes(i.toLowerCase())||C.studentUsername.toLowerCase().includes(i.toLowerCase())||Ke(C.assignmentId).toLowerCase().includes(i.toLowerCase());let Pe=!0;if(M!=="all"){const b=oe.find(v=>v.id===C.assignmentId);if(b)Pe=b.classId===M;else{const v=G.find(y=>y.username===C.studentUsername);v?Pe=v.classId===M:Pe=!1}}const u=re==="all"||C.assignmentId===re;return Te&&Pe&&u}).sort((C,Te)=>{let Pe,u;switch(d){case"student":Pe=C.studentName.toLowerCase(),u=Te.studentName.toLowerCase();break;case"assignment":Pe=Ke(C.assignmentId).toLowerCase(),u=Ke(Te.assignmentId).toLowerCase();break;case"points":Pe=C.points,u=Te.points;break;case"date":Pe=new Date(C.gradedAt).getTime(),u=new Date(Te.gradedAt).getTime();break;default:Pe=new Date(C.gradedAt).getTime(),u=new Date(Te.gradedAt).getTime()}return Pe<u?m==="asc"?-1:1:Pe>u?m==="asc"?1:-1:0}),_t=oe.filter(C=>M==="all"?!0:C.classId===M),zt=G.filter(C=>M==="all"?!0:C.classId===M),ns=()=>{const C=Ye.length,Te=C>0?Ye.reduce((K,Z)=>K+Z.points,0)/C:0,Pe=C>0?Math.max(...Ye.map(K=>K.points)):0,u=C>0?Math.min(...Ye.map(K=>K.points)):0,b=Ye.filter(K=>K.status==="excellent").length,v=Ye.filter(K=>K.status==="good").length,y=Ye.filter(K=>K.status==="fair").length,j=Ye.filter(K=>K.status==="poor").length,_=C>0?Ye.reduce((K,Z)=>K+(Z.percentage||0),0)/C:0;return{total:C,averageScore:Math.round(Te*100)/100,highestScore:Pe,lowestScore:u,excellentCount:b,goodCount:v,fairCount:y,poorCount:j,averagePercentage:Math.round(_),passRate:C>0?Math.round((b+v+y)/C*100):0,trend:{up:b+v,down:j}}},Dt=(C,Te=100)=>{const Pe=C/Te*100;return Pe>=85?"excellent":Pe>=70?"good":Pe>=60?"fair":"poor"},It=C=>{switch(C){case"excellent":return"bg-green-100 text-green-800 border-green-200";case"good":return"bg-blue-100 text-blue-800 border-blue-200";case"fair":return"bg-yellow-100 text-yellow-800 border-yellow-200";case"poor":return"bg-red-100 text-red-800 border-red-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}},wt=C=>{switch(C){case"excellent":return"Sangat Baik";case"good":return"Baik";case"fair":return"Cukup";case"poor":return"Perlu Perbaikan";default:return"N/A"}},Wt=C=>{switch(C){case"excellent":return e.jsx(tr,{className:"w-4 h-4"});case"good":return e.jsx(ao,{className:"w-4 h-4"});case"fair":return e.jsx(Vt,{className:"w-4 h-4"});case"poor":return e.jsx(Zs,{className:"w-4 h-4"});default:return e.jsx(ot,{className:"w-4 h-4"})}},$t=()=>{x.length===Ye.length?f([]):f(Ye.map(C=>C.id))},ga=C=>{f(Te=>Te.includes(C)?Te.filter(Pe=>Pe!==C):[...Te,C])},Oa=async()=>{if(x.length!==0){B(!0);try{const C=x.map(Te=>ya.delete(Te));await Promise.all(C),de("success",`${x.length} nilai berhasil dihapus!`),f([]),await ee()}catch{de("error","Gagal menghapus beberapa nilai")}finally{B(!1),h(!1)}}},La=async()=>{L(!0),await pe(),de("success","Data berhasil diperbarui!"),L(!1)},k=()=>{const C=[];return oe.filter(Pe=>M!=="all"?Pe.classId===M:re!=="all"?Pe.id===re:!0).forEach(Pe=>{const u=G.filter(j=>j.classId===Pe.classId),b=H.filter(j=>j.assignmentId===Pe.id),v=new Set(b.map(j=>j.studentUsername));u.filter(j=>!v.has(j.username)).forEach(j=>{C.push({studentUsername:j.username,studentName:j.fullName,studentClassId:j.classId,assignmentId:Pe.id,assignmentTitle:Pe.title,assignmentClassName:rs(Pe.classId)})})}),C},fe=C=>{me({id:"",assignmentId:C.assignmentId,studentUsername:C.studentUsername,points:"",feedback:""}),ke(!0)};return s?e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsx(dt,{size:"lg"})}):e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-purple-50 p-6",children:e.jsxs("div",{className:"max-w-7xl mx-auto space-y-6",children:[e.jsx(Ve,{children:O&&e.jsx(ge.div,{initial:{opacity:0,y:-50,scale:.9},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-20,scale:.95},className:`fixed top-4 right-4 z-50 p-4 rounded-lg shadow-lg border-l-4 ${O.type==="success"?"bg-green-50 border-green-400 text-green-800":"bg-red-50 border-red-400 text-red-800"}`,children:e.jsxs("div",{className:"flex items-center gap-3",children:[O.type==="success"?e.jsx(Vs,{className:"w-5 h-5 text-green-600"}):e.jsx(Zs,{className:"w-5 h-5 text-red-600"}),e.jsx("span",{className:"font-medium",children:O.message}),e.jsx("button",{onClick:()=>I(null),className:"ml-2 text-gray-400 hover:text-gray-600",children:e.jsx(Ys,{className:"w-4 h-4"})})]})})}),e.jsx(fs,{variant:Ws,children:e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold bg-gradient-to-r from-gray-900 to-gray-600 bg-clip-text text-transparent",children:"Manajemen Nilai"}),e.jsx("p",{className:"text-gray-600 mt-2",children:"Kelola penilaian dan lihat progres siswa dengan analitik mendalam"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[x.length>0&&e.jsxs(ge.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},className:"flex items-center gap-2",children:[e.jsxs(Xs,{variant:"secondary",className:"px-3 py-1",children:[x.length," dipilih"]}),e.jsxs(V,{variant:"destructive",size:"sm",onClick:()=>h(!0),className:"flex items-center gap-1",children:[e.jsx(hs,{className:"w-4 h-4"}),"Hapus Terpilih"]})]}),e.jsxs(V,{variant:"outline",size:"sm",onClick:La,disabled:w,className:"flex items-center gap-2",children:[e.jsx(ct,{className:`w-4 h-4 ${w?"animate-spin":""}`}),w?"Memperbarui...":"Refresh"]}),e.jsxs(V,{variant:"outline",size:"sm",className:"flex gap-1 items-center",onClick:Ue,disabled:T||Ye.length===0,children:[e.jsx(yn,{className:"w-4 h-4"}),e.jsx("span",{children:T?"Mengekspor...":"Ekspor Excel"})]}),e.jsxs(V,{onClick:Xe,className:"flex gap-1 items-center bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700",children:[e.jsx(xs,{className:"w-4 h-4"}),e.jsx("span",{children:"Input Nilai Baru"})]})]})]})}),t&&e.jsx(ge.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Zs,{className:"w-5 h-5"}),e.jsx("span",{children:t})]})}),e.jsx(fs,{variant:Aa,delay:.2,children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-6 gap-4",children:[e.jsx(Ge,{className:"border-0 shadow-lg",children:e.jsx(We,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Nilai"}),e.jsx("p",{className:"text-2xl font-bold text-blue-600",children:ns().total})]}),e.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:e.jsx(ot,{className:"w-5 h-5 text-blue-600"})})]})})}),e.jsx(Ge,{className:"border-0 shadow-lg",children:e.jsx(We,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Rata-rata"}),e.jsx("p",{className:"text-2xl font-bold text-green-600",children:ns().averageScore})]}),e.jsx("div",{className:"w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center",children:e.jsx(Ot,{className:"w-5 h-5 text-green-600"})})]})})}),e.jsx(Ge,{className:"border-0 shadow-lg",children:e.jsx(We,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Nilai Tertinggi"}),e.jsx("p",{className:"text-2xl font-bold text-purple-600",children:ns().highestScore})]}),e.jsx("div",{className:"w-10 h-10 bg-purple-100 rounded-lg flex items-center justify-center",children:e.jsx(na,{className:"w-5 h-5 text-purple-600"})})]})})}),e.jsx(Ge,{className:"border-0 shadow-lg",children:e.jsx(We,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Sangat Baik"}),e.jsx("p",{className:"text-2xl font-bold text-green-600",children:ns().excellentCount})]}),e.jsx("div",{className:"w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center",children:e.jsx(tr,{className:"w-5 h-5 text-green-600"})})]})})}),e.jsx(Ge,{className:"border-0 shadow-lg",children:e.jsx(We,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Tingkat Lulus"}),e.jsxs("p",{className:"text-2xl font-bold text-indigo-600",children:[ns().passRate,"%"]})]}),e.jsx("div",{className:"w-10 h-10 bg-indigo-100 rounded-lg flex items-center justify-center",children:e.jsx(er,{className:"w-5 h-5 text-indigo-600"})})]})})}),e.jsx(Ge,{className:"border-0 shadow-lg",children:e.jsx(We,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Perlu Perbaikan"}),e.jsx("p",{className:"text-2xl font-bold text-red-600",children:ns().poorCount})]}),e.jsx("div",{className:"w-10 h-10 bg-red-100 rounded-lg flex items-center justify-center",children:e.jsx(Zs,{className:"w-5 h-5 text-red-600"})})]})})})]})}),e.jsx(fs,{variant:Ws,delay:.3,children:e.jsx(Ge,{className:"border-0 shadow-lg",children:e.jsxs(We,{className:"p-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"class-filter",className:"text-sm font-medium text-gray-700 mb-2 block",children:"Filter Kelas"}),e.jsxs("select",{id:"class-filter",className:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",value:M,onChange:C=>Se(C.target.value),children:[e.jsx("option",{value:"all",children:"Semua Kelas"}),q.map(C=>e.jsx("option",{value:C.id,children:C.name},C.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"assignment-filter",className:"text-sm font-medium text-gray-700 mb-2 block",children:"Filter Tugas"}),e.jsxs("select",{id:"assignment-filter",className:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",value:re,onChange:C=>Ce(C.target.value),children:[e.jsx("option",{value:"all",children:"Semua Tugas"}),_t.map(C=>e.jsx("option",{value:C.id,children:C.title},C.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"search",className:"text-sm font-medium text-gray-700 mb-2 block",children:"Cari Nilai"}),e.jsxs("div",{className:"relative",children:[e.jsx(Zt,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),e.jsx(He,{id:"search",placeholder:"Cari siswa atau tugas...",className:"pl-9",value:i,onChange:C=>c(C.target.value)})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"sort-by",className:"text-sm font-medium text-gray-700 mb-2 block",children:"Urutkan Berdasarkan"}),e.jsxs("select",{id:"sort-by",className:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",value:d,onChange:C=>o(C.target.value),children:[e.jsx("option",{value:"date",children:"Tanggal Terbaru"}),e.jsx("option",{value:"student",children:"Nama Siswa"}),e.jsx("option",{value:"assignment",children:"Nama Tugas"}),e.jsx("option",{value:"points",children:"Nilai"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"sort-order",className:"text-sm font-medium text-gray-700 mb-2 block",children:"Urutan"}),e.jsxs("select",{id:"sort-order",className:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",value:m,onChange:C=>g(C.target.value),children:[e.jsx("option",{value:"desc",children:"Menurun"}),e.jsx("option",{value:"asc",children:"Menaik"})]})]})]}),e.jsx("div",{className:"flex items-center justify-between mt-4 pt-4 border-t",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",id:"select-all",checked:Ye.length>0&&x.length===Ye.length,onChange:$t,className:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 focus:ring-2"}),e.jsx("label",{htmlFor:"select-all",className:"text-sm font-medium text-gray-700",children:"Pilih Semua"})]}),e.jsxs("div",{className:"text-sm text-gray-600",children:["Menampilkan ",Ye.length," dari ",H.length," nilai"]})]})})]})})}),e.jsxs("div",{className:"flex border-b bg-white rounded-t-lg px-6",children:[e.jsx("button",{className:`px-4 py-3 font-medium text-sm border-b-2 transition-colors ${n==="grades"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,onClick:()=>l("grades"),children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ot,{className:"w-4 h-4"}),"Daftar Nilai (",Ye.length,")"]})}),e.jsx("button",{className:`px-4 py-3 font-medium text-sm border-b-2 transition-colors ${n==="pending"?"border-orange-500 text-orange-600":"border-transparent text-gray-500 hover:text-gray-700"}`,onClick:()=>l("pending"),children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ft,{className:"w-4 h-4"}),"Belum Dinilai (",k().length,")"]})}),e.jsx("button",{className:`px-4 py-3 font-medium text-sm border-b-2 transition-colors ${n==="analytics"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,onClick:()=>l("analytics"),children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Mr,{className:"w-4 h-4"}),"Analitik Mendalam"]})})]}),n==="grades"&&e.jsx(fs,{variant:Ws,delay:.4,children:e.jsx(Ge,{className:"border-0 shadow-lg overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gradient-to-r from-gray-50 to-gray-100",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-4 text-left",children:e.jsx("input",{type:"checkbox",checked:Ye.length>0&&x.length===Ye.length,onChange:$t,className:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500"})}),e.jsx("th",{className:"px-6 py-4 text-left font-semibold text-gray-700",children:"Siswa"}),e.jsx("th",{className:"px-6 py-4 text-left font-semibold text-gray-700",children:"Tugas"}),e.jsx("th",{className:"px-6 py-4 text-left font-semibold text-gray-700",children:"Nilai"}),e.jsx("th",{className:"px-6 py-4 text-left font-semibold text-gray-700",children:"Status"}),e.jsx("th",{className:"px-6 py-4 text-left font-semibold text-gray-700",children:"Feedback"}),e.jsx("th",{className:"px-6 py-4 text-left font-semibold text-gray-700",children:"Tanggal"}),e.jsx("th",{className:"px-6 py-4 text-right font-semibold text-gray-700",children:"Aksi"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-100",children:e.jsx(Ve,{children:Ye.length>0?Ye.map((C,Te)=>e.jsxs(ge.tr,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{delay:Te*.05},className:`hover:bg-gray-50 transition-colors ${x.includes(C.id)?"bg-blue-50":""}`,children:[e.jsx("td",{className:"px-6 py-4",children:e.jsx("input",{type:"checkbox",checked:x.includes(C.id),onChange:()=>ga(C.id),className:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500"})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-900",children:C.studentName}),e.jsxs("div",{className:"text-sm text-gray-500",children:[C.studentUsername," • ",Qs(C.studentUsername,C.assignmentId)]})]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"max-w-xs",children:[e.jsx("div",{className:"font-medium text-gray-900 truncate",children:Ke(C.assignmentId)}),e.jsxs("div",{className:"text-sm text-gray-500",children:["Max: ",C.maxPoints||100," poin"]})]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-2xl font-bold text-gray-900",children:C.points}),e.jsxs("div",{className:"text-sm text-gray-500",children:[e.jsxs("div",{children:[C.percentage,"%"]}),e.jsxs("div",{children:["/",C.maxPoints||100]})]})]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx(Xs,{className:`${It(C.status||"fair")} border`,children:e.jsxs("div",{className:"flex items-center gap-1",children:[Wt(C.status||"fair"),e.jsx("span",{children:wt(C.status||"fair")})]})})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("div",{className:"max-w-xs",children:e.jsx("p",{className:"text-sm text-gray-600 truncate",children:C.feedback||"-"})})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("div",{className:"text-sm text-gray-500",children:Ts(C.gradedAt)})}),e.jsx("td",{className:"px-6 py-4 text-right",children:e.jsxs("div",{className:"flex justify-end gap-1",children:[e.jsx(V,{variant:"ghost",size:"sm",onClick:()=>as(C),className:"text-blue-600 hover:text-blue-700 hover:bg-blue-50",children:e.jsx(Ms,{className:"w-4 h-4"})}),e.jsx(V,{variant:"ghost",size:"sm",onClick:()=>vs(C),className:"text-green-600 hover:text-green-700 hover:bg-green-50",children:e.jsx(gt,{className:"w-4 h-4"})}),e.jsx(V,{variant:"ghost",size:"sm",onClick:()=>P(C.id),className:"text-red-600 hover:text-red-700 hover:bg-red-50",children:e.jsx(hs,{className:"w-4 h-4"})})]})})]},C.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:8,className:"px-6 py-12 text-center",children:e.jsxs("div",{className:"flex flex-col items-center gap-4",children:[e.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center",children:e.jsx(ot,{className:"w-8 h-8 text-gray-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500 font-medium",children:i?"Tidak ada nilai yang sesuai dengan pencarian":"Belum ada nilai"}),e.jsx("p",{className:"text-gray-400 text-sm mt-1",children:i?"Coba ubah kata kunci pencarian":"Mulai tambahkan nilai untuk siswa"})]}),!i&&e.jsxs(V,{onClick:Xe,className:"mt-2",children:[e.jsx(xs,{className:"w-4 h-4 mr-2"}),"Tambah Nilai Pertama"]})]})})})})})]})})})}),n==="pending"&&e.jsx(fs,{variant:Ws,delay:.4,children:e.jsx(Ge,{className:"border-0 shadow-lg overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gradient-to-r from-gray-50 to-gray-100",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-4 text-left font-semibold text-gray-700",children:"Siswa"}),e.jsx("th",{className:"px-6 py-4 text-left font-semibold text-gray-700",children:"Tugas"}),e.jsx("th",{className:"px-6 py-4 text-left font-semibold text-gray-700",children:"Kelas"}),e.jsx("th",{className:"px-6 py-4 text-left font-semibold text-gray-700",children:"Status"}),e.jsx("th",{className:"px-6 py-4 text-right font-semibold text-gray-700",children:"Aksi"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-100",children:e.jsx(Ve,{children:k().length>0?k().map((C,Te)=>e.jsxs(ge.tr,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{delay:Te*.05},children:[e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-900",children:C.studentName}),e.jsx("div",{className:"text-sm text-gray-500",children:C.studentUsername})]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("div",{className:"max-w-xs",children:e.jsx("div",{className:"font-medium text-gray-900 truncate",children:C.assignmentTitle})})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("div",{className:"max-w-xs",children:e.jsx("div",{className:"font-medium text-gray-900 truncate",children:C.assignmentClassName})})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx(Xs,{className:"bg-orange-100 text-orange-800 border border-orange-200",children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(ft,{className:"w-3 h-3"}),e.jsx("span",{children:"Belum Dinilai"})]})})}),e.jsx("td",{className:"px-6 py-4 text-right",children:e.jsxs(V,{variant:"default",size:"sm",onClick:()=>fe(C),className:"bg-blue-600 hover:bg-blue-700 text-white",children:[e.jsx(xs,{className:"w-4 h-4 mr-1"}),"Nilai Sekarang"]})})]},`${C.studentUsername}-${C.assignmentId}`)):e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"px-6 py-12 text-center",children:e.jsxs("div",{className:"flex flex-col items-center gap-4",children:[e.jsx("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center",children:e.jsx(Vs,{className:"w-8 h-8 text-green-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500 font-medium",children:"Semua Siswa Sudah Dinilai! 🎉"}),e.jsx("p",{className:"text-gray-400 text-sm mt-1",children:re!=="all"?`Semua siswa sudah mendapat nilai untuk tugas "${Ke(re)}"`:M!=="all"?`Semua siswa di kelas "${rs(M)}" sudah dinilai`:"Semua siswa untuk semua tugas sudah mendapat nilai"})]})]})})})})})]})})})}),n==="analytics"&&e.jsx(fs,{variant:Ws,delay:.4,children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4 sm:gap-6",children:[e.jsxs(Ge,{className:"lg:col-span-2 border-0 shadow-lg",children:[e.jsxs(ms,{className:"pb-4",children:[e.jsxs(ls,{className:"flex items-center gap-2 text-base sm:text-lg",children:[e.jsx(Mr,{className:"w-4 h-4 sm:w-5 sm:h-5 text-blue-600"}),"Distribusi Nilai"]}),e.jsx(bs,{className:"text-xs sm:text-sm",children:"Analisis performa akademik siswa berdasarkan kategori nilai"})]}),e.jsxs(We,{className:"pt-0",children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 sm:gap-4",children:[e.jsxs("div",{className:"text-center p-3 sm:p-4 bg-green-50 rounded-lg border border-green-200",children:[e.jsx("div",{className:"text-xl sm:text-2xl font-bold text-green-600",children:ns().excellentCount}),e.jsx("div",{className:"text-xs sm:text-sm text-green-700 font-medium",children:"Sangat Baik"}),e.jsx("div",{className:"text-xs text-green-600",children:"85% - 100%"})]}),e.jsxs("div",{className:"text-center p-3 sm:p-4 bg-blue-50 rounded-lg border border-blue-200",children:[e.jsx("div",{className:"text-xl sm:text-2xl font-bold text-blue-600",children:ns().goodCount}),e.jsx("div",{className:"text-xs sm:text-sm text-blue-700 font-medium",children:"Baik"}),e.jsx("div",{className:"text-xs text-blue-600",children:"70% - 84%"})]}),e.jsxs("div",{className:"text-center p-3 sm:p-4 bg-yellow-50 rounded-lg border border-yellow-200",children:[e.jsx("div",{className:"text-xl sm:text-2xl font-bold text-yellow-600",children:ns().fairCount}),e.jsx("div",{className:"text-xs sm:text-sm text-yellow-700 font-medium",children:"Cukup"}),e.jsx("div",{className:"text-xs text-yellow-600",children:"60% - 69%"})]}),e.jsxs("div",{className:"text-center p-3 sm:p-4 bg-red-50 rounded-lg border border-red-200",children:[e.jsx("div",{className:"text-xl sm:text-2xl font-bold text-red-600",children:ns().poorCount}),e.jsx("div",{className:"text-xs sm:text-sm text-red-700 font-medium",children:"Perlu Perbaikan"}),e.jsx("div",{className:"text-xs text-red-600",children:"< 60%"})]})]}),e.jsxs("div",{className:"mt-4 sm:mt-6 space-y-3 sm:space-y-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between text-xs sm:text-sm mb-2",children:[e.jsx("span",{children:"Tingkat Kelulusan"}),e.jsxs("span",{className:"font-medium",children:[ns().passRate,"%"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 sm:h-3",children:e.jsx("div",{className:"bg-gradient-to-r from-green-500 to-blue-500 h-2 sm:h-3 rounded-full transition-all duration-1000",style:{width:`${ns().passRate}%`}})})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between text-xs sm:text-sm mb-2",children:[e.jsx("span",{children:"Rata-rata Persentase"}),e.jsxs("span",{className:"font-medium",children:[ns().averagePercentage,"%"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 sm:h-3",children:e.jsx("div",{className:"bg-gradient-to-r from-purple-500 to-pink-500 h-2 sm:h-3 rounded-full transition-all duration-1000",style:{width:`${ns().averagePercentage}%`}})})]})]})]})]}),e.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[e.jsxs(Ge,{className:"border-0 shadow-lg",children:[e.jsx(ms,{className:"pb-3 sm:pb-4",children:e.jsxs(ls,{className:"flex items-center gap-2 text-base sm:text-lg",children:[e.jsx(na,{className:"w-4 h-4 sm:w-5 sm:h-5 text-green-600"}),"Statistik Kunci"]})}),e.jsxs(We,{className:"space-y-3 sm:space-y-4 pt-0",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-600 text-xs sm:text-sm",children:"Total Nilai"}),e.jsx("span",{className:"font-bold text-base sm:text-lg",children:ns().total})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-600 text-xs sm:text-sm",children:"Rata-rata"}),e.jsx("span",{className:"font-bold text-base sm:text-lg text-blue-600",children:ns().averageScore})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-600 text-xs sm:text-sm",children:"Tertinggi"}),e.jsx("span",{className:"font-bold text-base sm:text-lg text-green-600",children:ns().highestScore})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-600 text-xs sm:text-sm",children:"Terendah"}),e.jsx("span",{className:"font-bold text-base sm:text-lg text-red-600",children:ns().lowestScore})]})]})]}),e.jsxs(Ge,{className:"border-0 shadow-lg",children:[e.jsx(ms,{className:"pb-3 sm:pb-4",children:e.jsxs(ls,{className:"flex items-center gap-2 text-base sm:text-lg",children:[e.jsx(Vt,{className:"w-4 h-4 sm:w-5 sm:h-5 text-purple-600"}),"Tren Performa"]})}),e.jsxs(We,{className:"pt-0",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(na,{className:"w-3 h-3 sm:w-4 sm:h-4 text-green-600"}),e.jsx("span",{className:"text-xs sm:text-sm text-gray-600",children:"Performa Baik"})]}),e.jsx("span",{className:"font-medium text-green-600 text-sm sm:text-base",children:ns().trend.up})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(rl,{className:"w-3 h-3 sm:w-4 sm:h-4 text-red-600"}),e.jsx("span",{className:"text-xs sm:text-sm text-gray-600",children:"Perlu Perhatian"})]}),e.jsx("span",{className:"font-medium text-red-600 text-sm sm:text-base",children:ns().trend.down})]})]}),ns().trend.down>0&&e.jsx("div",{className:"mt-4 p-3 bg-yellow-50 border border-yellow-200 rounded-lg",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(Zs,{className:"w-3 h-3 sm:w-4 sm:h-4 text-yellow-600 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"text-xs sm:text-sm",children:[e.jsx("p",{className:"font-medium text-yellow-800",children:"Rekomendasi"}),e.jsxs("p",{className:"text-yellow-700",children:["Ada ",ns().trend.down," siswa yang perlu perhatian khusus"]})]})]})})]})]})]})]})}),te&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-lg max-w-md w-full p-4 sm:p-6 mx-4",children:[e.jsx("h2",{className:"text-lg sm:text-xl font-bold mb-4",children:"Tambah Nilai Baru"}),e.jsx("form",{onSubmit:Gs,children:e.jsxs("div",{className:"space-y-3 sm:space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"assignmentId",className:"text-xs sm:text-sm font-medium",children:"Tugas *"}),e.jsxs("select",{id:"assignmentId",className:"flex h-9 sm:h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-xs sm:text-sm ring-offset-background file:border-0 file:bg-transparent file:text-xs file:font-medium placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",value:X.assignmentId,onChange:C=>qs("assignmentId",C.target.value),required:!0,children:[e.jsx("option",{value:"",children:"Pilih Tugas"}),_t.map(C=>e.jsxs("option",{value:C.id,children:[C.title," - ",rs(C.classId)]},C.id))]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"studentUsername",className:"text-xs sm:text-sm font-medium",children:"Siswa *"}),e.jsxs("select",{id:"studentUsername",className:"flex h-9 sm:h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-xs sm:text-sm ring-offset-background file:border-0 file:bg-transparent file:text-xs file:font-medium placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",value:X.studentUsername,onChange:C=>qs("studentUsername",C.target.value),required:!0,children:[e.jsx("option",{value:"",children:"Pilih Siswa"}),zt.map(C=>e.jsxs("option",{value:C.username,children:[C.fullName," (",Qs(C.username,X.assignmentId),")"]},C.username))]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"points",className:"text-xs sm:text-sm font-medium",children:"Nilai *"}),e.jsx(He,{id:"points",name:"points",type:"number",min:"0",max:"100",value:X.points,onChange:cs,placeholder:"Masukkan nilai (0-100)",className:"h-9 sm:h-10 text-xs sm:text-sm",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"feedback",className:"text-xs sm:text-sm font-medium",children:"Feedback"}),e.jsx("textarea",{id:"feedback",name:"feedback",rows:3,className:"flex w-full rounded-md border border-input bg-background px-3 py-2 text-xs sm:text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 resize-none",value:X.feedback,onChange:cs,placeholder:"Masukkan feedback untuk siswa"})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row justify-end gap-2 pt-4",children:[e.jsx(V,{type:"button",variant:"outline",onClick:()=>ke(!1),className:"order-2 sm:order-1 h-9 text-sm",disabled:U,children:"Batal"}),e.jsx(V,{type:"submit",className:"order-1 sm:order-2 h-9 text-sm",disabled:U,children:U?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),e.jsx("span",{children:"Menyimpan..."})]}):"Simpan"})]})]})})]})}),xe&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-lg max-w-md w-full p-6",children:[e.jsx("h2",{className:"text-xl font-bold mb-4",children:"Edit Nilai"}),e.jsx("form",{onSubmit:ie,children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Tugas"}),e.jsx("div",{className:"p-2 bg-gray-50 rounded text-sm",children:Ke(X.assignmentId)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Siswa"}),e.jsxs("div",{className:"p-2 bg-gray-50 rounded text-sm",children:[(Be=G.find(C=>C.username===X.studentUsername))==null?void 0:Be.fullName,"(",Qs(X.studentUsername,X.assignmentId),")"]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"points-edit",className:"text-sm font-medium",children:"Nilai *"}),e.jsx(He,{id:"points-edit",name:"points",type:"number",min:"0",max:"100",value:X.points,onChange:cs,placeholder:"Masukkan nilai (0-100)",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"feedback-edit",className:"text-sm font-medium",children:"Feedback"}),e.jsx("textarea",{id:"feedback-edit",name:"feedback",rows:3,className:"flex w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",value:X.feedback,onChange:cs,placeholder:"Masukkan feedback untuk siswa"})]}),e.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[e.jsx(V,{type:"button",variant:"outline",onClick:()=>Ie(!1),disabled:U,children:"Batal"}),e.jsx(V,{type:"submit",disabled:U,children:U?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),e.jsx("span",{children:"Menyimpan..."})]}):"Simpan Perubahan"})]})]})})]})}),je&&F&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-lg max-w-md w-full p-6",children:[e.jsx("h2",{className:"text-xl font-bold mb-4",children:"Detail Nilai"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Siswa"}),e.jsx("p",{className:"text-lg font-medium",children:F.studentName}),e.jsx("p",{className:"text-sm text-gray-500",children:Qs(F.studentUsername,F.assignmentId)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Tugas"}),e.jsx("p",{className:"text-lg",children:Ke(F.assignmentId)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Nilai"}),e.jsx("p",{className:"text-2xl font-bold text-blue-600",children:F.points})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Feedback"}),e.jsx("p",{className:"text-sm",children:F.feedback||"Tidak ada feedback"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Dinilai Pada"}),e.jsx("p",{className:"text-sm",children:Ts(F.gradedAt)})]}),e.jsx("div",{className:"flex justify-end pt-4",children:e.jsx(V,{onClick:()=>Oe(!1),children:"Tutup"})})]})]})}),N&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-lg max-w-sm w-full p-6",children:[e.jsx("h2",{className:"text-xl font-bold mb-4",children:"Konfirmasi Hapus"}),e.jsx("p",{className:"text-gray-500 mb-6",children:"Apakah Anda yakin ingin menghapus nilai ini? Tindakan ini tidak dapat dibatalkan."}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(V,{type:"button",variant:"outline",onClick:()=>P(null),disabled:ue,children:"Batal"}),e.jsx(V,{type:"button",variant:"destructive",onClick:()=>_e(N),disabled:ue,children:ue?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),e.jsx("span",{children:"Menghapus..."})]}):"Hapus"})]})]})}),p&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50",children:e.jsxs(ge.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},className:"bg-white rounded-lg shadow-xl max-w-md w-full p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"w-10 h-10 bg-red-100 rounded-full flex items-center justify-center",children:e.jsx(hs,{className:"w-5 h-5 text-red-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Konfirmasi Hapus Massal"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Tindakan ini tidak dapat dibatalkan"})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("p",{className:"text-gray-700",children:["Apakah Anda yakin ingin menghapus ",e.jsxs("span",{className:"font-semibold",children:[x.length," nilai"]})," yang dipilih?"]}),e.jsx("div",{className:"mt-3 p-3 bg-red-50 border border-red-200 rounded-lg",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Zs,{className:"w-4 h-4 text-red-600"}),e.jsx("p",{className:"text-sm text-red-700",children:"Data yang dihapus tidak dapat dikembalikan"})]})})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx(V,{variant:"outline",onClick:()=>h(!1),disabled:le,children:"Batal"}),e.jsx(V,{variant:"destructive",onClick:Oa,className:"bg-red-600 hover:bg-red-700",disabled:le,children:le?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),e.jsx("span",{children:"Menghapus..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(hs,{className:"w-4 h-4 mr-2"}),"Hapus ",x.length," Nilai"]})})]})]})})]})})},ba={present:{label:"Hadir",color:"bg-green-500",textColor:"text-green-700",bgColor:"bg-green-100"},sick:{label:"Sakit",color:"bg-blue-500",textColor:"text-blue-700",bgColor:"bg-blue-100"},permission:{label:"Izin",color:"bg-yellow-500",textColor:"text-yellow-700",bgColor:"bg-yellow-100"},absent:{label:"Alfa",color:"bg-red-500",textColor:"text-red-700",bgColor:"bg-red-100"}},Fg=()=>e.jsx("div",{className:"animate-pulse space-y-3 sm:space-y-4",children:[...Array(5)].map((s,a)=>e.jsxs("div",{className:"flex items-center space-x-3 sm:space-x-4 p-3 sm:p-4 bg-gray-50 rounded-xl",children:[e.jsx("div",{className:"w-10 h-10 sm:w-12 sm:h-12 bg-gray-300 rounded-full"}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsx("div",{className:"h-3 sm:h-4 bg-gray-300 rounded w-3/4"}),e.jsx("div",{className:"h-2 sm:h-3 bg-gray-300 rounded w-1/2"})]}),e.jsx("div",{className:"flex space-x-1 sm:space-x-2",children:[...Array(4)].map((t,r)=>e.jsx("div",{className:"w-12 sm:w-16 h-6 sm:h-8 bg-gray-300 rounded-lg"},r))})]},a))}),Dg=({notification:s,onClose:a})=>{if(!s.visible)return null;const t={success:"bg-green-50 border-green-200 text-green-800",error:"bg-red-50 border-red-200 text-red-800",warning:"bg-yellow-50 border-yellow-200 text-yellow-800",info:"bg-blue-50 border-blue-200 text-blue-800"};return e.jsx(Ve,{children:e.jsx(ge.div,{initial:{opacity:0,y:-50},animate:{opacity:1,y:0},exit:{opacity:0,y:-50},className:"fixed top-4 left-4 right-4 sm:top-4 sm:right-4 sm:left-auto z-50 max-w-md",children:e.jsx("div",{className:`p-3 sm:p-4 rounded-xl border shadow-lg ${t[s.type]}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-xs sm:text-sm font-medium flex-1 pr-2",children:s.message}),e.jsx("button",{onClick:a,className:"ml-2 text-gray-500 hover:text-gray-700 text-lg",children:"×"})]})})})})},Ig=()=>{const[s,a]=S.useState("daily"),[t,r]=S.useState([]),[n,l]=S.useState([]),[i,c]=S.useState(""),[d,o]=S.useState(new Date),[m,g]=S.useState({}),[x,f]=S.useState([]),[p,h]=S.useState([]),[w,L]=S.useState(1),[O,I]=S.useState(!1),[H,ae]=S.useState(!0),oe=20,[D,q]=S.useState(!0),[z,G]=S.useState(!1),[ce,M]=S.useState(!1),[W,re]=S.useState(!1),[ve,te]=S.useState({type:"info",message:"",visible:!1}),[ke,xe]=S.useState({totalPresent:0,totalSick:0,totalPermission:0,totalAbsent:0}),[Ie,je]=S.useState({totalRecords:0,uniqueDatesCount:0,uniqueStudentsCount:0,dateRange:""}),Oe=(ee,Se)=>{te({type:ee,message:Se,visible:!0}),setTimeout(()=>te(Ce=>({...Ce,visible:!1})),5e3)},N=ee=>ee.toISOString().split("T")[0],P=ee=>ee.toLocaleDateString("id-ID",{weekday:"long",year:"numeric",month:"long",day:"numeric"}),T=ee=>{console.log("📊 Calculating real-time stats from",ee.length,"total records");const Se={totalPresent:0,totalSick:0,totalPermission:0,totalAbsent:0,totalRecords:ee.length,uniqueDates:new Set,uniqueStudents:new Set};ee.forEach(Xe=>{switch(Xe.status){case"present":Se.totalPresent++;break;case"sick":Se.totalSick++;break;case"permission":Se.totalPermission++;break;case"absent":Se.totalAbsent++;break}Se.uniqueDates.add(Xe.date),Se.uniqueStudents.add(Xe.studentUsername)});let Ce="";if(Se.uniqueDates.size>0){const Xe=Array.from(Se.uniqueDates).sort(),vs=new Date(Xe[0]).toLocaleDateString("id-ID",{day:"2-digit",month:"short"}),as=new Date(Xe[Xe.length-1]).toLocaleDateString("id-ID",{day:"2-digit",month:"short"});Xe.length===1?Ce=vs:Ce=`${vs} - ${as}`}const Ue={totalPresent:Se.totalPresent,totalSick:Se.totalSick,totalPermission:Se.totalPermission,totalAbsent:Se.totalAbsent,totalRecords:Se.totalRecords,uniqueDatesCount:Se.uniqueDates.size,uniqueStudentsCount:Se.uniqueStudents.size,dateRange:Ce};return console.log("📊 Calculated stats:",Ue),Ue},A=async()=>{try{q(!0),await Promise.all([X(),J()]),Oe("success","Data berhasil dimuat"),console.log("🔄 Force refreshing statistics after initial data load")}catch(ee){console.error("Error fetching initial data:",ee),Oe("error","Gagal memuat data")}finally{q(!1)}},X=async()=>{try{const ee=await et.getAll();ee.success&&r(ee.classes||[])}catch(ee){console.error("Error fetching classes:",ee)}},me=async ee=>{if(ee)try{G(!0);const Se=await ta.getAll();if(Se.success){const Ce=Se.students.filter(Ue=>Ue.classId===ee);l(Ce),await F(ee,N(d))}}catch(Se){console.error("Error fetching students:",Se),Oe("error","Gagal memuat data siswa")}finally{G(!1)}},F=async(ee,Se)=>{try{const Ce=await Or.getByClass(ee,Se);if(Ce.success){const Ue={};Ce.attendance.forEach(Xe=>{Ue[Xe.studentUsername]=Xe.status}),g(Ue),console.log("📅 Loaded attendance for",Se,":",Ce.attendance.length,"records")}}catch(Ce){console.error("Error fetching attendance:",Ce)}},J=async()=>{try{console.log("📚 Fetching all attendance records...");const ee=await Or.getAll();if(ee.success){const Se=ee.attendance||[];if(f(Se),Se.length>0){const Ce=T(Se);xe({totalPresent:Ce.totalPresent,totalSick:Ce.totalSick,totalPermission:Ce.totalPermission,totalAbsent:Ce.totalAbsent}),je({totalRecords:Ce.totalRecords,uniqueDatesCount:Ce.uniqueDatesCount,uniqueStudentsCount:Ce.uniqueStudentsCount,dateRange:Ce.dateRange}),console.log("📊 Global stats updated after fetch:",{totalRecords:Ce.totalRecords,uniqueDates:Ce.uniqueDatesCount,uniqueStudents:Ce.uniqueStudentsCount,dateRange:Ce.dateRange,stats:{present:Ce.totalPresent,sick:Ce.totalSick,permission:Ce.totalPermission,absent:Ce.totalAbsent}})}else console.log("📚 No records found, resetting stats"),xe({totalPresent:0,totalSick:0,totalPermission:0,totalAbsent:0}),je({totalRecords:0,uniqueDatesCount:0,uniqueStudentsCount:0,dateRange:""})}else console.error("❌ Failed to fetch all records:",ee.error),Oe("error","Gagal memuat riwayat presensi: "+ee.error)}catch(ee){console.error("❌ Error fetching all records:",ee),Oe("error","Error saat memuat riwayat presensi")}},U=()=>{const ee=new Date(d);ee.setDate(ee.getDate()-1),o(ee),i&&F(i,N(ee))},Y=()=>{const ee=new Date(d);ee.setDate(ee.getDate()+1),o(ee),i&&F(i,N(ee))},ue=()=>{const ee=new Date;o(ee),i&&F(i,N(ee))},Me=ee=>{c(ee),g({}),me(ee)},le=()=>{const ee={};n.forEach(Se=>{ee[Se.username]="present"}),g(ee),Oe("success","Semua siswa ditandai hadir")},B=async()=>{if(!i){Oe("error","Pilih kelas terlebih dahulu");return}if(Object.keys(m).length===0){Oe("error","Tidak ada data presensi untuk disimpan");return}try{M(!0),console.log("💾 Bulk saving attendance data:",m);const ee=await Or.update(i,N(d),m);ee.success?(Oe("success","Presensi berhasil disimpan"),await J(),await F(i,N(d)),console.log("✅ Attendance saved and statistics updated")):(console.error("❌ Failed bulk save:",ee.error),Oe("error","Gagal menyimpan presensi: "+ee.error))}catch(ee){console.error("❌ Error saving attendance:",ee),Oe("error","Error menyimpan presensi")}finally{M(!1)}},de=()=>{const ee=x.map(Ue=>{var Xe,vs;return{Tanggal:Ue.date,Kelas:((Xe=t.find(as=>as.id===Ue.classId))==null?void 0:Xe.name)||"Unknown",Siswa:Ue.studentUsername,Status:((vs=ba[Ue.status])==null?void 0:vs.label)||Ue.status,Catatan:Ue.notes}}),Se=Nt.json_to_sheet(ee),Ce=Nt.book_new();Nt.book_append_sheet(Ce,Se,"Data Presensi"),$c(Ce,`presensi_${new Date().toISOString().split("T")[0]}.xlsx`),re(!1),Oe("success","Data berhasil diekspor")},pe=()=>{if(x.length===0){h([]),ae(!1);return}const ee=x.slice(0,oe);h(ee),L(1),ae(x.length>oe),console.log("📊 Initial records loaded:",ee.length,"of",x.length)},E=()=>{O||!H||(I(!0),setTimeout(()=>{const ee=w+1,Se=w*oe,Ce=ee*oe,Ue=x.slice(Se,Ce);Ue.length>0?(h(Xe=>[...Xe,...Ue]),L(ee),ae(Ce<x.length),console.log("📊 More records loaded:",Ue.length,"total displayed:",p.length+Ue.length)):ae(!1),I(!1)},300))},R=()=>{h([]),L(1),ae(!0),I(!1)},ye=ee=>{const{scrollTop:Se,scrollHeight:Ce,clientHeight:Ue}=ee.currentTarget;Ce-Se<=Ue+100&&H&&!O&&E()};return S.useEffect(()=>{x.length>0?pe():R()},[x]),S.useEffect(()=>{if(console.log("📊 Attendance records changed, auto-refreshing stats..."),console.log("📊 Current attendanceRecords length:",x.length),x.length>0){const ee=T(x);console.log("📊 Setting new global stats:",{totalPresent:ee.totalPresent,totalSick:ee.totalSick,totalPermission:ee.totalPermission,totalAbsent:ee.totalAbsent}),xe({totalPresent:ee.totalPresent,totalSick:ee.totalSick,totalPermission:ee.totalPermission,totalAbsent:ee.totalAbsent}),je({totalRecords:ee.totalRecords,uniqueDatesCount:ee.uniqueDatesCount,uniqueStudentsCount:ee.uniqueStudentsCount,dateRange:ee.dateRange}),console.log("✅ Global statistics updated successfully")}else console.log("📊 No records found, resetting stats to zero"),xe({totalPresent:0,totalSick:0,totalPermission:0,totalAbsent:0}),je({totalRecords:0,uniqueDatesCount:0,uniqueStudentsCount:0,dateRange:""})},[x]),S.useEffect(()=>{x.length>0&&i&&console.log("📊 Class selection changed, updating stats for class:",i)},[i]),S.useEffect(()=>{s==="records"&&(console.log("📋 Switched to records tab, ensuring data is fresh..."),x.length===0&&J())},[s]),S.useEffect(()=>{A()},[]),D?e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-50 flex items-center justify-center p-4",children:e.jsx(ge.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},className:"bg-white/80 backdrop-blur-md rounded-2xl p-6 sm:p-8 shadow-xl max-w-sm mx-4",children:e.jsxs("div",{className:"flex items-center gap-3 sm:gap-4",children:[e.jsx("div",{className:"w-6 h-6 sm:w-8 sm:h-8 border-4 border-blue-500/30 border-t-blue-500 rounded-full animate-spin"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-base sm:text-lg font-semibold text-gray-900",children:"Memuat Data Presensi"}),e.jsx("p",{className:"text-xs sm:text-sm text-gray-500",children:"Mohon tunggu sebentar..."})]})]})})}):e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-50",children:[e.jsx(Dg,{notification:ve,onClose:()=>te(ee=>({...ee,visible:!1}))}),e.jsx("div",{className:"bg-white/80 backdrop-blur-md border-b border-gray-200/50 sticky top-0 z-30",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"flex items-center justify-between h-14 sm:h-16",children:[e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 min-w-0 flex-1",children:[e.jsx("div",{className:"w-8 h-8 sm:w-10 sm:h-10 bg-gradient-to-r from-blue-500 to-purple-600 rounded-xl flex items-center justify-center flex-shrink-0",children:e.jsx(ri,{className:"w-4 h-4 sm:w-6 sm:h-6 text-white"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("h1",{className:"text-lg sm:text-xl font-bold bg-gradient-to-r from-gray-900 to-gray-600 bg-clip-text text-transparent truncate",children:"Presensi Siswa"}),e.jsx("p",{className:"text-xs sm:text-sm text-gray-500 hidden sm:block",children:"Kelola kehadiran siswa dengan mudah"})]})]}),e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 flex-shrink-0",children:[e.jsx("button",{onClick:A,className:"p-2 text-gray-600 hover:text-blue-600 hover:bg-blue-50 rounded-xl transition-colors",children:e.jsx(ct,{className:"w-4 h-4 sm:w-5 sm:h-5"})}),e.jsxs("button",{onClick:()=>re(!0),className:"flex items-center gap-1 sm:gap-2 px-3 sm:px-4 py-2 bg-gradient-to-r from-green-500 to-emerald-600 text-white rounded-xl hover:from-green-600 hover:to-emerald-700 transition-all shadow-lg text-xs sm:text-sm",children:[e.jsx(yn,{className:"w-3 h-3 sm:w-4 sm:h-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Export"}),e.jsx("span",{className:"sm:hidden",children:"Data"})]})]})]})})}),e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4 sm:py-8",children:[e.jsx(ge.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"mb-6 sm:mb-8",children:e.jsxs("div",{className:"mb-4 sm:mb-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between mb-3 gap-3",children:[e.jsx("h2",{className:"text-xl sm:text-2xl font-bold bg-gradient-to-r from-gray-900 to-gray-600 bg-clip-text text-transparent",children:"Statistik Presensi Real-Time"}),e.jsxs("button",{onClick:J,className:"flex items-center gap-2 px-3 py-2 text-xs sm:text-sm bg-blue-50 text-blue-600 rounded-lg hover:bg-blue-100 transition-colors w-full sm:w-auto justify-center",children:[e.jsx(ct,{className:"w-3 h-3 sm:w-4 sm:h-4"}),"Refresh Data"]})]}),e.jsx("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 rounded-xl p-3 sm:p-4 border border-blue-200/50",children:e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3 sm:gap-4 text-xs sm:text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full flex-shrink-0"}),e.jsx("span",{className:"text-gray-600",children:"Total Records:"}),e.jsx("span",{className:"font-semibold text-gray-900",children:Ie.totalRecords})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full flex-shrink-0"}),e.jsx("span",{className:"text-gray-600",children:"Tanggal Recorded:"}),e.jsxs("span",{className:"font-semibold text-gray-900",children:[Ie.uniqueDatesCount," hari"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 bg-purple-500 rounded-full flex-shrink-0"}),e.jsx("span",{className:"text-gray-600",children:"Siswa Tercatat:"}),e.jsxs("span",{className:"font-semibold text-gray-900",children:[Ie.uniqueStudentsCount," siswa"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 bg-orange-500 rounded-full flex-shrink-0"}),e.jsx("span",{className:"text-gray-600",children:"Periode:"}),e.jsx("span",{className:"font-semibold text-gray-900 truncate",children:Ie.dateRange||"Belum ada data"})]})]})})]})}),e.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-3 sm:gap-6 mb-6 sm:mb-8",children:[e.jsx(ge.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-gradient-to-br from-green-500 to-emerald-600 rounded-2xl p-4 sm:p-6 text-white shadow-xl",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("p",{className:"text-green-100 text-xs sm:text-sm font-medium",children:"Total Hadir"}),e.jsx("p",{className:"text-2xl sm:text-3xl font-bold truncate",children:ke.totalPresent}),e.jsx("p",{className:"text-green-200 text-xs mt-1",children:"Semua data"})]}),e.jsx(Vs,{className:"w-8 h-8 sm:w-12 sm:h-12 text-white/80 flex-shrink-0 ml-2"})]})}),e.jsx(ge.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"bg-gradient-to-br from-blue-500 to-cyan-600 rounded-2xl p-4 sm:p-6 text-white shadow-xl",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("p",{className:"text-blue-100 text-xs sm:text-sm font-medium",children:"Sakit"}),e.jsx("p",{className:"text-2xl sm:text-3xl font-bold truncate",children:ke.totalSick}),e.jsx("p",{className:"text-blue-200 text-xs mt-1",children:"Semua data"})]}),e.jsx(ro,{className:"w-8 h-8 sm:w-12 sm:h-12 text-white/80 flex-shrink-0 ml-2"})]})}),e.jsx(ge.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"bg-gradient-to-br from-yellow-500 to-orange-600 rounded-2xl p-4 sm:p-6 text-white shadow-xl",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("p",{className:"text-yellow-100 text-xs sm:text-sm font-medium",children:"Izin"}),e.jsx("p",{className:"text-2xl sm:text-3xl font-bold truncate",children:ke.totalPermission}),e.jsx("p",{className:"text-yellow-200 text-xs mt-1",children:"Semua data"})]}),e.jsx(Zs,{className:"w-8 h-8 sm:w-12 sm:h-12 text-white/80 flex-shrink-0 ml-2"})]})}),e.jsx(ge.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},className:"bg-gradient-to-br from-red-500 to-pink-600 rounded-2xl p-4 sm:p-6 text-white shadow-xl",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("p",{className:"text-red-100 text-xs sm:text-sm font-medium",children:"Alfa"}),e.jsx("p",{className:"text-2xl sm:text-3xl font-bold truncate",children:ke.totalAbsent}),e.jsx("p",{className:"text-red-200 text-xs mt-1",children:"Semua data"})]}),e.jsx(bn,{className:"w-8 h-8 sm:w-12 sm:h-12 text-white/80 flex-shrink-0 ml-2"})]})})]}),e.jsxs("div",{className:"bg-white/80 backdrop-blur-md rounded-2xl border border-gray-200/50 shadow-xl",children:[e.jsxs("div",{className:"flex border-b border-gray-200/50 overflow-x-auto",children:[e.jsx("button",{onClick:()=>a("daily"),className:`flex-1 px-4 sm:px-6 py-3 sm:py-4 text-center font-medium rounded-tl-2xl transition-all whitespace-nowrap ${s==="daily"?"bg-gradient-to-r from-blue-500 to-purple-600 text-white":"text-gray-600 hover:text-blue-600 hover:bg-blue-50"}`,children:e.jsxs("div",{className:"flex items-center justify-center gap-1 sm:gap-2",children:[e.jsx(ri,{className:"w-4 h-4 sm:w-5 sm:h-5"}),e.jsx("span",{className:"text-xs sm:text-sm",children:"Presensi Harian"})]})}),e.jsx("button",{onClick:()=>a("records"),className:`flex-1 px-4 sm:px-6 py-3 sm:py-4 text-center font-medium rounded-tr-2xl transition-all whitespace-nowrap ${s==="records"?"bg-gradient-to-r from-blue-500 to-purple-600 text-white":"text-gray-600 hover:text-blue-600 hover:bg-blue-50"}`,children:e.jsxs("div",{className:"flex items-center justify-center gap-1 sm:gap-2",children:[e.jsx(ra,{className:"w-4 h-4 sm:w-5 sm:h-5"}),e.jsx("span",{className:"text-xs sm:text-sm",children:"Riwayat Presensi"})]})})]}),e.jsxs("div",{className:"p-4 sm:p-6",children:[s==="daily"&&e.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4 sm:gap-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-xs sm:text-sm font-semibold text-gray-700",children:"Pilih Kelas"}),e.jsxs("select",{value:i,onChange:ee=>Me(ee.target.value),className:"w-full px-3 sm:px-4 py-2 sm:py-3 bg-white border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm sm:text-base",children:[e.jsx("option",{value:"",children:"Pilih Kelas..."}),t.map(ee=>e.jsx("option",{value:ee.id,children:ee.name},ee.id))]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-xs sm:text-sm font-semibold text-gray-700",children:"Tanggal"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:U,className:"p-2 sm:p-3 text-gray-600 hover:text-blue-600 hover:bg-blue-50 border border-gray-200 rounded-xl transition-colors",children:e.jsx(no,{className:"w-4 h-4 sm:w-5 sm:h-5"})}),e.jsx("div",{className:"flex-1 px-3 sm:px-4 py-2 sm:py-3 bg-white border border-gray-200 rounded-xl",children:e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3",children:[e.jsx(pt,{className:"w-4 h-4 sm:w-5 sm:h-5 text-gray-400 flex-shrink-0"}),e.jsx("span",{className:"text-gray-900 font-medium text-xs sm:text-sm lg:text-base truncate",children:P(d)})]})}),e.jsx("button",{onClick:Y,className:"p-2 sm:p-3 text-gray-600 hover:text-blue-600 hover:bg-blue-50 border border-gray-200 rounded-xl transition-colors",children:e.jsx(io,{className:"w-4 h-4 sm:w-5 sm:h-5"})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-xs sm:text-sm font-semibold text-gray-700",children:"Aksi Cepat"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:ue,className:"flex-1 px-3 sm:px-4 py-2 sm:py-3 bg-gradient-to-r from-blue-500 to-purple-600 text-white rounded-xl hover:from-blue-600 hover:to-purple-700 transition-all text-xs sm:text-sm font-medium",children:"Hari Ini"}),e.jsx("button",{onClick:le,disabled:!i||n.length===0,className:"flex-1 px-3 sm:px-4 py-2 sm:py-3 bg-gradient-to-r from-green-500 to-emerald-600 text-white rounded-xl hover:from-green-600 hover:to-emerald-700 transition-all text-xs sm:text-sm font-medium disabled:opacity-50",children:"Semua Hadir"})]})]})]}),i&&e.jsxs("div",{className:"bg-white rounded-2xl border border-gray-200/50 shadow-lg overflow-hidden",children:[e.jsx("div",{className:"bg-gradient-to-r from-gray-50 to-gray-100 px-4 sm:px-6 py-3 sm:py-4 border-b",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-base sm:text-lg font-bold text-gray-900",children:"Daftar Siswa"}),e.jsxs("span",{className:"px-2 sm:px-3 py-1 bg-blue-100 text-blue-700 rounded-full text-xs sm:text-sm font-medium",children:[n.length," siswa"]})]})}),e.jsx("div",{className:"overflow-x-auto",children:z?e.jsx("div",{className:"p-4 sm:p-6",children:e.jsx(Fg,{})}):n.length===0?e.jsxs("div",{className:"p-8 sm:p-12 text-center",children:[e.jsx(_s,{className:"w-12 h-12 sm:w-16 sm:h-16 text-gray-300 mx-auto mb-4"}),e.jsx("p",{className:"text-base sm:text-lg font-medium text-gray-900",children:"Tidak ada siswa"}),e.jsx("p",{className:"text-xs sm:text-sm text-gray-500",children:"Silakan pilih kelas yang memiliki siswa"})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full min-w-[600px]",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 sm:px-6 py-2 sm:py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"No"}),e.jsx("th",{className:"px-4 sm:px-6 py-2 sm:py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Nama Siswa"}),e.jsx("th",{className:"px-4 sm:px-6 py-2 sm:py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status Kehadiran"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:n.map((ee,Se)=>e.jsxs(ge.tr,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:Se*.05},className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-4 sm:px-6 py-3 sm:py-4 whitespace-nowrap text-xs sm:text-sm text-gray-900",children:Se+1}),e.jsx("td",{className:"px-4 sm:px-6 py-3 sm:py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-8 h-8 sm:w-10 sm:h-10 bg-gradient-to-r from-blue-500 to-purple-600 rounded-full flex items-center justify-center text-white font-semibold text-xs sm:text-sm mr-3 sm:mr-4 flex-shrink-0",children:ee.fullName.charAt(0).toUpperCase()}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("div",{className:"text-xs sm:text-sm font-medium text-gray-900 truncate",children:ee.fullName}),e.jsx("div",{className:"text-xs text-gray-500 truncate",children:ee.username})]})]})}),e.jsx("td",{className:"px-4 sm:px-6 py-3 sm:py-4 whitespace-nowrap",children:e.jsx("div",{className:"flex justify-center gap-1 sm:gap-2 flex-wrap",children:["present","sick","permission","absent"].map(Ce=>e.jsx("button",{onClick:()=>g(Ue=>({...Ue,[ee.username]:Ce})),className:`px-2 sm:px-3 py-1 sm:py-2 text-xs font-medium rounded-lg transition-all ${m[ee.username]===Ce?`${ba[Ce].color} text-white shadow-md`:"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:ba[Ce].label},Ce))})})]},ee.id))})]})})}),i&&n.length>0&&e.jsx("div",{className:"bg-gray-50/50 px-4 sm:px-6 py-3 sm:py-4 border-t",children:e.jsx("div",{className:"flex justify-end",children:e.jsx("button",{onClick:B,disabled:ce,className:"flex items-center gap-2 px-4 sm:px-6 py-2 sm:py-3 bg-gradient-to-r from-blue-500 to-purple-600 text-white rounded-xl hover:from-blue-600 hover:to-purple-700 transition-all shadow-lg disabled:opacity-50 text-xs sm:text-sm",children:ce?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-3 h-3 sm:w-4 sm:h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"}),e.jsx("span",{children:"Menyimpan..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(At,{className:"w-3 h-3 sm:w-4 sm:h-4"}),e.jsx("span",{children:"Simpan Presensi"})]})})})})]})]}),s==="records"&&e.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-3 sm:gap-4",children:[e.jsxs("div",{children:[e.jsxs(ls,{className:"flex items-center gap-2 text-base sm:text-lg",children:[e.jsx(ra,{className:"w-4 h-4 sm:w-5 sm:h-5 text-blue-600"}),"Riwayat Presensi"]}),e.jsx("p",{className:"text-xs sm:text-sm text-gray-500 mt-1",children:x.length>0?p.length<x.length?e.jsxs(e.Fragment,{children:["Menampilkan ",p.length," dari ",x.length," records • Scroll ke bawah untuk muat lebih banyak"]}):e.jsxs(e.Fragment,{children:["Total ",x.length," records • Semua data sudah dimuat"]}):"Belum ada data presensi"})]}),e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3",children:[e.jsx("button",{onClick:J,className:"p-2 text-gray-600 hover:text-blue-600 hover:bg-blue-50 rounded-xl transition-colors",title:"Refresh data",children:e.jsx(ct,{className:"w-4 h-4 sm:w-5 sm:h-5"})}),e.jsxs(V,{onClick:()=>re(!0),className:"bg-gradient-to-r from-green-600 to-emerald-600 hover:from-green-700 hover:to-emerald-700 text-white text-xs sm:text-sm px-3 sm:px-4 py-2",children:[e.jsx(yn,{className:"w-3 h-3 sm:w-4 sm:h-4 mr-1 sm:mr-2"}),e.jsx("span",{className:"hidden sm:inline",children:"Export Data"}),e.jsx("span",{className:"sm:hidden",children:"Export"})]})]})]}),e.jsxs("div",{className:"bg-white rounded-2xl border shadow-lg overflow-hidden",children:[e.jsx("div",{className:"overflow-x-auto max-h-80 sm:max-h-96 overflow-y-auto",onScroll:ye,children:e.jsxs("table",{className:"w-full min-w-[700px]",children:[e.jsx("thead",{className:"bg-gray-50 sticky top-0",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 sm:px-6 py-2 sm:py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Tanggal"}),e.jsx("th",{className:"px-4 sm:px-6 py-2 sm:py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Kelas"}),e.jsx("th",{className:"px-4 sm:px-6 py-2 sm:py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Siswa"}),e.jsx("th",{className:"px-4 sm:px-6 py-2 sm:py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-4 sm:px-6 py-2 sm:py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Catatan"})]})}),e.jsxs("tbody",{className:"bg-white divide-y divide-gray-200",children:[p.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"px-4 sm:px-6 py-8 sm:py-12 text-center",children:e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx(ra,{className:"w-10 h-10 sm:w-12 sm:h-12 text-gray-300 mb-3"}),e.jsx("p",{className:"text-base sm:text-lg font-medium text-gray-900",children:"Belum ada data presensi"}),e.jsx("p",{className:"text-xs sm:text-sm text-gray-500",children:"Data akan muncul setelah presensi dilakukan"})]})})}):p.map((ee,Se)=>{var Ce,Ue,Xe,vs;return e.jsxs(ge.tr,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:Se*.02},className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-4 sm:px-6 py-3 sm:py-4 whitespace-nowrap text-xs sm:text-sm text-gray-900",children:new Date(ee.date).toLocaleDateString("id-ID")}),e.jsx("td",{className:"px-4 sm:px-6 py-3 sm:py-4 whitespace-nowrap text-xs sm:text-sm text-gray-900",children:((Ce=t.find(as=>as.id===ee.classId))==null?void 0:Ce.name)||"Unknown"}),e.jsx("td",{className:"px-4 sm:px-6 py-3 sm:py-4 whitespace-nowrap text-xs sm:text-sm text-gray-900",children:ee.studentUsername}),e.jsx("td",{className:"px-4 sm:px-6 py-3 sm:py-4 whitespace-nowrap text-center",children:e.jsx(Xs,{variant:"outline",className:`text-xs ${((Ue=ba[ee.status])==null?void 0:Ue.bgColor)||"bg-gray-100"} ${((Xe=ba[ee.status])==null?void 0:Xe.textColor)||"text-gray-700"} border-transparent`,children:((vs=ba[ee.status])==null?void 0:vs.label)||ee.status})}),e.jsx("td",{className:"px-4 sm:px-6 py-3 sm:py-4 whitespace-nowrap text-xs sm:text-sm text-gray-500",children:ee.notes||"-"})]},ee.id)}),O&&e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"px-4 sm:px-6 py-3 sm:py-4 text-center",children:e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 sm:w-4 sm:h-4 border-2 border-blue-500/30 border-t-blue-500 rounded-full animate-spin"}),e.jsx("span",{className:"text-xs sm:text-sm text-gray-600",children:"Memuat data..."})]})})})]})]})}),e.jsx("div",{className:"border-t bg-gray-50/30 px-4 sm:px-6 py-2 sm:py-3",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between text-xs sm:text-sm text-gray-600 gap-2",children:[e.jsxs("span",{children:["Menampilkan ",p.length," dari ",x.length," records"]}),!H&&x.length>oe&&e.jsxs("span",{className:"text-green-600 font-medium flex items-center gap-1",children:[e.jsx(Vs,{className:"w-3 h-3 sm:w-4 sm:h-4"}),"Semua data telah dimuat"]}),H&&!O&&e.jsxs(V,{onClick:E,variant:"outline",size:"sm",className:"text-blue-600 border-blue-200 hover:bg-blue-50 text-xs px-3 py-1",children:[e.jsx(ct,{className:"w-3 h-3 mr-1"}),"Load More"]})]})})]})]})]})]})]}),W&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs(ge.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},className:"bg-white rounded-2xl p-4 sm:p-6 w-full max-w-md mx-4",children:[e.jsx("h3",{className:"text-base sm:text-lg font-bold text-gray-900 mb-3 sm:mb-4",children:"Export Data Presensi"}),e.jsx("p",{className:"text-xs sm:text-sm text-gray-600 mb-4 sm:mb-6",children:"Data akan diekspor dalam format Excel (.xlsx)"}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 sm:gap-3",children:[e.jsx("button",{onClick:()=>re(!1),className:"flex-1 px-3 sm:px-4 py-2 border border-gray-300 text-gray-700 rounded-xl hover:bg-gray-50 transition-colors text-xs sm:text-sm font-medium order-2 sm:order-1",children:"Batal"}),e.jsx("button",{onClick:de,className:"flex-1 px-3 sm:px-4 py-2 bg-green-500 text-white rounded-xl hover:bg-green-600 transition-colors text-xs sm:text-sm font-medium order-1 sm:order-2",children:"Export"})]})]})})]})},Pg=({notification:s,onClose:a})=>{if(!s.visible)return null;const t={success:"bg-green-50 border-green-200 text-green-800",error:"bg-red-50 border-red-200 text-red-800",warning:"bg-yellow-50 border-yellow-200 text-yellow-800",info:"bg-blue-50 border-blue-200 text-blue-800"},r={success:e.jsx(ll,{className:"w-4 h-4 sm:w-5 sm:h-5"}),error:e.jsx(Ks,{className:"w-4 h-4 sm:w-5 sm:h-5"}),warning:e.jsx(Ks,{className:"w-4 h-4 sm:w-5 sm:h-5"}),info:e.jsx(pt,{className:"w-4 h-4 sm:w-5 sm:h-5"})};return e.jsx(Ve,{children:e.jsx(ge.div,{initial:{opacity:0,y:-50},animate:{opacity:1,y:0},exit:{opacity:0,y:-50},className:"fixed top-4 left-4 right-4 sm:top-4 sm:right-4 sm:left-auto z-50 max-w-md",children:e.jsx("div",{className:`p-3 sm:p-4 rounded-xl border shadow-lg ${t[s.type]}`,children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"flex-shrink-0",children:r[s.type]}),e.jsx("span",{className:"text-sm font-medium flex-1 truncate",children:s.message}),e.jsx("button",{onClick:a,className:"text-gray-500 hover:text-gray-700 flex-shrink-0",children:e.jsx(Ys,{className:"w-4 h-4"})})]})})})})},Rg=()=>e.jsx("div",{className:"animate-pulse space-y-4",children:[...Array(3)].map((s,a)=>e.jsxs("div",{className:"bg-white rounded-2xl border border-gray-200/50 p-4 sm:p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-5 h-5 sm:w-6 sm:h-6 bg-gray-300 rounded-lg"}),e.jsx("div",{className:"h-5 sm:h-6 bg-gray-300 rounded w-32 sm:w-48"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("div",{className:"w-12 sm:w-16 h-6 sm:h-8 bg-gray-300 rounded-lg"}),e.jsx("div",{className:"w-12 sm:w-16 h-6 sm:h-8 bg-gray-300 rounded-lg"})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"h-3 sm:h-4 bg-gray-300 rounded w-full"}),e.jsx("div",{className:"h-3 sm:h-4 bg-gray-300 rounded w-3/4"}),e.jsx("div",{className:"h-3 sm:h-4 bg-gray-300 rounded w-1/2"})]})]},a))}),za=({isOpen:s,onClose:a,title:t,children:r,size:n="default"})=>{if(!s)return null;const l={default:"max-w-md w-full",large:"max-w-2xl w-full",xl:"max-w-4xl w-full"};return e.jsx(Ve,{children:e.jsx(ge.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",onClick:a,children:e.jsxs(ge.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},onClick:i=>i.stopPropagation(),className:`bg-white rounded-2xl shadow-2xl ${l[n]} max-h-[90vh] overflow-hidden mx-4`,children:[e.jsxs("div",{className:"flex items-center justify-between p-4 sm:p-6 border-b border-gray-200/50",children:[e.jsx("h3",{className:"text-lg sm:text-xl font-bold text-gray-900",children:t}),e.jsx("button",{onClick:a,className:"p-2 hover:bg-gray-100 rounded-xl transition-colors",children:e.jsx(Ys,{className:"w-4 h-4 sm:w-5 sm:h-5"})})]}),e.jsx("div",{className:"p-4 sm:p-6 overflow-y-auto max-h-[calc(90vh-80px)]",children:r})]})})})},Og=()=>{const[s,a]=S.useState(!0),[t,r]=S.useState(!1),[n,l]=S.useState("journals"),[i,c]=S.useState(""),[d,o]=S.useState("all"),[m,g]=S.useState([]),[x,f]=S.useState([]),[p,h]=S.useState(null),[w,L]=S.useState(!1),[O,I]=S.useState(!1),[H,ae]=S.useState(!1),[oe,D]=S.useState(!1),[q,z]=S.useState(!1),[G,ce]=S.useState(null),[M,W]=S.useState(null),[re,ve]=S.useState({classId:"",date:new Date().toISOString().split("T")[0],topic:"",activities:"",notes:""}),[te,ke]=S.useState({type:"info",message:"",visible:!1}),xe=(R,ye)=>{ke({type:R,message:ye,visible:!0}),setTimeout(()=>ke(ee=>({...ee,visible:!1})),5e3)},[Ie,je]=S.useState([{id:1,name:"Template Standar",description:"Template jurnal pembelajaran standar untuk kegiatan harian",topic:"Topik Pembelajaran",activities:`Kegiatan Pembuka:
- Salam dan doa
- Apersepsi
- Menyampaikan tujuan pembelajaran

Kegiatan Inti:
- Penjelasan materi
- Diskusi kelompok
- Latihan soal

Kegiatan Penutup:
- Kesimpulan
- Evaluasi
- Tugas rumah`,notes:"Catatan dan refleksi pembelajaran",isDefault:!0},{id:2,name:"Template Praktikum",description:"Template khusus untuk kegiatan praktikum dan eksperimen",topic:"Praktikum [Nama Praktikum]",activities:`Persiapan:
- Penjelasan tujuan praktikum
- Pembagian kelompok
- Persiapan alat dan bahan

Pelaksanaan:
- Demonstrasi prosedur
- Praktikum kelompok
- Pengamatan dan pencatatan data

Penutup:
- Diskusi hasil
- Kesimpulan
- Laporan praktikum`,notes:"Evaluasi jalannya praktikum dan hasil yang diperoleh",isDefault:!1},{id:3,name:"Template Evaluasi",description:"Template untuk pertemuan evaluasi, ulangan, atau ujian",topic:"Evaluasi [Materi]",activities:`Persiapan:
- Pengaturan tempat duduk
- Pembagian soal
- Penjelasan tata tertib

Pelaksanaan:
- Ujian/ulangan
- Pengawasan
- Pengumpulan jawaban

Tindak Lanjut:
- Koreksi
- Analisis hasil
- Feedback`,notes:"Analisis hasil evaluasi dan rencana tindak lanjut",isDefault:!1}]);S.useEffect(()=>{Oe()},[]);const Oe=async()=>{a(!0);try{await Promise.all([N(),P()]),xe("success","Data berhasil dimuat")}catch(R){console.error("Error fetching initial data:",R),xe("error","Gagal memuat data")}finally{a(!1)}},N=async()=>{try{const R=await et.getAll();R.success&&g(R.classes||[])}catch(R){console.error("Error fetching classes:",R),xe("error","Gagal memuat data kelas")}},P=async()=>{try{const R=await br.getAll();if(R.success){const ye=(R.journals||[]).map(ee=>({...ee,className:A(ee.classId),isComplete:ee.topic&&ee.activities&&ee.notes}));f(ye),T(ye)}}catch(R){console.error("Error fetching journals:",R),xe("error","Gagal memuat data jurnal")}},T=R=>{const ye=R.length,ee=R.filter(as=>as.isComplete).length,Se=ye-ee,Ce=ye>0?Math.round(ee/ye*100):0,Ue=m.map(as=>{const cs=R.filter(Gs=>Gs.classId===as.id),qs=cs.filter(Gs=>Gs.isComplete).length;return{className:as.name,total:cs.length,completed:qs,incomplete:cs.length-qs}}).filter(as=>as.total>0),vs=["Jan","Feb","Mar","Apr","Mei","Jun","Jul","Agt","Sep","Okt","Nov","Des"].map((as,cs)=>{const qs=R.filter(Gs=>{const ie=new Date(Gs.date);return ie.getMonth()===cs&&ie.getFullYear()===new Date().getFullYear()});return{month:as,count:qs.length}}).filter(as=>as.count>0);h({totalJournals:ye,completedJournals:ee,incompleteJournals:Se,completionRate:Ce,journalsByClass:Ue,journalsByMonth:vs})},A=R=>{const ye=m.find(ee=>ee.id===R);return ye?ye.name:"Unknown Class"},X=()=>{ve({classId:"",date:new Date().toISOString().split("T")[0],topic:"",activities:"",notes:""})},me=()=>{X(),L(!0)},F=R=>{ce(R),ve({classId:R.classId,date:R.date,topic:R.topic,activities:R.activities,notes:R.notes}),I(!0)},J=R=>{ce(R),D(!0)},U=R=>{ce(R),ae(!0)},Y=async()=>{if(!re.classId||!re.topic||!re.activities){xe("warning","Mohon lengkapi kelas, topik, dan aktivitas pembelajaran");return}r(!0);try{const R=await br.create(re.classId,re.date,re.topic,re.activities,re.notes);R.success?(await P(),L(!1),X(),xe("success","Jurnal berhasil dibuat")):xe("error","Gagal membuat jurnal: "+R.error)}catch(R){console.error("Error creating journal:",R),xe("error","Terjadi kesalahan saat membuat jurnal")}finally{r(!1)}},ue=async()=>{if(!G||!re.topic||!re.activities){xe("warning","Mohon lengkapi topik dan aktivitas pembelajaran");return}r(!0);try{const R=await br.update(G.id,re.topic,re.activities,re.notes);R.success?(await P(),I(!1),ce(null),X(),xe("success","Jurnal berhasil diperbarui")):xe("error","Gagal memperbarui jurnal: "+R.error)}catch(R){console.error("Error updating journal:",R),xe("error","Terjadi kesalahan saat memperbarui jurnal")}finally{r(!1)}},Me=async()=>{if(G){r(!0);try{const R=await br.delete(G.id);R.success?(await P(),ae(!1),ce(null),xe("success","Jurnal berhasil dihapus")):xe("error","Gagal menghapus jurnal: "+R.error)}catch(R){console.error("Error deleting journal:",R),xe("error","Terjadi kesalahan saat menghapus jurnal")}finally{r(!1)}}},le=R=>{ve(ye=>({...ye,topic:R.topic,activities:R.activities,notes:R.notes})),z(!1),L(!0),xe("success",`Template "${R.name}" berhasil diterapkan`)},B=R=>{W(R),z(!0)},de=R=>{var ye;if((ye=Ie.find(ee=>ee.id===R))!=null&&ye.isDefault){xe("warning","Template default tidak dapat dihapus");return}confirm("Yakin ingin menghapus template ini?")&&(je(ee=>ee.filter(Se=>Se.id!==R)),xe("success","Template berhasil dihapus"))},pe=x.filter(R=>{const ye=(R.className||"").toLowerCase().includes(i.toLowerCase())||R.topic.toLowerCase().includes(i.toLowerCase())||R.activities.toLowerCase().includes(i.toLowerCase()),ee=d==="all"||d==="complete"&&R.isComplete||d==="incomplete"&&!R.isComplete;return ye&&ee}),E=R=>{const ye=new Date(R);return new Intl.DateTimeFormat("id-ID",{day:"numeric",month:"long",year:"numeric"}).format(ye)};return s?e.jsx("div",{className:"min-h-screen bg-gray-50/50 p-4 sm:p-6",children:e.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"h-6 sm:h-8 bg-gray-300 rounded w-48 sm:w-64 animate-pulse"}),e.jsx("div",{className:"h-4 sm:h-5 bg-gray-200 rounded w-56 sm:w-80 mt-2 animate-pulse"})]}),e.jsx("div",{className:"h-9 sm:h-10 bg-gray-300 rounded w-32 sm:w-40 animate-pulse"})]}),e.jsx(Rg,{})]})}):e.jsxs(ge.div,{initial:{opacity:0},animate:{opacity:1},className:"min-h-screen bg-gray-50/50 p-4 sm:p-6 space-y-4 sm:space-y-6",children:[e.jsxs(ge.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900",children:"Jurnal Pembelajaran"}),e.jsx("p",{className:"text-gray-600 mt-1 text-sm sm:text-base",children:"Dokumentasi dan refleksi kegiatan pembelajaran"})]}),e.jsx(ge.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{delay:.1},children:e.jsxs(V,{className:"bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800 text-white shadow-lg hover:shadow-xl transition-all duration-200 flex items-center gap-2 h-10 sm:h-11 text-sm sm:text-base w-full sm:w-auto",onClick:me,children:[e.jsx(xs,{className:"w-3 h-3 sm:w-4 sm:h-4"}),e.jsx("span",{children:"Buat Jurnal Baru"})]})})]}),e.jsxs(ge.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"bg-white rounded-2xl border border-gray-200/50 shadow-sm overflow-hidden",children:[e.jsx("div",{className:"flex border-b border-gray-200/50 overflow-x-auto",children:[{id:"journals",label:"Semua Jurnal",icon:ys},{id:"templates",label:"Template",icon:ot},{id:"reports",label:"Laporan",icon:ra}].map(R=>e.jsxs("button",{className:`flex-1 px-4 sm:px-6 py-3 sm:py-4 font-medium text-xs sm:text-sm transition-all duration-200 flex items-center justify-center gap-2 whitespace-nowrap ${n===R.id?"text-blue-600 bg-blue-50/50 border-b-2 border-blue-500":"text-gray-600 hover:text-gray-900 hover:bg-gray-50/50"}`,onClick:()=>l(R.id),children:[e.jsx(R.icon,{className:"w-3 h-3 sm:w-4 sm:h-4"}),e.jsx("span",{children:R.label})]},R.id))}),e.jsxs("div",{className:"p-4 sm:p-6",children:[n==="journals"&&e.jsxs(ge.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"space-y-4 sm:space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 sm:gap-4 justify-between",children:[e.jsxs("div",{className:"relative flex-1 max-w-md",children:[e.jsx(Zt,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),e.jsx(He,{placeholder:"Cari jurnal berdasarkan topik, kelas, atau aktivitas...",className:"pl-10 h-10 sm:h-11 border-gray-200 focus:border-blue-300 focus:ring-blue-200 rounded-xl text-sm sm:text-base",value:i,onChange:R=>c(R.target.value)})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[[{id:"all",label:"Semua"},{id:"complete",label:"Lengkap"},{id:"incomplete",label:"Belum Lengkap"}].map(R=>e.jsx(V,{variant:d===R.id?"default":"outline",size:"sm",className:`transition-all duration-200 h-8 sm:h-9 text-xs sm:text-sm px-2 sm:px-3 ${d===R.id?"bg-blue-600 hover:bg-blue-700 text-white shadow-md":"border-gray-200 hover:bg-gray-50"}`,onClick:()=>o(R.id),children:R.label},R.id)),e.jsx(V,{variant:"outline",size:"sm",className:"border-gray-200 hover:bg-gray-50 h-8 sm:h-9 px-2 sm:px-3",onClick:P,children:e.jsx(ct,{className:"w-3 h-3 sm:w-4 sm:h-4"})})]})]}),e.jsx("div",{className:"space-y-4",children:pe.length>0?e.jsx(Ve,{children:pe.map((R,ye)=>e.jsx(ge.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.3,delay:ye*.05},className:"bg-white border border-gray-200/50 rounded-2xl shadow-sm hover:shadow-lg transition-all duration-300 overflow-hidden group",children:e.jsxs("div",{className:"p-4 sm:p-6",children:[e.jsxs("div",{className:"flex flex-col gap-4 mb-4",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-3",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx(ys,{className:"w-4 h-4 sm:w-5 sm:h-5 text-blue-600 flex-shrink-0"}),e.jsx("h2",{className:"text-base sm:text-lg font-semibold text-gray-900 line-clamp-1 flex-1",children:R.topic})]}),e.jsxs("div",{className:"flex flex-wrap items-center text-xs sm:text-sm text-gray-500 gap-3 sm:gap-4",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(il,{className:"w-3 h-3 sm:w-4 sm:h-4"}),e.jsx("span",{children:E(R.date)})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(ys,{className:"w-3 h-3 sm:w-4 sm:h-4"}),e.jsx("span",{className:"truncate",children:R.className})]})]})]}),e.jsx("div",{className:"flex items-center gap-3",children:e.jsx(Xs,{className:`${R.isComplete?"bg-green-100 text-green-800 border-green-200":"bg-yellow-100 text-yellow-800 border-yellow-200"}`,children:R.isComplete?e.jsxs(e.Fragment,{children:[e.jsx(ll,{className:"w-3 h-3 mr-1"}),"Lengkap"]}):e.jsxs(e.Fragment,{children:[e.jsx(ft,{className:"w-3 h-3 mr-1"}),"Draft"]})})})]}),e.jsxs("div",{className:"flex flex-wrap gap-2 sm:opacity-0 sm:group-hover:opacity-100 transition-opacity duration-200",children:[e.jsxs(V,{variant:"outline",size:"sm",className:"border-gray-200 hover:bg-blue-50 hover:border-blue-200 hover:text-blue-700 transition-all duration-200 h-8 text-xs flex-1 sm:flex-none",onClick:()=>J(R),children:[e.jsx(Ms,{className:"w-3 h-3 sm:w-4 sm:h-4 mr-1"}),"Lihat"]}),e.jsxs(V,{variant:"outline",size:"sm",className:"border-gray-200 hover:bg-green-50 hover:border-green-200 hover:text-green-700 transition-all duration-200 h-8 text-xs flex-1 sm:flex-none",onClick:()=>F(R),children:[e.jsx(gt,{className:"w-3 h-3 sm:w-4 sm:h-4 mr-1"}),"Edit"]}),e.jsx(V,{variant:"outline",size:"sm",className:"border-gray-200 hover:bg-red-50 hover:border-red-200 hover:text-red-700 transition-all duration-200 h-8 text-xs px-3",onClick:()=>U(R),children:e.jsx(hs,{className:"w-3 h-3 sm:w-4 sm:h-4"})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4 sm:gap-6",children:[e.jsxs("div",{className:"space-y-3 sm:space-y-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xs sm:text-sm font-medium text-gray-700 mb-2",children:"Topik Pembelajaran"}),e.jsx("p",{className:"text-gray-900 text-sm line-clamp-2",children:R.topic||"-"})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xs sm:text-sm font-medium text-gray-700 mb-2",children:"Aktivitas Pembelajaran"}),e.jsx("p",{className:"text-gray-900 text-sm line-clamp-3",children:R.activities||"-"})]})]}),e.jsxs("div",{className:"space-y-3 sm:space-y-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xs sm:text-sm font-medium text-gray-700 mb-2",children:"Catatan & Refleksi"}),e.jsx("p",{className:"text-gray-900 text-sm line-clamp-3",children:R.notes||"Tidak ada catatan"})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xs sm:text-sm font-medium text-gray-700 mb-2",children:"Tanggal Dibuat"}),e.jsx("p",{className:"text-gray-600 text-xs sm:text-sm",children:R.createdAt?E(R.createdAt):"-"})]})]})]})]})},R.id))}):e.jsxs(ge.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},className:"bg-white border-2 border-dashed border-gray-200 rounded-2xl p-8 sm:p-12 text-center",children:[e.jsx("div",{className:"w-12 h-12 sm:w-16 sm:h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(ot,{className:"w-6 h-6 sm:w-8 sm:h-8 text-gray-400"})}),e.jsx("h3",{className:"text-base sm:text-lg font-semibold text-gray-900 mb-2",children:"Tidak ada jurnal yang ditemukan"}),e.jsx("p",{className:"text-gray-500 mb-4 sm:mb-6 text-sm sm:text-base",children:"Coba ubah filter atau buat jurnal baru untuk memulai"}),e.jsxs(V,{onClick:me,className:"bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800 text-white h-10 sm:h-11 text-sm sm:text-base",children:[e.jsx(xs,{className:"w-3 h-3 sm:w-4 sm:h-4 mr-2"}),"Buat Jurnal Pertama"]})]})})]}),n==="templates"&&e.jsxs(ge.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 sm:gap-6",children:[e.jsx(Ve,{children:Ie.map((R,ye)=>e.jsxs(ge.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:ye*.1},className:"bg-white border border-gray-200/50 rounded-2xl shadow-sm p-4 sm:p-6 hover:shadow-lg transition-all duration-300 group",children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"font-semibold text-gray-900 text-sm sm:text-base",children:R.name}),e.jsx("p",{className:"text-xs sm:text-sm text-gray-500 mt-1 line-clamp-2",children:R.description})]}),R.isDefault&&e.jsx(Xs,{className:"bg-blue-100 text-blue-800 border-blue-200 text-xs ml-2 flex-shrink-0",children:"Default"})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 mt-4 sm:opacity-0 sm:group-hover:opacity-100 transition-opacity duration-200",children:[e.jsxs(V,{variant:"outline",size:"sm",className:"flex-1 border-gray-200 hover:bg-blue-50 hover:border-blue-200 hover:text-blue-700 h-8 text-xs",onClick:()=>B(R),children:[e.jsx(Ms,{className:"w-3 h-3 sm:w-4 sm:h-4 mr-1"}),"Lihat"]}),e.jsxs(V,{variant:"outline",size:"sm",className:"flex-1 border-gray-200 hover:bg-green-50 hover:border-green-200 hover:text-green-700 h-8 text-xs",onClick:()=>le(R),children:[e.jsx(xs,{className:"w-3 h-3 sm:w-4 sm:h-4 mr-1"}),"Gunakan"]}),!R.isDefault&&e.jsx(V,{variant:"outline",size:"sm",className:"border-gray-200 hover:bg-red-50 hover:border-red-200 hover:text-red-700 h-8 px-3",onClick:()=>de(R.id),children:e.jsx(hs,{className:"w-3 h-3 sm:w-4 sm:h-4"})})]})]},R.id))}),e.jsxs(ge.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:Ie.length*.1},className:"bg-gray-50/50 border-2 border-dashed border-gray-300 rounded-2xl flex flex-col items-center justify-center p-4 sm:p-6 text-center cursor-pointer hover:bg-gray-100/50 hover:border-gray-400 transition-all duration-200 group",onClick:()=>z(!0),children:[e.jsx("div",{className:"w-10 h-10 sm:w-12 sm:h-12 bg-gray-200 rounded-full flex items-center justify-center mb-3 group-hover:bg-gray-300 transition-colors",children:e.jsx(xs,{className:"w-5 h-5 sm:w-6 sm:h-6 text-gray-500"})}),e.jsx("h3",{className:"font-semibold text-gray-900 text-sm sm:text-base",children:"Buat Template Baru"}),e.jsx("p",{className:"text-xs sm:text-sm text-gray-500 mt-1",children:"Sesuaikan format jurnal sesuai kebutuhan"})]})]}),n==="reports"&&p&&e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4 sm:gap-6",children:[e.jsxs("div",{className:"lg:col-span-2 bg-white rounded-lg border shadow-sm p-4 sm:p-6",children:[e.jsx("h2",{className:"text-base sm:text-lg font-medium mb-4 sm:mb-6",children:"Ringkasan Jurnal Pembelajaran"}),e.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[e.jsxs("div",{className:"p-3 sm:p-4 border rounded-lg",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-2 mb-3 sm:mb-4",children:[e.jsx("h3",{className:"font-medium text-sm sm:text-base",children:"Jurnal Per Kelas"}),e.jsxs(V,{variant:"outline",size:"sm",className:"text-xs sm:text-sm h-8 sm:h-9 px-2 sm:px-3 w-full sm:w-auto",children:[e.jsx(ot,{className:"w-3 h-3 sm:w-4 sm:h-4 mr-2"}),"Ekspor Data"]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b",children:[e.jsx("th",{className:"px-2 sm:px-3 py-2 sm:py-3 text-left text-xs sm:text-sm font-medium text-gray-500",children:"Kelas"}),e.jsx("th",{className:"px-2 sm:px-3 py-2 sm:py-3 text-left text-xs sm:text-sm font-medium text-gray-500",children:"Total"}),e.jsx("th",{className:"px-2 sm:px-3 py-2 sm:py-3 text-left text-xs sm:text-sm font-medium text-gray-500",children:"Lengkap"}),e.jsx("th",{className:"px-2 sm:px-3 py-2 sm:py-3 text-left text-xs sm:text-sm font-medium text-gray-500",children:"Belum"}),e.jsx("th",{className:"px-2 sm:px-3 py-2 sm:py-3 text-left text-xs sm:text-sm font-medium text-gray-500",children:"%"})]})}),e.jsx("tbody",{className:"divide-y",children:p.journalsByClass.length>0?p.journalsByClass.map((R,ye)=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-2 sm:px-3 py-2 sm:py-3 text-xs sm:text-sm font-medium",children:R.className}),e.jsx("td",{className:"px-2 sm:px-3 py-2 sm:py-3 text-xs sm:text-sm",children:R.total}),e.jsx("td",{className:"px-2 sm:px-3 py-2 sm:py-3 text-xs sm:text-sm text-green-600",children:R.completed}),e.jsx("td",{className:"px-2 sm:px-3 py-2 sm:py-3 text-xs sm:text-sm text-yellow-600",children:R.incomplete}),e.jsx("td",{className:"px-2 sm:px-3 py-2 sm:py-3 text-xs sm:text-sm",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-12 sm:w-16 bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-green-500 h-2 rounded-full",style:{width:`${R.total>0?R.completed/R.total*100:0}%`}})}),e.jsxs("span",{className:"text-xs",children:[R.total>0?Math.round(R.completed/R.total*100):0,"%"]})]})})]},ye)):e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"px-2 sm:px-3 py-4 sm:py-6 text-center text-gray-500 text-xs sm:text-sm",children:"Belum ada data jurnal"})})})]})})]}),e.jsxs("div",{className:"p-3 sm:p-4 border rounded-lg",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-2 mb-3 sm:mb-4",children:[e.jsx("h3",{className:"font-medium text-sm sm:text-base",children:"Distribusi Jurnal Per Bulan"}),e.jsxs(V,{variant:"outline",size:"sm",className:"text-xs sm:text-sm h-8 sm:h-9 px-2 sm:px-3 w-full sm:w-auto",children:[e.jsx(pt,{className:"w-3 h-3 sm:w-4 sm:h-4 mr-2"}),"Lihat Detail"]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b",children:[e.jsx("th",{className:"px-2 sm:px-3 py-2 sm:py-3 text-left text-xs sm:text-sm font-medium text-gray-500",children:"Bulan"}),e.jsx("th",{className:"px-2 sm:px-3 py-2 sm:py-3 text-left text-xs sm:text-sm font-medium text-gray-500",children:"Jumlah Jurnal"}),e.jsx("th",{className:"px-2 sm:px-3 py-2 sm:py-3 text-left text-xs sm:text-sm font-medium text-gray-500",children:"Persentase"})]})}),e.jsx("tbody",{className:"divide-y",children:p.journalsByMonth.length>0?p.journalsByMonth.map((R,ye)=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-2 sm:px-3 py-2 sm:py-3 text-xs sm:text-sm font-medium",children:R.month}),e.jsx("td",{className:"px-2 sm:px-3 py-2 sm:py-3 text-xs sm:text-sm",children:R.count}),e.jsxs("td",{className:"px-2 sm:px-3 py-2 sm:py-3 text-xs sm:text-sm",children:[p.totalJournals>0?Math.round(R.count/p.totalJournals*100):0,"%"]})]},ye)):e.jsx("tr",{children:e.jsx("td",{colSpan:3,className:"px-2 sm:px-3 py-4 sm:py-6 text-center text-gray-500 text-xs sm:text-sm",children:"Belum ada data jurnal bulan ini"})})})]})})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg border shadow-sm p-4 sm:p-6",children:[e.jsx("h2",{className:"text-base sm:text-lg font-medium mb-4 sm:mb-6",children:"Statistik Jurnal"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"border rounded-lg p-3 sm:p-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("h3",{className:"text-xs sm:text-sm font-medium",children:"Total Jurnal"}),e.jsx("span",{className:"text-xl sm:text-2xl font-bold text-blue-600",children:p.totalJournals})]}),e.jsxs("div",{className:"flex items-center justify-between text-xs sm:text-sm",children:[e.jsxs("span",{className:"text-gray-500",children:["Tahun ",new Date().getFullYear()]}),e.jsx("span",{className:"text-blue-600",children:"📚 Jurnal aktif"})]})]}),e.jsxs("div",{className:"border rounded-lg p-3 sm:p-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("h3",{className:"text-xs sm:text-sm font-medium",children:"Jurnal Lengkap"}),e.jsxs("span",{className:"text-green-600 font-bold text-lg sm:text-xl",children:[p.completionRate,"%"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 sm:h-3 mb-2",children:e.jsx("div",{className:"bg-green-500 h-2 sm:h-3 rounded-full transition-all duration-300",style:{width:`${p.completionRate}%`}})}),e.jsxs("div",{className:"text-xs text-gray-500",children:[p.completedJournals," dari ",p.totalJournals," jurnal"]})]}),e.jsxs("div",{className:"border rounded-lg p-3 sm:p-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("h3",{className:"text-xs sm:text-sm font-medium",children:"Jurnal Belum Lengkap"}),e.jsxs("span",{className:"text-yellow-600 font-bold text-lg sm:text-xl",children:[p.totalJournals>0?100-p.completionRate:0,"%"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 sm:h-3 mb-2",children:e.jsx("div",{className:"bg-yellow-500 h-2 sm:h-3 rounded-full transition-all duration-300",style:{width:`${p.totalJournals>0?100-p.completionRate:0}%`}})}),e.jsxs("div",{className:"text-xs text-gray-500",children:[p.incompleteJournals," jurnal perlu dilengkapi"]})]}),e.jsxs("div",{className:"border rounded-lg p-3 sm:p-4",children:[e.jsx("h3",{className:"text-xs sm:text-sm font-medium mb-3",children:"Distribusi per Bulan"}),e.jsx("div",{className:"flex items-end h-24 sm:h-32 gap-1 justify-between",children:p.journalsByMonth.length>0?p.journalsByMonth.map((R,ye)=>{const ee=Math.max(...p.journalsByMonth.map(Ce=>Ce.count)),Se=ee>0?R.count/ee*100:0;return e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("div",{className:"bg-blue-500 w-4 sm:w-6 rounded-t transition-all duration-300 hover:bg-blue-600",style:{height:`${Math.max(Se,5)}%`},title:`${R.month}: ${R.count} jurnal`}),e.jsx("span",{className:"text-xs mt-1 text-gray-600",children:R.month})]},ye)}):e.jsx("div",{className:"w-full text-center text-gray-500 text-xs sm:text-sm",children:"Belum ada data"})})]})]})]})]}),n==="reports"&&!p&&e.jsxs("div",{className:"bg-white rounded-lg border shadow-sm p-8 text-center",children:[e.jsx(ot,{className:"w-12 h-12 mx-auto text-gray-400 mb-3"}),e.jsx("h3",{className:"text-lg font-medium",children:"Memuat Data Laporan"}),e.jsx("p",{className:"text-gray-500 mt-1",children:"Sedang menganalisis data jurnal pembelajaran..."})]}),e.jsx(za,{isOpen:w,onClose:()=>L(!1),title:"Buat Jurnal Baru",size:"xl",children:e.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 sm:gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Kelas *"}),e.jsxs("select",{className:"w-full px-3 py-2 h-10 sm:h-11 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent text-sm sm:text-base",value:re.classId,onChange:R=>ve(ye=>({...ye,classId:R.target.value})),children:[e.jsx("option",{value:"",children:"Pilih Kelas"}),m.map(R=>e.jsx("option",{value:R.id,children:R.name},R.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Tanggal *"}),e.jsx("input",{type:"date",className:"w-full px-3 py-2 h-10 sm:h-11 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent text-sm sm:text-base",value:re.date,onChange:R=>ve(ye=>({...ye,date:R.target.value}))})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Topik Pembelajaran *"}),e.jsx("input",{type:"text",className:"w-full px-3 py-2 h-10 sm:h-11 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent text-sm sm:text-base",placeholder:"Masukkan topik pembelajaran",value:re.topic,onChange:R=>ve(ye=>({...ye,topic:R.target.value}))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Aktivitas Pembelajaran *"}),e.jsx("textarea",{className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent text-sm sm:text-base resize-none",rows:6,placeholder:"Deskripsikan aktivitas pembelajaran yang dilakukan",value:re.activities,onChange:R=>ve(ye=>({...ye,activities:R.target.value}))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Catatan & Refleksi"}),e.jsx("textarea",{className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent text-sm sm:text-base resize-none",rows:4,placeholder:"Catatan, refleksi, atau hal-hal penting lainnya",value:re.notes,onChange:R=>ve(ye=>({...ye,notes:R.target.value}))})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 pt-4 border-t border-gray-200",children:[e.jsx(V,{variant:"outline",className:"flex-1 order-2 sm:order-1 h-10 sm:h-11",onClick:()=>L(!1),disabled:t,children:"Batal"}),e.jsxs(V,{className:"flex-1 order-1 sm:order-2 h-10 sm:h-11",onClick:Y,disabled:t,children:[e.jsx(At,{className:"w-3 h-3 sm:w-4 sm:h-4 mr-2"}),t?"Menyimpan...":"Simpan"]})]})]})}),e.jsx(za,{isOpen:O,onClose:()=>I(!1),title:"Edit Jurnal",size:"xl",children:e.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 sm:gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Kelas"}),e.jsx("input",{type:"text",className:"w-full px-3 py-2 h-10 sm:h-11 border border-gray-300 rounded-md bg-gray-50 text-sm sm:text-base",value:G?A(G.classId):"",disabled:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Tanggal"}),e.jsx("input",{type:"date",className:"w-full px-3 py-2 h-10 sm:h-11 border border-gray-300 rounded-md bg-gray-50 text-sm sm:text-base",value:re.date,disabled:!0})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Topik Pembelajaran *"}),e.jsx("input",{type:"text",className:"w-full px-3 py-2 h-10 sm:h-11 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent text-sm sm:text-base",placeholder:"Masukkan topik pembelajaran",value:re.topic,onChange:R=>ve(ye=>({...ye,topic:R.target.value}))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Aktivitas Pembelajaran *"}),e.jsx("textarea",{className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent text-sm sm:text-base resize-none",rows:6,placeholder:"Deskripsikan aktivitas pembelajaran yang dilakukan",value:re.activities,onChange:R=>ve(ye=>({...ye,activities:R.target.value}))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Catatan & Refleksi"}),e.jsx("textarea",{className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent text-sm sm:text-base resize-none",rows:4,placeholder:"Catatan, refleksi, atau hal-hal penting lainnya",value:re.notes,onChange:R=>ve(ye=>({...ye,notes:R.target.value}))})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 pt-4 border-t border-gray-200",children:[e.jsx(V,{variant:"outline",className:"flex-1 order-2 sm:order-1 h-10 sm:h-11",onClick:()=>I(!1),disabled:t,children:"Batal"}),e.jsxs(V,{className:"flex-1 order-1 sm:order-2 h-10 sm:h-11",onClick:ue,disabled:t,children:[e.jsx(At,{className:"w-3 h-3 sm:w-4 sm:h-4 mr-2"}),t?"Menyimpan...":"Simpan Perubahan"]})]})]})}),e.jsx(za,{isOpen:oe,onClose:()=>D(!1),title:"Detail Jurnal",size:"xl",children:G&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-500",children:"Kelas"}),e.jsx("p",{className:"mt-1 text-sm sm:text-base",children:A(G.classId)})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-500",children:"Tanggal"}),e.jsx("p",{className:"mt-1 text-sm sm:text-base",children:E(G.date)})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-500",children:"Topik Pembelajaran"}),e.jsx("p",{className:"mt-1 text-sm sm:text-base",children:G.topic})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-500",children:"Aktivitas Pembelajaran"}),e.jsx("p",{className:"mt-1 whitespace-pre-wrap text-sm sm:text-base",children:G.activities})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-500",children:"Catatan & Refleksi"}),e.jsx("p",{className:"mt-1 whitespace-pre-wrap text-sm sm:text-base",children:G.notes||"-"})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-500",children:"Dibuat Pada"}),e.jsx("p",{className:"mt-1 text-sm sm:text-base",children:G.createdAt?E(G.createdAt):"-"})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 pt-4 border-t border-gray-200",children:[e.jsx(V,{variant:"outline",className:"flex-1 order-2 sm:order-1 h-10 sm:h-11",onClick:()=>D(!1),children:"Tutup"}),e.jsxs(V,{className:"flex-1 order-1 sm:order-2 h-10 sm:h-11",onClick:()=>{D(!1),F(G)},children:[e.jsx(gt,{className:"w-3 h-3 sm:w-4 sm:h-4 mr-2"}),"Edit Jurnal"]})]})]})}),e.jsx(za,{isOpen:H,onClose:()=>ae(!1),title:"Hapus Jurnal",children:G&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3 p-3 sm:p-4 bg-red-50 rounded-lg",children:[e.jsx(Ks,{className:"w-5 h-5 sm:w-6 sm:h-6 text-red-600"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-red-800 text-sm sm:text-base",children:"Konfirmasi Penghapusan"}),e.jsx("p",{className:"text-xs sm:text-sm text-red-600",children:"Tindakan ini tidak dapat dibatalkan"})]})]}),e.jsx("div",{children:e.jsxs("p",{className:"text-gray-700 text-sm sm:text-base",children:["Anda yakin ingin menghapus jurnal dengan topik ",e.jsxs("strong",{children:['"',G.topic,'"']}),"untuk kelas ",e.jsx("strong",{children:A(G.classId)}),"pada tanggal ",e.jsx("strong",{children:E(G.date)}),"?"]})}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 pt-4 border-t border-gray-200",children:[e.jsx(V,{variant:"outline",className:"flex-1 order-2 sm:order-1 h-10 sm:h-11",onClick:()=>ae(!1),disabled:t,children:"Batal"}),e.jsxs(V,{className:"flex-1 bg-red-600 hover:bg-red-700 order-1 sm:order-2 h-10 sm:h-11",onClick:Me,disabled:t,children:[e.jsx(hs,{className:"w-3 h-3 sm:w-4 sm:h-4 mr-2"}),t?"Menghapus...":"Hapus Jurnal"]})]})]})}),e.jsx(za,{isOpen:q,onClose:()=>z(!1),title:"Detail Template",size:"large",children:M&&e.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-500",children:"Nama Template"}),e.jsx("p",{className:"mt-1 font-medium text-sm sm:text-base",children:M.name})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-500",children:"Status"}),e.jsx("div",{className:"mt-1",children:M.isDefault?e.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:"Template Default"}):e.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800",children:"Template Kustom"})})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-500",children:"Deskripsi"}),e.jsx("p",{className:"mt-1 text-sm sm:text-base",children:M.description})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-500",children:"Template Topik"}),e.jsx("div",{className:"mt-1 p-3 bg-gray-50 rounded-md",children:e.jsx("p",{className:"text-sm",children:M.topic})})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-500",children:"Template Aktivitas"}),e.jsx("div",{className:"mt-1 p-3 bg-gray-50 rounded-md",children:e.jsx("pre",{className:"text-sm whitespace-pre-wrap",children:M.activities})})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-500",children:"Template Catatan"}),e.jsx("div",{className:"mt-1 p-3 bg-gray-50 rounded-md",children:e.jsx("p",{className:"text-sm",children:M.notes})})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 pt-4 border-t border-gray-200",children:[e.jsx(V,{variant:"outline",className:"flex-1 order-2 sm:order-1 h-10 sm:h-11",onClick:()=>z(!1),children:"Tutup"}),e.jsxs(V,{className:"flex-1 order-1 sm:order-2 h-10 sm:h-11",onClick:()=>le(M),children:[e.jsx(xs,{className:"w-3 h-3 sm:w-4 sm:h-4 mr-2"}),"Gunakan Template"]})]})]})})]})]}),e.jsx(Pg,{notification:te,onClose:()=>ke(R=>({...R,visible:!1}))})]})},Wa=[{value:"ujian",label:"Ujian",icon:"📝",color:"bg-red-100 text-red-700"},{value:"tugas",label:"Tugas",icon:"📚",color:"bg-blue-100 text-blue-700"},{value:"presentasi",label:"Presentasi",icon:"🎤",color:"bg-purple-100 text-purple-700"},{value:"praktikum",label:"Praktikum",icon:"🔬",color:"bg-green-100 text-green-700"},{value:"karyawisata",label:"Karyawisata",icon:"🚌",color:"bg-yellow-100 text-yellow-700"},{value:"olahraga",label:"Olahraga",icon:"⚽",color:"bg-orange-100 text-orange-700"},{value:"seminar",label:"Seminar",icon:"🎓",color:"bg-indigo-100 text-indigo-700"},{value:"lainnya",label:"Lainnya",icon:"📅",color:"bg-gray-100 text-gray-700"}],Lg=({notification:s,onClose:a})=>{if(!s.visible)return null;const t=()=>{switch(s.type){case"success":return e.jsx(Vs,{className:"w-4 h-4 sm:w-5 sm:h-5"});case"error":return e.jsx(Ks,{className:"w-4 h-4 sm:w-5 sm:h-5"});case"warning":return e.jsx(Ks,{className:"w-4 h-4 sm:w-5 sm:h-5"});case"info":return e.jsx(Ks,{className:"w-4 h-4 sm:w-5 sm:h-5"})}},r=()=>{switch(s.type){case"success":return"bg-green-50 border-green-200 text-green-800";case"error":return"bg-red-50 border-red-200 text-red-800";case"warning":return"bg-yellow-50 border-yellow-200 text-yellow-800";case"info":return"bg-blue-50 border-blue-200 text-blue-800"}};return e.jsx(Ve,{children:e.jsx(ge.div,{initial:{opacity:0,y:-50,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-50,scale:.95},transition:{duration:.2},className:`fixed top-4 left-4 right-4 sm:top-4 sm:right-4 sm:left-auto z-50 p-3 sm:p-4 rounded-lg border shadow-lg max-w-md ${r()}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center min-w-0 flex-1",children:[e.jsx("div",{className:"flex-shrink-0",children:t()}),e.jsx("span",{className:"ml-2 font-medium text-sm sm:text-base truncate",children:s.message})]}),e.jsx("button",{onClick:a,className:"ml-4 text-current opacity-70 hover:opacity-100 transition-opacity flex-shrink-0",children:e.jsx(Ys,{className:"w-4 h-4"})})]})})})},Mg=()=>e.jsx("div",{className:"space-y-4",children:[...Array(3)].map((s,a)=>e.jsx("div",{className:"bg-white rounded-lg border p-4 sm:p-6",children:e.jsxs("div",{className:"animate-pulse",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("div",{className:"h-5 sm:h-6 w-16 sm:w-20 bg-gray-200 rounded-full"}),e.jsx("div",{className:"h-5 sm:h-6 w-12 sm:w-16 bg-gray-200 rounded-full"})]}),e.jsx("div",{className:"h-5 sm:h-6 w-3/4 bg-gray-200 rounded mb-2"}),e.jsx("div",{className:"h-3 sm:h-4 w-full bg-gray-200 rounded mb-3"}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"h-3 sm:h-4 w-24 sm:w-32 bg-gray-200 rounded"}),e.jsx("div",{className:"h-3 sm:h-4 w-20 sm:w-24 bg-gray-200 rounded"})]})]})},a))}),Ir=({isOpen:s,onClose:a,title:t,children:r,size:n="default"})=>{if(!s)return null;const l={default:"max-w-md",large:"max-w-2xl",xl:"max-w-4xl"};return e.jsx(Ve,{children:e.jsx(ge.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",onClick:a,children:e.jsxs(ge.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},transition:{duration:.2},className:`bg-white rounded-xl shadow-2xl ${l[n]} w-full max-h-[90vh] overflow-hidden mx-4`,onClick:i=>i.stopPropagation(),children:[e.jsxs("div",{className:"sticky top-0 bg-white border-b border-gray-200 px-4 sm:px-6 py-3 sm:py-4 flex justify-between items-center",children:[e.jsx("h3",{className:"text-base sm:text-lg font-semibold text-gray-900",children:t}),e.jsx("button",{onClick:a,className:"text-gray-400 hover:text-gray-600 transition-colors p-1 hover:bg-gray-100 rounded-full",children:e.jsx(Ys,{className:"w-4 h-4 sm:w-5 sm:h-5"})})]}),e.jsx("div",{className:"px-4 sm:px-6 py-3 sm:py-4 overflow-y-auto",children:r})]})})})},Bg=()=>{const[s,a]=S.useState(!0),[t,r]=S.useState(!1),[n,l]=S.useState("events"),[i,c]=S.useState(""),[d,o]=S.useState("all"),[m,g]=S.useState("all"),[x,f]=S.useState([]),[p,h]=S.useState([]),[w,L]=S.useState(null),[O,I]=S.useState(!1),[H,ae]=S.useState(!1),[oe,D]=S.useState(!1),[q,z]=S.useState(!1),[G,ce]=S.useState(null),[M,W]=S.useState({classId:"",title:"",description:"",eventDate:new Date().toISOString().split("T")[0],eventType:"lainnya"}),[re,ve]=S.useState({type:"success",message:"",visible:!1});S.useEffect(()=>{ke()},[]);const te=(B,de)=>{ve({type:B,message:de,visible:!0}),setTimeout(()=>{ve(pe=>({...pe,visible:!1}))},5e3)},ke=async()=>{a(!0);try{await Promise.all([xe(),Ie()])}catch(B){console.error("Error fetching initial data:",B),te("error","Gagal memuat data awal")}finally{a(!1)}},xe=async()=>{try{const B=await et.getAll();B.success?f(B.classes||[]):te("error","Gagal memuat daftar kelas")}catch(B){console.error("Error fetching classes:",B),te("error","Gagal memuat daftar kelas")}},Ie=async()=>{try{const B=await yr.getAll();if(B.success){const de=(B.events||[]).map(pe=>({...pe,className:Oe(pe.classId)}));h(de),je(de)}else te("error","Gagal memuat daftar kegiatan")}catch(B){console.error("Error fetching events:",B),te("error","Gagal memuat daftar kegiatan")}},je=B=>{const de=new Date,pe=B.filter(Se=>new Date(Se.eventDate)>=de),E=B.filter(Se=>new Date(Se.eventDate)<de),R=new Map;B.forEach(Se=>{R.set(Se.eventType,(R.get(Se.eventType)||0)+1)});const ye=new Map;B.forEach(Se=>{const Ce=Se.className||"Unknown";ye.set(Ce,(ye.get(Ce)||0)+1)});const ee=new Map;B.forEach(Se=>{const Ce=new Date(Se.eventDate).toLocaleDateString("id-ID",{month:"long",year:"numeric"});ee.set(Ce,(ee.get(Ce)||0)+1)}),L({totalEvents:B.length,upcomingEvents:pe.length,pastEvents:E.length,eventsByType:Array.from(R.entries()).map(([Se,Ce])=>({type:Se,count:Ce})),eventsByClass:Array.from(ye.entries()).map(([Se,Ce])=>({className:Se,count:Ce})),eventsByMonth:Array.from(ee.entries()).map(([Se,Ce])=>({month:Se,count:Ce}))})},Oe=B=>{const de=x.find(pe=>pe.id===B);return de?de.name:"Unknown Class"},N=B=>Wa.find(de=>de.value===B)||Wa.find(de=>de.value==="lainnya"),P=()=>{W({classId:"",title:"",description:"",eventDate:new Date().toISOString().split("T")[0],eventType:"lainnya"})},T=()=>{P(),I(!0)},A=B=>{W({classId:B.classId,title:B.title,description:B.description,eventDate:B.eventDate,eventType:B.eventType}),ce(B),ae(!0)},X=B=>{ce(B),z(!0)},me=B=>{ce(B),D(!0)},F=async()=>{if(!M.title||!M.classId||!M.eventDate){te("error","Harap isi semua field yang wajib!");return}r(!0);try{const B=await yr.create(M.classId,M.title,M.description,M.eventDate,M.eventType);B.success?(te("success","Kegiatan berhasil dibuat!"),I(!1),P(),Ie()):te("error",B.error||"Gagal membuat kegiatan")}catch{te("error","Terjadi kesalahan saat membuat kegiatan")}finally{r(!1)}},J=async()=>{if(!G||!M.title||!M.classId||!M.eventDate){te("error","Harap isi semua field yang wajib!");return}r(!0);try{const B=await yr.update(G.id,M.title,M.description,M.eventDate,M.eventType);B.success?(te("success","Kegiatan berhasil diperbarui!"),ae(!1),ce(null),P(),Ie()):te("error",B.error||"Gagal memperbarui kegiatan")}catch{te("error","Terjadi kesalahan saat memperbarui kegiatan")}finally{r(!1)}},U=async()=>{if(G){r(!0);try{const B=await yr.delete(G.id);B.success?(te("success","Kegiatan berhasil dihapus!"),D(!1),ce(null),Ie()):te("error",B.error||"Gagal menghapus kegiatan")}catch{te("error","Terjadi kesalahan saat menghapus kegiatan")}finally{r(!1)}}},Y=B=>new Date(B).toLocaleDateString("id-ID",{weekday:"long",year:"numeric",month:"long",day:"numeric"}),ue=B=>new Date(B).toLocaleDateString("id-ID",{year:"numeric",month:"short",day:"numeric"}),Me=B=>new Date(B)>=new Date,le=p.filter(B=>{const de=B.title.toLowerCase().includes(i.toLowerCase())||B.description.toLowerCase().includes(i.toLowerCase())||(B.className||"").toLowerCase().includes(i.toLowerCase()),pe=d==="all"||d==="upcoming"&&Me(B.eventDate)||d==="past"&&!Me(B.eventDate)||B.classId===d,E=m==="all"||B.eventType===m;return de&&pe&&E});return s?e.jsx("div",{className:"min-h-screen bg-gray-50/50",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4 sm:py-8",children:[e.jsxs("div",{className:"mb-6 sm:mb-8",children:[e.jsx("div",{className:"h-6 sm:h-8 w-32 sm:w-48 bg-gray-200 rounded animate-pulse mb-2"}),e.jsx("div",{className:"h-3 sm:h-4 w-48 sm:w-64 bg-gray-200 rounded animate-pulse"})]}),e.jsx(Mg,{})]})}):e.jsx("div",{className:"min-h-screen bg-gray-50/50",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4 sm:py-8",children:[e.jsx(Lg,{notification:re,onClose:()=>ve(B=>({...B,visible:!1}))}),e.jsxs(ge.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"flex flex-col sm:flex-row sm:items-center justify-between mb-6 sm:mb-8 gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold bg-gradient-to-r from-gray-900 to-gray-600 bg-clip-text text-transparent",children:"Kegiatan"}),e.jsx("p",{className:"text-gray-600 mt-1 text-sm sm:text-base",children:"Kelola jadwal dan kegiatan kelas"})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-center gap-3",children:[e.jsxs(V,{variant:"outline",onClick:Ie,className:"border-gray-300 hover:bg-gray-50 h-10 sm:h-11 text-sm sm:text-base",children:[e.jsx(ct,{className:"w-3 h-3 sm:w-4 sm:h-4 mr-2"}),"Refresh"]}),e.jsxs(V,{onClick:T,className:"bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800 text-white shadow-lg h-10 sm:h-11 text-sm sm:text-base",children:[e.jsx(xs,{className:"w-3 h-3 sm:w-4 sm:h-4 mr-2"}),"Tambah Kegiatan"]})]})]}),e.jsxs(ge.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"bg-white rounded-xl border border-gray-200 p-1 mb-4 sm:mb-6 inline-flex overflow-x-auto",children:[e.jsxs("button",{onClick:()=>l("events"),className:`flex items-center px-4 sm:px-6 py-2 sm:py-3 text-xs sm:text-sm font-medium rounded-lg transition-all duration-200 whitespace-nowrap ${n==="events"?"bg-blue-50 text-blue-700 shadow-sm border border-blue-200":"text-gray-600 hover:text-gray-900 hover:bg-gray-50"}`,children:[e.jsx(pt,{className:"w-3 h-3 sm:w-4 sm:h-4 mr-2"}),"Daftar Kegiatan"]}),e.jsxs("button",{onClick:()=>l("reports"),className:`flex items-center px-4 sm:px-6 py-2 sm:py-3 text-xs sm:text-sm font-medium rounded-lg transition-all duration-200 whitespace-nowrap ${n==="reports"?"bg-blue-50 text-blue-700 shadow-sm border border-blue-200":"text-gray-600 hover:text-gray-900 hover:bg-gray-50"}`,children:[e.jsx(ra,{className:"w-3 h-3 sm:w-4 sm:h-4 mr-2"}),"Laporan"]})]}),n==="events"&&e.jsxs(ge.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"space-y-6",children:[e.jsx("div",{className:"bg-white rounded-xl border border-gray-200 shadow-sm p-4 sm:p-6",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 sm:gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"relative",children:[e.jsx(Zt,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),e.jsx(He,{placeholder:"Cari kegiatan...",value:i,onChange:B=>c(B.target.value),className:"pl-10 h-10 sm:h-11 border-gray-300 focus:border-blue-500 focus:ring-blue-500 text-sm sm:text-base"})]})}),e.jsxs("div",{className:"flex flex-wrap gap-2 sm:gap-3",children:[e.jsxs("select",{value:d,onChange:B=>o(B.target.value),className:"px-3 sm:px-4 py-2 border border-gray-300 rounded-lg text-xs sm:text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white hover:bg-gray-50 transition-colors flex-1 sm:flex-none min-w-0",children:[e.jsx("option",{value:"all",children:"Semua Waktu"}),e.jsx("option",{value:"upcoming",children:"Mendatang"}),e.jsx("option",{value:"past",children:"Sudah Lewat"}),x.map(B=>e.jsx("option",{value:B.id,children:B.name},B.id))]}),e.jsxs("select",{value:m,onChange:B=>g(B.target.value),className:"px-3 sm:px-4 py-2 border border-gray-300 rounded-lg text-xs sm:text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white hover:bg-gray-50 transition-colors flex-1 sm:flex-none min-w-0",children:[e.jsx("option",{value:"all",children:"Semua Jenis"}),Wa.map(B=>e.jsx("option",{value:B.value,children:B.label},B.value))]})]})]})}),e.jsx("div",{className:"space-y-4",children:le.length===0?e.jsxs(ge.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},className:"bg-white rounded-xl border border-gray-200 shadow-sm p-8 sm:p-12 text-center",children:[e.jsx(pt,{className:"w-12 h-12 sm:w-16 sm:h-16 text-gray-300 mx-auto mb-4"}),e.jsx("h3",{className:"text-base sm:text-lg font-semibold text-gray-900 mb-2",children:"Belum ada kegiatan"}),e.jsx("p",{className:"text-gray-500 mb-4 sm:mb-6 max-w-md mx-auto text-sm sm:text-base",children:i||d!=="all"||m!=="all"?"Tidak ada kegiatan yang sesuai dengan filter yang dipilih":"Mulai dengan membuat kegiatan pertama Anda"}),!i&&d==="all"&&m==="all"&&e.jsxs(V,{onClick:T,className:"bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800 text-white h-10 sm:h-11 text-sm sm:text-base",children:[e.jsx(xs,{className:"w-3 h-3 sm:w-4 sm:h-4 mr-2"}),"Tambah Kegiatan"]})]}):e.jsx(ge.div,{className:"grid gap-4",variants:{hidden:{opacity:0},show:{opacity:1,transition:{staggerChildren:.1}}},initial:"hidden",animate:"show",children:le.map(B=>{const de=N(B.eventType),pe=Me(B.eventDate);return e.jsx(ge.div,{variants:{hidden:{opacity:0,y:20},show:{opacity:1,y:0}},className:"group bg-white rounded-xl border border-gray-200 shadow-sm hover:shadow-md transition-all duration-200 overflow-hidden",children:e.jsx("div",{className:"p-4 sm:p-6",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-start justify-between gap-4",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2 mb-3",children:[e.jsxs("span",{className:`inline-flex items-center px-2.5 py-1 rounded-full text-xs font-medium ${de.color}`,children:[de.icon," ",de.label]}),e.jsx("span",{className:`inline-flex items-center px-2.5 py-1 rounded-full text-xs font-medium ${pe?"bg-green-100 text-green-700":"bg-gray-100 text-gray-700"}`,children:pe?"🔮 Mendatang":"⏰ Sudah Lewat"})]}),e.jsx("h3",{className:"text-lg sm:text-xl font-semibold text-gray-900 mb-2 group-hover:text-blue-600 transition-colors line-clamp-2",children:B.title}),e.jsx("p",{className:"text-gray-600 mb-3 sm:mb-4 line-clamp-2 text-sm sm:text-base",children:B.description}),e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-3 sm:gap-6 text-xs sm:text-sm text-gray-500",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(il,{className:"w-3 h-3 sm:w-4 sm:h-4 mr-2 flex-shrink-0"}),e.jsx("span",{className:"truncate",children:Y(B.eventDate)})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(_s,{className:"w-3 h-3 sm:w-4 sm:h-4 mr-2 flex-shrink-0"}),e.jsx("span",{className:"truncate",children:B.className})]})]})]}),e.jsxs("div",{className:"flex items-center gap-1 sm:gap-2 sm:opacity-0 sm:group-hover:opacity-100 transition-opacity flex-shrink-0",children:[e.jsx(V,{variant:"outline",size:"sm",onClick:()=>X(B),className:"text-blue-600 border-blue-200 hover:bg-blue-50 h-8 sm:h-9 px-2 sm:px-3",children:e.jsx(Ms,{className:"w-3 h-3 sm:w-4 sm:h-4"})}),e.jsx(V,{variant:"outline",size:"sm",onClick:()=>A(B),className:"text-green-600 border-green-200 hover:bg-green-50 h-8 sm:h-9 px-2 sm:px-3",children:e.jsx(gt,{className:"w-3 h-3 sm:w-4 sm:h-4"})}),e.jsx(V,{variant:"outline",size:"sm",onClick:()=>me(B),className:"text-red-600 border-red-200 hover:bg-red-50 h-8 sm:h-9 px-2 sm:px-3",children:e.jsx(hs,{className:"w-3 h-3 sm:w-4 sm:h-4"})})]})]})})},B.id)})})})]}),n==="reports"&&w&&e.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[e.jsxs("div",{className:"grid gap-4 sm:gap-6 grid-cols-1 sm:grid-cols-3",children:[e.jsx("div",{className:"bg-white p-4 sm:p-6 rounded-lg border",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs sm:text-sm font-medium text-gray-600",children:"Total Kegiatan"}),e.jsx("p",{className:"text-2xl sm:text-3xl font-bold text-gray-900",children:w.totalEvents})]}),e.jsx("div",{className:"bg-blue-100 p-2 sm:p-3 rounded-lg",children:e.jsx(pt,{className:"w-5 h-5 sm:w-6 sm:h-6 text-blue-600"})})]})}),e.jsx("div",{className:"bg-white p-4 sm:p-6 rounded-lg border",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs sm:text-sm font-medium text-gray-600",children:"Kegiatan Mendatang"}),e.jsx("p",{className:"text-2xl sm:text-3xl font-bold text-green-600",children:w.upcomingEvents})]}),e.jsx("div",{className:"bg-green-100 p-2 sm:p-3 rounded-lg",children:e.jsx(ft,{className:"w-5 h-5 sm:w-6 sm:h-6 text-green-600"})})]})}),e.jsx("div",{className:"bg-white p-4 sm:p-6 rounded-lg border",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs sm:text-sm font-medium text-gray-600",children:"Kegiatan Selesai"}),e.jsx("p",{className:"text-2xl sm:text-3xl font-bold text-purple-600",children:w.pastEvents})]}),e.jsx("div",{className:"bg-purple-100 p-2 sm:p-3 rounded-lg",children:e.jsx(Vs,{className:"w-5 h-5 sm:w-6 sm:h-6 text-purple-600"})})]})})]}),e.jsxs("div",{className:"grid gap-4 sm:gap-6 grid-cols-1 lg:grid-cols-2",children:[e.jsxs("div",{className:"bg-white p-4 sm:p-6 rounded-lg border",children:[e.jsx("h3",{className:"text-base sm:text-lg font-semibold mb-3 sm:mb-4",children:"Kegiatan per Jenis"}),e.jsx("div",{className:"space-y-3",children:w.eventsByType.map(({type:B,count:de})=>{const pe=N(B),E=Math.round(de/w.totalEvents*100);return e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"flex items-center min-w-0 flex-1",children:e.jsxs("span",{className:`inline-flex items-center px-2 sm:px-2.5 py-0.5 rounded-full text-xs font-medium ${pe.color} mr-3 flex-shrink-0`,children:[pe.icon," ",pe.label]})}),e.jsxs("div",{className:"flex items-center flex-shrink-0",children:[e.jsx("div",{className:"w-16 sm:w-24 bg-gray-200 rounded-full h-2 mr-2 sm:mr-3",children:e.jsx("div",{className:"bg-blue-600 h-2 rounded-full",style:{width:`${E}%`}})}),e.jsx("span",{className:"text-xs sm:text-sm font-medium text-gray-900 w-6 sm:w-8",children:de})]})]},B)})})]}),e.jsxs("div",{className:"bg-white p-4 sm:p-6 rounded-lg border",children:[e.jsx("h3",{className:"text-base sm:text-lg font-semibold mb-3 sm:mb-4",children:"Kegiatan per Kelas"}),e.jsx("div",{className:"space-y-3",children:w.eventsByClass.map(({className:B,count:de})=>{const pe=Math.round(de/w.totalEvents*100);return e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"flex items-center min-w-0 flex-1",children:e.jsx("span",{className:"text-xs sm:text-sm font-medium text-gray-700 truncate",children:B})}),e.jsxs("div",{className:"flex items-center flex-shrink-0",children:[e.jsx("div",{className:"w-16 sm:w-24 bg-gray-200 rounded-full h-2 mr-2 sm:mr-3",children:e.jsx("div",{className:"bg-green-600 h-2 rounded-full",style:{width:`${pe}%`}})}),e.jsx("span",{className:"text-xs sm:text-sm font-medium text-gray-900 w-6 sm:w-8",children:de})]})]},B)})})]})]}),e.jsxs("div",{className:"bg-white p-4 sm:p-6 rounded-lg border",children:[e.jsx("h3",{className:"text-base sm:text-lg font-semibold mb-3 sm:mb-4",children:"Kegiatan per Bulan"}),e.jsx("div",{className:"grid gap-2 sm:gap-3 grid-cols-1 sm:grid-cols-2 lg:grid-cols-3",children:w.eventsByMonth.map(({month:B,count:de})=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsx("span",{className:"text-xs sm:text-sm font-medium text-gray-700 truncate",children:B}),e.jsx("span",{className:"text-xs sm:text-sm font-bold text-gray-900 flex-shrink-0 ml-2",children:de})]},B))})]})]}),e.jsx(Ir,{isOpen:O,onClose:()=>I(!1),title:"Tambah Kegiatan Baru",children:e.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Kelas ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{value:M.classId,onChange:B=>W({...M,classId:B.target.value}),className:"w-full px-3 py-2 h-10 sm:h-11 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm sm:text-base",required:!0,children:[e.jsx("option",{value:"",children:"Pilih Kelas"}),x.map(B=>e.jsx("option",{value:B.id,children:B.name},B.id))]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Judul Kegiatan ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(He,{type:"text",value:M.title,onChange:B=>W({...M,title:B.target.value}),placeholder:"Masukkan judul kegiatan",className:"h-10 sm:h-11 text-sm sm:text-base",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Jenis Kegiatan"}),e.jsx("select",{value:M.eventType,onChange:B=>W({...M,eventType:B.target.value}),className:"w-full px-3 py-2 h-10 sm:h-11 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm sm:text-base",children:Wa.map(B=>e.jsxs("option",{value:B.value,children:[B.icon," ",B.label]},B.value))})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Tanggal Kegiatan ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(He,{type:"date",value:M.eventDate,onChange:B=>W({...M,eventDate:B.target.value}),className:"h-10 sm:h-11 text-sm sm:text-base",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Deskripsi"}),e.jsx("textarea",{value:M.description,onChange:B=>W({...M,description:B.target.value}),placeholder:"Masukkan deskripsi kegiatan",rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm sm:text-base resize-none"})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row justify-end gap-3 pt-4 border-t border-gray-200",children:[e.jsx(V,{variant:"outline",onClick:()=>I(!1),className:"w-full sm:w-auto order-2 sm:order-1",children:"Batal"}),e.jsx(V,{onClick:F,disabled:t,className:"bg-blue-600 hover:bg-blue-700 text-white w-full sm:w-auto order-1 sm:order-2 h-10 sm:h-11",children:t?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Menyimpan..."]}):e.jsxs(e.Fragment,{children:[e.jsx(At,{className:"w-3 h-3 sm:w-4 sm:h-4 mr-2"}),"Simpan"]})})]})]})}),e.jsx(Ir,{isOpen:H,onClose:()=>ae(!1),title:"Edit Kegiatan",children:e.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Kelas ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{value:M.classId,onChange:B=>W({...M,classId:B.target.value}),className:"w-full px-3 py-2 h-10 sm:h-11 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm sm:text-base",required:!0,children:[e.jsx("option",{value:"",children:"Pilih Kelas"}),x.map(B=>e.jsx("option",{value:B.id,children:B.name},B.id))]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Judul Kegiatan ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(He,{type:"text",value:M.title,onChange:B=>W({...M,title:B.target.value}),placeholder:"Masukkan judul kegiatan",className:"h-10 sm:h-11 text-sm sm:text-base",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Jenis Kegiatan"}),e.jsx("select",{value:M.eventType,onChange:B=>W({...M,eventType:B.target.value}),className:"w-full px-3 py-2 h-10 sm:h-11 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm sm:text-base",children:Wa.map(B=>e.jsxs("option",{value:B.value,children:[B.icon," ",B.label]},B.value))})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Tanggal Kegiatan ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(He,{type:"date",value:M.eventDate,onChange:B=>W({...M,eventDate:B.target.value}),className:"h-10 sm:h-11 text-sm sm:text-base",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Deskripsi"}),e.jsx("textarea",{value:M.description,onChange:B=>W({...M,description:B.target.value}),placeholder:"Masukkan deskripsi kegiatan",rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm sm:text-base resize-none"})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row justify-end gap-3 pt-4 border-t border-gray-200",children:[e.jsx(V,{variant:"outline",onClick:()=>ae(!1),className:"w-full sm:w-auto order-2 sm:order-1",children:"Batal"}),e.jsx(V,{onClick:J,disabled:t,className:"bg-blue-600 hover:bg-blue-700 text-white w-full sm:w-auto order-1 sm:order-2 h-10 sm:h-11",children:t?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Menyimpan..."]}):e.jsxs(e.Fragment,{children:[e.jsx(At,{className:"w-3 h-3 sm:w-4 sm:h-4 mr-2"}),"Simpan Perubahan"]})})]})]})}),e.jsx(Ir,{isOpen:q,onClose:()=>z(!1),title:"Detail Kegiatan",children:G&&e.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[e.jsxs("div",{className:"grid gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-500 mb-2",children:"Judul"}),e.jsx("p",{className:"text-base sm:text-lg font-semibold text-gray-900",children:G.title})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-500 mb-2",children:"Kelas"}),e.jsx("p",{className:"font-medium text-gray-900",children:G.className})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-500 mb-2",children:"Jenis"}),e.jsx("div",{className:"flex items-center",children:(()=>{const B=N(G.eventType);return e.jsxs("span",{className:`inline-flex items-center px-2.5 py-1 rounded-full text-xs font-medium ${B.color}`,children:[B.icon," ",B.label]})})()})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-500 mb-2",children:"Tanggal"}),e.jsx("p",{className:"font-medium text-gray-900",children:Y(G.eventDate)}),e.jsx("p",{className:"text-xs sm:text-sm text-gray-500 mt-1",children:Me(G.eventDate)?"🔮 Mendatang":"⏰ Sudah Lewat"})]}),G.description&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-500 mb-2",children:"Deskripsi"}),e.jsx("p",{className:"text-gray-700 whitespace-pre-wrap text-sm sm:text-base",children:G.description})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-500 mb-2",children:"Dibuat"}),e.jsx("p",{className:"text-xs sm:text-sm text-gray-600",children:ue(G.createdAt)})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row justify-end gap-3 pt-4 border-t border-gray-200",children:[e.jsx(V,{variant:"outline",onClick:()=>z(!1),className:"w-full sm:w-auto order-2 sm:order-1",children:"Tutup"}),e.jsxs(V,{onClick:()=>{z(!1),A(G)},className:"bg-blue-600 hover:bg-blue-700 text-white w-full sm:w-auto order-1 sm:order-2 h-10 sm:h-11",children:[e.jsx(gt,{className:"w-3 h-3 sm:w-4 sm:h-4 mr-2"}),"Edit"]})]})]})}),e.jsx(Ir,{isOpen:oe,onClose:()=>D(!1),title:"Konfirmasi Hapus",children:G&&e.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[e.jsxs("div",{className:"flex items-center text-amber-600 mb-4",children:[e.jsx(Ks,{className:"w-5 h-5 sm:w-6 sm:h-6 mr-2"}),e.jsx("span",{className:"font-medium text-sm sm:text-base",children:"Peringatan!"})]}),e.jsxs("p",{className:"text-gray-700 text-sm sm:text-base",children:["Apakah Anda yakin ingin menghapus kegiatan ",e.jsxs("strong",{children:['"',G.title,'"']}),"?"]}),e.jsx("p",{className:"text-xs sm:text-sm text-gray-500",children:"Tindakan ini tidak dapat dibatalkan."}),e.jsxs("div",{className:"flex flex-col sm:flex-row justify-end gap-3 pt-4 border-t border-gray-200",children:[e.jsx(V,{variant:"outline",onClick:()=>D(!1),className:"w-full sm:w-auto order-2 sm:order-1",children:"Batal"}),e.jsx(V,{onClick:U,disabled:t,className:"bg-red-600 hover:bg-red-700 text-white w-full sm:w-auto order-1 sm:order-2 h-10 sm:h-11",children:t?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Menghapus..."]}):e.jsxs(e.Fragment,{children:[e.jsx(hs,{className:"w-3 h-3 sm:w-4 sm:h-4 mr-2"}),"Hapus"]})})]})]})})]})})},Ug=({notification:s,onClose:a})=>{if(!s.visible)return null;const t=()=>{switch(s.type){case"success":return e.jsx(Vs,{className:"w-4 h-4 sm:w-5 sm:h-5"});case"error":return e.jsx(Ks,{className:"w-4 h-4 sm:w-5 sm:h-5"});case"warning":return e.jsx(Ks,{className:"w-4 h-4 sm:w-5 sm:h-5"});case"info":return e.jsx(Ks,{className:"w-4 h-4 sm:w-5 sm:h-5"})}},r=()=>{switch(s.type){case"success":return"bg-green-50 border-green-200 text-green-800";case"error":return"bg-red-50 border-red-200 text-red-800";case"warning":return"bg-yellow-50 border-yellow-200 text-yellow-800";case"info":return"bg-blue-50 border-blue-200 text-blue-800"}};return e.jsx(Ve,{children:e.jsx(ge.div,{initial:{opacity:0,y:-50,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-50,scale:.95},transition:{duration:.2},className:`fixed top-4 left-4 right-4 sm:top-4 sm:right-4 sm:left-auto z-50 p-3 sm:p-4 rounded-lg border shadow-lg max-w-md sm:max-w-md ${r()}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center min-w-0 flex-1",children:[e.jsx("div",{className:"flex-shrink-0",children:t()}),e.jsx("span",{className:"ml-2 font-medium text-sm sm:text-base truncate",children:s.message})]}),e.jsx("button",{onClick:a,className:"ml-4 text-current opacity-70 hover:opacity-100 transition-opacity flex-shrink-0",children:e.jsx(Ys,{className:"w-4 h-4"})})]})})})},Gg=()=>e.jsx("div",{className:"space-y-4",children:[...Array(5)].map((s,a)=>e.jsx("div",{className:"bg-white rounded-lg border p-6",children:e.jsxs("div",{className:"animate-pulse",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("div",{className:"h-6 w-20 bg-gray-200 rounded-full"}),e.jsx("div",{className:"h-6 w-16 bg-gray-200 rounded-full"}),e.jsx("div",{className:"h-6 w-24 bg-gray-200 rounded-full"})]}),e.jsx("div",{className:"h-6 w-3/4 bg-gray-200 rounded mb-2"}),e.jsx("div",{className:"h-4 w-full bg-gray-200 rounded mb-3"}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"h-4 w-32 bg-gray-200 rounded"}),e.jsx("div",{className:"h-4 w-24 bg-gray-200 rounded"})]})]})},a))}),Pr=({isOpen:s,onClose:a,title:t,children:r,size:n="default"})=>{if(!s)return null;const l={default:"max-w-md",large:"max-w-2xl",xl:"max-w-4xl"};return e.jsx(Ve,{children:e.jsx(ge.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",onClick:a,children:e.jsxs(ge.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},transition:{duration:.2},className:`bg-white rounded-xl shadow-2xl ${l[n]} w-full max-h-[90vh] overflow-hidden mx-4`,onClick:i=>i.stopPropagation(),children:[e.jsxs("div",{className:"sticky top-0 bg-white border-b border-gray-200 px-4 sm:px-6 py-3 sm:py-4 flex justify-between items-center",children:[e.jsx("h3",{className:"text-base sm:text-lg font-semibold text-gray-900",children:t}),e.jsx("button",{onClick:a,className:"text-gray-400 hover:text-gray-600 transition-colors p-1 hover:bg-gray-100 rounded-full",children:e.jsx(Ys,{className:"w-4 h-4 sm:w-5 sm:h-5"})})]}),e.jsx("div",{className:"px-4 sm:px-6 py-3 sm:py-4 overflow-y-auto",children:r})]})})})},Hg=()=>{const[s,a]=S.useState(!0),[t,r]=S.useState(!1),[n,l]=S.useState("questions"),[i,c]=S.useState(""),[d,o]=S.useState("list"),[m,g]=S.useState("all"),[x,f]=S.useState("all"),[p,h]=S.useState("all"),[w,L]=S.useState(!1),[O,I]=S.useState(!1),[H,ae]=S.useState(!1),[oe,D]=S.useState(!1),[q,z]=S.useState([]),[G,ce]=S.useState([]),[M,W]=S.useState(null),[re,ve]=S.useState(null),[te,ke]=S.useState({classId:"",category:"",questionText:"",options:["","","",""],correctAnswer:"",difficulty:"medium"}),[xe,Ie]=S.useState({type:"success",message:"",visible:!1});S.useEffect(()=>{Oe()},[]);const je=(E,R)=>{Ie({type:E,message:R,visible:!0}),setTimeout(()=>{Ie(ye=>({...ye,visible:!1}))},5e3)},Oe=async()=>{a(!0);try{await Promise.all([N(),P()])}catch(E){console.error("Error fetching initial data:",E),je("error","Gagal memuat data awal")}finally{a(!1)}},N=async()=>{try{const E=await et.getAll();E.success?ce(E.classes||[]):je("error","Gagal memuat daftar kelas")}catch(E){console.error("Error fetching classes:",E),je("error","Gagal memuat daftar kelas")}},P=async()=>{try{const E=await Nr.getAll();if(E.success){const R=(E.questions||[]).map(ye=>({...ye,className:A(ye.classId),options:Array.isArray(ye.options)?ye.options:typeof ye.options=="string"?ye.options.split(","):[]}));z(R),T(R)}else je("error","Gagal memuat daftar soal")}catch(E){console.error("Error fetching questions:",E),je("error","Gagal memuat daftar soal")}},T=E=>{const R=new Map;E.forEach(Se=>{R.set(Se.difficulty,(R.get(Se.difficulty)||0)+1)});const ye=new Map;E.forEach(Se=>{const Ce=Se.className||"Unknown";ye.set(Ce,(ye.get(Ce)||0)+1)});const ee=new Map;E.forEach(Se=>{ee.set(Se.category,(ee.get(Se.category)||0)+1)}),ve({totalQuestions:E.length,questionsByDifficulty:Array.from(R.entries()).map(([Se,Ce])=>({difficulty:Se,count:Ce})),questionsByClass:Array.from(ye.entries()).map(([Se,Ce])=>({className:Se,count:Ce})),questionsByCategory:Array.from(ee.entries()).map(([Se,Ce])=>({category:Se,count:Ce}))})},A=E=>{const R=G.find(ye=>ye.id===E);return R?R.name:"Unknown Class"},X=()=>{ke({classId:"",category:"",questionText:"",options:["","","",""],correctAnswer:"",difficulty:"medium"})},me=()=>{X(),L(!0)},F=E=>{W(E),ke({classId:E.classId,category:E.category,questionText:E.questionText,options:Array.isArray(E.options)?E.options:typeof E.options=="string"?E.options.split(","):["","","",""],correctAnswer:E.correctAnswer,difficulty:E.difficulty}),I(!0)},J=E=>{W(E),ae(!0)},U=E=>{W(E),D(!0)},Y=async()=>{if(!te.questionText||!te.classId||!te.category||!te.correctAnswer){je("error","Harap isi semua field yang wajib!");return}r(!0);try{const E=await Nr.create(te.classId,te.category,te.questionText,te.options,te.correctAnswer,te.difficulty);E.success?(je("success","Soal berhasil dibuat!"),L(!1),X(),P()):je("error",E.error||"Gagal membuat soal")}catch{je("error","Terjadi kesalahan saat membuat soal")}finally{r(!1)}},ue=async()=>{if(!M||!te.questionText||!te.classId||!te.category||!te.correctAnswer){je("error","Harap isi semua field yang wajib!");return}r(!0);try{const E=await Nr.update(M.id,te.category,te.questionText,te.options,te.correctAnswer,te.difficulty);E.success?(je("success","Soal berhasil diperbarui!"),I(!1),W(null),X(),P()):je("error",E.error||"Gagal memperbarui soal")}catch{je("error","Terjadi kesalahan saat memperbarui soal")}finally{r(!1)}},Me=async()=>{if(M){r(!0);try{const E=await Nr.delete(M.id);E.success?(je("success","Soal berhasil dihapus!"),D(!1),W(null),P()):je("error",E.error||"Gagal menghapus soal")}catch{je("error","Terjadi kesalahan saat menghapus soal")}finally{r(!1)}}},le=E=>{switch(E){case"easy":return e.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:"Mudah"});case"medium":return e.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800",children:"Sedang"});case"hard":return e.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800",children:"Sulit"});default:return e.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800",children:E})}},B=E=>E&&E.some(ye=>ye.trim()!=="")?e.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:"Pilihan Ganda"}):e.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-purple-100 text-purple-800",children:"Esai"}),de=E=>new Date(E).toLocaleDateString("id-ID",{year:"numeric",month:"short",day:"numeric"}),pe=q.filter(E=>{const R=E.questionText.toLowerCase().includes(i.toLowerCase())||(E.className||"").toLowerCase().includes(i.toLowerCase())||E.category.toLowerCase().includes(i.toLowerCase())||E.options.some(Ce=>Ce.toLowerCase().includes(i.toLowerCase())),ye=m==="all"||E.category===m,ee=x==="all"||E.difficulty===x,Se=p==="all"||E.classId===p;return R&&ye&&ee&&Se});return s?e.jsx("div",{className:"min-h-screen bg-gray-50/50",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4 sm:py-8",children:[e.jsxs("div",{className:"mb-6 sm:mb-8",children:[e.jsx("div",{className:"h-6 sm:h-8 w-32 sm:w-48 bg-gray-200 rounded animate-pulse mb-2"}),e.jsx("div",{className:"h-3 sm:h-4 w-48 sm:w-64 bg-gray-200 rounded animate-pulse"})]}),e.jsx(Gg,{})]})}):e.jsxs("div",{className:"min-h-screen bg-gray-50/50",children:[e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4 sm:py-8",children:[xe.visible&&e.jsx(Ug,{notification:xe,onClose:()=>Ie(E=>({...E,visible:!1}))}),e.jsx("div",{className:"mb-6 sm:mb-8",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent",children:"Bank Soal"}),e.jsx("p",{className:"text-gray-600 text-sm sm:text-base",children:"Kelola soal-soal dan bank pertanyaan untuk berbagai mata pelajaran"})]}),e.jsx(ge.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{duration:.2},className:"w-full sm:w-auto",children:e.jsxs(V,{onClick:me,className:"bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800 text-white shadow-lg hover:shadow-xl transition-all duration-200 border-0 w-full sm:w-auto h-10 sm:h-11 text-sm sm:text-base",children:[e.jsx(xs,{className:"w-3 h-3 sm:w-4 sm:h-4 mr-2"}),"Tambah Soal Baru"]})})]})}),e.jsx("div",{className:"bg-white rounded-lg border border-gray-200 shadow-sm mb-4 sm:mb-6",children:e.jsx("nav",{className:"flex overflow-x-auto border-b border-gray-200",children:[{id:"questions",label:"Daftar Soal",icon:ys},{id:"categories",label:"Kategori",icon:ot},{id:"reports",label:"Laporan",icon:ra}].map(E=>e.jsxs(ge.button,{whileHover:{y:-1},whileTap:{scale:.98},onClick:()=>l(E.id),className:`flex items-center gap-2 px-4 sm:px-6 py-3 sm:py-4 text-xs sm:text-sm font-medium border-b-2 transition-all duration-200 whitespace-nowrap ${n===E.id?"border-blue-500 text-blue-600 bg-blue-50/50":"border-transparent text-gray-500 hover:text-gray-700 hover:bg-gray-50/50"}`,children:[e.jsx(E.icon,{className:"w-3 h-3 sm:w-4 sm:h-4"}),E.label]},E.id))})}),n==="questions"&&e.jsxs(ge.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},className:"space-y-6",children:[e.jsx("div",{className:"bg-white rounded-lg border border-gray-200 shadow-sm p-4 sm:p-6",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 sm:gap-4",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(Zt,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4 sm:w-5 sm:h-5"}),e.jsx(He,{placeholder:"Cari soal berdasarkan teks, kategori, atau kelas...",className:"pl-9 sm:pl-10 h-10 sm:h-11 border-gray-300 focus:border-blue-500 focus:ring-blue-500/20 text-sm sm:text-base",value:i,onChange:E=>c(E.target.value)})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs("select",{className:"px-2 sm:px-3 py-2 border border-gray-300 rounded-lg text-xs sm:text-sm bg-white hover:bg-gray-50 focus:border-blue-500 focus:ring-2 focus:ring-blue-500/20 transition-colors flex-1 sm:flex-none min-w-0",value:m,onChange:E=>g(E.target.value),children:[e.jsx("option",{value:"all",children:"Semua Kategori"}),Array.from(new Set(q.map(E=>E.category))).map(E=>e.jsx("option",{value:E,children:E},E))]}),e.jsxs("select",{className:"px-2 sm:px-3 py-2 border border-gray-300 rounded-lg text-xs sm:text-sm bg-white hover:bg-gray-50 focus:border-blue-500 focus:ring-2 focus:ring-blue-500/20 transition-colors flex-1 sm:flex-none min-w-0",value:x,onChange:E=>f(E.target.value),children:[e.jsx("option",{value:"all",children:"Semua Tingkat"}),e.jsx("option",{value:"easy",children:"Mudah"}),e.jsx("option",{value:"medium",children:"Sedang"}),e.jsx("option",{value:"hard",children:"Sulit"})]}),e.jsxs("select",{className:"px-2 sm:px-3 py-2 border border-gray-300 rounded-lg text-xs sm:text-sm bg-white hover:bg-gray-50 focus:border-blue-500 focus:ring-2 focus:ring-blue-500/20 transition-colors flex-1 sm:flex-none min-w-0",value:p,onChange:E=>h(E.target.value),children:[e.jsx("option",{value:"all",children:"Semua Kelas"}),G.map(E=>e.jsx("option",{value:E.id,children:E.name},E.id))]}),e.jsxs("div",{className:"flex border border-gray-300 rounded-lg overflow-hidden bg-white",children:[e.jsx("button",{className:`p-1.5 sm:p-2 transition-colors ${d==="list"?"bg-blue-50 text-blue-600":"text-gray-500 hover:bg-gray-50"}`,onClick:()=>o("list"),children:e.jsx(lo,{className:"w-3 h-3 sm:w-4 sm:h-4"})}),e.jsx("button",{className:`p-1.5 sm:p-2 transition-colors ${d==="grid"?"bg-blue-50 text-blue-600":"text-gray-500 hover:bg-gray-50"}`,onClick:()=>o("grid"),children:e.jsx(co,{className:"w-3 h-3 sm:w-4 sm:h-4"})})]}),e.jsx(V,{variant:"outline",size:"sm",onClick:P,className:"h-8 sm:h-10 px-2 sm:px-3 border-gray-300 hover:bg-gray-50",children:e.jsx(ct,{className:"w-3 h-3 sm:w-4 sm:h-4"})})]})]})}),d==="list"?e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 shadow-sm overflow-hidden",children:[e.jsx("div",{className:"hidden md:block overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50/80",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-4 text-left text-sm font-semibold text-gray-900",children:"Soal"}),e.jsx("th",{className:"px-6 py-4 text-left text-sm font-semibold text-gray-900",children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{children:"Kelas"}),e.jsx(ni,{className:"w-4 h-4 text-gray-400"})]})}),e.jsx("th",{className:"px-6 py-4 text-left text-sm font-semibold text-gray-900",children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{children:"Kategori"}),e.jsx(ni,{className:"w-4 h-4 text-gray-400"})]})}),e.jsx("th",{className:"px-6 py-4 text-left text-sm font-semibold text-gray-900",children:"Tipe"}),e.jsx("th",{className:"px-6 py-4 text-left text-sm font-semibold text-gray-900",children:"Kesulitan"}),e.jsx("th",{className:"px-6 py-4 text-left text-sm font-semibold text-gray-900",children:"Aksi"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:pe.length>0?pe.map((E,R)=>e.jsxs(ge.tr,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.2,delay:R*.05},className:"hover:bg-gray-50/50 transition-colors group",children:[e.jsxs("td",{className:"px-6 py-4",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900 line-clamp-2 max-w-md",children:E.questionText}),e.jsx("div",{className:"text-xs text-gray-500 mt-1",children:de(E.createdAt)})]}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-900",children:E.className}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-900",children:E.category}),e.jsx("td",{className:"px-6 py-4",children:B(E.options)}),e.jsx("td",{className:"px-6 py-4",children:le(E.difficulty)}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[e.jsx(V,{variant:"ghost",size:"sm",className:"text-blue-600 hover:text-blue-700 hover:bg-blue-50",onClick:()=>J(E),children:e.jsx(Ms,{className:"w-4 h-4"})}),e.jsx(V,{variant:"ghost",size:"sm",className:"text-green-600 hover:text-green-700 hover:bg-green-50",onClick:()=>F(E),children:e.jsx(gt,{className:"w-4 h-4"})}),e.jsx(V,{variant:"ghost",size:"sm",className:"text-red-600 hover:text-red-700 hover:bg-red-50",onClick:()=>U(E),children:e.jsx(hs,{className:"w-4 h-4"})})]})})]},E.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"px-6 py-12 text-center",children:e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx(ys,{className:"w-12 h-12 text-gray-400 mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Tidak ada soal yang ditemukan"}),e.jsx("p",{className:"text-gray-500 mb-4",children:"Coba ubah filter pencarian atau tambahkan soal baru"}),e.jsxs(V,{onClick:me,className:"bg-blue-600 hover:bg-blue-700 text-white",children:[e.jsx(xs,{className:"w-4 h-4 mr-2"}),"Tambah Soal Pertama"]})]})})})})]})}),e.jsx("div",{className:"md:hidden",children:pe.length>0?e.jsx("div",{className:"p-4 space-y-3",children:pe.map((E,R)=>e.jsxs(ge.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.2,delay:R*.05},className:"bg-white rounded-lg border border-gray-200 p-4 hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-900 line-clamp-2 mb-2",children:E.questionText}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2 mb-2",children:[B(E.options),le(E.difficulty)]})]}),e.jsxs("div",{className:"flex gap-1 flex-shrink-0 ml-2",children:[e.jsx(V,{variant:"ghost",size:"sm",className:"w-8 h-8 p-0 text-blue-600 hover:text-blue-700 hover:bg-blue-50",onClick:()=>J(E),children:e.jsx(Ms,{className:"w-4 h-4"})}),e.jsx(V,{variant:"ghost",size:"sm",onClick:()=>F(E),className:"w-8 h-8 p-0 text-green-600 hover:text-green-700 hover:bg-green-50",children:e.jsx(gt,{className:"w-4 h-4"})}),e.jsx(V,{variant:"ghost",size:"sm",onClick:()=>U(E),className:"w-8 h-8 p-0 text-red-600 hover:text-red-700 hover:bg-red-50",children:e.jsx(hs,{className:"w-4 h-4"})})]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-3 text-xs text-gray-600",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"font-medium",children:"Kelas:"}),e.jsx("span",{className:"ml-1",children:E.className})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"font-medium",children:"Kategori:"}),e.jsx("span",{className:"ml-1",children:E.category})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"font-medium",children:"Dibuat:"}),e.jsx("span",{className:"ml-1",children:de(E.createdAt)})]})]})]},E.id))}):e.jsx("div",{className:"p-6 text-center",children:e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx(ys,{className:"w-12 h-12 text-gray-400 mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Tidak ada soal yang ditemukan"}),e.jsx("p",{className:"text-gray-500 mb-4 text-sm",children:"Coba ubah filter pencarian atau tambahkan soal baru"}),e.jsxs(V,{onClick:me,className:"bg-blue-600 hover:bg-blue-700 text-white h-10 text-sm",children:[e.jsx(xs,{className:"w-4 h-4 mr-2"}),"Tambah Soal Pertama"]})]})})})]}):e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 sm:gap-6",children:pe.length>0?pe.map((E,R)=>e.jsx(ge.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.2,delay:R*.05},className:"bg-white rounded-lg border border-gray-200 shadow-sm hover:shadow-md transition-all duration-200 group overflow-hidden",children:e.jsxs("div",{className:"p-4 sm:p-6",children:[e.jsxs("div",{className:"flex justify-between items-start mb-3 sm:mb-4",children:[e.jsxs("div",{className:"flex flex-wrap gap-2",children:[B(E.options),le(E.difficulty)]}),e.jsxs("div",{className:"flex gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[e.jsx(V,{variant:"ghost",size:"sm",className:"h-7 w-7 sm:h-8 sm:w-8 p-0 text-green-600 hover:text-green-700 hover:bg-green-50",onClick:()=>F(E),children:e.jsx(gt,{className:"w-3 h-3"})}),e.jsx(V,{variant:"ghost",size:"sm",className:"h-7 w-7 sm:h-8 sm:w-8 p-0 text-red-600 hover:text-red-700 hover:bg-red-50",onClick:()=>U(E),children:e.jsx(hs,{className:"w-3 h-3"})})]})]}),e.jsx("h3",{className:"font-semibold text-gray-900 line-clamp-3 mb-3 min-h-[3.5rem] sm:min-h-[4.5rem] text-sm sm:text-base",children:E.questionText}),e.jsxs("div",{className:"space-y-2 text-xs sm:text-sm text-gray-600",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Kelas:"}),e.jsx("span",{className:"font-medium",children:E.className})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Kategori:"}),e.jsx("span",{className:"font-medium",children:E.category})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Pilihan:"}),e.jsx("span",{className:"font-medium",children:E.options.filter(ye=>ye.trim()).length})]})]}),e.jsx("div",{className:"mt-3 sm:mt-4 pt-3 sm:pt-4 border-t border-gray-100",children:e.jsxs(V,{variant:"outline",size:"sm",className:"w-full h-8 sm:h-9 text-xs sm:text-sm",onClick:()=>J(E),children:[e.jsx(Ms,{className:"w-3 h-3 sm:w-4 sm:h-4 mr-2"}),"Lihat Detail"]})})]})},E.id)):e.jsxs("div",{className:"col-span-full bg-white border-2 border-dashed border-gray-300 rounded-xl p-8 sm:p-12 text-center",children:[e.jsx(ot,{className:"w-12 h-12 sm:w-16 sm:h-16 mx-auto text-gray-400 mb-4"}),e.jsx("h3",{className:"text-lg sm:text-xl font-semibold text-gray-900 mb-2",children:"Tidak ada soal yang ditemukan"}),e.jsx("p",{className:"text-gray-500 mb-4 sm:mb-6 text-sm sm:text-base",children:"Coba ubah filter atau tambahkan soal baru untuk memulai"}),e.jsxs(V,{onClick:me,className:"bg-blue-600 hover:bg-blue-700 text-white h-9 sm:h-10 text-sm sm:text-base",children:[e.jsx(xs,{className:"w-3 h-3 sm:w-4 sm:h-4 mr-2"}),"Tambah Soal Pertama"]})]})})]}),n==="categories"&&e.jsx(ge.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},children:e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 sm:gap-6",children:G.map((E,R)=>e.jsxs(ge.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.2,delay:R*.05},className:"bg-white rounded-lg border border-gray-200 shadow-sm hover:shadow-md transition-all duration-200 p-4 sm:p-6",children:[e.jsxs("div",{className:"flex justify-between items-start mb-3 sm:mb-4",children:[e.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:e.jsx(_s,{className:"w-5 h-5 sm:w-6 sm:h-6 text-blue-600"})}),e.jsxs("span",{className:"bg-blue-100 text-blue-800 rounded-full px-2 sm:px-3 py-1 text-xs font-medium",children:[q.filter(ye=>ye.classId===E.id).length," soal"]})]}),e.jsx("h3",{className:"font-semibold text-gray-900 mb-2 text-sm sm:text-base",children:E.name}),e.jsx("p",{className:"text-xs sm:text-sm text-gray-600 mb-3 sm:mb-4 line-clamp-2",children:E.description}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(V,{variant:"outline",size:"sm",className:"flex-1 h-8 sm:h-9 text-xs sm:text-sm",onClick:()=>{h(E.id),l("questions")},children:"Lihat Soal"}),e.jsx(V,{size:"sm",className:"flex-1 bg-blue-600 hover:bg-blue-700 text-white h-8 sm:h-9 text-xs sm:text-sm",onClick:()=>{ke(ye=>({...ye,classId:E.id})),me()},children:"Buat Soal"})]})]},E.id))})}),n==="reports"&&re&&e.jsxs(ge.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},className:"space-y-4 sm:space-y-6",children:[e.jsxs("div",{className:"grid gap-4 sm:gap-6 grid-cols-1 sm:grid-cols-3",children:[e.jsx("div",{className:"bg-white p-4 sm:p-6 rounded-lg border border-gray-200 shadow-sm",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs sm:text-sm font-medium text-gray-600",children:"Total Soal"}),e.jsx("p",{className:"text-2xl sm:text-3xl font-bold text-gray-900",children:re.totalQuestions})]}),e.jsx("div",{className:"bg-blue-100 p-2 sm:p-3 rounded-lg",children:e.jsx(ys,{className:"w-5 h-5 sm:w-6 sm:h-6 text-blue-600"})})]})}),e.jsx("div",{className:"bg-white p-4 sm:p-6 rounded-lg border border-gray-200 shadow-sm",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs sm:text-sm font-medium text-gray-600",children:"Total Kategori"}),e.jsx("p",{className:"text-2xl sm:text-3xl font-bold text-gray-900",children:re.questionsByCategory.length})]}),e.jsx("div",{className:"bg-green-100 p-2 sm:p-3 rounded-lg",children:e.jsx(ot,{className:"w-5 h-5 sm:w-6 sm:h-6 text-green-600"})})]})}),e.jsx("div",{className:"bg-white p-4 sm:p-6 rounded-lg border border-gray-200 shadow-sm",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs sm:text-sm font-medium text-gray-600",children:"Kelas Aktif"}),e.jsx("p",{className:"text-2xl sm:text-3xl font-bold text-gray-900",children:re.questionsByClass.length})]}),e.jsx("div",{className:"bg-purple-100 p-2 sm:p-3 rounded-lg",children:e.jsx(_s,{className:"w-5 h-5 sm:w-6 sm:h-6 text-purple-600"})})]})})]}),e.jsxs("div",{className:"grid gap-4 sm:gap-6 grid-cols-1 lg:grid-cols-2",children:[e.jsxs("div",{className:"bg-white p-4 sm:p-6 rounded-lg border border-gray-200 shadow-sm",children:[e.jsx("h3",{className:"text-base sm:text-lg font-semibold text-gray-900 mb-3 sm:mb-4",children:"Distribusi Tingkat Kesulitan"}),e.jsx("div",{className:"space-y-3",children:re.questionsByDifficulty.map(E=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"flex items-center",children:le(E.difficulty)}),e.jsxs("div",{className:"text-xs sm:text-sm font-medium text-gray-900",children:[E.count," soal"]})]},E.difficulty))})]}),e.jsxs("div",{className:"bg-white p-4 sm:p-6 rounded-lg border border-gray-200 shadow-sm",children:[e.jsx("h3",{className:"text-base sm:text-lg font-semibold text-gray-900 mb-3 sm:mb-4",children:"Distribusi Kategori"}),e.jsx("div",{className:"space-y-3",children:re.questionsByCategory.slice(0,5).map(E=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-xs sm:text-sm text-gray-600 truncate",children:E.category}),e.jsxs("span",{className:"text-xs sm:text-sm font-medium text-gray-900 flex-shrink-0 ml-2",children:[E.count," soal"]})]},E.category))})]})]})]})]}),e.jsx(Pr,{isOpen:w,onClose:()=>L(!1),title:"Tambah Soal Baru",size:"large",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Kelas ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:border-blue-500 focus:ring-2 focus:ring-blue-500/20 transition-colors",value:te.classId,onChange:E=>ke({...te,classId:E.target.value}),children:[e.jsx("option",{value:"",children:"Pilih Kelas"}),G.map(E=>e.jsx("option",{value:E.id,children:E.name},E.id))]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Kategori ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:border-blue-500 focus:ring-2 focus:ring-blue-500/20 transition-colors",value:te.category,onChange:E=>ke({...te,category:E.target.value}),placeholder:"Contoh: Aljabar, Kalkulus, dll"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Pertanyaan ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("textarea",{className:"w-full border border-gray-300 rounded-lg px-3 py-2 h-24 focus:border-blue-500 focus:ring-2 focus:ring-blue-500/20 transition-colors resize-none",value:te.questionText,onChange:E=>ke({...te,questionText:E.target.value}),placeholder:"Tulis soal di sini..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Pilihan Jawaban (kosongkan jika soal esai)"}),e.jsx("div",{className:"space-y-3",children:te.options.map((E,R)=>e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("span",{className:"text-sm font-medium text-gray-500 w-8",children:[String.fromCharCode(65+R),"."]}),e.jsx("input",{type:"text",className:"flex-1 border border-gray-300 rounded-lg px-3 py-2 focus:border-blue-500 focus:ring-2 focus:ring-blue-500/20 transition-colors",value:E,onChange:ye=>{const ee=[...te.options];ee[R]=ye.target.value,ke({...te,options:ee})},placeholder:`Pilihan ${String.fromCharCode(65+R)}`})]},R))})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Jawaban Benar ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:border-blue-500 focus:ring-2 focus:ring-blue-500/20 transition-colors",value:te.correctAnswer,onChange:E=>ke({...te,correctAnswer:E.target.value}),placeholder:"Jawaban yang benar"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Tingkat Kesulitan ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:border-blue-500 focus:ring-2 focus:ring-blue-500/20 transition-colors",value:te.difficulty,onChange:E=>ke({...te,difficulty:E.target.value}),children:[e.jsx("option",{value:"easy",children:"Mudah"}),e.jsx("option",{value:"medium",children:"Sedang"}),e.jsx("option",{value:"hard",children:"Sulit"})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-gray-200",children:[e.jsx(V,{variant:"outline",onClick:()=>L(!1),disabled:t,children:"Batal"}),e.jsx(V,{onClick:Y,disabled:t,className:"bg-blue-600 hover:bg-blue-700 text-white min-w-[120px]",children:t?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"}),"Menyimpan..."]}):e.jsxs(e.Fragment,{children:[e.jsx(At,{className:"w-4 h-4 mr-2"}),"Simpan Soal"]})})]})]})}),e.jsx(Pr,{isOpen:O,onClose:()=>I(!1),title:"Edit Soal",size:"large",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Kelas ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:border-blue-500 focus:ring-2 focus:ring-blue-500/20 transition-colors",value:te.classId,onChange:E=>ke({...te,classId:E.target.value}),children:[e.jsx("option",{value:"",children:"Pilih Kelas"}),G.map(E=>e.jsx("option",{value:E.id,children:E.name},E.id))]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Kategori ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:border-blue-500 focus:ring-2 focus:ring-blue-500/20 transition-colors",value:te.category,onChange:E=>ke({...te,category:E.target.value}),placeholder:"Contoh: Aljabar, Kalkulus, dll"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Pertanyaan ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("textarea",{className:"w-full border border-gray-300 rounded-lg px-3 py-2 h-24 focus:border-blue-500 focus:ring-2 focus:ring-blue-500/20 transition-colors resize-none",value:te.questionText,onChange:E=>ke({...te,questionText:E.target.value}),placeholder:"Tulis soal di sini..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Pilihan Jawaban (kosongkan jika soal esai)"}),e.jsx("div",{className:"space-y-3",children:te.options.map((E,R)=>e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("span",{className:"text-sm font-medium text-gray-500 w-8",children:[String.fromCharCode(65+R),"."]}),e.jsx("input",{type:"text",className:"flex-1 border border-gray-300 rounded-lg px-3 py-2 focus:border-blue-500 focus:ring-2 focus:ring-blue-500/20 transition-colors",value:E,onChange:ye=>{const ee=[...te.options];ee[R]=ye.target.value,ke({...te,options:ee})},placeholder:`Pilihan ${String.fromCharCode(65+R)}`})]},R))})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Jawaban Benar ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:border-blue-500 focus:ring-2 focus:ring-blue-500/20 transition-colors",value:te.correctAnswer,onChange:E=>ke({...te,correctAnswer:E.target.value}),placeholder:"Jawaban yang benar"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Tingkat Kesulitan ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:border-blue-500 focus:ring-2 focus:ring-blue-500/20 transition-colors",value:te.difficulty,onChange:E=>ke({...te,difficulty:E.target.value}),children:[e.jsx("option",{value:"easy",children:"Mudah"}),e.jsx("option",{value:"medium",children:"Sedang"}),e.jsx("option",{value:"hard",children:"Sulit"})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-gray-200",children:[e.jsx(V,{variant:"outline",onClick:()=>I(!1),disabled:t,children:"Batal"}),e.jsx(V,{onClick:ue,disabled:t,className:"bg-blue-600 hover:bg-blue-700 text-white min-w-[120px]",children:t?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"}),"Menyimpan..."]}):e.jsxs(e.Fragment,{children:[e.jsx(At,{className:"w-4 h-4 mr-2"}),"Update Soal"]})})]})]})}),e.jsx(Pr,{isOpen:H,onClose:()=>ae(!1),title:"Detail Soal",size:"large",children:M&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Kelas"}),e.jsx("p",{className:"text-sm font-semibold text-gray-900",children:M.className})]}),e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Kategori"}),e.jsx("p",{className:"text-sm font-semibold text-gray-900",children:M.category})]})]}),e.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Pertanyaan"}),e.jsx("p",{className:"text-gray-900 leading-relaxed",children:M.questionText})]}),M.options&&M.options.some(E=>E.trim())&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Pilihan Jawaban"}),e.jsx("div",{className:"space-y-2",children:M.options.filter(E=>E.trim()).map((E,R)=>e.jsxs("div",{className:"flex items-center p-3 bg-gray-50 rounded-lg",children:[e.jsxs("span",{className:"text-sm font-medium text-blue-600 w-8 flex-shrink-0",children:[String.fromCharCode(65+R),"."]}),e.jsx("span",{className:"text-sm text-gray-900",children:E})]},R))})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-green-50 p-4 rounded-lg",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Jawaban Benar"}),e.jsx("p",{className:"text-sm font-semibold text-green-700",children:M.correctAnswer})]}),e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Tingkat Kesulitan"}),e.jsx("div",{children:le(M.difficulty)})]})]}),e.jsx("div",{className:"bg-gray-50 p-4 rounded-lg",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Dibuat pada"}),e.jsx("p",{className:"text-sm text-gray-900",children:de(M.createdAt)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tipe Soal"}),e.jsx("div",{children:B(M.options)})]})]})}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-gray-200",children:[e.jsx(V,{variant:"outline",onClick:()=>ae(!1),children:"Tutup"}),e.jsxs(V,{onClick:()=>{ae(!1),F(M)},className:"bg-blue-600 hover:bg-blue-700 text-white",children:[e.jsx(gt,{className:"w-4 h-4 mr-2"}),"Edit Soal"]})]})]})}),e.jsx(Pr,{isOpen:oe,onClose:()=>D(!1),title:"Hapus Soal",children:M&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center py-4",children:[e.jsx("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(Ks,{className:"w-8 h-8 text-red-600"})}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Apakah Anda yakin ingin menghapus soal ini?"}),e.jsx("div",{className:"bg-gray-50 p-4 rounded-lg mb-4",children:e.jsxs("p",{className:"text-sm text-gray-600 line-clamp-3",children:['"',M.questionText,'"']})}),e.jsx("p",{className:"text-sm text-red-600 font-medium",children:"Tindakan ini tidak dapat dibatalkan."})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-gray-200",children:[e.jsx(V,{variant:"outline",onClick:()=>D(!1),disabled:t,children:"Batal"}),e.jsx(V,{onClick:Me,disabled:t,className:"bg-red-600 hover:bg-red-700 text-white min-w-[120px]",children:t?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"}),"Menghapus..."]}):e.jsxs(e.Fragment,{children:[e.jsx(hs,{className:"w-4 h-4 mr-2"}),"Hapus Soal"]})})]})]})})]})},zg=({notification:s,onClose:a})=>{const t=()=>{switch(s.type){case"success":return e.jsx(Vs,{className:"w-5 h-5"});case"error":return e.jsx(Ks,{className:"w-5 h-5"});case"warning":return e.jsx(Ks,{className:"w-5 h-5"});default:return e.jsx(ja,{className:"w-5 h-5"})}},r=()=>{switch(s.type){case"success":return"bg-green-50 border-green-200 text-green-800";case"error":return"bg-red-50 border-red-200 text-red-800";case"warning":return"bg-yellow-50 border-yellow-200 text-yellow-800";default:return"bg-blue-50 border-blue-200 text-blue-800"}};return e.jsx(Ve,{children:s.visible&&e.jsxs(ge.div,{initial:{opacity:0,y:-50,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-50,scale:.95},className:`fixed top-4 right-4 z-50 flex items-center gap-2 px-4 py-3 border rounded-lg shadow-lg ${r()}`,children:[t(),e.jsx("span",{className:"text-sm font-medium",children:s.message}),e.jsx(V,{variant:"ghost",size:"sm",onClick:a,className:"h-6 w-6 p-0 hover:bg-black/10",children:e.jsx(Ys,{className:"w-4 h-4"})})]})})},Wg=()=>e.jsxs("div",{className:"animate-pulse space-y-4",children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[...Array(4)].map((s,a)=>e.jsx("div",{className:"bg-gray-200 h-24 rounded-lg"},a))}),e.jsx("div",{className:"bg-gray-200 h-64 rounded-lg"})]}),$a=({isOpen:s,onClose:a,title:t,children:r,size:n="default"})=>{const l={default:"max-w-md",large:"max-w-2xl",xl:"max-w-4xl"};return e.jsx(Ve,{children:s&&e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[e.jsx(ge.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/60 backdrop-blur-sm",onClick:a}),e.jsxs(ge.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},className:`relative bg-white rounded-xl shadow-2xl border border-gray-200 w-full ${l[n]} max-h-[90vh] overflow-hidden`,children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:t}),e.jsx(V,{variant:"ghost",size:"sm",onClick:a,className:"h-8 w-8 p-0 hover:bg-gray-100",children:e.jsx(Ys,{className:"w-4 h-4"})})]}),e.jsx("div",{className:"overflow-y-auto max-h-[calc(90vh-120px)]",children:r})]})]})})},$g=({selectedEmoji:s,onEmojiSelect:a,isOpen:t,onToggle:r})=>{const n={"Trophies & Awards":["🏆","🥇","🥈","🥉","🏅","🎖️","🏵️","🎗️","👑","💎"],Achievement:["⭐","🌟","✨","💫","🔥","⚡","💥","🎯","💪","🎊"],Education:["📚","📖","✏️","📝","🎓","🏫","📊","📈","📋","📌"],Activities:["🎨","🎵","🎬","🎮","⚽","🏀","🏓","🎪","🎭","🎸"],Special:["🎉","🎁","🌈","🦄","🚀","🛸","✨","💯","🔮","💝"],Animals:["🦁","🐯","🐻","🦊","🐺","🐸","🐵","🦅","🐲","🦋"],Nature:["🌺","🌸","🌻","🌹","🌿","🍀","🌳","🌴","🌙","☀️"],Objects:["⚔️","🛡️","🗡️","🏹","🔱","⚖️","🔧","🔨","⚙️","🔑"]};return e.jsxs("div",{className:"relative","data-emoji-picker":!0,children:[e.jsxs(V,{type:"button",variant:"outline",onClick:r,className:"w-full flex items-center justify-between h-10 px-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-lg",children:s}),e.jsx("span",{className:"text-sm text-gray-600",children:"Choose icon"})]}),e.jsx(oo,{className:"w-4 h-4 text-gray-400"})]}),e.jsx(Ve,{children:t&&e.jsx(ge.div,{initial:{opacity:0,y:-10,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-10,scale:.95},className:"absolute top-full left-0 right-0 z-50 mt-2 bg-white border border-gray-200 rounded-lg shadow-lg max-h-80 overflow-y-auto",children:e.jsxs("div",{className:"p-4 space-y-4",children:[e.jsx("div",{className:"text-center text-xs text-gray-500 mb-3",children:"💡 Click on an emoji to select it as your badge icon"}),Object.entries(n).map(([l,i])=>e.jsxs("div",{children:[e.jsx("h4",{className:"text-xs font-medium text-gray-500 mb-2 uppercase tracking-wide",children:l}),e.jsx("div",{className:"grid grid-cols-10 gap-1",children:i.map((c,d)=>e.jsx("button",{type:"button",onClick:()=>{a(c),r()},className:`w-8 h-8 flex items-center justify-center text-lg hover:bg-gray-100 rounded transition-colors ${s===c?"bg-blue-100 ring-2 ring-blue-500":""}`,title:c,children:c},`${l}-${c}-${d}`))})]},l))]})})})]})},Kg=()=>{const[s,a]=S.useState([]),[t,r]=S.useState([]),[n,l]=S.useState([]),[i,c]=S.useState([]),[d,o]=S.useState(!0),[m,g]=S.useState("dashboard"),[x,f]=S.useState(""),[p,h]=S.useState("all"),[w,L]=S.useState("all"),[O,I]=S.useState(!1),[H,ae]=S.useState(!1),[oe,D]=S.useState(!1),[q,z]=S.useState(!1),[G,ce]=S.useState(!1),[M,W]=S.useState(null),[re,ve]=S.useState(null),[te,ke]=S.useState(null),[xe,Ie]=S.useState(null),[je,Oe]=S.useState(null),[N,P]=S.useState([]),[T,A]=S.useState(!1),[X,me]=S.useState(!1),[F,J]=S.useState({visible:!1,type:"info",message:""}),[U,Y]=S.useState({name:"",description:"",icon:"🏆",category:"achievement",pointValue:100}),[ue,Me]=S.useState({title:"",description:"",reward:50,deadline:""}),[le,B]=S.useState({name:"",pointsRequired:0,benefits:"",color:"#3B82F6"}),[de,pe]=S.useState({type:"points",points:10,badgeId:"",reason:""}),E=(k,fe)=>{J({visible:!0,type:k,message:fe}),setTimeout(()=>J(Be=>({...Be,visible:!1})),5e3)},R=async()=>{o(!0);try{await Promise.all([ye(),ee(),Se(),Ce()])}catch(k){console.error("Error fetching data:",k),E("error","Gagal memuat data gamifikasi")}finally{o(!1)}},ye=async()=>{try{const k=await jr.getAll();k.success&&r(k.badges||[])}catch(k){console.error("Error fetching badges:",k)}},ee=async()=>{try{const k=await Ga.getAll();k.success&&l(k.challenges||[])}catch(k){console.error("Error fetching challenges:",k)}},Se=async()=>{try{const k=await Sr.getAll();k.success&&c(k.levels||[])}catch(k){console.error("Error fetching levels:",k)}},Ce=async()=>{var k;try{console.log("🔍 Fetching students data...");const[fe,Be]=await Promise.all([be("getStudentsFromSheet",{}),Eo.getAll()]);if(console.log("📊 Students response:",fe),console.log("🎮 Gamification response:",Be),!fe.success||fe.success&&((k=fe.students)==null?void 0:k.length)===0){console.log("📝 No students found, creating sample data...");const C=await be("createStudentsSheet",{});if(console.log("🏗️ Create students response:",C),C.success){const Te=await be("getStudentsFromSheet",{});if(console.log("🔄 Retry students response:",Te),Te.success&&Be.success){const Pe=Ue(Te.students||[],Be.data||[]);console.log("✅ Combined student data (after creation):",Pe),a(Pe),E("info","Data siswa sampel telah dibuat");return}}else E("error","Gagal membuat data siswa sampel")}if(fe.success&&Be.success){const C=Ue(fe.students||[],Be.data||[]);console.log("✅ Combined student data:",C),a(C)}else console.error("❌ Failed to fetch student data:",{studentsResponse:fe,gamificationResponse:Be}),E("error","Gagal memuat data siswa")}catch(fe){console.error("💥 Error fetching students:",fe),E("error","Terjadi kesalahan saat memuat data siswa")}},Ue=(k,fe)=>{console.log("🔄 Combining students with gamification..."),console.log("👥 Students from sheet:",k),console.log("🎮 Gamification data:",fe);const Be=[];return k.forEach(C=>{console.log("👤 Processing student:",C);const Te=fe.find(v=>v.studentUsername===C.username&&v.classId===C.classId),Pe=Te!=null&&Te.badges?Te.badges.split(",").filter(v=>v.trim()).map(v=>v.trim()):[],u=Te!=null&&Te.achievements?Te.achievements.split(",").filter(v=>v.trim()).map(v=>v.trim()):[],b={id:`${C.classId}-${C.username}`,name:C.fullName||C.username,username:C.username,class:C.class||"Unknown Class",classId:C.classId,points:(Te==null?void 0:Te.points)||0,level:(Te==null?void 0:Te.level)||1,badges:Pe.length,achievements:[...Pe,...u]};console.log("📝 Created student data:",b),console.log("🎖️ Student badges:",Pe),console.log("🏆 Student achievements:",u),Be.push(b)}),console.log("✅ Final combined data:",Be),Be},Xe=async()=>{await R(),E("success","Data berhasil diperbarui")},vs=async()=>{if(!U.name.trim()||!U.description.trim()){E("error","Nama dan deskripsi badge wajib diisi");return}A(!0);try{const k=M?await jr.update(M.id,U.name,U.description,U.icon,U.category,U.pointValue):await jr.create(U.name,U.description,U.icon,U.category,U.pointValue);k.success?(E("success",M?"Badge berhasil diperbarui":"Badge berhasil dibuat"),await ye(),I(!1),W(null),Y({name:"",description:"",icon:"🏆",category:"achievement",pointValue:100})):E("error",k.error||"Gagal menyimpan badge")}catch{E("error","Terjadi kesalahan saat menyimpan badge")}finally{A(!1)}},as=async()=>{if(!ue.title.trim()||!ue.description.trim()){E("error","Judul dan deskripsi challenge wajib diisi");return}A(!0);try{const k=re?await Ga.update(re.id.toString(),ue.title,ue.description,ue.reward,ue.deadline):await Ga.create(ue.title,ue.description,ue.reward,ue.deadline);k.success?(E("success",re?"Challenge berhasil diperbarui":"Challenge berhasil dibuat"),await ee(),ae(!1),ve(null),Me({title:"",description:"",reward:50,deadline:""})):E("error",k.error||"Gagal menyimpan challenge")}catch{E("error","Terjadi kesalahan saat menyimpan challenge")}finally{A(!1)}},cs=async()=>{if(!le.name.trim()||le.pointsRequired<=0){E("error","Nama dan poin yang diperlukan wajib diisi");return}A(!0);try{const k=te?await Sr.update(te.id,le.name,le.pointsRequired,le.benefits,le.color):await Sr.create(le.name,le.pointsRequired,le.benefits,le.color);k.success?(E("success",te?"Level berhasil diperbarui":"Level berhasil dibuat"),await Se(),D(!1),ke(null),B({name:"",pointsRequired:0,benefits:"",color:"#3B82F6"})):E("error",k.error||"Gagal menyimpan level")}catch{E("error","Terjadi kesalahan saat menyimpan level")}finally{A(!1)}},qs=async()=>{if(xe){A(!0);try{let k;if(de.type==="badge"){const fe=t.find(Be=>Be.id.toString()===de.badgeId);if(!fe){E("error","Badge tidak ditemukan"),A(!1);return}console.log("Awarding badge:",{classId:xe.classId,studentUsername:xe.username,badgeId:de.badgeId,badgeName:fe.name}),k=await be("awardBadge",{classId:xe.classId,studentUsername:xe.username,badgeId:de.badgeId,badgeName:fe.name})}else console.log("Awarding points:",{classId:xe.classId,studentUsername:xe.username,points:de.points,reason:de.reason}),k=await be("awardPoints",{classId:xe.classId,studentUsername:xe.username,points:de.points,reason:de.reason});console.log("Award response:",k),k.success?(E("success",`Berhasil memberikan ${de.type==="badge"?"badge":"poin"} kepada ${xe.name}`),await Ce(),z(!1),Ie(null),pe({type:"points",points:10,badgeId:"",reason:""})):E("error",k.error||"Gagal memberikan reward")}catch(k){console.error("Award error:",k),E("error","Terjadi kesalahan saat memberikan reward")}finally{A(!1)}}},Gs=async()=>{if(!je||N.length===0){E("error","Pilih badge dan minimal satu siswa");return}A(!0);try{console.log("Starting bulk badge assignment:",{badge:je.name,students:N.length});const k=N.map(Te=>{const Pe=s.find(u=>u.id===Te);return Pe?(console.log("Assigning badge to student:",{classId:Pe.classId,studentUsername:Pe.username,badgeId:je.id.toString(),badgeName:je.name}),be("awardBadge",{classId:Pe.classId,studentUsername:Pe.username,badgeId:je.id.toString(),badgeName:je.name})):Promise.resolve({success:!1,error:"Student not found"})}),fe=await Promise.all(k);console.log("Bulk assignment results:",fe);const Be=fe.filter(Te=>Te.success).length,C=fe.filter(Te=>!Te.success);Be>0?(E("success",`Badge berhasil diberikan kepada ${Be} siswa`),C.length>0&&(console.log("Failed assignments:",C),E("warning",`${C.length} siswa gagal menerima badge`)),await Ce()):(console.error("All assignments failed:",C),E("error","Gagal memberikan badge ke semua siswa")),ce(!1),Oe(null),P([])}catch(k){console.error("Badge assignment error:",k),E("error","Terjadi kesalahan saat memberikan badge")}finally{A(!1)}},ie=k=>{W(k),Y({name:k.name,description:k.description,icon:k.icon,category:k.category,pointValue:k.pointValue}),me(!1),I(!0)},_e=k=>{ve(k),Me({title:k.title,description:k.description,reward:k.reward,deadline:k.deadline}),ae(!0)},Ke=k=>{ke(k),B({name:k.name,pointsRequired:k.pointsRequired,benefits:k.benefits,color:k.color||"#3B82F6"}),D(!0)},ps=k=>{Ie(k),z(!0)},rs=async k=>{try{const fe=await jr.delete(k);fe.success?(E("success","Badge berhasil dihapus"),await ye()):E("error",fe.error||"Gagal menghapus badge")}catch{E("error","Terjadi kesalahan saat menghapus badge")}},Qs=async k=>{try{const fe=await Ga.delete(k.toString());fe.success?(E("success","Challenge berhasil dihapus"),await ee()):E("error",fe.error||"Gagal menghapus challenge")}catch{E("error","Terjadi kesalahan saat menghapus challenge")}},Ts=async k=>{try{const fe=await Sr.delete(k);fe.success?(E("success","Level berhasil dihapus"),await Se()):E("error",fe.error||"Gagal menghapus level")}catch{E("error","Terjadi kesalahan saat menghapus level")}},Ye=async k=>{try{const fe=await Ga.toggleStatus(k.toString());fe.success?(E("success","Status challenge berhasil diubah"),await ee()):E("error",fe.error||"Gagal mengubah status challenge")}catch{E("error","Terjadi kesalahan saat mengubah status challenge")}},_t=k=>{if(console.log("🎁 Opening badge assign modal for:",k.name),console.log("📊 Current students data:",s),console.log("🏫 Available classes:",Wt),console.log("📈 Available levels:",$t),s.length===0){E("warning","Tidak ada data siswa. Silakan refresh halaman.");return}if(Wt.length===0){E("warning","Tidak ada kelas terdeteksi. Pastikan siswa memiliki data kelas yang valid.");return}Oe(k),h("all"),L("all"),P([]),ce(!0)},zt=k=>{P(fe=>fe.includes(k)?fe.filter(Be=>Be!==k):[...fe,k])},ns=()=>{const k=Dt(),fe=k.every(Be=>N.includes(Be.id));P(fe?Be=>Be.filter(C=>!k.some(Te=>Te.id===C)):Be=>[...new Set([...Be,...k.map(C=>C.id)])])},Dt=()=>{console.log("🔍 Filtering students for assignment..."),console.log("📊 Total students:",s.length),console.log("🏫 Class filter:",p),console.log("📈 Level filter:",w);const k=s.filter(fe=>{const Be=p==="all"||fe.classId===p,C=w==="all"||fe.level.toString()===w;return console.log(`👤 Student ${fe.name} (${fe.classId}): class match=${Be}, level match=${C}`),Be&&C});return console.log("✅ Filtered students:",k),k},It=s.filter(k=>k.name.toLowerCase().includes(x.toLowerCase())||k.username.toLowerCase().includes(x.toLowerCase())||k.class.toLowerCase().includes(x.toLowerCase())),wt={totalStudents:s.length,totalBadges:t.length,totalChallenges:n.length,totalLevels:i.length,averagePoints:s.length>0?Math.round(s.reduce((k,fe)=>k+fe.points,0)/s.length):0,topStudent:s.length>0?s.reduce((k,fe)=>fe.points>k.points?fe:k):null},Wt=Nn.useMemo(()=>{console.log("🏫 Generating unique classes from students:",s);const k=new Map;s.forEach(Be=>{Be.classId&&Be.class&&k.set(Be.classId,{id:Be.classId,name:Be.class})});const fe=Array.from(k.values());return console.log("📚 Unique classes generated:",fe),fe},[s]),$t=Nn.useMemo(()=>{const k=[...new Set(s.map(fe=>fe.level))].sort((fe,Be)=>fe-Be);return console.log("📊 Unique levels generated:",k),k},[s]),ga=k=>k.match(new RegExp("\\p{Emoji}","u"))?e.jsx("span",{className:"text-2xl",children:k}):e.jsx(ja,{className:"w-6 h-6 text-yellow-500"}),Oa=k=>{const fe=["bg-gray-500","bg-green-500","bg-blue-500","bg-purple-500","bg-yellow-500"];return fe[Math.min(k-1,fe.length-1)]||fe[0]},La=k=>{try{return new Date(k).toLocaleDateString("id-ID")}catch{return k}};return S.useEffect(()=>{R()},[]),S.useEffect(()=>{const k=fe=>{if(X){const Be=fe.target,C=document.querySelector("[data-emoji-picker]");C&&!C.contains(Be)&&me(!1)}};return document.addEventListener("mousedown",k),()=>{document.removeEventListener("mousedown",k)}},[X]),d?e.jsx("div",{className:"min-h-screen bg-gray-50/50",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:e.jsx(Wg,{})})}):e.jsxs("div",{className:"min-h-screen bg-gray-50/50",children:[e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[F.visible&&e.jsx(zg,{notification:F,onClose:()=>J(k=>({...k,visible:!1}))}),e.jsx("div",{className:"mb-8",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("h1",{className:"text-3xl font-bold bg-gradient-to-r from-purple-600 to-pink-600 bg-clip-text text-transparent",children:"Gamifikasi"}),e.jsx("p",{className:"text-gray-600",children:"Kelola sistem penghargaan dan motivasi siswa"})]}),e.jsx("div",{className:"flex items-center gap-3",children:e.jsxs(V,{onClick:Xe,variant:"outline",size:"sm",className:"flex items-center gap-2",children:[e.jsx(ct,{className:"w-4 h-4"}),"Refresh"]})})]})}),e.jsx("div",{className:"mb-8",children:e.jsx("div",{className:"border-b border-gray-200",children:e.jsx("nav",{className:"-mb-px flex space-x-8",children:[{key:"dashboard",label:"Dashboard",icon:Mr},{key:"badges",label:"Badge",icon:vr},{key:"levels",label:"Level",icon:ja},{key:"challenges",label:"Challenge",icon:Ot},{key:"students",label:"Siswa",icon:_s}].map(k=>{const fe=k.icon;return e.jsxs(ge.button,{onClick:()=>g(k.key),className:`flex items-center gap-2 py-2 px-1 border-b-2 font-medium text-sm transition-colors ${m===k.key?"border-purple-500 text-purple-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,whileHover:{y:-1},whileTap:{y:0},children:[e.jsx(fe,{className:"w-4 h-4"}),k.label]},k.key)})})})}),(m==="badges"||m==="students"||m==="challenges"||m==="levels")&&e.jsxs("div",{className:"mb-6 flex flex-col sm:flex-row gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"relative",children:[e.jsx(Zt,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),e.jsx(He,{placeholder:"Cari data...",value:x,onChange:k=>f(k.target.value),className:"pl-10"})]})}),e.jsxs("div",{className:"flex gap-2",children:[m==="badges"&&e.jsxs(V,{onClick:()=>{W(null),Y({name:"",description:"",icon:"🏆",category:"achievement",pointValue:100}),I(!0)},className:"flex items-center gap-2",children:[e.jsx(xs,{className:"w-4 h-4"}),"Tambah Badge"]}),m==="levels"&&e.jsxs(V,{onClick:()=>{ke(null),B({name:"",pointsRequired:0,benefits:"",color:"#3B82F6"}),D(!0)},className:"flex items-center gap-2",children:[e.jsx(xs,{className:"w-4 h-4"}),"Tambah Level"]}),m==="challenges"&&e.jsxs(V,{onClick:()=>{ve(null),Me({title:"",description:"",reward:50,deadline:""}),ae(!0)},className:"flex items-center gap-2",children:[e.jsx(xs,{className:"w-4 h-4"}),"Tambah Challenge"]})]})]}),e.jsx(Ve,{mode:"wait",children:e.jsxs(ge.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.2},children:[m==="dashboard"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx(ge.div,{className:"bg-white p-6 rounded-lg border shadow-sm",whileHover:{y:-2},children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Siswa"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:wt.totalStudents})]}),e.jsx("div",{className:"bg-blue-100 p-3 rounded-lg",children:e.jsx(_s,{className:"w-6 h-6 text-blue-600"})})]})}),e.jsx(ge.div,{className:"bg-white p-6 rounded-lg border shadow-sm",whileHover:{y:-2},children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Badge"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:wt.totalBadges})]}),e.jsx("div",{className:"bg-yellow-100 p-3 rounded-lg",children:e.jsx(vr,{className:"w-6 h-6 text-yellow-600"})})]})}),e.jsx(ge.div,{className:"bg-white p-6 rounded-lg border shadow-sm",whileHover:{y:-2},children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Rata-rata Poin"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:wt.averagePoints})]}),e.jsx("div",{className:"bg-green-100 p-3 rounded-lg",children:e.jsx(ja,{className:"w-6 h-6 text-green-600"})})]})}),e.jsx(ge.div,{className:"bg-white p-6 rounded-lg border shadow-sm",whileHover:{y:-2},children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Siswa Terbaik"}),e.jsx("p",{className:"text-lg font-bold text-gray-900 truncate",children:wt.topStudent?wt.topStudent.name:"Belum ada"}),wt.topStudent&&e.jsxs("p",{className:"text-sm text-gray-500",children:[wt.topStudent.points," poin"]})]}),e.jsx("div",{className:"bg-purple-100 p-3 rounded-lg",children:e.jsx(tr,{className:"w-6 h-6 text-purple-600"})})]})})]}),e.jsxs("div",{className:"bg-white rounded-lg border shadow-sm p-6",children:[e.jsx("h3",{className:"text-lg font-medium mb-4",children:"Leaderboard Siswa"}),e.jsx("div",{className:"space-y-3",children:It.sort((k,fe)=>fe.points-k.points).slice(0,10).map((k,fe)=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-sm font-bold text-white ${fe===0?"bg-yellow-500":fe===1?"bg-gray-400":fe===2?"bg-amber-600":"bg-gray-300"}`,children:fe+1}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:k.name}),e.jsx("p",{className:"text-sm text-gray-500",children:k.class})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"font-bold text-gray-900",children:[k.points," poin"]}),e.jsxs("p",{className:"text-sm text-gray-500",children:["Level ",k.level]})]})]},k.id))})]})]}),m==="badges"&&e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:[t.filter(k=>k.name.toLowerCase().includes(x.toLowerCase())||k.description.toLowerCase().includes(x.toLowerCase())).map(k=>e.jsxs(ge.div,{className:"bg-white rounded-lg border shadow-sm p-6 hover:shadow-md transition-shadow",whileHover:{y:-2},layout:!0,children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[ga(k.icon),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-gray-900",children:k.name}),e.jsx("p",{className:"text-sm text-gray-500",children:k.category})]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(V,{variant:"ghost",size:"sm",onClick:()=>ie(k),className:"h-8 w-8 p-0 hover:bg-blue-100",children:e.jsx(gt,{className:"w-4 h-4 text-blue-600"})}),e.jsx(V,{variant:"ghost",size:"sm",onClick:()=>_t(k),className:"h-8 w-8 p-0 hover:bg-green-100",children:e.jsx(wr,{className:"w-4 h-4 text-green-600"})}),e.jsx(V,{variant:"ghost",size:"sm",onClick:()=>rs(k.id),className:"h-8 w-8 p-0 hover:bg-red-100",children:e.jsx(hs,{className:"w-4 h-4 text-red-600"})})]})]}),e.jsx("p",{className:"text-sm text-gray-600 mb-3",children:k.description}),e.jsxs("div",{className:"flex justify-between items-center text-sm",children:[e.jsxs("span",{className:"font-medium text-purple-600",children:[k.pointValue," poin"]}),e.jsxs("span",{className:"text-gray-500",children:[k.awardedCount||0," diberikan"]})]})]},k.id)),t.length===0&&e.jsxs("div",{className:"col-span-full text-center py-12",children:[e.jsx(vr,{className:"w-12 h-12 text-gray-300 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500",children:"Belum ada badge yang dibuat"})]})]}),m==="levels"&&e.jsxs("div",{className:"bg-white rounded-lg border shadow-sm overflow-hidden",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Level"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Nama"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Poin Diperlukan"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Manfaat"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Aksi"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:i.filter(k=>k.name.toLowerCase().includes(x.toLowerCase())||k.benefits.toLowerCase().includes(x.toLowerCase())).map(k=>e.jsxs(ge.tr,{className:"hover:bg-gray-50",initial:{opacity:0},animate:{opacity:1},children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:`inline-flex items-center px-3 py-1 rounded-full text-sm font-medium text-white ${k.color?"bg-blue-500":"bg-gray-500"}`,children:k.id})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:k.name}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:[k.pointsRequired.toLocaleString()," poin"]}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-500",children:k.benefits}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:e.jsxs("div",{className:"flex justify-end gap-1",children:[e.jsx(V,{variant:"ghost",size:"sm",onClick:()=>Ke(k),className:"h-8 w-8 p-0 hover:bg-blue-100",children:e.jsx(gt,{className:"w-4 h-4 text-blue-600"})}),e.jsx(V,{variant:"ghost",size:"sm",onClick:()=>Ts(k.id),className:"h-8 w-8 p-0 hover:bg-red-100",children:e.jsx(hs,{className:"w-4 h-4 text-red-600"})})]})})]},k.id))})]})}),i.length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx(ja,{className:"w-12 h-12 text-gray-300 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500",children:"Belum ada level yang dibuat"})]})]}),m==="challenges"&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[n.filter(k=>k.title.toLowerCase().includes(x.toLowerCase())||k.description.toLowerCase().includes(x.toLowerCase())).map(k=>e.jsxs(ge.div,{className:"bg-white rounded-lg border shadow-sm p-6 hover:shadow-md transition-shadow",whileHover:{y:-2},layout:!0,children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`p-2 rounded-lg ${k.isActive?"bg-green-100":"bg-gray-100"}`,children:e.jsx(Ot,{className:`w-5 h-5 ${k.isActive?"text-green-600":"text-gray-400"}`})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-gray-900",children:k.title}),e.jsx("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${k.isActive?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:k.isActive?"Aktif":"Nonaktif"})]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(V,{variant:"ghost",size:"sm",onClick:()=>_e(k),className:"h-8 w-8 p-0 hover:bg-blue-100",children:e.jsx(gt,{className:"w-4 h-4 text-blue-600"})}),e.jsx(V,{variant:"ghost",size:"sm",onClick:()=>Ye(k.id),className:"h-8 w-8 p-0 hover:bg-yellow-100",children:e.jsx(nl,{className:"w-4 h-4 text-yellow-600"})}),e.jsx(V,{variant:"ghost",size:"sm",onClick:()=>Qs(k.id),className:"h-8 w-8 p-0 hover:bg-red-100",children:e.jsx(hs,{className:"w-4 h-4 text-red-600"})})]})]}),e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:k.description}),e.jsxs("div",{className:"flex justify-between items-center text-sm",children:[e.jsxs("span",{className:"font-medium text-green-600",children:[k.reward," poin"]}),e.jsxs("span",{className:"text-gray-500",children:["Deadline: ",La(k.deadline)]})]})]},k.id)),n.length===0&&e.jsxs("div",{className:"col-span-full text-center py-12",children:[e.jsx(Ot,{className:"w-12 h-12 text-gray-300 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500",children:"Belum ada challenge yang dibuat"})]})]}),m==="students"&&e.jsxs("div",{className:"bg-white rounded-lg border shadow-sm overflow-hidden",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Siswa"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Kelas"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Level"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Poin"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Badge Diperoleh"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Aksi"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:It.map(k=>{console.log(`🔍 Mapping badges for ${k.name}:`,{achievements:k.achievements,availableBadges:t.map(Be=>({id:Be.id,name:Be.name}))});const fe=k.achievements.map(Be=>{const C=t.find(Te=>Te.name===Be);return console.log(C?`✅ Badge found: "${Be}" for ${k.name}`:`❌ Badge not found: "${Be}" for ${k.name}`),C}).filter(Boolean);return console.log(`🎖️ Final badges for ${k.name}:`,fe.map(Be=>Be.name)),e.jsxs(ge.tr,{className:"hover:bg-gray-50",initial:{opacity:0},animate:{opacity:1},children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-10 h-10 bg-purple-100 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-sm font-medium text-purple-600",children:k.name.charAt(0).toUpperCase()})}),e.jsxs("div",{className:"ml-3",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:k.name}),e.jsx("div",{className:"text-sm text-gray-500",children:k.username})]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:k.class}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-sm font-medium text-white ${Oa(k.level)}`,children:["Level ",k.level]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:k.points.toLocaleString()}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsx("div",{className:"flex items-center gap-1 flex-wrap max-w-xs",children:fe.length>0?e.jsxs(e.Fragment,{children:[fe.slice(0,4).map((Be,C)=>e.jsxs("div",{className:"group relative",title:`${Be.name}: ${Be.description}`,children:[e.jsx("div",{className:"w-8 h-8 bg-yellow-100 rounded-full flex items-center justify-center border-2 border-yellow-200 hover:border-yellow-400 transition-colors cursor-help",children:Be.icon.match(new RegExp("\\p{Emoji}","u"))?e.jsx("span",{className:"text-sm",children:Be.icon}):e.jsx(vr,{className:"w-4 h-4 text-yellow-600"})}),e.jsxs("div",{className:"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-3 py-2 bg-gray-900 text-white text-xs rounded-lg opacity-0 group-hover:opacity-100 transition-opacity pointer-events-none whitespace-nowrap z-10",children:[e.jsx("div",{className:"font-medium",children:Be.name}),e.jsx("div",{className:"text-gray-300",children:Be.description}),e.jsxs("div",{className:"text-yellow-300",children:["+",Be.pointValue," poin"]}),e.jsx("div",{className:"absolute top-full left-1/2 transform -translate-x-1/2 border-4 border-transparent border-t-gray-900"})]})]},`${Be.id}-${C}`)),fe.length>4&&e.jsxs("div",{className:"w-8 h-8 bg-gray-100 rounded-full flex items-center justify-center border-2 border-gray-200 text-xs text-gray-600 font-medium",children:["+",fe.length-4]})]}):e.jsx("span",{className:"text-sm text-gray-400 italic",children:"Belum ada badge"})}),e.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[fe.length," badge total"]})]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:e.jsxs(V,{variant:"outline",size:"sm",onClick:()=>ps(k),className:"flex items-center gap-2",children:[e.jsx(wr,{className:"w-4 h-4"}),"Beri Reward"]})})]},k.id)})})]})}),s.length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx(_s,{className:"w-12 h-12 text-gray-300 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500",children:"Belum ada data siswa"})]})]})]},m)})]}),e.jsx($a,{isOpen:O,onClose:()=>{I(!1),W(null),Y({name:"",description:"",icon:"🏆",category:"achievement",pointValue:100}),me(!1)},title:M?"Edit Badge":"Tambah Badge Baru",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Nama Badge ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(He,{value:U.name,onChange:k=>Y(fe=>({...fe,name:k.target.value})),placeholder:"Masukkan nama badge"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Deskripsi ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("textarea",{value:U.description,onChange:k=>Y(fe=>({...fe,description:k.target.value})),placeholder:"Masukkan deskripsi badge",className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:border-blue-500 focus:ring-2 focus:ring-blue-500/20 resize-none",rows:3})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Icon"}),e.jsx($g,{selectedEmoji:U.icon,onEmojiSelect:k=>Y(fe=>({...fe,icon:k})),isOpen:X,onToggle:()=>me(!X)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nilai Poin"}),e.jsx(He,{type:"number",value:U.pointValue,onChange:k=>Y(fe=>({...fe,pointValue:parseInt(k.target.value)||0})),placeholder:"100",min:"0"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Kategori"}),e.jsxs("select",{value:U.category,onChange:k=>Y(fe=>({...fe,category:k.target.value})),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:border-blue-500 focus:ring-2 focus:ring-blue-500/20",children:[e.jsx("option",{value:"achievement",children:"Achievement"}),e.jsx("option",{value:"activity",children:"Activity"}),e.jsx("option",{value:"attendance",children:"Attendance"}),e.jsx("option",{value:"special",children:"Special"})]})]})]}),e.jsxs("div",{className:"flex gap-3 mt-6 pt-6 border-t",children:[e.jsx(V,{variant:"outline",onClick:()=>{I(!1),W(null),Y({name:"",description:"",icon:"🏆",category:"achievement",pointValue:100}),me(!1)},className:"flex-1",children:"Batal"}),e.jsxs(V,{onClick:vs,disabled:T||!U.name.trim()||!U.description.trim(),className:"flex-1 flex items-center gap-2",children:[e.jsx(At,{className:"w-4 h-4"}),T?"Menyimpan...":M?"Update":"Simpan"]})]})]})}),e.jsx($a,{isOpen:oe,onClose:()=>{D(!1),ke(null),B({name:"",pointsRequired:0,benefits:"",color:"#3B82F6"})},title:te?"Edit Level":"Tambah Level Baru",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Nama Level ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(He,{value:le.name,onChange:k=>B(fe=>({...fe,name:k.target.value})),placeholder:"Contoh: Pemula, Mahir, Expert"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Poin Diperlukan ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(He,{type:"number",value:le.pointsRequired,onChange:k=>B(fe=>({...fe,pointsRequired:parseInt(k.target.value)||0})),placeholder:"500",min:"0"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Manfaat"}),e.jsx("textarea",{value:le.benefits,onChange:k=>B(fe=>({...fe,benefits:k.target.value})),placeholder:"Jelaskan manfaat mencapai level ini",className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:border-blue-500 focus:ring-2 focus:ring-blue-500/20 resize-none",rows:3})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Warna"}),e.jsx(He,{type:"color",value:le.color,onChange:k=>B(fe=>({...fe,color:k.target.value}))})]})]}),e.jsxs("div",{className:"flex gap-3 mt-6 pt-6 border-t",children:[e.jsx(V,{variant:"outline",onClick:()=>{D(!1),ke(null),B({name:"",pointsRequired:0,benefits:"",color:"#3B82F6"})},className:"flex-1",children:"Batal"}),e.jsxs(V,{onClick:cs,disabled:T||!le.name.trim()||le.pointsRequired<=0,className:"flex-1 flex items-center gap-2",children:[e.jsx(At,{className:"w-4 h-4"}),T?"Menyimpan...":te?"Update":"Simpan"]})]})]})}),e.jsx($a,{isOpen:H,onClose:()=>{ae(!1),ve(null),Me({title:"",description:"",reward:50,deadline:""})},title:re?"Edit Challenge":"Tambah Challenge Baru",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Judul Challenge ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(He,{value:ue.title,onChange:k=>Me(fe=>({...fe,title:k.target.value})),placeholder:"Masukkan judul challenge"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Deskripsi ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("textarea",{value:ue.description,onChange:k=>Me(fe=>({...fe,description:k.target.value})),placeholder:"Jelaskan detail challenge",className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:border-blue-500 focus:ring-2 focus:ring-blue-500/20 resize-none",rows:3})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Reward Poin"}),e.jsx(He,{type:"number",value:ue.reward,onChange:k=>Me(fe=>({...fe,reward:parseInt(k.target.value)||0})),placeholder:"50",min:"0"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Deadline"}),e.jsx(He,{type:"date",value:ue.deadline,onChange:k=>Me(fe=>({...fe,deadline:k.target.value}))})]})]})]}),e.jsxs("div",{className:"flex gap-3 mt-6 pt-6 border-t",children:[e.jsx(V,{variant:"outline",onClick:()=>{ae(!1),ve(null),Me({title:"",description:"",reward:50,deadline:""})},className:"flex-1",children:"Batal"}),e.jsxs(V,{onClick:as,disabled:T||!ue.title.trim()||!ue.description.trim(),className:"flex-1 flex items-center gap-2",children:[e.jsx(At,{className:"w-4 h-4"}),T?"Menyimpan...":re?"Update":"Simpan"]})]})]})}),e.jsx($a,{isOpen:q,onClose:()=>{z(!1),Ie(null),pe({type:"points",points:10,badgeId:"",reason:""})},title:"Beri Reward",children:e.jsx("div",{className:"p-6",children:xe&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"mb-4 p-4 bg-gray-50 rounded-lg",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-purple-100 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-sm font-medium text-purple-600",children:xe.name.charAt(0).toUpperCase()})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:xe.name}),e.jsx("p",{className:"text-sm text-gray-500",children:xe.class})]})]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Jenis Reward"}),e.jsxs("select",{value:de.type,onChange:k=>pe(fe=>({...fe,type:k.target.value})),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:border-blue-500 focus:ring-2 focus:ring-blue-500/20",children:[e.jsx("option",{value:"points",children:"Poin"}),e.jsx("option",{value:"badge",children:"Badge"})]})]}),de.type==="points"?e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Jumlah Poin"}),e.jsx(He,{type:"number",value:de.points,onChange:k=>pe(fe=>({...fe,points:parseInt(k.target.value)||0})),placeholder:"10",min:"1"})]}):e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Pilih Badge"}),e.jsxs("select",{value:de.badgeId,onChange:k=>pe(fe=>({...fe,badgeId:k.target.value})),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:border-blue-500 focus:ring-2 focus:ring-blue-500/20",children:[e.jsx("option",{value:"",children:"Pilih badge..."}),t.map(k=>e.jsxs("option",{value:k.id.toString(),children:[k.name," (+",k.pointValue," poin)"]},k.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Alasan (Opsional)"}),e.jsx(He,{value:de.reason,onChange:k=>pe(fe=>({...fe,reason:k.target.value})),placeholder:"Alasan pemberian reward"})]})]}),e.jsxs("div",{className:"flex gap-3 mt-6 pt-6 border-t",children:[e.jsx(V,{variant:"outline",onClick:()=>{z(!1),Ie(null),pe({type:"points",points:10,badgeId:"",reason:""})},className:"flex-1",children:"Batal"}),e.jsxs(V,{onClick:qs,disabled:T||de.type==="points"&&de.points<=0||de.type==="badge"&&!de.badgeId,className:"flex-1 flex items-center gap-2",children:[e.jsx(wr,{className:"w-4 h-4"}),T?"Memberikan...":"Beri Reward"]})]})]})})}),e.jsx($a,{isOpen:G,onClose:()=>{ce(!1),Oe(null),P([])},title:je?`Berikan Badge: ${je.name}`:"Berikan Badge",size:"large",children:e.jsx("div",{className:"p-6",children:je&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"mb-4 p-4 bg-blue-50 rounded-lg",children:e.jsxs("div",{className:"flex items-center gap-3",children:[ga(je.icon),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:je.name}),e.jsxs("p",{className:"text-sm text-gray-500",children:["+",je.pointValue," poin • ",je.description]})]})]})}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Filter Kelas"}),e.jsxs("select",{value:p,onChange:k=>h(k.target.value),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:border-blue-500 focus:ring-2 focus:ring-blue-500/20",children:[e.jsxs("option",{value:"all",children:["Semua kelas (",s.length," siswa)"]}),Wt.map(k=>e.jsxs("option",{value:k.id,children:[k.name," (",s.filter(fe=>fe.classId===k.id).length," siswa)"]},k.id))]}),Wt.length===0&&e.jsx("p",{className:"text-xs text-red-500 mt-1",children:"⚠️ Tidak ada kelas terdeteksi"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Filter Level"}),e.jsxs("select",{value:w,onChange:k=>L(k.target.value),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:border-blue-500 focus:ring-2 focus:ring-blue-500/20",children:[e.jsx("option",{value:"all",children:"Semua level"}),$t.map(k=>e.jsxs("option",{value:k.toString(),children:["Level ",k," (",s.filter(fe=>fe.level===k).length," siswa)"]},k))]}),$t.length===0&&e.jsx("p",{className:"text-xs text-red-500 mt-1",children:"⚠️ Tidak ada level terdeteksi"})]})]}),!1,e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700",children:["Pilih Siswa (",Dt().length," tersedia)"]}),e.jsx(V,{variant:"outline",size:"sm",onClick:ns,children:Dt().every(k=>N.includes(k.id))?"Batal Pilih Semua":"Pilih Semua"})]}),e.jsxs("div",{className:"max-h-60 overflow-y-auto border rounded-lg",children:[Dt().map(k=>e.jsxs("div",{className:"flex items-center gap-3 p-3 hover:bg-gray-50",children:[e.jsx("input",{type:"checkbox",checked:N.includes(k.id),onChange:()=>zt(k.id),className:"rounded border-gray-300"}),e.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[e.jsx("div",{className:"w-8 h-8 bg-purple-100 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-xs font-medium text-purple-600",children:k.name.charAt(0).toUpperCase()})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:k.name}),e.jsxs("p",{className:"text-xs text-gray-500",children:[k.class," • Level ",k.level]})]})]})]},k.id)),Dt().length===0&&e.jsx("div",{className:"p-4 text-center text-gray-500",children:"Tidak ada siswa yang sesuai filter"})]})]}),e.jsxs("div",{className:"flex gap-3 mt-6 pt-6 border-t",children:[e.jsx(V,{variant:"outline",onClick:()=>{ce(!1),Oe(null),P([])},className:"flex-1",children:"Batal"}),e.jsxs(V,{onClick:Gs,disabled:T||N.length===0,className:"flex-1 flex items-center gap-2",children:[e.jsx(wr,{className:"w-4 h-4"}),T?"Memberikan...":`Berikan ke ${N.length} Siswa`]})]})]})})})]})};function Zi({children:s,allowedRoles:a}){if(!la())return e.jsx(Sa,{to:"/login",replace:!0});const t=Zr();return a&&t&&!a.includes(t.role)?t.role==="teacher"?e.jsx(Sa,{to:"/guru",replace:!0}):t.role==="student"?e.jsx(Sa,{to:"/siswa",replace:!0}):e.jsx(Sa,{to:"/login",replace:!0}):e.jsx(e.Fragment,{children:s})}function Vg(){return S.useEffect(()=>{An()},[]),e.jsxs(ho,{children:[e.jsx(ks,{path:"/login",element:e.jsx(li,{children:e.jsx(Do,{})})}),e.jsx(ks,{path:"/register",element:e.jsx(li,{children:e.jsx(Io,{})})}),e.jsxs(ks,{path:"/guru",element:e.jsx(Zi,{allowedRoles:["teacher"],children:e.jsx(Co,{})}),children:[e.jsx(ks,{index:!0,element:e.jsx(Oo,{})}),e.jsx(ks,{path:"kelas",element:e.jsx(Mo,{})}),e.jsx(ks,{path:"siswa",element:e.jsx(Bo,{})}),e.jsx(ks,{path:"tugas",element:e.jsx(Uo,{})}),e.jsx(ks,{path:"nilai",element:e.jsx(Ag,{})}),e.jsx(ks,{path:"presensi",element:e.jsx(Ig,{})}),e.jsx(ks,{path:"jurnal",element:e.jsx(Og,{})}),e.jsx(ks,{path:"kegiatan",element:e.jsx(Bg,{})}),e.jsx(ks,{path:"bank-soal",element:e.jsx(Hg,{})}),e.jsx(ks,{path:"gamifikasi",element:e.jsx(Kg,{})}),e.jsx(ks,{path:"pengaturan",element:e.jsx("div",{className:"p-6 text-center text-gray-500",children:"Halaman Pengaturan - Coming Soon"})})]}),e.jsx(ks,{path:"/siswa",element:e.jsx(Zi,{allowedRoles:["student"],children:e.jsx(Ao,{})}),children:e.jsx(ks,{index:!0,element:e.jsx(Lo,{})})}),e.jsx(ks,{path:"/",element:e.jsx(Sa,{to:"/login",replace:!0})}),e.jsx(ks,{path:"*",element:e.jsx(Sa,{to:"/login",replace:!0})})]})}Sn.createRoot(document.getElementById("root")).render(e.jsx(Nn.StrictMode,{children:e.jsx(uo,{future:{v7_startTransition:!0},children:e.jsx(Vg,{})})}));
